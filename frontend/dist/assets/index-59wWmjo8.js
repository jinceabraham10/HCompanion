var v1=Object.defineProperty;var E1=(e,t,r)=>t in e?v1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var _1=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var wm=(e,t,r)=>E1(e,typeof t!="symbol"?t+"":t,r);var i4e=_1((ss,as)=>{function b1(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var cN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function H8(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var W8={exports:{}},hw={},G8={exports:{}},Zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ey=Symbol.for("react.element"),w1=Symbol.for("react.portal"),S1=Symbol.for("react.fragment"),T1=Symbol.for("react.strict_mode"),C1=Symbol.for("react.profiler"),R1=Symbol.for("react.provider"),I1=Symbol.for("react.context"),A1=Symbol.for("react.forward_ref"),x1=Symbol.for("react.suspense"),O1=Symbol.for("react.memo"),N1=Symbol.for("react.lazy"),y2=Symbol.iterator;function k1(e){return e===null||typeof e!="object"?null:(e=y2&&e[y2]||e["@@iterator"],typeof e=="function"?e:null)}var z8={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K8=Object.assign,q8={};function Df(e,t,r){this.props=e,this.context=t,this.refs=q8,this.updater=r||z8}Df.prototype.isReactComponent={};Df.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Df.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Y8(){}Y8.prototype=Df.prototype;function lN(e,t,r){this.props=e,this.context=t,this.refs=q8,this.updater=r||z8}var dN=lN.prototype=new Y8;dN.constructor=lN;K8(dN,Df.prototype);dN.isPureReactComponent=!0;var v2=Array.isArray,X8=Object.prototype.hasOwnProperty,uN={current:null},J8={key:!0,ref:!0,__self:!0,__source:!0};function Q8(e,t,r){var n,i={},o=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)X8.call(t,n)&&!J8.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:ey,type:e,key:o,ref:s,props:i,_owner:uN.current}}function P1(e,t){return{$$typeof:ey,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function hN(e){return typeof e=="object"&&e!==null&&e.$$typeof===ey}function D1(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var E2=/\/+/g;function wT(e,t){return typeof e=="object"&&e!==null&&e.key!=null?D1(""+e.key):t.toString(36)}function xE(e,t,r,n,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case ey:case w1:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+wT(s,0):n,v2(i)?(r="",e!=null&&(r=e.replace(E2,"$&/")+"/"),xE(i,t,r,"",function(l){return l})):i!=null&&(hN(i)&&(i=P1(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(E2,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",v2(e))for(var a=0;a<e.length;a++){o=e[a];var c=n+wT(o,a);s+=xE(o,t,r,c,i)}else if(c=k1(e),typeof c=="function")for(e=c.call(e),a=0;!(o=e.next()).done;)o=o.value,c=n+wT(o,a++),s+=xE(o,t,r,c,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function rv(e,t,r){if(e==null)return e;var n=[],i=0;return xE(e,n,"","",function(o){return t.call(r,o,i++)}),n}function L1(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var uo={current:null},OE={transition:null},M1={ReactCurrentDispatcher:uo,ReactCurrentBatchConfig:OE,ReactCurrentOwner:uN};function Z8(){throw Error("act(...) is not supported in production builds of React.")}Zt.Children={map:rv,forEach:function(e,t,r){rv(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return rv(e,function(){t++}),t},toArray:function(e){return rv(e,function(t){return t})||[]},only:function(e){if(!hN(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Zt.Component=Df;Zt.Fragment=S1;Zt.Profiler=C1;Zt.PureComponent=lN;Zt.StrictMode=T1;Zt.Suspense=x1;Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M1;Zt.act=Z8;Zt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=K8({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=uN.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)X8.call(t,c)&&!J8.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];n.children=a}return{$$typeof:ey,type:e.type,key:i,ref:o,props:n,_owner:s}};Zt.createContext=function(e){return e={$$typeof:I1,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:R1,_context:e},e.Consumer=e};Zt.createElement=Q8;Zt.createFactory=function(e){var t=Q8.bind(null,e);return t.type=e,t};Zt.createRef=function(){return{current:null}};Zt.forwardRef=function(e){return{$$typeof:A1,render:e}};Zt.isValidElement=hN;Zt.lazy=function(e){return{$$typeof:N1,_payload:{_status:-1,_result:e},_init:L1}};Zt.memo=function(e,t){return{$$typeof:O1,type:e,compare:t===void 0?null:t}};Zt.startTransition=function(e){var t=OE.transition;OE.transition={};try{e()}finally{OE.transition=t}};Zt.unstable_act=Z8;Zt.useCallback=function(e,t){return uo.current.useCallback(e,t)};Zt.useContext=function(e){return uo.current.useContext(e)};Zt.useDebugValue=function(){};Zt.useDeferredValue=function(e){return uo.current.useDeferredValue(e)};Zt.useEffect=function(e,t){return uo.current.useEffect(e,t)};Zt.useId=function(){return uo.current.useId()};Zt.useImperativeHandle=function(e,t,r){return uo.current.useImperativeHandle(e,t,r)};Zt.useInsertionEffect=function(e,t){return uo.current.useInsertionEffect(e,t)};Zt.useLayoutEffect=function(e,t){return uo.current.useLayoutEffect(e,t)};Zt.useMemo=function(e,t){return uo.current.useMemo(e,t)};Zt.useReducer=function(e,t,r){return uo.current.useReducer(e,t,r)};Zt.useRef=function(e){return uo.current.useRef(e)};Zt.useState=function(e){return uo.current.useState(e)};Zt.useSyncExternalStore=function(e,t,r){return uo.current.useSyncExternalStore(e,t,r)};Zt.useTransition=function(){return uo.current.useTransition()};Zt.version="18.3.1";G8.exports=Zt;var T=G8.exports;const Sr=Pa(T),e$=b1({__proto__:null,default:Sr},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j1=T,U1=Symbol.for("react.element"),F1=Symbol.for("react.fragment"),V1=Object.prototype.hasOwnProperty,B1=j1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$1={key:!0,ref:!0,__self:!0,__source:!0};function t$(e,t,r){var n,i={},o=null,s=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)V1.call(t,n)&&!$1.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:U1,type:e,key:o,ref:s,props:i,_owner:B1.current}}hw.Fragment=F1;hw.jsx=t$;hw.jsxs=t$;W8.exports=hw;var h=W8.exports,r$={exports:{}},ms={},n$={exports:{}},i$={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,F){var P=O.length;O.push(F);e:for(;0<P;){var _=P-1>>>1,R=O[_];if(0<i(R,F))O[_]=F,O[P]=R,P=_;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var F=O[0],P=O.pop();if(P!==F){O[0]=P;e:for(var _=0,R=O.length,k=R>>>1;_<k;){var z=2*(_+1)-1,U=O[z],q=z+1,ie=O[q];if(0>i(U,P))q<R&&0>i(ie,U)?(O[_]=ie,O[q]=P,_=q):(O[_]=U,O[z]=P,_=z);else if(q<R&&0>i(ie,P))O[_]=ie,O[q]=P,_=q;else break e}}return F}function i(O,F){var P=O.sortIndex-F.sortIndex;return P!==0?P:O.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var c=[],l=[],d=1,u=null,p=3,f=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(O){for(var F=r(l);F!==null;){if(F.callback===null)n(l);else if(F.startTime<=O)n(l),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(l)}}function S(O){if(g=!1,w(O),!m)if(r(c)!==null)m=!0,K(A);else{var F=r(l);F!==null&&x(S,F.startTime-O)}}function A(O,F){m=!1,g&&(g=!1,v(j),j=-1),f=!0;var P=p;try{for(w(F),u=r(c);u!==null&&(!(u.expirationTime>F)||O&&!Y());){var _=u.callback;if(typeof _=="function"){u.callback=null,p=u.priorityLevel;var R=_(u.expirationTime<=F);F=e.unstable_now(),typeof R=="function"?u.callback=R:u===r(c)&&n(c),w(F)}else n(c);u=r(c)}if(u!==null)var k=!0;else{var z=r(l);z!==null&&x(S,z.startTime-F),k=!1}return k}finally{u=null,p=P,f=!1}}var N=!1,L=null,j=-1,W=5,V=-1;function Y(){return!(e.unstable_now()-V<W)}function Z(){if(L!==null){var O=e.unstable_now();V=O;var F=!0;try{F=L(!0,O)}finally{F?te():(N=!1,L=null)}}else N=!1}var te;if(typeof E=="function")te=function(){E(Z)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,$=H.port2;H.port1.onmessage=Z,te=function(){$.postMessage(null)}}else te=function(){y(Z,0)};function K(O){L=O,N||(N=!0,te())}function x(O,F){j=y(function(){O(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,K(A))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var P=p;p=F;try{return O()}finally{p=P}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,F){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var P=p;p=O;try{return F()}finally{p=P}},e.unstable_scheduleCallback=function(O,F,P){var _=e.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?_+P:_):P=_,O){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=P+R,O={id:d++,callback:F,priorityLevel:O,startTime:P,expirationTime:R,sortIndex:-1},P>_?(O.sortIndex=P,t(l,O),r(c)===null&&O===r(l)&&(g?(v(j),j=-1):g=!0,x(S,P-_))):(O.sortIndex=R,t(c,O),m||f||(m=!0,K(A))),O},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(O){var F=p;return function(){var P=p;p=F;try{return O.apply(this,arguments)}finally{p=P}}}})(i$);n$.exports=i$;var H1=n$.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W1=T,ds=H1;function Ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o$=new Set,Xg={};function ah(e,t){tf(e,t),tf(e+"Capture",t)}function tf(e,t){for(Xg[e]=t,e=0;e<t.length;e++)o$.add(t[e])}var ol=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),aA=Object.prototype.hasOwnProperty,G1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_2={},b2={};function z1(e){return aA.call(b2,e)?!0:aA.call(_2,e)?!1:G1.test(e)?b2[e]=!0:(_2[e]=!0,!1)}function K1(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function q1(e,t,r,n){if(t===null||typeof t>"u"||K1(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ho(e,t,r,n,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Di={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Di[e]=new ho(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Di[t]=new ho(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Di[e]=new ho(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Di[e]=new ho(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Di[e]=new ho(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Di[e]=new ho(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Di[e]=new ho(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Di[e]=new ho(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Di[e]=new ho(e,5,!1,e.toLowerCase(),null,!1,!1)});var pN=/[\-:]([a-z])/g;function fN(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(pN,fN);Di[t]=new ho(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(pN,fN);Di[t]=new ho(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(pN,fN);Di[t]=new ho(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Di[e]=new ho(e,1,!1,e.toLowerCase(),null,!1,!1)});Di.xlinkHref=new ho("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Di[e]=new ho(e,1,!1,e.toLowerCase(),null,!0,!0)});function mN(e,t,r,n){var i=Di.hasOwnProperty(t)?Di[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(q1(t,r,i,n)&&(r=null),n||i===null?z1(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ml=W1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nv=Symbol.for("react.element"),sp=Symbol.for("react.portal"),ap=Symbol.for("react.fragment"),gN=Symbol.for("react.strict_mode"),cA=Symbol.for("react.profiler"),s$=Symbol.for("react.provider"),a$=Symbol.for("react.context"),yN=Symbol.for("react.forward_ref"),lA=Symbol.for("react.suspense"),dA=Symbol.for("react.suspense_list"),vN=Symbol.for("react.memo"),Bl=Symbol.for("react.lazy"),c$=Symbol.for("react.offscreen"),w2=Symbol.iterator;function Sm(e){return e===null||typeof e!="object"?null:(e=w2&&e[w2]||e["@@iterator"],typeof e=="function"?e:null)}var Cn=Object.assign,ST;function Zm(e){if(ST===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ST=t&&t[1]||""}return`
`+ST+e}var TT=!1;function CT(e,t){if(!e||TT)return"";TT=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=n.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var c=`
`+i[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=a);break}}}finally{TT=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Zm(e):""}function Y1(e){switch(e.tag){case 5:return Zm(e.type);case 16:return Zm("Lazy");case 13:return Zm("Suspense");case 19:return Zm("SuspenseList");case 0:case 2:case 15:return e=CT(e.type,!1),e;case 11:return e=CT(e.type.render,!1),e;case 1:return e=CT(e.type,!0),e;default:return""}}function uA(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ap:return"Fragment";case sp:return"Portal";case cA:return"Profiler";case gN:return"StrictMode";case lA:return"Suspense";case dA:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case a$:return(e.displayName||"Context")+".Consumer";case s$:return(e._context.displayName||"Context")+".Provider";case yN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case vN:return t=e.displayName||null,t!==null?t:uA(e.type)||"Memo";case Bl:t=e._payload,e=e._init;try{return uA(e(t))}catch{}}return null}function X1(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return uA(t);case 8:return t===gN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Sd(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function l$(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function J1(e){var t=l$(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function iv(e){e._valueTracker||(e._valueTracker=J1(e))}function d$(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=l$(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function S_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function hA(e,t){var r=t.checked;return Cn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function S2(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Sd(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function u$(e,t){t=t.checked,t!=null&&mN(e,"checked",t,!1)}function pA(e,t){u$(e,t);var r=Sd(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?fA(e,t.type,r):t.hasOwnProperty("defaultValue")&&fA(e,t.type,Sd(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function T2(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function fA(e,t,r){(t!=="number"||S_(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var eg=Array.isArray;function Lp(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Sd(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function mA(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ie(91));return Cn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function C2(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ie(92));if(eg(r)){if(1<r.length)throw Error(Ie(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Sd(r)}}function h$(e,t){var r=Sd(t.value),n=Sd(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function R2(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function p$(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gA(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?p$(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ov,f$=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ov=ov||document.createElement("div"),ov.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ov.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Jg(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Eg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Q1=["Webkit","ms","Moz","O"];Object.keys(Eg).forEach(function(e){Q1.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Eg[t]=Eg[e]})});function m$(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Eg.hasOwnProperty(e)&&Eg[e]?(""+t).trim():t+"px"}function g$(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=m$(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Z1=Cn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yA(e,t){if(t){if(Z1[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ie(62))}}function vA(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var EA=null;function EN(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _A=null,Mp=null,jp=null;function I2(e){if(e=ny(e)){if(typeof _A!="function")throw Error(Ie(280));var t=e.stateNode;t&&(t=yw(t),_A(e.stateNode,e.type,t))}}function y$(e){Mp?jp?jp.push(e):jp=[e]:Mp=e}function v$(){if(Mp){var e=Mp,t=jp;if(jp=Mp=null,I2(e),t)for(e=0;e<t.length;e++)I2(t[e])}}function E$(e,t){return e(t)}function _$(){}var RT=!1;function b$(e,t,r){if(RT)return e(t,r);RT=!0;try{return E$(e,t,r)}finally{RT=!1,(Mp!==null||jp!==null)&&(_$(),v$())}}function Qg(e,t){var r=e.stateNode;if(r===null)return null;var n=yw(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ie(231,t,typeof r));return r}var bA=!1;if(ol)try{var Tm={};Object.defineProperty(Tm,"passive",{get:function(){bA=!0}}),window.addEventListener("test",Tm,Tm),window.removeEventListener("test",Tm,Tm)}catch{bA=!1}function eee(e,t,r,n,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(d){this.onError(d)}}var _g=!1,T_=null,C_=!1,wA=null,tee={onError:function(e){_g=!0,T_=e}};function ree(e,t,r,n,i,o,s,a,c){_g=!1,T_=null,eee.apply(tee,arguments)}function nee(e,t,r,n,i,o,s,a,c){if(ree.apply(this,arguments),_g){if(_g){var l=T_;_g=!1,T_=null}else throw Error(Ie(198));C_||(C_=!0,wA=l)}}function ch(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function w$(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function A2(e){if(ch(e)!==e)throw Error(Ie(188))}function iee(e){var t=e.alternate;if(!t){if(t=ch(e),t===null)throw Error(Ie(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return A2(i),e;if(o===n)return A2(i),t;o=o.sibling}throw Error(Ie(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,a=i.child;a;){if(a===r){s=!0,r=i,n=o;break}if(a===n){s=!0,n=i,r=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===r){s=!0,r=o,n=i;break}if(a===n){s=!0,n=o,r=i;break}a=a.sibling}if(!s)throw Error(Ie(189))}}if(r.alternate!==n)throw Error(Ie(190))}if(r.tag!==3)throw Error(Ie(188));return r.stateNode.current===r?e:t}function S$(e){return e=iee(e),e!==null?T$(e):null}function T$(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=T$(e);if(t!==null)return t;e=e.sibling}return null}var C$=ds.unstable_scheduleCallback,x2=ds.unstable_cancelCallback,oee=ds.unstable_shouldYield,see=ds.unstable_requestPaint,Hn=ds.unstable_now,aee=ds.unstable_getCurrentPriorityLevel,_N=ds.unstable_ImmediatePriority,R$=ds.unstable_UserBlockingPriority,R_=ds.unstable_NormalPriority,cee=ds.unstable_LowPriority,I$=ds.unstable_IdlePriority,pw=null,dc=null;function lee(e){if(dc&&typeof dc.onCommitFiberRoot=="function")try{dc.onCommitFiberRoot(pw,e,void 0,(e.current.flags&128)===128)}catch{}}var Aa=Math.clz32?Math.clz32:hee,dee=Math.log,uee=Math.LN2;function hee(e){return e>>>=0,e===0?32:31-(dee(e)/uee|0)|0}var sv=64,av=4194304;function tg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function I_(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,s=r&268435455;if(s!==0){var a=s&~i;a!==0?n=tg(a):(o&=s,o!==0&&(n=tg(o)))}else s=r&~i,s!==0?n=tg(s):o!==0&&(n=tg(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Aa(t),i=1<<r,n|=e[r],t&=~i;return n}function pee(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fee(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-Aa(o),a=1<<s,c=i[s];c===-1?(!(a&r)||a&n)&&(i[s]=pee(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}function SA(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function A$(){var e=sv;return sv<<=1,!(sv&4194240)&&(sv=64),e}function IT(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ty(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Aa(t),e[t]=r}function mee(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Aa(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}function bN(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Aa(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Lr=0;function x$(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var O$,wN,N$,k$,P$,TA=!1,cv=[],ad=null,cd=null,ld=null,Zg=new Map,e0=new Map,Wl=[],gee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function O2(e,t){switch(e){case"focusin":case"focusout":ad=null;break;case"dragenter":case"dragleave":cd=null;break;case"mouseover":case"mouseout":ld=null;break;case"pointerover":case"pointerout":Zg.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":e0.delete(t.pointerId)}}function Cm(e,t,r,n,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},t!==null&&(t=ny(t),t!==null&&wN(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function yee(e,t,r,n,i){switch(t){case"focusin":return ad=Cm(ad,e,t,r,n,i),!0;case"dragenter":return cd=Cm(cd,e,t,r,n,i),!0;case"mouseover":return ld=Cm(ld,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return Zg.set(o,Cm(Zg.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,e0.set(o,Cm(e0.get(o)||null,e,t,r,n,i)),!0}return!1}function D$(e){var t=yu(e.target);if(t!==null){var r=ch(t);if(r!==null){if(t=r.tag,t===13){if(t=w$(r),t!==null){e.blockedOn=t,P$(e.priority,function(){N$(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function NE(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=CA(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);EA=n,r.target.dispatchEvent(n),EA=null}else return t=ny(r),t!==null&&wN(t),e.blockedOn=r,!1;t.shift()}return!0}function N2(e,t,r){NE(e)&&r.delete(t)}function vee(){TA=!1,ad!==null&&NE(ad)&&(ad=null),cd!==null&&NE(cd)&&(cd=null),ld!==null&&NE(ld)&&(ld=null),Zg.forEach(N2),e0.forEach(N2)}function Rm(e,t){e.blockedOn===t&&(e.blockedOn=null,TA||(TA=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,vee)))}function t0(e){function t(i){return Rm(i,e)}if(0<cv.length){Rm(cv[0],e);for(var r=1;r<cv.length;r++){var n=cv[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ad!==null&&Rm(ad,e),cd!==null&&Rm(cd,e),ld!==null&&Rm(ld,e),Zg.forEach(t),e0.forEach(t),r=0;r<Wl.length;r++)n=Wl[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Wl.length&&(r=Wl[0],r.blockedOn===null);)D$(r),r.blockedOn===null&&Wl.shift()}var Up=ml.ReactCurrentBatchConfig,A_=!0;function Eee(e,t,r,n){var i=Lr,o=Up.transition;Up.transition=null;try{Lr=1,SN(e,t,r,n)}finally{Lr=i,Up.transition=o}}function _ee(e,t,r,n){var i=Lr,o=Up.transition;Up.transition=null;try{Lr=4,SN(e,t,r,n)}finally{Lr=i,Up.transition=o}}function SN(e,t,r,n){if(A_){var i=CA(e,t,r,n);if(i===null)jT(e,t,n,x_,r),O2(e,n);else if(yee(i,e,t,r,n))n.stopPropagation();else if(O2(e,n),t&4&&-1<gee.indexOf(e)){for(;i!==null;){var o=ny(i);if(o!==null&&O$(o),o=CA(e,t,r,n),o===null&&jT(e,t,n,x_,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else jT(e,t,n,null,r)}}var x_=null;function CA(e,t,r,n){if(x_=null,e=EN(n),e=yu(e),e!==null)if(t=ch(e),t===null)e=null;else if(r=t.tag,r===13){if(e=w$(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return x_=e,null}function L$(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(aee()){case _N:return 1;case R$:return 4;case R_:case cee:return 16;case I$:return 536870912;default:return 16}default:return 16}}var Xl=null,TN=null,kE=null;function M$(){if(kE)return kE;var e,t=TN,r=t.length,n,i="value"in Xl?Xl.value:Xl.textContent,o=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[o-n];n++);return kE=i.slice(e,1<n?1-n:void 0)}function PE(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function lv(){return!0}function k2(){return!1}function gs(e){function t(r,n,i,o,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?lv:k2,this.isPropagationStopped=k2,this}return Cn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=lv)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=lv)},persist:function(){},isPersistent:lv}),t}var Lf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},CN=gs(Lf),ry=Cn({},Lf,{view:0,detail:0}),bee=gs(ry),AT,xT,Im,fw=Cn({},ry,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:RN,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Im&&(Im&&e.type==="mousemove"?(AT=e.screenX-Im.screenX,xT=e.screenY-Im.screenY):xT=AT=0,Im=e),AT)},movementY:function(e){return"movementY"in e?e.movementY:xT}}),P2=gs(fw),wee=Cn({},fw,{dataTransfer:0}),See=gs(wee),Tee=Cn({},ry,{relatedTarget:0}),OT=gs(Tee),Cee=Cn({},Lf,{animationName:0,elapsedTime:0,pseudoElement:0}),Ree=gs(Cee),Iee=Cn({},Lf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Aee=gs(Iee),xee=Cn({},Lf,{data:0}),D2=gs(xee),Oee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pee(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=kee[e])?!!t[e]:!1}function RN(){return Pee}var Dee=Cn({},ry,{key:function(e){if(e.key){var t=Oee[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=PE(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nee[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:RN,charCode:function(e){return e.type==="keypress"?PE(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?PE(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lee=gs(Dee),Mee=Cn({},fw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),L2=gs(Mee),jee=Cn({},ry,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:RN}),Uee=gs(jee),Fee=Cn({},Lf,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vee=gs(Fee),Bee=Cn({},fw,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$ee=gs(Bee),Hee=[9,13,27,32],IN=ol&&"CompositionEvent"in window,bg=null;ol&&"documentMode"in document&&(bg=document.documentMode);var Wee=ol&&"TextEvent"in window&&!bg,j$=ol&&(!IN||bg&&8<bg&&11>=bg),M2=" ",j2=!1;function U$(e,t){switch(e){case"keyup":return Hee.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function F$(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var cp=!1;function Gee(e,t){switch(e){case"compositionend":return F$(t);case"keypress":return t.which!==32?null:(j2=!0,M2);case"textInput":return e=t.data,e===M2&&j2?null:e;default:return null}}function zee(e,t){if(cp)return e==="compositionend"||!IN&&U$(e,t)?(e=M$(),kE=TN=Xl=null,cp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return j$&&t.locale!=="ko"?null:t.data;default:return null}}var Kee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function U2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Kee[e.type]:t==="textarea"}function V$(e,t,r,n){y$(n),t=O_(t,"onChange"),0<t.length&&(r=new CN("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var wg=null,r0=null;function qee(e){J$(e,0)}function mw(e){var t=up(e);if(d$(t))return e}function Yee(e,t){if(e==="change")return t}var B$=!1;if(ol){var NT;if(ol){var kT="oninput"in document;if(!kT){var F2=document.createElement("div");F2.setAttribute("oninput","return;"),kT=typeof F2.oninput=="function"}NT=kT}else NT=!1;B$=NT&&(!document.documentMode||9<document.documentMode)}function V2(){wg&&(wg.detachEvent("onpropertychange",$$),r0=wg=null)}function $$(e){if(e.propertyName==="value"&&mw(r0)){var t=[];V$(t,r0,e,EN(e)),b$(qee,t)}}function Xee(e,t,r){e==="focusin"?(V2(),wg=t,r0=r,wg.attachEvent("onpropertychange",$$)):e==="focusout"&&V2()}function Jee(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return mw(r0)}function Qee(e,t){if(e==="click")return mw(t)}function Zee(e,t){if(e==="input"||e==="change")return mw(t)}function ete(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Na=typeof Object.is=="function"?Object.is:ete;function n0(e,t){if(Na(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!aA.call(t,i)||!Na(e[i],t[i]))return!1}return!0}function B2(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $2(e,t){var r=B2(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=B2(r)}}function H$(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?H$(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function W$(){for(var e=window,t=S_();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=S_(e.document)}return t}function AN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tte(e){var t=W$(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&H$(r.ownerDocument.documentElement,r)){if(n!==null&&AN(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=$2(r,o);var s=$2(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var rte=ol&&"documentMode"in document&&11>=document.documentMode,lp=null,RA=null,Sg=null,IA=!1;function H2(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;IA||lp==null||lp!==S_(n)||(n=lp,"selectionStart"in n&&AN(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Sg&&n0(Sg,n)||(Sg=n,n=O_(RA,"onSelect"),0<n.length&&(t=new CN("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=lp)))}function dv(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var dp={animationend:dv("Animation","AnimationEnd"),animationiteration:dv("Animation","AnimationIteration"),animationstart:dv("Animation","AnimationStart"),transitionend:dv("Transition","TransitionEnd")},PT={},G$={};ol&&(G$=document.createElement("div").style,"AnimationEvent"in window||(delete dp.animationend.animation,delete dp.animationiteration.animation,delete dp.animationstart.animation),"TransitionEvent"in window||delete dp.transitionend.transition);function gw(e){if(PT[e])return PT[e];if(!dp[e])return e;var t=dp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in G$)return PT[e]=t[r];return e}var z$=gw("animationend"),K$=gw("animationiteration"),q$=gw("animationstart"),Y$=gw("transitionend"),X$=new Map,W2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kd(e,t){X$.set(e,t),ah(t,[e])}for(var DT=0;DT<W2.length;DT++){var LT=W2[DT],nte=LT.toLowerCase(),ite=LT[0].toUpperCase()+LT.slice(1);kd(nte,"on"+ite)}kd(z$,"onAnimationEnd");kd(K$,"onAnimationIteration");kd(q$,"onAnimationStart");kd("dblclick","onDoubleClick");kd("focusin","onFocus");kd("focusout","onBlur");kd(Y$,"onTransitionEnd");tf("onMouseEnter",["mouseout","mouseover"]);tf("onMouseLeave",["mouseout","mouseover"]);tf("onPointerEnter",["pointerout","pointerover"]);tf("onPointerLeave",["pointerout","pointerover"]);ah("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ah("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ah("onBeforeInput",["compositionend","keypress","textInput","paste"]);ah("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ah("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ah("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ote=new Set("cancel close invalid load scroll toggle".split(" ").concat(rg));function G2(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,nee(n,t,void 0,e),e.currentTarget=null}function J$(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;G2(i,a,l),o=c}else for(s=0;s<n.length;s++){if(a=n[s],c=a.instance,l=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;G2(i,a,l),o=c}}}if(C_)throw e=wA,C_=!1,wA=null,e}function en(e,t){var r=t[kA];r===void 0&&(r=t[kA]=new Set);var n=e+"__bubble";r.has(n)||(Q$(t,e,2,!1),r.add(n))}function MT(e,t,r){var n=0;t&&(n|=4),Q$(r,e,n,t)}var uv="_reactListening"+Math.random().toString(36).slice(2);function i0(e){if(!e[uv]){e[uv]=!0,o$.forEach(function(r){r!=="selectionchange"&&(ote.has(r)||MT(r,!1,e),MT(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[uv]||(t[uv]=!0,MT("selectionchange",!1,t))}}function Q$(e,t,r,n){switch(L$(t)){case 1:var i=Eee;break;case 4:i=_ee;break;default:i=SN}r=i.bind(null,t,r,e),i=void 0,!bA||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function jT(e,t,r,n,i){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;a!==null;){if(s=yu(a),s===null)return;if(c=s.tag,c===5||c===6){n=o=s;continue e}a=a.parentNode}}n=n.return}b$(function(){var l=o,d=EN(r),u=[];e:{var p=X$.get(e);if(p!==void 0){var f=CN,m=e;switch(e){case"keypress":if(PE(r)===0)break e;case"keydown":case"keyup":f=Lee;break;case"focusin":m="focus",f=OT;break;case"focusout":m="blur",f=OT;break;case"beforeblur":case"afterblur":f=OT;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=P2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=See;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Uee;break;case z$:case K$:case q$:f=Ree;break;case Y$:f=Vee;break;case"scroll":f=bee;break;case"wheel":f=$ee;break;case"copy":case"cut":case"paste":f=Aee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=L2}var g=(t&4)!==0,y=!g&&e==="scroll",v=g?p!==null?p+"Capture":null:p;g=[];for(var E=l,w;E!==null;){w=E;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,v!==null&&(S=Qg(E,v),S!=null&&g.push(o0(E,S,w)))),y)break;E=E.return}0<g.length&&(p=new f(p,m,null,r,d),u.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&r!==EA&&(m=r.relatedTarget||r.fromElement)&&(yu(m)||m[sl]))break e;if((f||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,f?(m=r.relatedTarget||r.toElement,f=l,m=m?yu(m):null,m!==null&&(y=ch(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=l),f!==m)){if(g=P2,S="onMouseLeave",v="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(g=L2,S="onPointerLeave",v="onPointerEnter",E="pointer"),y=f==null?p:up(f),w=m==null?p:up(m),p=new g(S,E+"leave",f,r,d),p.target=y,p.relatedTarget=w,S=null,yu(d)===l&&(g=new g(v,E+"enter",m,r,d),g.target=w,g.relatedTarget=y,S=g),y=S,f&&m)t:{for(g=f,v=m,E=0,w=g;w;w=Dh(w))E++;for(w=0,S=v;S;S=Dh(S))w++;for(;0<E-w;)g=Dh(g),E--;for(;0<w-E;)v=Dh(v),w--;for(;E--;){if(g===v||v!==null&&g===v.alternate)break t;g=Dh(g),v=Dh(v)}g=null}else g=null;f!==null&&z2(u,p,f,g,!1),m!==null&&y!==null&&z2(u,y,m,g,!0)}}e:{if(p=l?up(l):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var A=Yee;else if(U2(p))if(B$)A=Zee;else{A=Jee;var N=Xee}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(A=Qee);if(A&&(A=A(e,l))){V$(u,A,r,d);break e}N&&N(e,p,l),e==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&fA(p,"number",p.value)}switch(N=l?up(l):window,e){case"focusin":(U2(N)||N.contentEditable==="true")&&(lp=N,RA=l,Sg=null);break;case"focusout":Sg=RA=lp=null;break;case"mousedown":IA=!0;break;case"contextmenu":case"mouseup":case"dragend":IA=!1,H2(u,r,d);break;case"selectionchange":if(rte)break;case"keydown":case"keyup":H2(u,r,d)}var L;if(IN)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else cp?U$(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(j$&&r.locale!=="ko"&&(cp||j!=="onCompositionStart"?j==="onCompositionEnd"&&cp&&(L=M$()):(Xl=d,TN="value"in Xl?Xl.value:Xl.textContent,cp=!0)),N=O_(l,j),0<N.length&&(j=new D2(j,e,null,r,d),u.push({event:j,listeners:N}),L?j.data=L:(L=F$(r),L!==null&&(j.data=L)))),(L=Wee?Gee(e,r):zee(e,r))&&(l=O_(l,"onBeforeInput"),0<l.length&&(d=new D2("onBeforeInput","beforeinput",null,r,d),u.push({event:d,listeners:l}),d.data=L))}J$(u,t)})}function o0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function O_(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Qg(e,r),o!=null&&n.unshift(o0(e,o,i)),o=Qg(e,t),o!=null&&n.push(o0(e,o,i))),e=e.return}return n}function Dh(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function z2(e,t,r,n,i){for(var o=t._reactName,s=[];r!==null&&r!==n;){var a=r,c=a.alternate,l=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&l!==null&&(a=l,i?(c=Qg(r,o),c!=null&&s.unshift(o0(r,c,a))):i||(c=Qg(r,o),c!=null&&s.push(o0(r,c,a)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var ste=/\r\n?/g,ate=/\u0000|\uFFFD/g;function K2(e){return(typeof e=="string"?e:""+e).replace(ste,`
`).replace(ate,"")}function hv(e,t,r){if(t=K2(t),K2(e)!==t&&r)throw Error(Ie(425))}function N_(){}var AA=null,xA=null;function OA(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var NA=typeof setTimeout=="function"?setTimeout:void 0,cte=typeof clearTimeout=="function"?clearTimeout:void 0,q2=typeof Promise=="function"?Promise:void 0,lte=typeof queueMicrotask=="function"?queueMicrotask:typeof q2<"u"?function(e){return q2.resolve(null).then(e).catch(dte)}:NA;function dte(e){setTimeout(function(){throw e})}function UT(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),t0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);t0(t)}function dd(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Y2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Mf=Math.random().toString(36).slice(2),nc="__reactFiber$"+Mf,s0="__reactProps$"+Mf,sl="__reactContainer$"+Mf,kA="__reactEvents$"+Mf,ute="__reactListeners$"+Mf,hte="__reactHandles$"+Mf;function yu(e){var t=e[nc];if(t)return t;for(var r=e.parentNode;r;){if(t=r[sl]||r[nc]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Y2(e);e!==null;){if(r=e[nc])return r;e=Y2(e)}return t}e=r,r=e.parentNode}return null}function ny(e){return e=e[nc]||e[sl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function up(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ie(33))}function yw(e){return e[s0]||null}var PA=[],hp=-1;function Pd(e){return{current:e}}function an(e){0>hp||(e.current=PA[hp],PA[hp]=null,hp--)}function Jr(e,t){hp++,PA[hp]=e.current,e.current=t}var Td={},Ki=Pd(Td),No=Pd(!1),Hu=Td;function rf(e,t){var r=e.type.contextTypes;if(!r)return Td;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ko(e){return e=e.childContextTypes,e!=null}function k_(){an(No),an(Ki)}function X2(e,t,r){if(Ki.current!==Td)throw Error(Ie(168));Jr(Ki,t),Jr(No,r)}function Z$(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Ie(108,X1(e)||"Unknown",i));return Cn({},r,n)}function P_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Td,Hu=Ki.current,Jr(Ki,e),Jr(No,No.current),!0}function J2(e,t,r){var n=e.stateNode;if(!n)throw Error(Ie(169));r?(e=Z$(e,t,Hu),n.__reactInternalMemoizedMergedChildContext=e,an(No),an(Ki),Jr(Ki,e)):an(No),Jr(No,r)}var Hc=null,vw=!1,FT=!1;function e7(e){Hc===null?Hc=[e]:Hc.push(e)}function pte(e){vw=!0,e7(e)}function Dd(){if(!FT&&Hc!==null){FT=!0;var e=0,t=Lr;try{var r=Hc;for(Lr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Hc=null,vw=!1}catch(i){throw Hc!==null&&(Hc=Hc.slice(e+1)),C$(_N,Dd),i}finally{Lr=t,FT=!1}}return null}var pp=[],fp=0,D_=null,L_=0,$s=[],Hs=0,Wu=null,Yc=1,Xc="";function ru(e,t){pp[fp++]=L_,pp[fp++]=D_,D_=e,L_=t}function t7(e,t,r){$s[Hs++]=Yc,$s[Hs++]=Xc,$s[Hs++]=Wu,Wu=e;var n=Yc;e=Xc;var i=32-Aa(n)-1;n&=~(1<<i),r+=1;var o=32-Aa(t)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Yc=1<<32-Aa(t)+i|r<<i|n,Xc=o+e}else Yc=1<<o|r<<i|n,Xc=e}function xN(e){e.return!==null&&(ru(e,1),t7(e,1,0))}function ON(e){for(;e===D_;)D_=pp[--fp],pp[fp]=null,L_=pp[--fp],pp[fp]=null;for(;e===Wu;)Wu=$s[--Hs],$s[Hs]=null,Xc=$s[--Hs],$s[Hs]=null,Yc=$s[--Hs],$s[Hs]=null}var cs=null,rs=null,hn=!1,Sa=null;function r7(e,t){var r=Ks(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Q2(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,cs=e,rs=dd(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,cs=e,rs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Wu!==null?{id:Yc,overflow:Xc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ks(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,cs=e,rs=null,!0):!1;default:return!1}}function DA(e){return(e.mode&1)!==0&&(e.flags&128)===0}function LA(e){if(hn){var t=rs;if(t){var r=t;if(!Q2(e,t)){if(DA(e))throw Error(Ie(418));t=dd(r.nextSibling);var n=cs;t&&Q2(e,t)?r7(n,r):(e.flags=e.flags&-4097|2,hn=!1,cs=e)}}else{if(DA(e))throw Error(Ie(418));e.flags=e.flags&-4097|2,hn=!1,cs=e}}}function Z2(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;cs=e}function pv(e){if(e!==cs)return!1;if(!hn)return Z2(e),hn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!OA(e.type,e.memoizedProps)),t&&(t=rs)){if(DA(e))throw n7(),Error(Ie(418));for(;t;)r7(e,t),t=dd(t.nextSibling)}if(Z2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){rs=dd(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}rs=null}}else rs=cs?dd(e.stateNode.nextSibling):null;return!0}function n7(){for(var e=rs;e;)e=dd(e.nextSibling)}function nf(){rs=cs=null,hn=!1}function NN(e){Sa===null?Sa=[e]:Sa.push(e)}var fte=ml.ReactCurrentBatchConfig;function Am(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ie(309));var n=r.stateNode}if(!n)throw Error(Ie(147,e));var i=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(Ie(284));if(!r._owner)throw Error(Ie(290,e))}return e}function fv(e,t){throw e=Object.prototype.toString.call(t),Error(Ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function eL(e){var t=e._init;return t(e._payload)}function i7(e){function t(v,E){if(e){var w=v.deletions;w===null?(v.deletions=[E],v.flags|=16):w.push(E)}}function r(v,E){if(!e)return null;for(;E!==null;)t(v,E),E=E.sibling;return null}function n(v,E){for(v=new Map;E!==null;)E.key!==null?v.set(E.key,E):v.set(E.index,E),E=E.sibling;return v}function i(v,E){return v=fd(v,E),v.index=0,v.sibling=null,v}function o(v,E,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<E?(v.flags|=2,E):w):(v.flags|=2,E)):(v.flags|=1048576,E)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function a(v,E,w,S){return E===null||E.tag!==6?(E=zT(w,v.mode,S),E.return=v,E):(E=i(E,w),E.return=v,E)}function c(v,E,w,S){var A=w.type;return A===ap?d(v,E,w.props.children,S,w.key):E!==null&&(E.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Bl&&eL(A)===E.type)?(S=i(E,w.props),S.ref=Am(v,E,w),S.return=v,S):(S=VE(w.type,w.key,w.props,null,v.mode,S),S.ref=Am(v,E,w),S.return=v,S)}function l(v,E,w,S){return E===null||E.tag!==4||E.stateNode.containerInfo!==w.containerInfo||E.stateNode.implementation!==w.implementation?(E=KT(w,v.mode,S),E.return=v,E):(E=i(E,w.children||[]),E.return=v,E)}function d(v,E,w,S,A){return E===null||E.tag!==7?(E=Nu(w,v.mode,S,A),E.return=v,E):(E=i(E,w),E.return=v,E)}function u(v,E,w){if(typeof E=="string"&&E!==""||typeof E=="number")return E=zT(""+E,v.mode,w),E.return=v,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case nv:return w=VE(E.type,E.key,E.props,null,v.mode,w),w.ref=Am(v,null,E),w.return=v,w;case sp:return E=KT(E,v.mode,w),E.return=v,E;case Bl:var S=E._init;return u(v,S(E._payload),w)}if(eg(E)||Sm(E))return E=Nu(E,v.mode,w,null),E.return=v,E;fv(v,E)}return null}function p(v,E,w,S){var A=E!==null?E.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return A!==null?null:a(v,E,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case nv:return w.key===A?c(v,E,w,S):null;case sp:return w.key===A?l(v,E,w,S):null;case Bl:return A=w._init,p(v,E,A(w._payload),S)}if(eg(w)||Sm(w))return A!==null?null:d(v,E,w,S,null);fv(v,w)}return null}function f(v,E,w,S,A){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(w)||null,a(E,v,""+S,A);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case nv:return v=v.get(S.key===null?w:S.key)||null,c(E,v,S,A);case sp:return v=v.get(S.key===null?w:S.key)||null,l(E,v,S,A);case Bl:var N=S._init;return f(v,E,w,N(S._payload),A)}if(eg(S)||Sm(S))return v=v.get(w)||null,d(E,v,S,A,null);fv(E,S)}return null}function m(v,E,w,S){for(var A=null,N=null,L=E,j=E=0,W=null;L!==null&&j<w.length;j++){L.index>j?(W=L,L=null):W=L.sibling;var V=p(v,L,w[j],S);if(V===null){L===null&&(L=W);break}e&&L&&V.alternate===null&&t(v,L),E=o(V,E,j),N===null?A=V:N.sibling=V,N=V,L=W}if(j===w.length)return r(v,L),hn&&ru(v,j),A;if(L===null){for(;j<w.length;j++)L=u(v,w[j],S),L!==null&&(E=o(L,E,j),N===null?A=L:N.sibling=L,N=L);return hn&&ru(v,j),A}for(L=n(v,L);j<w.length;j++)W=f(L,v,j,w[j],S),W!==null&&(e&&W.alternate!==null&&L.delete(W.key===null?j:W.key),E=o(W,E,j),N===null?A=W:N.sibling=W,N=W);return e&&L.forEach(function(Y){return t(v,Y)}),hn&&ru(v,j),A}function g(v,E,w,S){var A=Sm(w);if(typeof A!="function")throw Error(Ie(150));if(w=A.call(w),w==null)throw Error(Ie(151));for(var N=A=null,L=E,j=E=0,W=null,V=w.next();L!==null&&!V.done;j++,V=w.next()){L.index>j?(W=L,L=null):W=L.sibling;var Y=p(v,L,V.value,S);if(Y===null){L===null&&(L=W);break}e&&L&&Y.alternate===null&&t(v,L),E=o(Y,E,j),N===null?A=Y:N.sibling=Y,N=Y,L=W}if(V.done)return r(v,L),hn&&ru(v,j),A;if(L===null){for(;!V.done;j++,V=w.next())V=u(v,V.value,S),V!==null&&(E=o(V,E,j),N===null?A=V:N.sibling=V,N=V);return hn&&ru(v,j),A}for(L=n(v,L);!V.done;j++,V=w.next())V=f(L,v,j,V.value,S),V!==null&&(e&&V.alternate!==null&&L.delete(V.key===null?j:V.key),E=o(V,E,j),N===null?A=V:N.sibling=V,N=V);return e&&L.forEach(function(Z){return t(v,Z)}),hn&&ru(v,j),A}function y(v,E,w,S){if(typeof w=="object"&&w!==null&&w.type===ap&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case nv:e:{for(var A=w.key,N=E;N!==null;){if(N.key===A){if(A=w.type,A===ap){if(N.tag===7){r(v,N.sibling),E=i(N,w.props.children),E.return=v,v=E;break e}}else if(N.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Bl&&eL(A)===N.type){r(v,N.sibling),E=i(N,w.props),E.ref=Am(v,N,w),E.return=v,v=E;break e}r(v,N);break}else t(v,N);N=N.sibling}w.type===ap?(E=Nu(w.props.children,v.mode,S,w.key),E.return=v,v=E):(S=VE(w.type,w.key,w.props,null,v.mode,S),S.ref=Am(v,E,w),S.return=v,v=S)}return s(v);case sp:e:{for(N=w.key;E!==null;){if(E.key===N)if(E.tag===4&&E.stateNode.containerInfo===w.containerInfo&&E.stateNode.implementation===w.implementation){r(v,E.sibling),E=i(E,w.children||[]),E.return=v,v=E;break e}else{r(v,E);break}else t(v,E);E=E.sibling}E=KT(w,v.mode,S),E.return=v,v=E}return s(v);case Bl:return N=w._init,y(v,E,N(w._payload),S)}if(eg(w))return m(v,E,w,S);if(Sm(w))return g(v,E,w,S);fv(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,E!==null&&E.tag===6?(r(v,E.sibling),E=i(E,w),E.return=v,v=E):(r(v,E),E=zT(w,v.mode,S),E.return=v,v=E),s(v)):r(v,E)}return y}var of=i7(!0),o7=i7(!1),M_=Pd(null),j_=null,mp=null,kN=null;function PN(){kN=mp=j_=null}function DN(e){var t=M_.current;an(M_),e._currentValue=t}function MA(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Fp(e,t){j_=e,kN=mp=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(xo=!0),e.firstContext=null)}function Qs(e){var t=e._currentValue;if(kN!==e)if(e={context:e,memoizedValue:t,next:null},mp===null){if(j_===null)throw Error(Ie(308));mp=e,j_.dependencies={lanes:0,firstContext:e}}else mp=mp.next=e;return t}var vu=null;function LN(e){vu===null?vu=[e]:vu.push(e)}function s7(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,LN(t)):(r.next=i.next,i.next=r),t.interleaved=r,al(e,n)}function al(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var $l=!1;function MN(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function a7(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Zc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ud(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,pr&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,al(e,r)}return i=n.interleaved,i===null?(t.next=t,LN(n)):(t.next=i.next,i.next=t),n.interleaved=t,al(e,r)}function DE(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,bN(e,r)}}function tL(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?i=o=t:o=o.next=t}else i=o=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function U_(e,t,r,n){var i=e.updateQueue;$l=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,s===null?o=l:s.next=l,s=c;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==s&&(a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=c))}if(o!==null){var u=i.baseState;s=0,d=l=c=null,a=o;do{var p=a.lane,f=a.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=e,g=a;switch(p=t,f=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){u=m.call(f,u,p);break e}u=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,p=typeof m=="function"?m.call(f,u,p):m,p==null)break e;u=Cn({},u,p);break e;case 2:$l=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else f={eventTime:f,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(l=d=f,c=u):d=d.next=f,s|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(c=u),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);zu|=s,e.lanes=s,e.memoizedState=u}}function rL(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Ie(191,i));i.call(n)}}}var iy={},uc=Pd(iy),a0=Pd(iy),c0=Pd(iy);function Eu(e){if(e===iy)throw Error(Ie(174));return e}function jN(e,t){switch(Jr(c0,t),Jr(a0,e),Jr(uc,iy),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:gA(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=gA(t,e)}an(uc),Jr(uc,t)}function sf(){an(uc),an(a0),an(c0)}function c7(e){Eu(c0.current);var t=Eu(uc.current),r=gA(t,e.type);t!==r&&(Jr(a0,e),Jr(uc,r))}function UN(e){a0.current===e&&(an(uc),an(a0))}var _n=Pd(0);function F_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var VT=[];function FN(){for(var e=0;e<VT.length;e++)VT[e]._workInProgressVersionPrimary=null;VT.length=0}var LE=ml.ReactCurrentDispatcher,BT=ml.ReactCurrentBatchConfig,Gu=0,Sn=null,ai=null,mi=null,V_=!1,Tg=!1,l0=0,mte=0;function Ui(){throw Error(Ie(321))}function VN(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Na(e[r],t[r]))return!1;return!0}function BN(e,t,r,n,i,o){if(Gu=o,Sn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,LE.current=e===null||e.memoizedState===null?Ete:_te,e=r(n,i),Tg){o=0;do{if(Tg=!1,l0=0,25<=o)throw Error(Ie(301));o+=1,mi=ai=null,t.updateQueue=null,LE.current=bte,e=r(n,i)}while(Tg)}if(LE.current=B_,t=ai!==null&&ai.next!==null,Gu=0,mi=ai=Sn=null,V_=!1,t)throw Error(Ie(300));return e}function $N(){var e=l0!==0;return l0=0,e}function Za(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mi===null?Sn.memoizedState=mi=e:mi=mi.next=e,mi}function Zs(){if(ai===null){var e=Sn.alternate;e=e!==null?e.memoizedState:null}else e=ai.next;var t=mi===null?Sn.memoizedState:mi.next;if(t!==null)mi=t,ai=e;else{if(e===null)throw Error(Ie(310));ai=e,e={memoizedState:ai.memoizedState,baseState:ai.baseState,baseQueue:ai.baseQueue,queue:ai.queue,next:null},mi===null?Sn.memoizedState=mi=e:mi=mi.next=e}return mi}function d0(e,t){return typeof t=="function"?t(e):t}function $T(e){var t=Zs(),r=t.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=e;var n=ai,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var a=s=null,c=null,l=o;do{var d=l.lane;if((Gu&d)===d)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var u={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=u,s=n):c=c.next=u,Sn.lanes|=d,zu|=d}l=l.next}while(l!==null&&l!==o);c===null?s=n:c.next=a,Na(n,t.memoizedState)||(xo=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do o=i.lane,Sn.lanes|=o,zu|=o,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function HT(e){var t=Zs(),r=t.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,o=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);Na(o,t.memoizedState)||(xo=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function l7(){}function d7(e,t){var r=Sn,n=Zs(),i=t(),o=!Na(n.memoizedState,i);if(o&&(n.memoizedState=i,xo=!0),n=n.queue,HN(p7.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||mi!==null&&mi.memoizedState.tag&1){if(r.flags|=2048,u0(9,h7.bind(null,r,n,i,t),void 0,null),bi===null)throw Error(Ie(349));Gu&30||u7(r,t,i)}return i}function u7(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Sn.updateQueue,t===null?(t={lastEffect:null,stores:null},Sn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function h7(e,t,r,n){t.value=r,t.getSnapshot=n,f7(t)&&m7(e)}function p7(e,t,r){return r(function(){f7(t)&&m7(e)})}function f7(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Na(e,r)}catch{return!0}}function m7(e){var t=al(e,1);t!==null&&xa(t,e,1,-1)}function nL(e){var t=Za();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d0,lastRenderedState:e},t.queue=e,e=e.dispatch=vte.bind(null,Sn,e),[t.memoizedState,e]}function u0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Sn.updateQueue,t===null?(t={lastEffect:null,stores:null},Sn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function g7(){return Zs().memoizedState}function ME(e,t,r,n){var i=Za();Sn.flags|=e,i.memoizedState=u0(1|t,r,void 0,n===void 0?null:n)}function Ew(e,t,r,n){var i=Zs();n=n===void 0?null:n;var o=void 0;if(ai!==null){var s=ai.memoizedState;if(o=s.destroy,n!==null&&VN(n,s.deps)){i.memoizedState=u0(t,r,o,n);return}}Sn.flags|=e,i.memoizedState=u0(1|t,r,o,n)}function iL(e,t){return ME(8390656,8,e,t)}function HN(e,t){return Ew(2048,8,e,t)}function y7(e,t){return Ew(4,2,e,t)}function v7(e,t){return Ew(4,4,e,t)}function E7(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function _7(e,t,r){return r=r!=null?r.concat([e]):null,Ew(4,4,E7.bind(null,t,e),r)}function WN(){}function b7(e,t){var r=Zs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&VN(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function w7(e,t){var r=Zs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&VN(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function S7(e,t,r){return Gu&21?(Na(r,t)||(r=A$(),Sn.lanes|=r,zu|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=r)}function gte(e,t){var r=Lr;Lr=r!==0&&4>r?r:4,e(!0);var n=BT.transition;BT.transition={};try{e(!1),t()}finally{Lr=r,BT.transition=n}}function T7(){return Zs().memoizedState}function yte(e,t,r){var n=pd(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},C7(e))R7(t,r);else if(r=s7(e,t,r,n),r!==null){var i=co();xa(r,e,n,i),I7(r,t,n)}}function vte(e,t,r){var n=pd(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(C7(e))R7(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,r);if(i.hasEagerState=!0,i.eagerState=a,Na(a,s)){var c=t.interleaved;c===null?(i.next=i,LN(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=s7(e,t,i,n),r!==null&&(i=co(),xa(r,e,n,i),I7(r,t,n))}}function C7(e){var t=e.alternate;return e===Sn||t!==null&&t===Sn}function R7(e,t){Tg=V_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function I7(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,bN(e,r)}}var B_={readContext:Qs,useCallback:Ui,useContext:Ui,useEffect:Ui,useImperativeHandle:Ui,useInsertionEffect:Ui,useLayoutEffect:Ui,useMemo:Ui,useReducer:Ui,useRef:Ui,useState:Ui,useDebugValue:Ui,useDeferredValue:Ui,useTransition:Ui,useMutableSource:Ui,useSyncExternalStore:Ui,useId:Ui,unstable_isNewReconciler:!1},Ete={readContext:Qs,useCallback:function(e,t){return Za().memoizedState=[e,t===void 0?null:t],e},useContext:Qs,useEffect:iL,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ME(4194308,4,E7.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ME(4194308,4,e,t)},useInsertionEffect:function(e,t){return ME(4,2,e,t)},useMemo:function(e,t){var r=Za();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Za();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=yte.bind(null,Sn,e),[n.memoizedState,e]},useRef:function(e){var t=Za();return e={current:e},t.memoizedState=e},useState:nL,useDebugValue:WN,useDeferredValue:function(e){return Za().memoizedState=e},useTransition:function(){var e=nL(!1),t=e[0];return e=gte.bind(null,e[1]),Za().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Sn,i=Za();if(hn){if(r===void 0)throw Error(Ie(407));r=r()}else{if(r=t(),bi===null)throw Error(Ie(349));Gu&30||u7(n,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,iL(p7.bind(null,n,o,e),[e]),n.flags|=2048,u0(9,h7.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Za(),t=bi.identifierPrefix;if(hn){var r=Xc,n=Yc;r=(n&~(1<<32-Aa(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=l0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=mte++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},_te={readContext:Qs,useCallback:b7,useContext:Qs,useEffect:HN,useImperativeHandle:_7,useInsertionEffect:y7,useLayoutEffect:v7,useMemo:w7,useReducer:$T,useRef:g7,useState:function(){return $T(d0)},useDebugValue:WN,useDeferredValue:function(e){var t=Zs();return S7(t,ai.memoizedState,e)},useTransition:function(){var e=$T(d0)[0],t=Zs().memoizedState;return[e,t]},useMutableSource:l7,useSyncExternalStore:d7,useId:T7,unstable_isNewReconciler:!1},bte={readContext:Qs,useCallback:b7,useContext:Qs,useEffect:HN,useImperativeHandle:_7,useInsertionEffect:y7,useLayoutEffect:v7,useMemo:w7,useReducer:HT,useRef:g7,useState:function(){return HT(d0)},useDebugValue:WN,useDeferredValue:function(e){var t=Zs();return ai===null?t.memoizedState=e:S7(t,ai.memoizedState,e)},useTransition:function(){var e=HT(d0)[0],t=Zs().memoizedState;return[e,t]},useMutableSource:l7,useSyncExternalStore:d7,useId:T7,unstable_isNewReconciler:!1};function Ea(e,t){if(e&&e.defaultProps){t=Cn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function jA(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Cn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _w={isMounted:function(e){return(e=e._reactInternals)?ch(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=co(),i=pd(e),o=Zc(n,i);o.payload=t,r!=null&&(o.callback=r),t=ud(e,o,i),t!==null&&(xa(t,e,i,n),DE(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=co(),i=pd(e),o=Zc(n,i);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=ud(e,o,i),t!==null&&(xa(t,e,i,n),DE(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=co(),n=pd(e),i=Zc(r,n);i.tag=2,t!=null&&(i.callback=t),t=ud(e,i,n),t!==null&&(xa(t,e,n,r),DE(t,e,n))}};function oL(e,t,r,n,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,s):t.prototype&&t.prototype.isPureReactComponent?!n0(r,n)||!n0(i,o):!0}function A7(e,t,r){var n=!1,i=Td,o=t.contextType;return typeof o=="object"&&o!==null?o=Qs(o):(i=ko(t)?Hu:Ki.current,n=t.contextTypes,o=(n=n!=null)?rf(e,i):Td),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_w,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function sL(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&_w.enqueueReplaceState(t,t.state,null)}function UA(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},MN(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=Qs(o):(o=ko(t)?Hu:Ki.current,i.context=rf(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(jA(e,t,o,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&_w.enqueueReplaceState(i,i.state,null),U_(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function af(e,t){try{var r="",n=t;do r+=Y1(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function WT(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function FA(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var wte=typeof WeakMap=="function"?WeakMap:Map;function x7(e,t,r){r=Zc(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){H_||(H_=!0,YA=n),FA(e,t)},r}function O7(e,t,r){r=Zc(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){FA(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){FA(e,t),typeof n!="function"&&(hd===null?hd=new Set([this]):hd.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function aL(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new wte;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Mte.bind(null,e,t,r),t.then(e,e))}function cL(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function lL(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Zc(-1,1),t.tag=2,ud(r,t,1))),r.lanes|=1),e)}var Ste=ml.ReactCurrentOwner,xo=!1;function io(e,t,r,n){t.child=e===null?o7(t,null,r,n):of(t,e.child,r,n)}function dL(e,t,r,n,i){r=r.render;var o=t.ref;return Fp(t,i),n=BN(e,t,r,n,o,i),r=$N(),e!==null&&!xo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,cl(e,t,i)):(hn&&r&&xN(t),t.flags|=1,io(e,t,n,i),t.child)}function uL(e,t,r,n,i){if(e===null){var o=r.type;return typeof o=="function"&&!QN(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,N7(e,t,o,n,i)):(e=VE(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:n0,r(s,n)&&e.ref===t.ref)return cl(e,t,i)}return t.flags|=1,e=fd(o,n),e.ref=t.ref,e.return=t,t.child=e}function N7(e,t,r,n,i){if(e!==null){var o=e.memoizedProps;if(n0(o,n)&&e.ref===t.ref)if(xo=!1,t.pendingProps=n=o,(e.lanes&i)!==0)e.flags&131072&&(xo=!0);else return t.lanes=e.lanes,cl(e,t,i)}return VA(e,t,r,n,i)}function k7(e,t,r){var n=t.pendingProps,i=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jr(yp,Qo),Qo|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Jr(yp,Qo),Qo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Jr(yp,Qo),Qo|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,Jr(yp,Qo),Qo|=n;return io(e,t,i,r),t.child}function P7(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function VA(e,t,r,n,i){var o=ko(r)?Hu:Ki.current;return o=rf(t,o),Fp(t,i),r=BN(e,t,r,n,o,i),n=$N(),e!==null&&!xo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,cl(e,t,i)):(hn&&n&&xN(t),t.flags|=1,io(e,t,r,i),t.child)}function hL(e,t,r,n,i){if(ko(r)){var o=!0;P_(t)}else o=!1;if(Fp(t,i),t.stateNode===null)jE(e,t),A7(t,r,n),UA(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=r.contextType;typeof l=="object"&&l!==null?l=Qs(l):(l=ko(r)?Hu:Ki.current,l=rf(t,l));var d=r.getDerivedStateFromProps,u=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";u||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==n||c!==l)&&sL(t,s,n,l),$l=!1;var p=t.memoizedState;s.state=p,U_(t,n,s,i),c=t.memoizedState,a!==n||p!==c||No.current||$l?(typeof d=="function"&&(jA(t,r,d,n),c=t.memoizedState),(a=$l||oL(t,r,a,n,p,c,l))?(u||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=l,n=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,a7(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:Ea(t.type,a),s.props=l,u=t.pendingProps,p=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=Qs(c):(c=ko(r)?Hu:Ki.current,c=rf(t,c));var f=r.getDerivedStateFromProps;(d=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==u||p!==c)&&sL(t,s,n,c),$l=!1,p=t.memoizedState,s.state=p,U_(t,n,s,i);var m=t.memoizedState;a!==u||p!==m||No.current||$l?(typeof f=="function"&&(jA(t,r,f,n),m=t.memoizedState),(l=$l||oL(t,r,l,n,p,m,c)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=c,n=l):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return BA(e,t,r,n,o,i)}function BA(e,t,r,n,i,o){P7(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&J2(t,r,!1),cl(e,t,o);n=t.stateNode,Ste.current=t;var a=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=of(t,e.child,null,o),t.child=of(t,null,a,o)):io(e,t,a,o),t.memoizedState=n.state,i&&J2(t,r,!0),t.child}function D7(e){var t=e.stateNode;t.pendingContext?X2(e,t.pendingContext,t.pendingContext!==t.context):t.context&&X2(e,t.context,!1),jN(e,t.containerInfo)}function pL(e,t,r,n,i){return nf(),NN(i),t.flags|=256,io(e,t,r,n),t.child}var $A={dehydrated:null,treeContext:null,retryLane:0};function HA(e){return{baseLanes:e,cachePool:null,transitions:null}}function L7(e,t,r){var n=t.pendingProps,i=_n.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Jr(_n,i&1),e===null)return LA(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,o?(n=t.mode,o=t.child,s={mode:"hidden",children:s},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Sw(s,n,0,null),e=Nu(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=HA(r),t.memoizedState=$A,e):GN(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Tte(e,t,s,n,a,i,r);if(o){o=n.fallback,s=t.mode,i=e.child,a=i.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=fd(i,c),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=fd(a,o):(o=Nu(o,s,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,s=e.child.memoizedState,s=s===null?HA(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~r,t.memoizedState=$A,n}return o=e.child,e=o.sibling,n=fd(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function GN(e,t){return t=Sw({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function mv(e,t,r,n){return n!==null&&NN(n),of(t,e.child,null,r),e=GN(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Tte(e,t,r,n,i,o,s){if(r)return t.flags&256?(t.flags&=-257,n=WT(Error(Ie(422))),mv(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,i=t.mode,n=Sw({mode:"visible",children:n.children},i,0,null),o=Nu(o,i,s,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&of(t,e.child,null,s),t.child.memoizedState=HA(s),t.memoizedState=$A,o);if(!(t.mode&1))return mv(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(Ie(419)),n=WT(o,n,void 0),mv(e,t,s,n)}if(a=(s&e.childLanes)!==0,xo||a){if(n=bi,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,al(e,i),xa(n,e,i,-1))}return JN(),n=WT(Error(Ie(421))),mv(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=jte.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=dd(i.nextSibling),cs=t,hn=!0,Sa=null,e!==null&&($s[Hs++]=Yc,$s[Hs++]=Xc,$s[Hs++]=Wu,Yc=e.id,Xc=e.overflow,Wu=t),t=GN(t,n.children),t.flags|=4096,t)}function fL(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),MA(e.return,t,r)}function GT(e,t,r,n,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function M7(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(io(e,t,n.children,r),n=_n.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&fL(e,r,t);else if(e.tag===19)fL(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Jr(_n,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&F_(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),GT(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&F_(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}GT(t,!0,r,null,o);break;case"together":GT(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function jE(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),zu|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ie(153));if(t.child!==null){for(e=t.child,r=fd(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=fd(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Cte(e,t,r){switch(t.tag){case 3:D7(t),nf();break;case 5:c7(t);break;case 1:ko(t.type)&&P_(t);break;case 4:jN(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Jr(M_,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Jr(_n,_n.current&1),t.flags|=128,null):r&t.child.childLanes?L7(e,t,r):(Jr(_n,_n.current&1),e=cl(e,t,r),e!==null?e.sibling:null);Jr(_n,_n.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return M7(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Jr(_n,_n.current),n)break;return null;case 22:case 23:return t.lanes=0,k7(e,t,r)}return cl(e,t,r)}var j7,WA,U7,F7;j7=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};WA=function(){};U7=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Eu(uc.current);var o=null;switch(r){case"input":i=hA(e,i),n=hA(e,n),o=[];break;case"select":i=Cn({},i,{value:void 0}),n=Cn({},n,{value:void 0}),o=[];break;case"textarea":i=mA(e,i),n=mA(e,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=N_)}yA(r,n);var s;r=null;for(l in i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(s in a)a.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Xg.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in n){var c=n[l];if(a=i!=null?i[l]:void 0,n.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(s in a)!a.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&a[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(o||(o=[]),o.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Xg.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&en("scroll",e),o||a===c||(o=[])):(o=o||[]).push(l,c))}r&&(o=o||[]).push("style",r);var l=o;(t.updateQueue=l)&&(t.flags|=4)}};F7=function(e,t,r,n){r!==n&&(t.flags|=4)};function xm(e,t){if(!hn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Fi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Rte(e,t,r){var n=t.pendingProps;switch(ON(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fi(t),null;case 1:return ko(t.type)&&k_(),Fi(t),null;case 3:return n=t.stateNode,sf(),an(No),an(Ki),FN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(pv(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Sa!==null&&(QA(Sa),Sa=null))),WA(e,t),Fi(t),null;case 5:UN(t);var i=Eu(c0.current);if(r=t.type,e!==null&&t.stateNode!=null)U7(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ie(166));return Fi(t),null}if(e=Eu(uc.current),pv(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[nc]=t,n[s0]=o,e=(t.mode&1)!==0,r){case"dialog":en("cancel",n),en("close",n);break;case"iframe":case"object":case"embed":en("load",n);break;case"video":case"audio":for(i=0;i<rg.length;i++)en(rg[i],n);break;case"source":en("error",n);break;case"img":case"image":case"link":en("error",n),en("load",n);break;case"details":en("toggle",n);break;case"input":S2(n,o),en("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},en("invalid",n);break;case"textarea":C2(n,o),en("invalid",n)}yA(r,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&hv(n.textContent,a,e),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&hv(n.textContent,a,e),i=["children",""+a]):Xg.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&en("scroll",n)}switch(r){case"input":iv(n),T2(n,o,!0);break;case"textarea":iv(n),R2(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=N_)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=p$(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[nc]=t,e[s0]=n,j7(e,t,!1,!1),t.stateNode=e;e:{switch(s=vA(r,n),r){case"dialog":en("cancel",e),en("close",e),i=n;break;case"iframe":case"object":case"embed":en("load",e),i=n;break;case"video":case"audio":for(i=0;i<rg.length;i++)en(rg[i],e);i=n;break;case"source":en("error",e),i=n;break;case"img":case"image":case"link":en("error",e),en("load",e),i=n;break;case"details":en("toggle",e),i=n;break;case"input":S2(e,n),i=hA(e,n),en("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Cn({},n,{value:void 0}),en("invalid",e);break;case"textarea":C2(e,n),i=mA(e,n),en("invalid",e);break;default:i=n}yA(r,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?g$(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&f$(e,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Jg(e,c):typeof c=="number"&&Jg(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Xg.hasOwnProperty(o)?c!=null&&o==="onScroll"&&en("scroll",e):c!=null&&mN(e,o,c,s))}switch(r){case"input":iv(e),T2(e,n,!1);break;case"textarea":iv(e),R2(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Sd(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?Lp(e,!!n.multiple,o,!1):n.defaultValue!=null&&Lp(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=N_)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Fi(t),null;case 6:if(e&&t.stateNode!=null)F7(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ie(166));if(r=Eu(c0.current),Eu(uc.current),pv(t)){if(n=t.stateNode,r=t.memoizedProps,n[nc]=t,(o=n.nodeValue!==r)&&(e=cs,e!==null))switch(e.tag){case 3:hv(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hv(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[nc]=t,t.stateNode=n}return Fi(t),null;case 13:if(an(_n),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(hn&&rs!==null&&t.mode&1&&!(t.flags&128))n7(),nf(),t.flags|=98560,o=!1;else if(o=pv(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(Ie(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Ie(317));o[nc]=t}else nf(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Fi(t),o=!1}else Sa!==null&&(QA(Sa),Sa=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||_n.current&1?li===0&&(li=3):JN())),t.updateQueue!==null&&(t.flags|=4),Fi(t),null);case 4:return sf(),WA(e,t),e===null&&i0(t.stateNode.containerInfo),Fi(t),null;case 10:return DN(t.type._context),Fi(t),null;case 17:return ko(t.type)&&k_(),Fi(t),null;case 19:if(an(_n),o=t.memoizedState,o===null)return Fi(t),null;if(n=(t.flags&128)!==0,s=o.rendering,s===null)if(n)xm(o,!1);else{if(li!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=F_(e),s!==null){for(t.flags|=128,xm(o,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Jr(_n,_n.current&1|2),t.child}e=e.sibling}o.tail!==null&&Hn()>cf&&(t.flags|=128,n=!0,xm(o,!1),t.lanes=4194304)}else{if(!n)if(e=F_(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),xm(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!hn)return Fi(t),null}else 2*Hn()-o.renderingStartTime>cf&&r!==1073741824&&(t.flags|=128,n=!0,xm(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(r=o.last,r!==null?r.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Hn(),t.sibling=null,r=_n.current,Jr(_n,n?r&1|2:r&1),t):(Fi(t),null);case 22:case 23:return XN(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Qo&1073741824&&(Fi(t),t.subtreeFlags&6&&(t.flags|=8192)):Fi(t),null;case 24:return null;case 25:return null}throw Error(Ie(156,t.tag))}function Ite(e,t){switch(ON(t),t.tag){case 1:return ko(t.type)&&k_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return sf(),an(No),an(Ki),FN(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return UN(t),null;case 13:if(an(_n),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ie(340));nf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return an(_n),null;case 4:return sf(),null;case 10:return DN(t.type._context),null;case 22:case 23:return XN(),null;case 24:return null;default:return null}}var gv=!1,Gi=!1,Ate=typeof WeakSet=="function"?WeakSet:Set,qe=null;function gp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nn(e,t,n)}else r.current=null}function GA(e,t,r){try{r()}catch(n){Nn(e,t,n)}}var mL=!1;function xte(e,t){if(AA=A_,e=W$(),AN(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var s=0,a=-1,c=-1,l=0,d=0,u=e,p=null;t:for(;;){for(var f;u!==r||i!==0&&u.nodeType!==3||(a=s+i),u!==o||n!==0&&u.nodeType!==3||(c=s+n),u.nodeType===3&&(s+=u.nodeValue.length),(f=u.firstChild)!==null;)p=u,u=f;for(;;){if(u===e)break t;if(p===r&&++l===i&&(a=s),p===o&&++d===n&&(c=s),(f=u.nextSibling)!==null)break;u=p,p=u.parentNode}u=f}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(xA={focusedElem:e,selectionRange:r},A_=!1,qe=t;qe!==null;)if(t=qe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,qe=e;else for(;qe!==null;){t=qe;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,E=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ea(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ie(163))}}catch(S){Nn(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,qe=e;break}qe=t.return}return m=mL,mL=!1,m}function Cg(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&GA(t,r,o)}i=i.next}while(i!==n)}}function bw(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function zA(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function V7(e){var t=e.alternate;t!==null&&(e.alternate=null,V7(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[nc],delete t[s0],delete t[kA],delete t[ute],delete t[hte])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function B7(e){return e.tag===5||e.tag===3||e.tag===4}function gL(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||B7(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function KA(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=N_));else if(n!==4&&(e=e.child,e!==null))for(KA(e,t,r),e=e.sibling;e!==null;)KA(e,t,r),e=e.sibling}function qA(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(qA(e,t,r),e=e.sibling;e!==null;)qA(e,t,r),e=e.sibling}var Ai=null,ba=!1;function Cl(e,t,r){for(r=r.child;r!==null;)$7(e,t,r),r=r.sibling}function $7(e,t,r){if(dc&&typeof dc.onCommitFiberUnmount=="function")try{dc.onCommitFiberUnmount(pw,r)}catch{}switch(r.tag){case 5:Gi||gp(r,t);case 6:var n=Ai,i=ba;Ai=null,Cl(e,t,r),Ai=n,ba=i,Ai!==null&&(ba?(e=Ai,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ai.removeChild(r.stateNode));break;case 18:Ai!==null&&(ba?(e=Ai,r=r.stateNode,e.nodeType===8?UT(e.parentNode,r):e.nodeType===1&&UT(e,r),t0(e)):UT(Ai,r.stateNode));break;case 4:n=Ai,i=ba,Ai=r.stateNode.containerInfo,ba=!0,Cl(e,t,r),Ai=n,ba=i;break;case 0:case 11:case 14:case 15:if(!Gi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&GA(r,t,s),i=i.next}while(i!==n)}Cl(e,t,r);break;case 1:if(!Gi&&(gp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Nn(r,t,a)}Cl(e,t,r);break;case 21:Cl(e,t,r);break;case 22:r.mode&1?(Gi=(n=Gi)||r.memoizedState!==null,Cl(e,t,r),Gi=n):Cl(e,t,r);break;default:Cl(e,t,r)}}function yL(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ate),t.forEach(function(n){var i=Ute.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function la(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:Ai=a.stateNode,ba=!1;break e;case 3:Ai=a.stateNode.containerInfo,ba=!0;break e;case 4:Ai=a.stateNode.containerInfo,ba=!0;break e}a=a.return}if(Ai===null)throw Error(Ie(160));$7(o,s,i),Ai=null,ba=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Nn(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)H7(t,e),t=t.sibling}function H7(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(la(t,e),Ha(e),n&4){try{Cg(3,e,e.return),bw(3,e)}catch(g){Nn(e,e.return,g)}try{Cg(5,e,e.return)}catch(g){Nn(e,e.return,g)}}break;case 1:la(t,e),Ha(e),n&512&&r!==null&&gp(r,r.return);break;case 5:if(la(t,e),Ha(e),n&512&&r!==null&&gp(r,r.return),e.flags&32){var i=e.stateNode;try{Jg(i,"")}catch(g){Nn(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=r!==null?r.memoizedProps:o,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&u$(i,o),vA(a,s);var l=vA(a,o);for(s=0;s<c.length;s+=2){var d=c[s],u=c[s+1];d==="style"?g$(i,u):d==="dangerouslySetInnerHTML"?f$(i,u):d==="children"?Jg(i,u):mN(i,d,u,l)}switch(a){case"input":pA(i,o);break;case"textarea":h$(i,o);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?Lp(i,!!o.multiple,f,!1):p!==!!o.multiple&&(o.defaultValue!=null?Lp(i,!!o.multiple,o.defaultValue,!0):Lp(i,!!o.multiple,o.multiple?[]:"",!1))}i[s0]=o}catch(g){Nn(e,e.return,g)}}break;case 6:if(la(t,e),Ha(e),n&4){if(e.stateNode===null)throw Error(Ie(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Nn(e,e.return,g)}}break;case 3:if(la(t,e),Ha(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{t0(t.containerInfo)}catch(g){Nn(e,e.return,g)}break;case 4:la(t,e),Ha(e);break;case 13:la(t,e),Ha(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(qN=Hn())),n&4&&yL(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Gi=(l=Gi)||d,la(t,e),Gi=l):la(t,e),Ha(e),n&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!d&&e.mode&1)for(qe=e,d=e.child;d!==null;){for(u=qe=d;qe!==null;){switch(p=qe,f=p.child,p.tag){case 0:case 11:case 14:case 15:Cg(4,p,p.return);break;case 1:gp(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Nn(n,r,g)}}break;case 5:gp(p,p.return);break;case 22:if(p.memoizedState!==null){EL(u);continue}}f!==null?(f.return=p,qe=f):EL(u)}d=d.sibling}e:for(d=null,u=e;;){if(u.tag===5){if(d===null){d=u;try{i=u.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=u.stateNode,c=u.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=m$("display",s))}catch(g){Nn(e,e.return,g)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=l?"":u.memoizedProps}catch(g){Nn(e,e.return,g)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:la(t,e),Ha(e),n&4&&yL(e);break;case 21:break;default:la(t,e),Ha(e)}}function Ha(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(B7(r)){var n=r;break e}r=r.return}throw Error(Ie(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Jg(i,""),n.flags&=-33);var o=gL(e);qA(e,o,i);break;case 3:case 4:var s=n.stateNode.containerInfo,a=gL(e);KA(e,a,s);break;default:throw Error(Ie(161))}}catch(c){Nn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ote(e,t,r){qe=e,W7(e)}function W7(e,t,r){for(var n=(e.mode&1)!==0;qe!==null;){var i=qe,o=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||gv;if(!s){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Gi;a=gv;var l=Gi;if(gv=s,(Gi=c)&&!l)for(qe=i;qe!==null;)s=qe,c=s.child,s.tag===22&&s.memoizedState!==null?_L(i):c!==null?(c.return=s,qe=c):_L(i);for(;o!==null;)qe=o,W7(o),o=o.sibling;qe=i,gv=a,Gi=l}vL(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,qe=o):vL(e)}}function vL(e){for(;qe!==null;){var t=qe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Gi||bw(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Gi)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Ea(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&rL(t,o,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}rL(t,s,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var d=l.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&t0(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ie(163))}Gi||t.flags&512&&zA(t)}catch(p){Nn(t,t.return,p)}}if(t===e){qe=null;break}if(r=t.sibling,r!==null){r.return=t.return,qe=r;break}qe=t.return}}function EL(e){for(;qe!==null;){var t=qe;if(t===e){qe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,qe=r;break}qe=t.return}}function _L(e){for(;qe!==null;){var t=qe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{bw(4,t)}catch(c){Nn(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Nn(t,i,c)}}var o=t.return;try{zA(t)}catch(c){Nn(t,o,c)}break;case 5:var s=t.return;try{zA(t)}catch(c){Nn(t,s,c)}}}catch(c){Nn(t,t.return,c)}if(t===e){qe=null;break}var a=t.sibling;if(a!==null){a.return=t.return,qe=a;break}qe=t.return}}var Nte=Math.ceil,$_=ml.ReactCurrentDispatcher,zN=ml.ReactCurrentOwner,Ys=ml.ReactCurrentBatchConfig,pr=0,bi=null,Qn=null,Pi=0,Qo=0,yp=Pd(0),li=0,h0=null,zu=0,ww=0,KN=0,Rg=null,So=null,qN=0,cf=1/0,Bc=null,H_=!1,YA=null,hd=null,yv=!1,Jl=null,W_=0,Ig=0,XA=null,UE=-1,FE=0;function co(){return pr&6?Hn():UE!==-1?UE:UE=Hn()}function pd(e){return e.mode&1?pr&2&&Pi!==0?Pi&-Pi:fte.transition!==null?(FE===0&&(FE=A$()),FE):(e=Lr,e!==0||(e=window.event,e=e===void 0?16:L$(e.type)),e):1}function xa(e,t,r,n){if(50<Ig)throw Ig=0,XA=null,Error(Ie(185));ty(e,r,n),(!(pr&2)||e!==bi)&&(e===bi&&(!(pr&2)&&(ww|=r),li===4&&Gl(e,Pi)),Po(e,n),r===1&&pr===0&&!(t.mode&1)&&(cf=Hn()+500,vw&&Dd()))}function Po(e,t){var r=e.callbackNode;fee(e,t);var n=I_(e,e===bi?Pi:0);if(n===0)r!==null&&x2(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&x2(r),t===1)e.tag===0?pte(bL.bind(null,e)):e7(bL.bind(null,e)),lte(function(){!(pr&6)&&Dd()}),r=null;else{switch(x$(n)){case 1:r=_N;break;case 4:r=R$;break;case 16:r=R_;break;case 536870912:r=I$;break;default:r=R_}r=Q7(r,G7.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function G7(e,t){if(UE=-1,FE=0,pr&6)throw Error(Ie(327));var r=e.callbackNode;if(Vp()&&e.callbackNode!==r)return null;var n=I_(e,e===bi?Pi:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=G_(e,n);else{t=n;var i=pr;pr|=2;var o=K7();(bi!==e||Pi!==t)&&(Bc=null,cf=Hn()+500,Ou(e,t));do try{Dte();break}catch(a){z7(e,a)}while(!0);PN(),$_.current=o,pr=i,Qn!==null?t=0:(bi=null,Pi=0,t=li)}if(t!==0){if(t===2&&(i=SA(e),i!==0&&(n=i,t=JA(e,i))),t===1)throw r=h0,Ou(e,0),Gl(e,n),Po(e,Hn()),r;if(t===6)Gl(e,n);else{if(i=e.current.alternate,!(n&30)&&!kte(i)&&(t=G_(e,n),t===2&&(o=SA(e),o!==0&&(n=o,t=JA(e,o))),t===1))throw r=h0,Ou(e,0),Gl(e,n),Po(e,Hn()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Ie(345));case 2:nu(e,So,Bc);break;case 3:if(Gl(e,n),(n&130023424)===n&&(t=qN+500-Hn(),10<t)){if(I_(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){co(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=NA(nu.bind(null,e,So,Bc),t);break}nu(e,So,Bc);break;case 4:if(Gl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-Aa(n);o=1<<s,s=t[s],s>i&&(i=s),n&=~o}if(n=i,n=Hn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Nte(n/1960))-n,10<n){e.timeoutHandle=NA(nu.bind(null,e,So,Bc),n);break}nu(e,So,Bc);break;case 5:nu(e,So,Bc);break;default:throw Error(Ie(329))}}}return Po(e,Hn()),e.callbackNode===r?G7.bind(null,e):null}function JA(e,t){var r=Rg;return e.current.memoizedState.isDehydrated&&(Ou(e,t).flags|=256),e=G_(e,t),e!==2&&(t=So,So=r,t!==null&&QA(t)),e}function QA(e){So===null?So=e:So.push.apply(So,e)}function kte(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!Na(o(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gl(e,t){for(t&=~KN,t&=~ww,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Aa(t),n=1<<r;e[r]=-1,t&=~n}}function bL(e){if(pr&6)throw Error(Ie(327));Vp();var t=I_(e,0);if(!(t&1))return Po(e,Hn()),null;var r=G_(e,t);if(e.tag!==0&&r===2){var n=SA(e);n!==0&&(t=n,r=JA(e,n))}if(r===1)throw r=h0,Ou(e,0),Gl(e,t),Po(e,Hn()),r;if(r===6)throw Error(Ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,nu(e,So,Bc),Po(e,Hn()),null}function YN(e,t){var r=pr;pr|=1;try{return e(t)}finally{pr=r,pr===0&&(cf=Hn()+500,vw&&Dd())}}function Ku(e){Jl!==null&&Jl.tag===0&&!(pr&6)&&Vp();var t=pr;pr|=1;var r=Ys.transition,n=Lr;try{if(Ys.transition=null,Lr=1,e)return e()}finally{Lr=n,Ys.transition=r,pr=t,!(pr&6)&&Dd()}}function XN(){Qo=yp.current,an(yp)}function Ou(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,cte(r)),Qn!==null)for(r=Qn.return;r!==null;){var n=r;switch(ON(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&k_();break;case 3:sf(),an(No),an(Ki),FN();break;case 5:UN(n);break;case 4:sf();break;case 13:an(_n);break;case 19:an(_n);break;case 10:DN(n.type._context);break;case 22:case 23:XN()}r=r.return}if(bi=e,Qn=e=fd(e.current,null),Pi=Qo=t,li=0,h0=null,KN=ww=zu=0,So=Rg=null,vu!==null){for(t=0;t<vu.length;t++)if(r=vu[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var s=o.next;o.next=i,n.next=s}r.pending=n}vu=null}return e}function z7(e,t){do{var r=Qn;try{if(PN(),LE.current=B_,V_){for(var n=Sn.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}V_=!1}if(Gu=0,mi=ai=Sn=null,Tg=!1,l0=0,zN.current=null,r===null||r.return===null){li=1,h0=t,Qn=null;break}e:{var o=e,s=r.return,a=r,c=t;if(t=Pi,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,d=a,u=d.tag;if(!(d.mode&1)&&(u===0||u===11||u===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=cL(s);if(f!==null){f.flags&=-257,lL(f,s,a,o,t),f.mode&1&&aL(o,l,t),t=f,c=l;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){aL(o,l,t),JN();break e}c=Error(Ie(426))}}else if(hn&&a.mode&1){var y=cL(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),lL(y,s,a,o,t),NN(af(c,a));break e}}o=c=af(c,a),li!==4&&(li=2),Rg===null?Rg=[o]:Rg.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var v=x7(o,c,t);tL(o,v);break e;case 1:a=c;var E=o.type,w=o.stateNode;if(!(o.flags&128)&&(typeof E.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(hd===null||!hd.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t;var S=O7(o,a,t);tL(o,S);break e}}o=o.return}while(o!==null)}Y7(r)}catch(A){t=A,Qn===r&&r!==null&&(Qn=r=r.return);continue}break}while(!0)}function K7(){var e=$_.current;return $_.current=B_,e===null?B_:e}function JN(){(li===0||li===3||li===2)&&(li=4),bi===null||!(zu&268435455)&&!(ww&268435455)||Gl(bi,Pi)}function G_(e,t){var r=pr;pr|=2;var n=K7();(bi!==e||Pi!==t)&&(Bc=null,Ou(e,t));do try{Pte();break}catch(i){z7(e,i)}while(!0);if(PN(),pr=r,$_.current=n,Qn!==null)throw Error(Ie(261));return bi=null,Pi=0,li}function Pte(){for(;Qn!==null;)q7(Qn)}function Dte(){for(;Qn!==null&&!oee();)q7(Qn)}function q7(e){var t=J7(e.alternate,e,Qo);e.memoizedProps=e.pendingProps,t===null?Y7(e):Qn=t,zN.current=null}function Y7(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Ite(r,t),r!==null){r.flags&=32767,Qn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{li=6,Qn=null;return}}else if(r=Rte(r,t,Qo),r!==null){Qn=r;return}if(t=t.sibling,t!==null){Qn=t;return}Qn=t=e}while(t!==null);li===0&&(li=5)}function nu(e,t,r){var n=Lr,i=Ys.transition;try{Ys.transition=null,Lr=1,Lte(e,t,r,n)}finally{Ys.transition=i,Lr=n}return null}function Lte(e,t,r,n){do Vp();while(Jl!==null);if(pr&6)throw Error(Ie(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ie(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(mee(e,o),e===bi&&(Qn=bi=null,Pi=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||yv||(yv=!0,Q7(R_,function(){return Vp(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Ys.transition,Ys.transition=null;var s=Lr;Lr=1;var a=pr;pr|=4,zN.current=null,xte(e,r),H7(r,e),tte(xA),A_=!!AA,xA=AA=null,e.current=r,Ote(r),see(),pr=a,Lr=s,Ys.transition=o}else e.current=r;if(yv&&(yv=!1,Jl=e,W_=i),o=e.pendingLanes,o===0&&(hd=null),lee(r.stateNode),Po(e,Hn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(H_)throw H_=!1,e=YA,YA=null,e;return W_&1&&e.tag!==0&&Vp(),o=e.pendingLanes,o&1?e===XA?Ig++:(Ig=0,XA=e):Ig=0,Dd(),null}function Vp(){if(Jl!==null){var e=x$(W_),t=Ys.transition,r=Lr;try{if(Ys.transition=null,Lr=16>e?16:e,Jl===null)var n=!1;else{if(e=Jl,Jl=null,W_=0,pr&6)throw Error(Ie(331));var i=pr;for(pr|=4,qe=e.current;qe!==null;){var o=qe,s=o.child;if(qe.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(qe=l;qe!==null;){var d=qe;switch(d.tag){case 0:case 11:case 15:Cg(8,d,o)}var u=d.child;if(u!==null)u.return=d,qe=u;else for(;qe!==null;){d=qe;var p=d.sibling,f=d.return;if(V7(d),d===l){qe=null;break}if(p!==null){p.return=f,qe=p;break}qe=f}}}var m=o.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}qe=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,qe=s;else e:for(;qe!==null;){if(o=qe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Cg(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,qe=v;break e}qe=o.return}}var E=e.current;for(qe=E;qe!==null;){s=qe;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,qe=w;else e:for(s=E;qe!==null;){if(a=qe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:bw(9,a)}}catch(A){Nn(a,a.return,A)}if(a===s){qe=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,qe=S;break e}qe=a.return}}if(pr=i,Dd(),dc&&typeof dc.onPostCommitFiberRoot=="function")try{dc.onPostCommitFiberRoot(pw,e)}catch{}n=!0}return n}finally{Lr=r,Ys.transition=t}}return!1}function wL(e,t,r){t=af(r,t),t=x7(e,t,1),e=ud(e,t,1),t=co(),e!==null&&(ty(e,1,t),Po(e,t))}function Nn(e,t,r){if(e.tag===3)wL(e,e,r);else for(;t!==null;){if(t.tag===3){wL(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(hd===null||!hd.has(n))){e=af(r,e),e=O7(t,e,1),t=ud(t,e,1),e=co(),t!==null&&(ty(t,1,e),Po(t,e));break}}t=t.return}}function Mte(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=co(),e.pingedLanes|=e.suspendedLanes&r,bi===e&&(Pi&r)===r&&(li===4||li===3&&(Pi&130023424)===Pi&&500>Hn()-qN?Ou(e,0):KN|=r),Po(e,t)}function X7(e,t){t===0&&(e.mode&1?(t=av,av<<=1,!(av&130023424)&&(av=4194304)):t=1);var r=co();e=al(e,t),e!==null&&(ty(e,t,r),Po(e,r))}function jte(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),X7(e,r)}function Ute(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ie(314))}n!==null&&n.delete(t),X7(e,r)}var J7;J7=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||No.current)xo=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return xo=!1,Cte(e,t,r);xo=!!(e.flags&131072)}else xo=!1,hn&&t.flags&1048576&&t7(t,L_,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;jE(e,t),e=t.pendingProps;var i=rf(t,Ki.current);Fp(t,r),i=BN(null,t,n,e,i,r);var o=$N();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ko(n)?(o=!0,P_(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,MN(t),i.updater=_w,t.stateNode=i,i._reactInternals=t,UA(t,n,e,r),t=BA(null,t,n,!0,o,r)):(t.tag=0,hn&&o&&xN(t),io(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(jE(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Vte(n),e=Ea(n,e),i){case 0:t=VA(null,t,n,e,r);break e;case 1:t=hL(null,t,n,e,r);break e;case 11:t=dL(null,t,n,e,r);break e;case 14:t=uL(null,t,n,Ea(n.type,e),r);break e}throw Error(Ie(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ea(n,i),VA(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ea(n,i),hL(e,t,n,i,r);case 3:e:{if(D7(t),e===null)throw Error(Ie(387));n=t.pendingProps,o=t.memoizedState,i=o.element,a7(e,t),U_(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=af(Error(Ie(423)),t),t=pL(e,t,n,r,i);break e}else if(n!==i){i=af(Error(Ie(424)),t),t=pL(e,t,n,r,i);break e}else for(rs=dd(t.stateNode.containerInfo.firstChild),cs=t,hn=!0,Sa=null,r=o7(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(nf(),n===i){t=cl(e,t,r);break e}io(e,t,n,r)}t=t.child}return t;case 5:return c7(t),e===null&&LA(t),n=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,OA(n,i)?s=null:o!==null&&OA(n,o)&&(t.flags|=32),P7(e,t),io(e,t,s,r),t.child;case 6:return e===null&&LA(t),null;case 13:return L7(e,t,r);case 4:return jN(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=of(t,null,n,r):io(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ea(n,i),dL(e,t,n,i,r);case 7:return io(e,t,t.pendingProps,r),t.child;case 8:return io(e,t,t.pendingProps.children,r),t.child;case 12:return io(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Jr(M_,n._currentValue),n._currentValue=s,o!==null)if(Na(o.value,s)){if(o.children===i.children&&!No.current){t=cl(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=Zc(-1,r&-r),c.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var d=l.pending;d===null?c.next=c:(c.next=d.next,d.next=c),l.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),MA(o.return,r,t),a.lanes|=r;break}c=c.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(Ie(341));s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),MA(s,r,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}io(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Fp(t,r),i=Qs(i),n=n(i),t.flags|=1,io(e,t,n,r),t.child;case 14:return n=t.type,i=Ea(n,t.pendingProps),i=Ea(n.type,i),uL(e,t,n,i,r);case 15:return N7(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ea(n,i),jE(e,t),t.tag=1,ko(n)?(e=!0,P_(t)):e=!1,Fp(t,r),A7(t,n,i),UA(t,n,i,r),BA(null,t,n,!0,e,r);case 19:return M7(e,t,r);case 22:return k7(e,t,r)}throw Error(Ie(156,t.tag))};function Q7(e,t){return C$(e,t)}function Fte(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ks(e,t,r,n){return new Fte(e,t,r,n)}function QN(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Vte(e){if(typeof e=="function")return QN(e)?1:0;if(e!=null){if(e=e.$$typeof,e===yN)return 11;if(e===vN)return 14}return 2}function fd(e,t){var r=e.alternate;return r===null?(r=Ks(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function VE(e,t,r,n,i,o){var s=2;if(n=e,typeof e=="function")QN(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case ap:return Nu(r.children,i,o,t);case gN:s=8,i|=8;break;case cA:return e=Ks(12,r,t,i|2),e.elementType=cA,e.lanes=o,e;case lA:return e=Ks(13,r,t,i),e.elementType=lA,e.lanes=o,e;case dA:return e=Ks(19,r,t,i),e.elementType=dA,e.lanes=o,e;case c$:return Sw(r,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case s$:s=10;break e;case a$:s=9;break e;case yN:s=11;break e;case vN:s=14;break e;case Bl:s=16,n=null;break e}throw Error(Ie(130,e==null?e:typeof e,""))}return t=Ks(s,r,t,i),t.elementType=e,t.type=n,t.lanes=o,t}function Nu(e,t,r,n){return e=Ks(7,e,n,t),e.lanes=r,e}function Sw(e,t,r,n){return e=Ks(22,e,n,t),e.elementType=c$,e.lanes=r,e.stateNode={isHidden:!1},e}function zT(e,t,r){return e=Ks(6,e,null,t),e.lanes=r,e}function KT(e,t,r){return t=Ks(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bte(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=IT(0),this.expirationTimes=IT(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=IT(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ZN(e,t,r,n,i,o,s,a,c){return e=new Bte(e,t,r,a,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Ks(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},MN(o),e}function $te(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sp,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Z7(e){if(!e)return Td;e=e._reactInternals;e:{if(ch(e)!==e||e.tag!==1)throw Error(Ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ko(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ie(171))}if(e.tag===1){var r=e.type;if(ko(r))return Z$(e,r,t)}return t}function eH(e,t,r,n,i,o,s,a,c){return e=ZN(r,n,!0,e,i,o,s,a,c),e.context=Z7(null),r=e.current,n=co(),i=pd(r),o=Zc(n,i),o.callback=t??null,ud(r,o,i),e.current.lanes=i,ty(e,i,n),Po(e,n),e}function Tw(e,t,r,n){var i=t.current,o=co(),s=pd(i);return r=Z7(r),t.context===null?t.context=r:t.pendingContext=r,t=Zc(o,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ud(i,t,s),e!==null&&(xa(e,i,s,o),DE(e,i,s)),s}function z_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function SL(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function ek(e,t){SL(e,t),(e=e.alternate)&&SL(e,t)}function Hte(){return null}var tH=typeof reportError=="function"?reportError:function(e){console.error(e)};function tk(e){this._internalRoot=e}Cw.prototype.render=tk.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ie(409));Tw(e,t,null,null)};Cw.prototype.unmount=tk.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ku(function(){Tw(null,e,null,null)}),t[sl]=null}};function Cw(e){this._internalRoot=e}Cw.prototype.unstable_scheduleHydration=function(e){if(e){var t=k$();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Wl.length&&t!==0&&t<Wl[r].priority;r++);Wl.splice(r,0,e),r===0&&D$(e)}};function rk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function TL(){}function Wte(e,t,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var l=z_(s);o.call(l)}}var s=eH(t,n,e,0,null,!1,!1,"",TL);return e._reactRootContainer=s,e[sl]=s.current,i0(e.nodeType===8?e.parentNode:e),Ku(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var l=z_(c);a.call(l)}}var c=ZN(e,0,!1,null,null,!1,!1,"",TL);return e._reactRootContainer=c,e[sl]=c.current,i0(e.nodeType===8?e.parentNode:e),Ku(function(){Tw(t,c,r,n)}),c}function Iw(e,t,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var c=z_(s);a.call(c)}}Tw(t,s,e,i)}else s=Wte(r,t,e,i,n);return z_(s)}O$=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=tg(t.pendingLanes);r!==0&&(bN(t,r|1),Po(t,Hn()),!(pr&6)&&(cf=Hn()+500,Dd()))}break;case 13:Ku(function(){var n=al(e,1);if(n!==null){var i=co();xa(n,e,1,i)}}),ek(e,1)}};wN=function(e){if(e.tag===13){var t=al(e,134217728);if(t!==null){var r=co();xa(t,e,134217728,r)}ek(e,134217728)}};N$=function(e){if(e.tag===13){var t=pd(e),r=al(e,t);if(r!==null){var n=co();xa(r,e,t,n)}ek(e,t)}};k$=function(){return Lr};P$=function(e,t){var r=Lr;try{return Lr=e,t()}finally{Lr=r}};_A=function(e,t,r){switch(t){case"input":if(pA(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=yw(n);if(!i)throw Error(Ie(90));d$(n),pA(n,i)}}}break;case"textarea":h$(e,r);break;case"select":t=r.value,t!=null&&Lp(e,!!r.multiple,t,!1)}};E$=YN;_$=Ku;var Gte={usingClientEntryPoint:!1,Events:[ny,up,yw,y$,v$,YN]},Om={findFiberByHostInstance:yu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zte={bundleType:Om.bundleType,version:Om.version,rendererPackageName:Om.rendererPackageName,rendererConfig:Om.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ml.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=S$(e),e===null?null:e.stateNode},findFiberByHostInstance:Om.findFiberByHostInstance||Hte,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vv.isDisabled&&vv.supportsFiber)try{pw=vv.inject(zte),dc=vv}catch{}}ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gte;ms.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rk(t))throw Error(Ie(200));return $te(e,t,null,r)};ms.createRoot=function(e,t){if(!rk(e))throw Error(Ie(299));var r=!1,n="",i=tH;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=ZN(e,1,!1,null,null,r,!1,n,i),e[sl]=t.current,i0(e.nodeType===8?e.parentNode:e),new tk(t)};ms.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ie(188)):(e=Object.keys(e).join(","),Error(Ie(268,e)));return e=S$(t),e=e===null?null:e.stateNode,e};ms.flushSync=function(e){return Ku(e)};ms.hydrate=function(e,t,r){if(!Rw(t))throw Error(Ie(200));return Iw(null,e,t,!0,r)};ms.hydrateRoot=function(e,t,r){if(!rk(e))throw Error(Ie(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",s=tH;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=eH(t,null,e,1,r??null,i,!1,o,s),e[sl]=t.current,i0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Cw(t)};ms.render=function(e,t,r){if(!Rw(t))throw Error(Ie(200));return Iw(null,e,t,!1,r)};ms.unmountComponentAtNode=function(e){if(!Rw(e))throw Error(Ie(40));return e._reactRootContainer?(Ku(function(){Iw(null,null,e,!1,function(){e._reactRootContainer=null,e[sl]=null})}),!0):!1};ms.unstable_batchedUpdates=YN;ms.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Rw(r))throw Error(Ie(200));if(e==null||e._reactInternals===void 0)throw Error(Ie(38));return Iw(e,t,r,!1,n)};ms.version="18.3.1-next-f1338f8080-20240426";function rH(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rH)}catch(e){console.error(e)}}rH(),r$.exports=ms;var Aw=r$.exports,nH,CL=Aw;nH=CL.createRoot,CL.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function p0(){return p0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p0.apply(this,arguments)}var Ql;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ql||(Ql={}));const RL="popstate";function Kte(e){e===void 0&&(e={});function t(n,i){let{pathname:o,search:s,hash:a}=n.location;return ZA("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:K_(i)}return Yte(t,r,null,e)}function Zn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function iH(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function qte(){return Math.random().toString(36).substr(2,8)}function IL(e,t){return{usr:e.state,key:e.key,idx:t}}function ZA(e,t,r,n){return r===void 0&&(r=null),p0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?jf(t):t,{state:r,key:t&&t.key||n||qte()})}function K_(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function jf(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Yte(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,s=i.history,a=Ql.Pop,c=null,l=d();l==null&&(l=0,s.replaceState(p0({},s.state,{idx:l}),""));function d(){return(s.state||{idx:null}).idx}function u(){a=Ql.Pop;let y=d(),v=y==null?null:y-l;l=y,c&&c({action:a,location:g.location,delta:v})}function p(y,v){a=Ql.Push;let E=ZA(g.location,y,v);l=d()+1;let w=IL(E,l),S=g.createHref(E);try{s.pushState(w,"",S)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;i.location.assign(S)}o&&c&&c({action:a,location:g.location,delta:1})}function f(y,v){a=Ql.Replace;let E=ZA(g.location,y,v);l=d();let w=IL(E,l),S=g.createHref(E);s.replaceState(w,"",S),o&&c&&c({action:a,location:g.location,delta:0})}function m(y){let v=i.location.origin!=="null"?i.location.origin:i.location.href,E=typeof y=="string"?y:K_(y);return E=E.replace(/ $/,"%20"),Zn(v,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,v)}let g={get action(){return a},get location(){return e(i,s)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(RL,u),c=y,()=>{i.removeEventListener(RL,u),c=null}},createHref(y){return t(i,y)},createURL:m,encodeLocation(y){let v=m(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:f,go(y){return s.go(y)}};return g}var AL;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(AL||(AL={}));function Xte(e,t,r){return r===void 0&&(r="/"),Jte(e,t,r,!1)}function Jte(e,t,r,n){let i=typeof t=="string"?jf(t):t,o=nk(i.pathname||"/",r);if(o==null)return null;let s=oH(e);Qte(s);let a=null;for(let c=0;a==null&&c<s.length;++c){let l=lre(o);a=are(s[c],l,n)}return a}function oH(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(o,s,a)=>{let c={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};c.relativePath.startsWith("/")&&(Zn(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let l=md([n,c.relativePath]),d=r.concat(c);o.children&&o.children.length>0&&(Zn(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),oH(o.children,t,d,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:ore(l,o.index),routesMeta:d})};return e.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let c of sH(o.path))i(o,s,c)}),t}function sH(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let s=sH(n.join("/")),a=[];return a.push(...s.map(c=>c===""?o:[o,c].join("/"))),i&&a.push(...s),a.map(c=>e.startsWith("/")&&c===""?"/":c)}function Qte(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:sre(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Zte=/^:[\w-]+$/,ere=3,tre=2,rre=1,nre=10,ire=-2,xL=e=>e==="*";function ore(e,t){let r=e.split("/"),n=r.length;return r.some(xL)&&(n+=ire),t&&(n+=tre),r.filter(i=>!xL(i)).reduce((i,o)=>i+(Zte.test(o)?ere:o===""?rre:nre),n)}function sre(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function are(e,t,r){let{routesMeta:n}=e,i={},o="/",s=[];for(let a=0;a<n.length;++a){let c=n[a],l=a===n.length-1,d=o==="/"?t:t.slice(o.length)||"/",u=OL({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},d),p=c.route;if(!u&&l&&r&&!n[n.length-1].route.index&&(u=OL({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!u)return null;Object.assign(i,u.params),s.push({params:i,pathname:md([o,u.pathname]),pathnameBase:pre(md([o,u.pathnameBase])),route:p}),u.pathnameBase!=="/"&&(o=md([o,u.pathnameBase]))}return s}function OL(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=cre(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((l,d,u)=>{let{paramName:p,isOptional:f}=d;if(p==="*"){let g=a[u]||"";s=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const m=a[u];return f&&!m?l[p]=void 0:l[p]=(m||"").replace(/%2F/g,"/"),l},{}),pathname:o,pathnameBase:s,pattern:e}}function cre(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),iH(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,c)=>(n.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function lre(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return iH(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function nk(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function dre(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?jf(e):e;return{pathname:r?r.startsWith("/")?r:ure(r,t):t,search:fre(n),hash:mre(i)}}function ure(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function qT(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hre(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function aH(e,t){let r=hre(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function cH(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=jf(e):(i=p0({},e),Zn(!i.pathname||!i.pathname.includes("?"),qT("?","pathname","search",i)),Zn(!i.pathname||!i.pathname.includes("#"),qT("#","pathname","hash",i)),Zn(!i.search||!i.search.includes("#"),qT("#","search","hash",i)));let o=e===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=r;else{let u=t.length-1;if(!n&&s.startsWith("..")){let p=s.split("/");for(;p[0]==="..";)p.shift(),u-=1;i.pathname=p.join("/")}a=u>=0?t[u]:"/"}let c=dre(i,a),l=s&&s!=="/"&&s.endsWith("/"),d=(o||s===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(l||d)&&(c.pathname+="/"),c}const md=e=>e.join("/").replace(/\/\/+/g,"/"),pre=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),fre=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,mre=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function gre(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const lH=["post","put","patch","delete"];new Set(lH);const yre=["get",...lH];new Set(yre);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function f0(){return f0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f0.apply(this,arguments)}const ik=T.createContext(null),vre=T.createContext(null),lh=T.createContext(null),xw=T.createContext(null),gl=T.createContext({outlet:null,matches:[],isDataRoute:!1}),dH=T.createContext(null);function Ere(e,t){let{relative:r}=t===void 0?{}:t;oy()||Zn(!1);let{basename:n,navigator:i}=T.useContext(lh),{hash:o,pathname:s,search:a}=hH(e,{relative:r}),c=s;return n!=="/"&&(c=s==="/"?n:md([n,s])),i.createHref({pathname:c,search:a,hash:o})}function oy(){return T.useContext(xw)!=null}function Uf(){return oy()||Zn(!1),T.useContext(xw).location}function uH(e){T.useContext(lh).static||T.useLayoutEffect(e)}function Ln(){let{isDataRoute:e}=T.useContext(gl);return e?Dre():_re()}function _re(){oy()||Zn(!1);let e=T.useContext(ik),{basename:t,future:r,navigator:n}=T.useContext(lh),{matches:i}=T.useContext(gl),{pathname:o}=Uf(),s=JSON.stringify(aH(i,r.v7_relativeSplatPath)),a=T.useRef(!1);return uH(()=>{a.current=!0}),T.useCallback(function(l,d){if(d===void 0&&(d={}),!a.current)return;if(typeof l=="number"){n.go(l);return}let u=cH(l,JSON.parse(s),o,d.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:md([t,u.pathname])),(d.replace?n.replace:n.push)(u,d.state,d)},[t,n,s,o,e])}const bre=T.createContext(null);function wre(e){let t=T.useContext(gl).outlet;return t&&T.createElement(bre.Provider,{value:e},t)}function sy(){let{matches:e}=T.useContext(gl),t=e[e.length-1];return t?t.params:{}}function hH(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=T.useContext(lh),{matches:i}=T.useContext(gl),{pathname:o}=Uf(),s=JSON.stringify(aH(i,n.v7_relativeSplatPath));return T.useMemo(()=>cH(e,JSON.parse(s),o,r==="path"),[e,s,o,r])}function Sre(e,t){return Tre(e,t)}function Tre(e,t,r,n){oy()||Zn(!1);let{navigator:i}=T.useContext(lh),{matches:o}=T.useContext(gl),s=o[o.length-1],a=s?s.params:{};s&&s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let l=Uf(),d;if(t){var u;let y=typeof t=="string"?jf(t):t;c==="/"||(u=y.pathname)!=null&&u.startsWith(c)||Zn(!1),d=y}else d=l;let p=d.pathname||"/",f=p;if(c!=="/"){let y=c.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=Xte(e,{pathname:f}),g=xre(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:md([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:md([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,r,n);return t&&g?T.createElement(xw.Provider,{value:{location:f0({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ql.Pop}},g):g}function Cre(){let e=Pre(),t=gre(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},t),r?T.createElement("pre",{style:i},r):null,null)}const Rre=T.createElement(Cre,null);class Ire extends T.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?T.createElement(gl.Provider,{value:this.props.routeContext},T.createElement(dH.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Are(e){let{routeContext:t,match:r,children:n}=e,i=T.useContext(ik);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),T.createElement(gl.Provider,{value:t},n)}function xre(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var o;if(!r)return null;if(r.errors)e=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,a=(i=r)==null?void 0:i.errors;if(a!=null){let d=s.findIndex(u=>u.route.id&&(a==null?void 0:a[u.route.id])!==void 0);d>=0||Zn(!1),s=s.slice(0,Math.min(s.length,d+1))}let c=!1,l=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<s.length;d++){let u=s[d];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=d),u.route.id){let{loaderData:p,errors:f}=r,m=u.route.loader&&p[u.route.id]===void 0&&(!f||f[u.route.id]===void 0);if(u.route.lazy||m){c=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((d,u,p)=>{let f,m=!1,g=null,y=null;r&&(f=a&&u.route.id?a[u.route.id]:void 0,g=u.route.errorElement||Rre,c&&(l<0&&p===0?(m=!0,y=null):l===p&&(m=!0,y=u.route.hydrateFallbackElement||null)));let v=t.concat(s.slice(0,p+1)),E=()=>{let w;return f?w=g:m?w=y:u.route.Component?w=T.createElement(u.route.Component,null):u.route.element?w=u.route.element:w=d,T.createElement(Are,{match:u,routeContext:{outlet:d,matches:v,isDataRoute:r!=null},children:w})};return r&&(u.route.ErrorBoundary||u.route.errorElement||p===0)?T.createElement(Ire,{location:r.location,revalidation:r.revalidation,component:g,error:f,children:E(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):E()},null)}var pH=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(pH||{}),q_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(q_||{});function Ore(e){let t=T.useContext(ik);return t||Zn(!1),t}function Nre(e){let t=T.useContext(vre);return t||Zn(!1),t}function kre(e){let t=T.useContext(gl);return t||Zn(!1),t}function fH(e){let t=kre(),r=t.matches[t.matches.length-1];return r.route.id||Zn(!1),r.route.id}function Pre(){var e;let t=T.useContext(dH),r=Nre(q_.UseRouteError),n=fH(q_.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Dre(){let{router:e}=Ore(pH.UseNavigateStable),t=fH(q_.UseNavigateStable),r=T.useRef(!1);return uH(()=>{r.current=!0}),T.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,f0({fromRouteId:t},o)))},[e,t])}const NL={};function Lre(e,t){NL[t]||(NL[t]=!0,console.warn(t))}const kL=(e,t,r)=>Lre(e,"⚠️ React Router Future Flag Warning: "+t+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function Mre(e,t){e!=null&&e.v7_startTransition||kL("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(e!=null&&e.v7_relativeSplatPath)&&!t&&kL("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function po(e){return wre(e.context)}function ot(e){Zn(!1)}function jre(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Ql.Pop,navigator:o,static:s=!1,future:a}=e;oy()&&Zn(!1);let c=t.replace(/^\/*/,"/"),l=T.useMemo(()=>({basename:c,navigator:o,static:s,future:f0({v7_relativeSplatPath:!1},a)}),[c,a,o,s]);typeof n=="string"&&(n=jf(n));let{pathname:d="/",search:u="",hash:p="",state:f=null,key:m="default"}=n,g=T.useMemo(()=>{let y=nk(d,c);return y==null?null:{location:{pathname:y,search:u,hash:p,state:f,key:m},navigationType:i}},[c,d,u,p,f,m,i]);return g==null?null:T.createElement(lh.Provider,{value:l},T.createElement(xw.Provider,{children:r,value:g}))}function Ure(e){let{children:t,location:r}=e;return Sre(ex(t),r)}new Promise(()=>{});function ex(e,t){t===void 0&&(t=[]);let r=[];return T.Children.forEach(e,(n,i)=>{if(!T.isValidElement(n))return;let o=[...t,i];if(n.type===T.Fragment){r.push.apply(r,ex(n.props.children,o));return}n.type!==ot&&Zn(!1),!n.props.index||!n.props.children||Zn(!1);let s={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=ex(n.props.children,o)),r.push(s)}),r}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tx(){return tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tx.apply(this,arguments)}function Fre(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Vre(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Bre(e,t){return e.button===0&&(!t||t==="_self")&&!Vre(e)}function Y_(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function $re(e,t){let r=Y_(e);return t&&t.forEach((n,i)=>{r.has(i)||t.getAll(i).forEach(o=>{r.append(i,o)})}),r}const Hre=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Wre="6";try{window.__reactRouterVersion=Wre}catch{}const Gre="startTransition",PL=e$[Gre];function zre(e){let{basename:t,children:r,future:n,window:i}=e,o=T.useRef();o.current==null&&(o.current=Kte({window:i,v5Compat:!0}));let s=o.current,[a,c]=T.useState({action:s.action,location:s.location}),{v7_startTransition:l}=n||{},d=T.useCallback(u=>{l&&PL?PL(()=>c(u)):c(u)},[c,l]);return T.useLayoutEffect(()=>s.listen(d),[s,d]),T.useEffect(()=>Mre(n),[n]),T.createElement(jre,{basename:t,children:r,location:a.location,navigationType:a.action,navigator:s,future:n})}const Kre=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qre=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Kr=T.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:o,replace:s,state:a,target:c,to:l,preventScrollReset:d,viewTransition:u}=t,p=Fre(t,Hre),{basename:f}=T.useContext(lh),m,g=!1;if(typeof l=="string"&&qre.test(l)&&(m=l,Kre))try{let w=new URL(window.location.href),S=l.startsWith("//")?new URL(w.protocol+l):new URL(l),A=nk(S.pathname,f);S.origin===w.origin&&A!=null?l=A+S.search+S.hash:g=!0}catch{}let y=Ere(l,{relative:i}),v=Yre(l,{replace:s,state:a,target:c,preventScrollReset:d,relative:i,viewTransition:u});function E(w){n&&n(w),w.defaultPrevented||v(w)}return T.createElement("a",tx({},p,{href:m||y,onClick:g||o?n:E,ref:r,target:c}))});var DL;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(DL||(DL={}));var LL;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(LL||(LL={}));function Yre(e,t){let{target:r,replace:n,state:i,preventScrollReset:o,relative:s,viewTransition:a}=t===void 0?{}:t,c=Ln(),l=Uf(),d=hH(e,{relative:s});return T.useCallback(u=>{if(Bre(u,r)){u.preventDefault();let p=n!==void 0?n:K_(l)===K_(d);c(e,{replace:p,state:i,preventScrollReset:o,relative:s,viewTransition:a})}},[l,c,d,n,i,r,e,o,s,a])}function mH(e){let t=T.useRef(Y_(e)),r=T.useRef(!1),n=Uf(),i=T.useMemo(()=>$re(n.search,r.current?null:t.current),[n.search]),o=Ln(),s=T.useCallback((a,c)=>{const l=Y_(typeof a=="function"?a(i):a);r.current=!0,o("?"+l,c)},[o,i]);return[i,s]}var Xre=function(t){return Jre(t)&&!Qre(t)};function Jre(e){return!!e&&typeof e=="object"}function Qre(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||tne(e)}var Zre=typeof Symbol=="function"&&Symbol.for,ene=Zre?Symbol.for("react.element"):60103;function tne(e){return e.$$typeof===ene}function rne(e){return Array.isArray(e)?[]:{}}function X_(e,t){return t.clone!==!1&&t.isMergeableObject(e)?m0(rne(e),e,t):e}function nne(e,t,r){return e.concat(t).map(function(n){return X_(n,r)})}function ine(e,t,r){var n={};return r.isMergeableObject(e)&&Object.keys(e).forEach(function(i){n[i]=X_(e[i],r)}),Object.keys(t).forEach(function(i){!r.isMergeableObject(t[i])||!e[i]?n[i]=X_(t[i],r):n[i]=m0(e[i],t[i],r)}),n}function m0(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||nne,r.isMergeableObject=r.isMergeableObject||Xre;var n=Array.isArray(t),i=Array.isArray(e),o=n===i;return o?n?r.arrayMerge(e,t,r):ine(e,t,r):X_(t,r)}m0.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,i){return m0(n,i,r)},{})};var rx=m0,gH=typeof global=="object"&&global&&global.Object===Object&&global,one=typeof self=="object"&&self&&self.Object===Object&&self,_c=gH||one||Function("return this")(),Cd=_c.Symbol,yH=Object.prototype,sne=yH.hasOwnProperty,ane=yH.toString,Nm=Cd?Cd.toStringTag:void 0;function cne(e){var t=sne.call(e,Nm),r=e[Nm];try{e[Nm]=void 0;var n=!0}catch{}var i=ane.call(e);return n&&(t?e[Nm]=r:delete e[Nm]),i}var lne=Object.prototype,dne=lne.toString;function une(e){return dne.call(e)}var hne="[object Null]",pne="[object Undefined]",ML=Cd?Cd.toStringTag:void 0;function dh(e){return e==null?e===void 0?pne:hne:ML&&ML in Object(e)?cne(e):une(e)}function vH(e,t){return function(r){return e(t(r))}}var ok=vH(Object.getPrototypeOf,Object);function uh(e){return e!=null&&typeof e=="object"}var fne="[object Object]",mne=Function.prototype,gne=Object.prototype,EH=mne.toString,yne=gne.hasOwnProperty,vne=EH.call(Object);function jL(e){if(!uh(e)||dh(e)!=fne)return!1;var t=ok(e);if(t===null)return!0;var r=yne.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&EH.call(r)==vne}function Ene(){this.__data__=[],this.size=0}function _H(e,t){return e===t||e!==e&&t!==t}function Ow(e,t){for(var r=e.length;r--;)if(_H(e[r][0],t))return r;return-1}var _ne=Array.prototype,bne=_ne.splice;function wne(e){var t=this.__data__,r=Ow(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():bne.call(t,r,1),--this.size,!0}function Sne(e){var t=this.__data__,r=Ow(t,e);return r<0?void 0:t[r][1]}function Tne(e){return Ow(this.__data__,e)>-1}function Cne(e,t){var r=this.__data__,n=Ow(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function yl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}yl.prototype.clear=Ene;yl.prototype.delete=wne;yl.prototype.get=Sne;yl.prototype.has=Tne;yl.prototype.set=Cne;function Rne(){this.__data__=new yl,this.size=0}function Ine(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function Ane(e){return this.__data__.get(e)}function xne(e){return this.__data__.has(e)}function ay(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var One="[object AsyncFunction]",Nne="[object Function]",kne="[object GeneratorFunction]",Pne="[object Proxy]";function bH(e){if(!ay(e))return!1;var t=dh(e);return t==Nne||t==kne||t==One||t==Pne}var YT=_c["__core-js_shared__"],UL=function(){var e=/[^.]+$/.exec(YT&&YT.keys&&YT.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Dne(e){return!!UL&&UL in e}var Lne=Function.prototype,Mne=Lne.toString;function hh(e){if(e!=null){try{return Mne.call(e)}catch{}try{return e+""}catch{}}return""}var jne=/[\\^$.*+?()[\]{}|]/g,Une=/^\[object .+?Constructor\]$/,Fne=Function.prototype,Vne=Object.prototype,Bne=Fne.toString,$ne=Vne.hasOwnProperty,Hne=RegExp("^"+Bne.call($ne).replace(jne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Wne(e){if(!ay(e)||Dne(e))return!1;var t=bH(e)?Hne:Une;return t.test(hh(e))}function Gne(e,t){return e==null?void 0:e[t]}function ph(e,t){var r=Gne(e,t);return Wne(r)?r:void 0}var g0=ph(_c,"Map"),y0=ph(Object,"create");function zne(){this.__data__=y0?y0(null):{},this.size=0}function Kne(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var qne="__lodash_hash_undefined__",Yne=Object.prototype,Xne=Yne.hasOwnProperty;function Jne(e){var t=this.__data__;if(y0){var r=t[e];return r===qne?void 0:r}return Xne.call(t,e)?t[e]:void 0}var Qne=Object.prototype,Zne=Qne.hasOwnProperty;function eie(e){var t=this.__data__;return y0?t[e]!==void 0:Zne.call(t,e)}var tie="__lodash_hash_undefined__";function rie(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=y0&&t===void 0?tie:t,this}function qu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qu.prototype.clear=zne;qu.prototype.delete=Kne;qu.prototype.get=Jne;qu.prototype.has=eie;qu.prototype.set=rie;function nie(){this.size=0,this.__data__={hash:new qu,map:new(g0||yl),string:new qu}}function iie(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Nw(e,t){var r=e.__data__;return iie(t)?r[typeof t=="string"?"string":"hash"]:r.map}function oie(e){var t=Nw(this,e).delete(e);return this.size-=t?1:0,t}function sie(e){return Nw(this,e).get(e)}function aie(e){return Nw(this,e).has(e)}function cie(e,t){var r=Nw(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function Ld(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ld.prototype.clear=nie;Ld.prototype.delete=oie;Ld.prototype.get=sie;Ld.prototype.has=aie;Ld.prototype.set=cie;var lie=200;function die(e,t){var r=this.__data__;if(r instanceof yl){var n=r.__data__;if(!g0||n.length<lie-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ld(n)}return r.set(e,t),this.size=r.size,this}function Ff(e){var t=this.__data__=new yl(e);this.size=t.size}Ff.prototype.clear=Rne;Ff.prototype.delete=Ine;Ff.prototype.get=Ane;Ff.prototype.has=xne;Ff.prototype.set=die;function uie(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var FL=function(){try{var e=ph(Object,"defineProperty");return e({},"",{}),e}catch{}}();function wH(e,t,r){t=="__proto__"&&FL?FL(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var hie=Object.prototype,pie=hie.hasOwnProperty;function SH(e,t,r){var n=e[t];(!(pie.call(e,t)&&_H(n,r))||r===void 0&&!(t in e))&&wH(e,t,r)}function kw(e,t,r,n){var i=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var a=t[o],c=void 0;c===void 0&&(c=e[a]),i?wH(r,a,c):SH(r,a,c)}return r}function fie(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var mie="[object Arguments]";function VL(e){return uh(e)&&dh(e)==mie}var TH=Object.prototype,gie=TH.hasOwnProperty,yie=TH.propertyIsEnumerable,vie=VL(function(){return arguments}())?VL:function(e){return uh(e)&&gie.call(e,"callee")&&!yie.call(e,"callee")},cy=Array.isArray;function Eie(){return!1}var CH=typeof ss=="object"&&ss&&!ss.nodeType&&ss,BL=CH&&typeof as=="object"&&as&&!as.nodeType&&as,_ie=BL&&BL.exports===CH,$L=_ie?_c.Buffer:void 0,bie=$L?$L.isBuffer:void 0,RH=bie||Eie,wie=9007199254740991,Sie=/^(?:0|[1-9]\d*)$/;function Tie(e,t){var r=typeof e;return t=t??wie,!!t&&(r=="number"||r!="symbol"&&Sie.test(e))&&e>-1&&e%1==0&&e<t}var Cie=9007199254740991;function IH(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Cie}var Rie="[object Arguments]",Iie="[object Array]",Aie="[object Boolean]",xie="[object Date]",Oie="[object Error]",Nie="[object Function]",kie="[object Map]",Pie="[object Number]",Die="[object Object]",Lie="[object RegExp]",Mie="[object Set]",jie="[object String]",Uie="[object WeakMap]",Fie="[object ArrayBuffer]",Vie="[object DataView]",Bie="[object Float32Array]",$ie="[object Float64Array]",Hie="[object Int8Array]",Wie="[object Int16Array]",Gie="[object Int32Array]",zie="[object Uint8Array]",Kie="[object Uint8ClampedArray]",qie="[object Uint16Array]",Yie="[object Uint32Array]",nn={};nn[Bie]=nn[$ie]=nn[Hie]=nn[Wie]=nn[Gie]=nn[zie]=nn[Kie]=nn[qie]=nn[Yie]=!0;nn[Rie]=nn[Iie]=nn[Fie]=nn[Aie]=nn[Vie]=nn[xie]=nn[Oie]=nn[Nie]=nn[kie]=nn[Pie]=nn[Die]=nn[Lie]=nn[Mie]=nn[jie]=nn[Uie]=!1;function Xie(e){return uh(e)&&IH(e.length)&&!!nn[dh(e)]}function sk(e){return function(t){return e(t)}}var AH=typeof ss=="object"&&ss&&!ss.nodeType&&ss,Ag=AH&&typeof as=="object"&&as&&!as.nodeType&&as,Jie=Ag&&Ag.exports===AH,XT=Jie&&gH.process,lf=function(){try{var e=Ag&&Ag.require&&Ag.require("util").types;return e||XT&&XT.binding&&XT.binding("util")}catch{}}(),HL=lf&&lf.isTypedArray,Qie=HL?sk(HL):Xie,Zie=Object.prototype,eoe=Zie.hasOwnProperty;function xH(e,t){var r=cy(e),n=!r&&vie(e),i=!r&&!n&&RH(e),o=!r&&!n&&!i&&Qie(e),s=r||n||i||o,a=s?fie(e.length,String):[],c=a.length;for(var l in e)(t||eoe.call(e,l))&&!(s&&(l=="length"||i&&(l=="offset"||l=="parent")||o&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Tie(l,c)))&&a.push(l);return a}var toe=Object.prototype;function ak(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||toe;return e===r}var roe=vH(Object.keys,Object),noe=Object.prototype,ioe=noe.hasOwnProperty;function ooe(e){if(!ak(e))return roe(e);var t=[];for(var r in Object(e))ioe.call(e,r)&&r!="constructor"&&t.push(r);return t}function OH(e){return e!=null&&IH(e.length)&&!bH(e)}function ck(e){return OH(e)?xH(e):ooe(e)}function soe(e,t){return e&&kw(t,ck(t),e)}function aoe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var coe=Object.prototype,loe=coe.hasOwnProperty;function doe(e){if(!ay(e))return aoe(e);var t=ak(e),r=[];for(var n in e)n=="constructor"&&(t||!loe.call(e,n))||r.push(n);return r}function lk(e){return OH(e)?xH(e,!0):doe(e)}function uoe(e,t){return e&&kw(t,lk(t),e)}var NH=typeof ss=="object"&&ss&&!ss.nodeType&&ss,WL=NH&&typeof as=="object"&&as&&!as.nodeType&&as,hoe=WL&&WL.exports===NH,GL=hoe?_c.Buffer:void 0,zL=GL?GL.allocUnsafe:void 0;function poe(e,t){if(t)return e.slice();var r=e.length,n=zL?zL(r):new e.constructor(r);return e.copy(n),n}function kH(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function foe(e,t){for(var r=-1,n=e==null?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}function PH(){return[]}var moe=Object.prototype,goe=moe.propertyIsEnumerable,KL=Object.getOwnPropertySymbols,dk=KL?function(e){return e==null?[]:(e=Object(e),foe(KL(e),function(t){return goe.call(e,t)}))}:PH;function yoe(e,t){return kw(e,dk(e),t)}function DH(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var voe=Object.getOwnPropertySymbols,LH=voe?function(e){for(var t=[];e;)DH(t,dk(e)),e=ok(e);return t}:PH;function Eoe(e,t){return kw(e,LH(e),t)}function MH(e,t,r){var n=t(e);return cy(e)?n:DH(n,r(e))}function _oe(e){return MH(e,ck,dk)}function boe(e){return MH(e,lk,LH)}var nx=ph(_c,"DataView"),ix=ph(_c,"Promise"),ox=ph(_c,"Set"),sx=ph(_c,"WeakMap"),qL="[object Map]",woe="[object Object]",YL="[object Promise]",XL="[object Set]",JL="[object WeakMap]",QL="[object DataView]",Soe=hh(nx),Toe=hh(g0),Coe=hh(ix),Roe=hh(ox),Ioe=hh(sx),Wc=dh;(nx&&Wc(new nx(new ArrayBuffer(1)))!=QL||g0&&Wc(new g0)!=qL||ix&&Wc(ix.resolve())!=YL||ox&&Wc(new ox)!=XL||sx&&Wc(new sx)!=JL)&&(Wc=function(e){var t=dh(e),r=t==woe?e.constructor:void 0,n=r?hh(r):"";if(n)switch(n){case Soe:return QL;case Toe:return qL;case Coe:return YL;case Roe:return XL;case Ioe:return JL}return t});var Aoe=Object.prototype,xoe=Aoe.hasOwnProperty;function Ooe(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&xoe.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var ZL=_c.Uint8Array;function uk(e){var t=new e.constructor(e.byteLength);return new ZL(t).set(new ZL(e)),t}function Noe(e,t){var r=t?uk(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var koe=/\w*$/;function Poe(e){var t=new e.constructor(e.source,koe.exec(e));return t.lastIndex=e.lastIndex,t}var eM=Cd?Cd.prototype:void 0,tM=eM?eM.valueOf:void 0;function Doe(e){return tM?Object(tM.call(e)):{}}function Loe(e,t){var r=t?uk(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Moe="[object Boolean]",joe="[object Date]",Uoe="[object Map]",Foe="[object Number]",Voe="[object RegExp]",Boe="[object Set]",$oe="[object String]",Hoe="[object Symbol]",Woe="[object ArrayBuffer]",Goe="[object DataView]",zoe="[object Float32Array]",Koe="[object Float64Array]",qoe="[object Int8Array]",Yoe="[object Int16Array]",Xoe="[object Int32Array]",Joe="[object Uint8Array]",Qoe="[object Uint8ClampedArray]",Zoe="[object Uint16Array]",ese="[object Uint32Array]";function tse(e,t,r){var n=e.constructor;switch(t){case Woe:return uk(e);case Moe:case joe:return new n(+e);case Goe:return Noe(e,r);case zoe:case Koe:case qoe:case Yoe:case Xoe:case Joe:case Qoe:case Zoe:case ese:return Loe(e,r);case Uoe:return new n;case Foe:case $oe:return new n(e);case Voe:return Poe(e);case Boe:return new n;case Hoe:return Doe(e)}}var rM=Object.create,rse=function(){function e(){}return function(t){if(!ay(t))return{};if(rM)return rM(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function nse(e){return typeof e.constructor=="function"&&!ak(e)?rse(ok(e)):{}}var ise="[object Map]";function ose(e){return uh(e)&&Wc(e)==ise}var nM=lf&&lf.isMap,sse=nM?sk(nM):ose,ase="[object Set]";function cse(e){return uh(e)&&Wc(e)==ase}var iM=lf&&lf.isSet,lse=iM?sk(iM):cse,dse=1,use=2,hse=4,jH="[object Arguments]",pse="[object Array]",fse="[object Boolean]",mse="[object Date]",gse="[object Error]",UH="[object Function]",yse="[object GeneratorFunction]",vse="[object Map]",Ese="[object Number]",FH="[object Object]",_se="[object RegExp]",bse="[object Set]",wse="[object String]",Sse="[object Symbol]",Tse="[object WeakMap]",Cse="[object ArrayBuffer]",Rse="[object DataView]",Ise="[object Float32Array]",Ase="[object Float64Array]",xse="[object Int8Array]",Ose="[object Int16Array]",Nse="[object Int32Array]",kse="[object Uint8Array]",Pse="[object Uint8ClampedArray]",Dse="[object Uint16Array]",Lse="[object Uint32Array]",Yr={};Yr[jH]=Yr[pse]=Yr[Cse]=Yr[Rse]=Yr[fse]=Yr[mse]=Yr[Ise]=Yr[Ase]=Yr[xse]=Yr[Ose]=Yr[Nse]=Yr[vse]=Yr[Ese]=Yr[FH]=Yr[_se]=Yr[bse]=Yr[wse]=Yr[Sse]=Yr[kse]=Yr[Pse]=Yr[Dse]=Yr[Lse]=!0;Yr[gse]=Yr[UH]=Yr[Tse]=!1;function xg(e,t,r,n,i,o){var s,a=t&dse,c=t&use,l=t&hse;if(s!==void 0)return s;if(!ay(e))return e;var d=cy(e);if(d){if(s=Ooe(e),!a)return kH(e,s)}else{var u=Wc(e),p=u==UH||u==yse;if(RH(e))return poe(e,a);if(u==FH||u==jH||p&&!i){if(s=c||p?{}:nse(e),!a)return c?Eoe(e,uoe(s,e)):yoe(e,soe(s,e))}else{if(!Yr[u])return i?e:{};s=tse(e,u,a)}}o||(o=new Ff);var f=o.get(e);if(f)return f;o.set(e,s),lse(e)?e.forEach(function(y){s.add(xg(y,t,r,y,e,o))}):sse(e)&&e.forEach(function(y,v){s.set(v,xg(y,t,r,v,e,o))});var m=l?c?boe:_oe:c?lk:ck,g=d?void 0:m(e);return uie(g||e,function(y,v){g&&(v=y,y=e[v]),SH(s,v,xg(y,t,r,v,e,o))}),s}var Mse=1,jse=4;function Ev(e){return xg(e,Mse|jse)}var oM=Array.isArray,sM=Object.keys,Use=Object.prototype.hasOwnProperty,Fse=typeof Element<"u";function ax(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var r=oM(e),n=oM(t),i,o,s;if(r&&n){if(o=e.length,o!=t.length)return!1;for(i=o;i--!==0;)if(!ax(e[i],t[i]))return!1;return!0}if(r!=n)return!1;var a=e instanceof Date,c=t instanceof Date;if(a!=c)return!1;if(a&&c)return e.getTime()==t.getTime();var l=e instanceof RegExp,d=t instanceof RegExp;if(l!=d)return!1;if(l&&d)return e.toString()==t.toString();var u=sM(e);if(o=u.length,o!==sM(t).length)return!1;for(i=o;i--!==0;)if(!Use.call(t,u[i]))return!1;if(Fse&&e instanceof Element&&t instanceof Element)return e===t;for(i=o;i--!==0;)if(s=u[i],!(s==="_owner"&&e.$$typeof)&&!ax(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}var Vse=function(t,r){try{return ax(t,r)}catch(n){if(n.message&&n.message.match(/stack|recursion/i)||n.number===-2146828260)return console.warn("Warning: react-fast-compare does not handle circular references.",n.name,n.message),!1;throw n}};const iu=Pa(Vse);var Bse=4;function aM(e){return xg(e,Bse)}function VH(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var $se="[object Symbol]";function hk(e){return typeof e=="symbol"||uh(e)&&dh(e)==$se}var Hse="Expected a function";function pk(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Hse);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(pk.Cache||Ld),r}pk.Cache=Ld;var Wse=500;function Gse(e){var t=pk(e,function(n){return r.size===Wse&&r.clear(),n}),r=t.cache;return t}var zse=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Kse=/\\(\\)?/g,qse=Gse(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(zse,function(r,n,i,o){t.push(i?o.replace(Kse,"$1"):n||r)}),t}),Yse=1/0;function Xse(e){if(typeof e=="string"||hk(e))return e;var t=e+"";return t=="0"&&1/e==-Yse?"-0":t}var Jse=1/0,cM=Cd?Cd.prototype:void 0,lM=cM?cM.toString:void 0;function BH(e){if(typeof e=="string")return e;if(cy(e))return VH(e,BH)+"";if(hk(e))return lM?lM.call(e):"";var t=e+"";return t=="0"&&1/e==-Jse?"-0":t}function Qse(e){return e==null?"":BH(e)}function $H(e){return cy(e)?VH(e,Xse):hk(e)?[e]:kH(qse(Qse(e)))}var HH={exports:{}},Mr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Si=typeof Symbol=="function"&&Symbol.for,fk=Si?Symbol.for("react.element"):60103,mk=Si?Symbol.for("react.portal"):60106,Pw=Si?Symbol.for("react.fragment"):60107,Dw=Si?Symbol.for("react.strict_mode"):60108,Lw=Si?Symbol.for("react.profiler"):60114,Mw=Si?Symbol.for("react.provider"):60109,jw=Si?Symbol.for("react.context"):60110,gk=Si?Symbol.for("react.async_mode"):60111,Uw=Si?Symbol.for("react.concurrent_mode"):60111,Fw=Si?Symbol.for("react.forward_ref"):60112,Vw=Si?Symbol.for("react.suspense"):60113,Zse=Si?Symbol.for("react.suspense_list"):60120,Bw=Si?Symbol.for("react.memo"):60115,$w=Si?Symbol.for("react.lazy"):60116,eae=Si?Symbol.for("react.block"):60121,tae=Si?Symbol.for("react.fundamental"):60117,rae=Si?Symbol.for("react.responder"):60118,nae=Si?Symbol.for("react.scope"):60119;function ys(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case fk:switch(e=e.type,e){case gk:case Uw:case Pw:case Lw:case Dw:case Vw:return e;default:switch(e=e&&e.$$typeof,e){case jw:case Fw:case $w:case Bw:case Mw:return e;default:return t}}case mk:return t}}}function WH(e){return ys(e)===Uw}Mr.AsyncMode=gk;Mr.ConcurrentMode=Uw;Mr.ContextConsumer=jw;Mr.ContextProvider=Mw;Mr.Element=fk;Mr.ForwardRef=Fw;Mr.Fragment=Pw;Mr.Lazy=$w;Mr.Memo=Bw;Mr.Portal=mk;Mr.Profiler=Lw;Mr.StrictMode=Dw;Mr.Suspense=Vw;Mr.isAsyncMode=function(e){return WH(e)||ys(e)===gk};Mr.isConcurrentMode=WH;Mr.isContextConsumer=function(e){return ys(e)===jw};Mr.isContextProvider=function(e){return ys(e)===Mw};Mr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===fk};Mr.isForwardRef=function(e){return ys(e)===Fw};Mr.isFragment=function(e){return ys(e)===Pw};Mr.isLazy=function(e){return ys(e)===$w};Mr.isMemo=function(e){return ys(e)===Bw};Mr.isPortal=function(e){return ys(e)===mk};Mr.isProfiler=function(e){return ys(e)===Lw};Mr.isStrictMode=function(e){return ys(e)===Dw};Mr.isSuspense=function(e){return ys(e)===Vw};Mr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Pw||e===Uw||e===Lw||e===Dw||e===Vw||e===Zse||typeof e=="object"&&e!==null&&(e.$$typeof===$w||e.$$typeof===Bw||e.$$typeof===Mw||e.$$typeof===jw||e.$$typeof===Fw||e.$$typeof===tae||e.$$typeof===rae||e.$$typeof===nae||e.$$typeof===eae)};Mr.typeOf=ys;HH.exports=Mr;var yk=HH.exports,GH=yk,iae={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},oae={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},zH={};zH[GH.ForwardRef]=iae;zH[GH.Memo]=oae;function pi(){return pi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pi.apply(this,arguments)}function KH(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}var Hw=T.createContext(void 0);Hw.displayName="FormikContext";Hw.Provider;Hw.Consumer;function sae(){var e=T.useContext(Hw);return e}var fa=function(t){return typeof t=="function"},Ww=function(t){return t!==null&&typeof t=="object"},aae=function(t){return String(Math.floor(Number(t)))===t},JT=function(t){return Object.prototype.toString.call(t)==="[object String]"},QT=function(t){return Ww(t)&&fa(t.then)};function Yo(e,t,r,n){n===void 0&&(n=0);for(var i=$H(t);e&&n<i.length;)e=e[i[n++]];return n!==i.length&&!e||e===void 0?r:e}function ku(e,t,r){for(var n=aM(e),i=n,o=0,s=$H(t);o<s.length-1;o++){var a=s[o],c=Yo(e,s.slice(0,o+1));if(c&&(Ww(c)||Array.isArray(c)))i=i[a]=aM(c);else{var l=s[o+1];i=i[a]=aae(l)&&Number(l)>=0?[]:{}}}return(o===0?e:i)[s[o]]===r?e:(r===void 0?delete i[s[o]]:i[s[o]]=r,o===0&&r===void 0&&delete n[s[o]],n)}function qH(e,t,r,n){r===void 0&&(r=new WeakMap),n===void 0&&(n={});for(var i=0,o=Object.keys(e);i<o.length;i++){var s=o[i],a=e[s];Ww(a)?r.get(a)||(r.set(a,!0),n[s]=Array.isArray(a)?[]:{},qH(a,t,r,n[s])):n[s]=t}return n}function cae(e,t){switch(t.type){case"SET_VALUES":return pi({},e,{values:t.payload});case"SET_TOUCHED":return pi({},e,{touched:t.payload});case"SET_ERRORS":return iu(e.errors,t.payload)?e:pi({},e,{errors:t.payload});case"SET_STATUS":return pi({},e,{status:t.payload});case"SET_ISSUBMITTING":return pi({},e,{isSubmitting:t.payload});case"SET_ISVALIDATING":return pi({},e,{isValidating:t.payload});case"SET_FIELD_VALUE":return pi({},e,{values:ku(e.values,t.payload.field,t.payload.value)});case"SET_FIELD_TOUCHED":return pi({},e,{touched:ku(e.touched,t.payload.field,t.payload.value)});case"SET_FIELD_ERROR":return pi({},e,{errors:ku(e.errors,t.payload.field,t.payload.value)});case"RESET_FORM":return pi({},e,t.payload);case"SET_FORMIK_STATE":return t.payload(e);case"SUBMIT_ATTEMPT":return pi({},e,{touched:qH(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":return pi({},e,{isSubmitting:!1});case"SUBMIT_SUCCESS":return pi({},e,{isSubmitting:!1});default:return e}}var qd={},_v={};function Yi(e){var t=e.validateOnChange,r=t===void 0?!0:t,n=e.validateOnBlur,i=n===void 0?!0:n,o=e.validateOnMount,s=o===void 0?!1:o,a=e.isInitialValid,c=e.enableReinitialize,l=c===void 0?!1:c,d=e.onSubmit,u=KH(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),p=pi({validateOnChange:r,validateOnBlur:i,validateOnMount:s,onSubmit:d},u),f=T.useRef(p.initialValues),m=T.useRef(p.initialErrors||qd),g=T.useRef(p.initialTouched||_v),y=T.useRef(p.initialStatus),v=T.useRef(!1),E=T.useRef({});T.useEffect(function(){return v.current=!0,function(){v.current=!1}},[]);var w=T.useState(0),S=w[1],A=T.useRef({values:Ev(p.initialValues),errors:Ev(p.initialErrors)||qd,touched:Ev(p.initialTouched)||_v,status:Ev(p.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),N=A.current,L=T.useCallback(function(ee){var Ae=A.current;A.current=cae(Ae,ee),Ae!==A.current&&S(function(Le){return Le+1})},[]),j=T.useCallback(function(ee,Ae){return new Promise(function(Le,We){var dt=p.validate(ee,Ae);dt==null?Le(qd):QT(dt)?dt.then(function(Gt){Le(Gt||qd)},function(Gt){We(Gt)}):Le(dt)})},[p.validate]),W=T.useCallback(function(ee,Ae){var Le=p.validationSchema,We=fa(Le)?Le(Ae):Le,dt=Ae&&We.validateAt?We.validateAt(Ae,ee):dae(ee,We);return new Promise(function(Gt,$r){dt.then(function(){Gt(qd)},function(fn){fn.name==="ValidationError"?Gt(lae(fn)):$r(fn)})})},[p.validationSchema]),V=T.useCallback(function(ee,Ae){return new Promise(function(Le){return Le(E.current[ee].validate(Ae))})},[]),Y=T.useCallback(function(ee){var Ae=Object.keys(E.current).filter(function(We){return fa(E.current[We].validate)}),Le=Ae.length>0?Ae.map(function(We){return V(We,Yo(ee,We))}):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(Le).then(function(We){return We.reduce(function(dt,Gt,$r){return Gt==="DO_NOT_DELETE_YOU_WILL_BE_FIRED"||Gt&&(dt=ku(dt,Ae[$r],Gt)),dt},{})})},[V]),Z=T.useCallback(function(ee){return Promise.all([Y(ee),p.validationSchema?W(ee):{},p.validate?j(ee):{}]).then(function(Ae){var Le=Ae[0],We=Ae[1],dt=Ae[2],Gt=rx.all([Le,We,dt],{arrayMerge:uae});return Gt})},[p.validate,p.validationSchema,Y,j,W]),te=Is(function(ee){return ee===void 0&&(ee=N.values),L({type:"SET_ISVALIDATING",payload:!0}),Z(ee).then(function(Ae){return v.current&&(L({type:"SET_ISVALIDATING",payload:!1}),L({type:"SET_ERRORS",payload:Ae})),Ae})});T.useEffect(function(){s&&v.current===!0&&iu(f.current,p.initialValues)&&te(f.current)},[s,te]);var H=T.useCallback(function(ee){var Ae=ee&&ee.values?ee.values:f.current,Le=ee&&ee.errors?ee.errors:m.current?m.current:p.initialErrors||{},We=ee&&ee.touched?ee.touched:g.current?g.current:p.initialTouched||{},dt=ee&&ee.status?ee.status:y.current?y.current:p.initialStatus;f.current=Ae,m.current=Le,g.current=We,y.current=dt;var Gt=function(){L({type:"RESET_FORM",payload:{isSubmitting:!!ee&&!!ee.isSubmitting,errors:Le,touched:We,status:dt,values:Ae,isValidating:!!ee&&!!ee.isValidating,submitCount:ee&&ee.submitCount&&typeof ee.submitCount=="number"?ee.submitCount:0}})};if(p.onReset){var $r=p.onReset(N.values,nt);QT($r)?$r.then(Gt):Gt()}else Gt()},[p.initialErrors,p.initialStatus,p.initialTouched,p.onReset]);T.useEffect(function(){v.current===!0&&!iu(f.current,p.initialValues)&&l&&(f.current=p.initialValues,H(),s&&te(f.current))},[l,p.initialValues,H,s,te]),T.useEffect(function(){l&&v.current===!0&&!iu(m.current,p.initialErrors)&&(m.current=p.initialErrors||qd,L({type:"SET_ERRORS",payload:p.initialErrors||qd}))},[l,p.initialErrors]),T.useEffect(function(){l&&v.current===!0&&!iu(g.current,p.initialTouched)&&(g.current=p.initialTouched||_v,L({type:"SET_TOUCHED",payload:p.initialTouched||_v}))},[l,p.initialTouched]),T.useEffect(function(){l&&v.current===!0&&!iu(y.current,p.initialStatus)&&(y.current=p.initialStatus,L({type:"SET_STATUS",payload:p.initialStatus}))},[l,p.initialStatus,p.initialTouched]);var $=Is(function(ee){if(E.current[ee]&&fa(E.current[ee].validate)){var Ae=Yo(N.values,ee),Le=E.current[ee].validate(Ae);return QT(Le)?(L({type:"SET_ISVALIDATING",payload:!0}),Le.then(function(We){return We}).then(function(We){L({type:"SET_FIELD_ERROR",payload:{field:ee,value:We}}),L({type:"SET_ISVALIDATING",payload:!1})})):(L({type:"SET_FIELD_ERROR",payload:{field:ee,value:Le}}),Promise.resolve(Le))}else if(p.validationSchema)return L({type:"SET_ISVALIDATING",payload:!0}),W(N.values,ee).then(function(We){return We}).then(function(We){L({type:"SET_FIELD_ERROR",payload:{field:ee,value:Yo(We,ee)}}),L({type:"SET_ISVALIDATING",payload:!1})});return Promise.resolve()}),K=T.useCallback(function(ee,Ae){var Le=Ae.validate;E.current[ee]={validate:Le}},[]),x=T.useCallback(function(ee){delete E.current[ee]},[]),O=Is(function(ee,Ae){L({type:"SET_TOUCHED",payload:ee});var Le=Ae===void 0?i:Ae;return Le?te(N.values):Promise.resolve()}),F=T.useCallback(function(ee){L({type:"SET_ERRORS",payload:ee})},[]),P=Is(function(ee,Ae){var Le=fa(ee)?ee(N.values):ee;L({type:"SET_VALUES",payload:Le});var We=Ae===void 0?r:Ae;return We?te(Le):Promise.resolve()}),_=T.useCallback(function(ee,Ae){L({type:"SET_FIELD_ERROR",payload:{field:ee,value:Ae}})},[]),R=Is(function(ee,Ae,Le){L({type:"SET_FIELD_VALUE",payload:{field:ee,value:Ae}});var We=Le===void 0?r:Le;return We?te(ku(N.values,ee,Ae)):Promise.resolve()}),k=T.useCallback(function(ee,Ae){var Le=Ae,We=ee,dt;if(!JT(ee)){ee.persist&&ee.persist();var Gt=ee.target?ee.target:ee.currentTarget,$r=Gt.type,fn=Gt.name,$o=Gt.id,Va=Gt.value,Ji=Gt.checked,Ac=Gt.outerHTML,Ci=Gt.options,ws=Gt.multiple;Le=Ae||fn||$o,We=/number|range/.test($r)?(dt=parseFloat(Va),isNaN(dt)?"":dt):/checkbox/.test($r)?pae(Yo(N.values,Le),Ji,Va):Ci&&ws?hae(Ci):Va}Le&&R(Le,We)},[R,N.values]),z=Is(function(ee){if(JT(ee))return function(Ae){return k(Ae,ee)};k(ee)}),U=Is(function(ee,Ae,Le){Ae===void 0&&(Ae=!0),L({type:"SET_FIELD_TOUCHED",payload:{field:ee,value:Ae}});var We=Le===void 0?i:Le;return We?te(N.values):Promise.resolve()}),q=T.useCallback(function(ee,Ae){ee.persist&&ee.persist();var Le=ee.target,We=Le.name,dt=Le.id,Gt=Le.outerHTML,$r=Ae||We||dt;U($r,!0)},[U]),ie=Is(function(ee){if(JT(ee))return function(Ae){return q(Ae,ee)};q(ee)}),ue=T.useCallback(function(ee){fa(ee)?L({type:"SET_FORMIK_STATE",payload:ee}):L({type:"SET_FORMIK_STATE",payload:function(){return ee}})},[]),me=T.useCallback(function(ee){L({type:"SET_STATUS",payload:ee})},[]),De=T.useCallback(function(ee){L({type:"SET_ISSUBMITTING",payload:ee})},[]),He=Is(function(){return L({type:"SUBMIT_ATTEMPT"}),te().then(function(ee){var Ae=ee instanceof Error,Le=!Ae&&Object.keys(ee).length===0;if(Le){var We;try{if(We=Rt(),We===void 0)return}catch(dt){throw dt}return Promise.resolve(We).then(function(dt){return v.current&&L({type:"SUBMIT_SUCCESS"}),dt}).catch(function(dt){if(v.current)throw L({type:"SUBMIT_FAILURE"}),dt})}else if(v.current&&(L({type:"SUBMIT_FAILURE"}),Ae))throw ee})}),Pe=Is(function(ee){ee&&ee.preventDefault&&fa(ee.preventDefault)&&ee.preventDefault(),ee&&ee.stopPropagation&&fa(ee.stopPropagation)&&ee.stopPropagation(),He().catch(function(Ae){console.warn("Warning: An unhandled error was caught from submitForm()",Ae)})}),nt={resetForm:H,validateForm:te,validateField:$,setErrors:F,setFieldError:_,setFieldTouched:U,setFieldValue:R,setStatus:me,setSubmitting:De,setTouched:O,setValues:P,setFormikState:ue,submitForm:He},Rt=Is(function(){return d(N.values,nt)}),Ye=Is(function(ee){ee&&ee.preventDefault&&fa(ee.preventDefault)&&ee.preventDefault(),ee&&ee.stopPropagation&&fa(ee.stopPropagation)&&ee.stopPropagation(),H()}),_t=T.useCallback(function(ee){return{value:Yo(N.values,ee),error:Yo(N.errors,ee),touched:!!Yo(N.touched,ee),initialValue:Yo(f.current,ee),initialTouched:!!Yo(g.current,ee),initialError:Yo(m.current,ee)}},[N.errors,N.touched,N.values]),Te=T.useCallback(function(ee){return{setValue:function(Le,We){return R(ee,Le,We)},setTouched:function(Le,We){return U(ee,Le,We)},setError:function(Le){return _(ee,Le)}}},[R,U,_]),Ze=T.useCallback(function(ee){var Ae=Ww(ee),Le=Ae?ee.name:ee,We=Yo(N.values,Le),dt={name:Le,value:We,onChange:z,onBlur:ie};if(Ae){var Gt=ee.type,$r=ee.value,fn=ee.as,$o=ee.multiple;Gt==="checkbox"?$r===void 0?dt.checked=!!We:(dt.checked=!!(Array.isArray(We)&&~We.indexOf($r)),dt.value=$r):Gt==="radio"?(dt.checked=We===$r,dt.value=$r):fn==="select"&&$o&&(dt.value=dt.value||[],dt.multiple=!0)}return dt},[ie,z,N.values]),Ve=T.useMemo(function(){return!iu(f.current,N.values)},[f.current,N.values]),Ke=T.useMemo(function(){return typeof a<"u"?Ve?N.errors&&Object.keys(N.errors).length===0:a!==!1&&fa(a)?a(p):a:N.errors&&Object.keys(N.errors).length===0},[a,Ve,N.errors,p]),Ge=pi({},N,{initialValues:f.current,initialErrors:m.current,initialTouched:g.current,initialStatus:y.current,handleBlur:ie,handleChange:z,handleReset:Ye,handleSubmit:Pe,resetForm:H,setErrors:F,setFormikState:ue,setFieldTouched:U,setFieldValue:R,setFieldError:_,setStatus:me,setSubmitting:De,setTouched:O,setValues:P,submitForm:He,validateForm:te,validateField:$,isValid:Ke,dirty:Ve,unregisterField:x,registerField:K,getFieldProps:Ze,getFieldMeta:_t,getFieldHelpers:Te,validateOnBlur:i,validateOnChange:r,validateOnMount:s});return Ge}function lae(e){var t={};if(e.inner){if(e.inner.length===0)return ku(t,e.path,e.message);for(var i=e.inner,r=Array.isArray(i),n=0,i=r?i:i[Symbol.iterator]();;){var o;if(r){if(n>=i.length)break;o=i[n++]}else{if(n=i.next(),n.done)break;o=n.value}var s=o;Yo(t,s.path)||(t=ku(t,s.path,s.message))}}return t}function dae(e,t,r,n){r===void 0&&(r=!1);var i=cx(e);return t[r?"validateSync":"validate"](i,{abortEarly:!1,context:i})}function cx(e){var t=Array.isArray(e)?[]:{};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=String(r);Array.isArray(e[n])===!0?t[n]=e[n].map(function(i){return Array.isArray(i)===!0||jL(i)?cx(i):i!==""?i:void 0}):jL(e[n])?t[n]=cx(e[n]):t[n]=e[n]!==""?e[n]:void 0}return t}function uae(e,t,r){var n=e.slice();return t.forEach(function(o,s){if(typeof n[s]>"u"){var a=r.clone!==!1,c=a&&r.isMergeableObject(o);n[s]=c?rx(Array.isArray(o)?[]:{},o,r):o}else r.isMergeableObject(o)?n[s]=rx(e[s],o,r):e.indexOf(o)===-1&&n.push(o)}),n}function hae(e){return Array.from(e).filter(function(t){return t.selected}).map(function(t){return t.value})}function pae(e,t,r){if(typeof e=="boolean")return!!t;var n=[],i=!1,o=-1;if(Array.isArray(e))n=e,o=e.indexOf(r),i=o>=0;else if(!r||r=="true"||r=="false")return!!t;return t&&r&&!i?n.concat(r):i?n.slice(0,o).concat(n.slice(o+1)):n}var fae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?T.useLayoutEffect:T.useEffect;function Is(e){var t=T.useRef(e);return fae(function(){t.current=e}),T.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current.apply(void 0,n)},[])}var mae=T.forwardRef(function(e,t){var r=e.action,n=KH(e,["action"]),i=r??"#",o=sae(),s=o.handleReset,a=o.handleSubmit;return T.createElement("form",pi({onSubmit:a,ref:t,onReset:s,action:i},n))});mae.displayName="Form";function fh(e){this._maxSize=e,this.clear()}fh.prototype.clear=function(){this._size=0,this._values=Object.create(null)};fh.prototype.get=function(e){return this._values[e]};fh.prototype.set=function(e,t){return this._size>=this._maxSize&&this.clear(),e in this._values||this._size++,this._values[e]=t};var gae=/[^.^\]^[]+|(?=\[\]|\.\.)/g,YH=/^\d+$/,yae=/^\d/,vae=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,Eae=/^\s*(['"]?)(.*?)(\1)\s*$/,vk=512,dM=new fh(vk),uM=new fh(vk),hM=new fh(vk),Pu={Cache:fh,split:lx,normalizePath:ZT,setter:function(e){var t=ZT(e);return uM.get(e)||uM.set(e,function(n,i){for(var o=0,s=t.length,a=n;o<s-1;){var c=t[o];if(c==="__proto__"||c==="constructor"||c==="prototype")return n;a=a[t[o++]]}a[t[o]]=i})},getter:function(e,t){var r=ZT(e);return hM.get(e)||hM.set(e,function(i){for(var o=0,s=r.length;o<s;)if(i!=null||!t)i=i[r[o++]];else return;return i})},join:function(e){return e.reduce(function(t,r){return t+(Ek(r)||YH.test(r)?"["+r+"]":(t?".":"")+r)},"")},forEach:function(e,t,r){_ae(Array.isArray(e)?e:lx(e),t,r)}};function ZT(e){return dM.get(e)||dM.set(e,lx(e).map(function(t){return t.replace(Eae,"$2")}))}function lx(e){return e.match(gae)||[""]}function _ae(e,t,r){var n=e.length,i,o,s,a;for(o=0;o<n;o++)i=e[o],i&&(Sae(i)&&(i='"'+i+'"'),a=Ek(i),s=!a&&/^\d+$/.test(i),t.call(r,i,a,s,o,e))}function Ek(e){return typeof e=="string"&&e&&["'",'"'].indexOf(e.charAt(0))!==-1}function bae(e){return e.match(yae)&&!e.match(YH)}function wae(e){return vae.test(e)}function Sae(e){return!Ek(e)&&(bae(e)||wae(e))}const Tae=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,Gw=e=>e.match(Tae)||[],zw=e=>e[0].toUpperCase()+e.slice(1),_k=(e,t)=>Gw(e).join(t).toLowerCase(),XH=e=>Gw(e).reduce((t,r)=>`${t}${t?r[0].toUpperCase()+r.slice(1).toLowerCase():r.toLowerCase()}`,""),Cae=e=>zw(XH(e)),Rae=e=>_k(e,"_"),Iae=e=>_k(e,"-"),Aae=e=>zw(_k(e," ")),xae=e=>Gw(e).map(zw).join(" ");var eC={words:Gw,upperFirst:zw,camelCase:XH,pascalCase:Cae,snakeCase:Rae,kebabCase:Iae,sentenceCase:Aae,titleCase:xae},bk={exports:{}};bk.exports=function(e){return JH(Oae(e),e)};bk.exports.array=JH;function JH(e,t){var r=e.length,n=new Array(r),i={},o=r,s=Nae(t),a=kae(e);for(t.forEach(function(l){if(!a.has(l[0])||!a.has(l[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});o--;)i[o]||c(e[o],o,new Set);return n;function c(l,d,u){if(u.has(l)){var p;try{p=", node was:"+JSON.stringify(l)}catch{p=""}throw new Error("Cyclic dependency"+p)}if(!a.has(l))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(l));if(!i[d]){i[d]=!0;var f=s.get(l)||new Set;if(f=Array.from(f),d=f.length){u.add(l);do{var m=f[--d];c(m,a.get(m),u)}while(d);u.delete(l)}n[--r]=l}}}function Oae(e){for(var t=new Set,r=0,n=e.length;r<n;r++){var i=e[r];t.add(i[0]),t.add(i[1])}return Array.from(t)}function Nae(e){for(var t=new Map,r=0,n=e.length;r<n;r++){var i=e[r];t.has(i[0])||t.set(i[0],new Set),t.has(i[1])||t.set(i[1],new Set),t.get(i[0]).add(i[1])}return t}function kae(e){for(var t=new Map,r=0,n=e.length;r<n;r++)t.set(e[r],r);return t}var Pae=bk.exports;const Dae=Pa(Pae),Lae=Object.prototype.toString,Mae=Error.prototype.toString,jae=RegExp.prototype.toString,Uae=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",Fae=/^Symbol\((.*)\)(.*)$/;function Vae(e){return e!=+e?"NaN":e===0&&1/e<0?"-0":""+e}function pM(e,t=!1){if(e==null||e===!0||e===!1)return""+e;const r=typeof e;if(r==="number")return Vae(e);if(r==="string")return t?`"${e}"`:e;if(r==="function")return"[Function "+(e.name||"anonymous")+"]";if(r==="symbol")return Uae.call(e).replace(Fae,"Symbol($1)");const n=Lae.call(e).slice(8,-1);return n==="Date"?isNaN(e.getTime())?""+e:e.toISOString(e):n==="Error"||e instanceof Error?"["+Mae.call(e)+"]":n==="RegExp"?jae.call(e):null}function el(e,t){let r=pM(e,t);return r!==null?r:JSON.stringify(e,function(n,i){let o=pM(this[n],t);return o!==null?o:i},2)}function QH(e){return e==null?[]:[].concat(e)}let ZH,eW,tW,Bae=/\$\{\s*(\w+)\s*\}/g;ZH=Symbol.toStringTag;class fM{constructor(t,r,n,i){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[ZH]="Error",this.name="ValidationError",this.value=r,this.path=n,this.type=i,this.errors=[],this.inner=[],QH(t).forEach(o=>{if(To.isError(o)){this.errors.push(...o.errors);const s=o.inner.length?o.inner:[o];this.inner.push(...s)}else this.errors.push(o)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}eW=Symbol.hasInstance;tW=Symbol.toStringTag;class To extends Error{static formatError(t,r){const n=r.label||r.path||"this";return r=Object.assign({},r,{path:n,originalPath:r.path}),typeof t=="string"?t.replace(Bae,(i,o)=>el(r[o])):typeof t=="function"?t(r):t}static isError(t){return t&&t.name==="ValidationError"}constructor(t,r,n,i,o){const s=new fM(t,r,n,i);if(o)return s;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[tW]="Error",this.name=s.name,this.message=s.message,this.type=s.type,this.value=s.value,this.path=s.path,this.errors=s.errors,this.inner=s.inner,Error.captureStackTrace&&Error.captureStackTrace(this,To)}static[eW](t){return fM[Symbol.hasInstance](t)||super[Symbol.hasInstance](t)}}let tc={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:e,type:t,value:r,originalValue:n})=>{const i=n!=null&&n!==r?` (cast from the value \`${el(n,!0)}\`).`:".";return t!=="mixed"?`${e} must be a \`${t}\` type, but the final value was: \`${el(r,!0)}\``+i:`${e} must match the configured type. The validated value was: \`${el(r,!0)}\``+i}},Eo={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},$ae={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},dx={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},ux={isValue:"${path} field must be ${value}"},BE={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},$E={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},Hae={notType:e=>{const{path:t,value:r,spec:n}=e,i=n.types.length;if(Array.isArray(r)){if(r.length<i)return`${t} tuple value has too few items, expected a length of ${i} but got ${r.length} for value: \`${el(r,!0)}\``;if(r.length>i)return`${t} tuple value has too many items, expected a length of ${i} but got ${r.length} for value: \`${el(r,!0)}\``}return To.formatError(tc.notType,e)}};Object.assign(Object.create(null),{mixed:tc,string:Eo,number:$ae,date:dx,object:BE,array:$E,boolean:ux,tuple:Hae});const Kw=e=>e&&e.__isYupSchema__;class J_{static fromOptions(t,r){if(!r.then&&!r.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:n,then:i,otherwise:o}=r,s=typeof n=="function"?n:(...a)=>a.every(c=>c===n);return new J_(t,(a,c)=>{var l;let d=s(...a)?i:o;return(l=d==null?void 0:d(c))!=null?l:c})}constructor(t,r){this.fn=void 0,this.refs=t,this.refs=t,this.fn=r}resolve(t,r){let n=this.refs.map(o=>o.getValue(r==null?void 0:r.value,r==null?void 0:r.parent,r==null?void 0:r.context)),i=this.fn(n,t,r);if(i===void 0||i===t)return t;if(!Kw(i))throw new TypeError("conditions must return a schema object");return i.resolve(r)}}const bv={context:"$",value:"."};function rW(e,t){return new Md(e,t)}class Md{constructor(t,r={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof t!="string")throw new TypeError("ref must be a string, got: "+t);if(this.key=t.trim(),t==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===bv.context,this.isValue=this.key[0]===bv.value,this.isSibling=!this.isContext&&!this.isValue;let n=this.isContext?bv.context:this.isValue?bv.value:"";this.path=this.key.slice(n.length),this.getter=this.path&&Pu.getter(this.path,!0),this.map=r.map}getValue(t,r,n){let i=this.isContext?n:this.isValue?t:r;return this.getter&&(i=this.getter(i||{})),this.map&&(i=this.map(i)),i}cast(t,r){return this.getValue(t,r==null?void 0:r.parent,r==null?void 0:r.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(t){return t&&t.__isYupRef}}Md.prototype.__isYupRef=!0;const Jc=e=>e==null;function Lh(e){function t({value:r,path:n="",options:i,originalValue:o,schema:s},a,c){const{name:l,test:d,params:u,message:p,skipAbsent:f}=e;let{parent:m,context:g,abortEarly:y=s.spec.abortEarly,disableStackTrace:v=s.spec.disableStackTrace}=i;function E(Y){return Md.isRef(Y)?Y.getValue(r,m,g):Y}function w(Y={}){const Z=Object.assign({value:r,originalValue:o,label:s.spec.label,path:Y.path||n,spec:s.spec,disableStackTrace:Y.disableStackTrace||v},u,Y.params);for(const H of Object.keys(Z))Z[H]=E(Z[H]);const te=new To(To.formatError(Y.message||p,Z),r,Z.path,Y.type||l,Z.disableStackTrace);return te.params=Z,te}const S=y?a:c;let A={path:n,parent:m,type:l,from:i.from,createError:w,resolve:E,options:i,originalValue:o,schema:s};const N=Y=>{To.isError(Y)?S(Y):Y?c(null):S(w())},L=Y=>{To.isError(Y)?S(Y):a(Y)};if(f&&Jc(r))return N(!0);let W;try{var V;if(W=d.call(A,r,A),typeof((V=W)==null?void 0:V.then)=="function"){if(i.sync)throw new Error(`Validation test of type: "${A.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(W).then(N,L)}}catch(Y){L(Y);return}N(W)}return t.OPTIONS=e,t}function Wae(e,t,r,n=r){let i,o,s;return t?(Pu.forEach(t,(a,c,l)=>{let d=c?a.slice(1,a.length-1):a;e=e.resolve({context:n,parent:i,value:r});let u=e.type==="tuple",p=l?parseInt(d,10):0;if(e.innerType||u){if(u&&!l)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${s}" must contain an index to the tuple element, e.g. "${s}[0]"`);if(r&&p>=r.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${a}, in the path: ${t}. because there is no value at that index. `);i=r,r=r&&r[p],e=u?e.spec.types[p]:e.innerType}if(!l){if(!e.fields||!e.fields[d])throw new Error(`The schema does not contain the path: ${t}. (failed at: ${s} which is a type: "${e.type}")`);i=r,r=r&&r[d],e=e.fields[d]}o=d,s=c?"["+a+"]":"."+a}),{schema:e,parent:i,parentPath:o}):{parent:i,parentPath:t,schema:e}}class Q_ extends Set{describe(){const t=[];for(const r of this.values())t.push(Md.isRef(r)?r.describe():r);return t}resolveAll(t){let r=[];for(const n of this.values())r.push(t(n));return r}clone(){return new Q_(this.values())}merge(t,r){const n=this.clone();return t.forEach(i=>n.add(i)),r.forEach(i=>n.delete(i)),n}}function vp(e,t=new Map){if(Kw(e)||!e||typeof e!="object")return e;if(t.has(e))return t.get(e);let r;if(e instanceof Date)r=new Date(e.getTime()),t.set(e,r);else if(e instanceof RegExp)r=new RegExp(e),t.set(e,r);else if(Array.isArray(e)){r=new Array(e.length),t.set(e,r);for(let n=0;n<e.length;n++)r[n]=vp(e[n],t)}else if(e instanceof Map){r=new Map,t.set(e,r);for(const[n,i]of e.entries())r.set(n,vp(i,t))}else if(e instanceof Set){r=new Set,t.set(e,r);for(const n of e)r.add(vp(n,t))}else if(e instanceof Object){r={},t.set(e,r);for(const[n,i]of Object.entries(e))r[n]=vp(i,t)}else throw Error(`Unable to clone ${e}`);return r}class us{constructor(t){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Q_,this._blacklist=new Q_,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(tc.notType)}),this.type=t.type,this._typeCheck=t.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},t==null?void 0:t.spec),this.withMutation(r=>{r.nonNullable()})}get _type(){return this.type}clone(t){if(this._mutate)return t&&Object.assign(this.spec,t),this;const r=Object.create(Object.getPrototypeOf(this));return r.type=this.type,r._typeCheck=this._typeCheck,r._whitelist=this._whitelist.clone(),r._blacklist=this._blacklist.clone(),r.internalTests=Object.assign({},this.internalTests),r.exclusiveTests=Object.assign({},this.exclusiveTests),r.deps=[...this.deps],r.conditions=[...this.conditions],r.tests=[...this.tests],r.transforms=[...this.transforms],r.spec=vp(Object.assign({},this.spec,t)),r}label(t){let r=this.clone();return r.spec.label=t,r}meta(...t){if(t.length===0)return this.spec.meta;let r=this.clone();return r.spec.meta=Object.assign(r.spec.meta||{},t[0]),r}withMutation(t){let r=this._mutate;this._mutate=!0;let n=t(this);return this._mutate=r,n}concat(t){if(!t||t===this)return this;if(t.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${t.type}`);let r=this,n=t.clone();const i=Object.assign({},r.spec,n.spec);return n.spec=i,n.internalTests=Object.assign({},r.internalTests,n.internalTests),n._whitelist=r._whitelist.merge(t._whitelist,t._blacklist),n._blacklist=r._blacklist.merge(t._blacklist,t._whitelist),n.tests=r.tests,n.exclusiveTests=r.exclusiveTests,n.withMutation(o=>{t.tests.forEach(s=>{o.test(s.OPTIONS)})}),n.transforms=[...r.transforms,...n.transforms],n}isType(t){return t==null?!!(this.spec.nullable&&t===null||this.spec.optional&&t===void 0):this._typeCheck(t)}resolve(t){let r=this;if(r.conditions.length){let n=r.conditions;r=r.clone(),r.conditions=[],r=n.reduce((i,o)=>o.resolve(i,t),r),r=r.resolve(t)}return r}resolveOptions(t){var r,n,i,o;return Object.assign({},t,{from:t.from||[],strict:(r=t.strict)!=null?r:this.spec.strict,abortEarly:(n=t.abortEarly)!=null?n:this.spec.abortEarly,recursive:(i=t.recursive)!=null?i:this.spec.recursive,disableStackTrace:(o=t.disableStackTrace)!=null?o:this.spec.disableStackTrace})}cast(t,r={}){let n=this.resolve(Object.assign({value:t},r)),i=r.assert==="ignore-optionality",o=n._cast(t,r);if(r.assert!==!1&&!n.isType(o)){if(i&&Jc(o))return o;let s=el(t),a=el(o);throw new TypeError(`The value of ${r.path||"field"} could not be cast to a value that satisfies the schema type: "${n.type}". 

attempted value: ${s} 
`+(a!==s?`result of cast: ${a}`:""))}return o}_cast(t,r){let n=t===void 0?t:this.transforms.reduce((i,o)=>o.call(this,i,t,this),t);return n===void 0&&(n=this.getDefault(r)),n}_validate(t,r={},n,i){let{path:o,originalValue:s=t,strict:a=this.spec.strict}=r,c=t;a||(c=this._cast(c,Object.assign({assert:!1},r)));let l=[];for(let d of Object.values(this.internalTests))d&&l.push(d);this.runTests({path:o,value:c,originalValue:s,options:r,tests:l},n,d=>{if(d.length)return i(d,c);this.runTests({path:o,value:c,originalValue:s,options:r,tests:this.tests},n,i)})}runTests(t,r,n){let i=!1,{tests:o,value:s,originalValue:a,path:c,options:l}=t,d=g=>{i||(i=!0,r(g,s))},u=g=>{i||(i=!0,n(g,s))},p=o.length,f=[];if(!p)return u([]);let m={value:s,originalValue:a,path:c,options:l,schema:this};for(let g=0;g<o.length;g++){const y=o[g];y(m,d,function(E){E&&(Array.isArray(E)?f.push(...E):f.push(E)),--p<=0&&u(f)})}}asNestedTest({key:t,index:r,parent:n,parentPath:i,originalParent:o,options:s}){const a=t??r;if(a==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof a=="number";let l=n[a];const d=Object.assign({},s,{strict:!0,parent:n,value:l,originalValue:o[a],key:void 0,[c?"index":"key"]:a,path:c||a.includes(".")?`${i||""}[${c?a:`"${a}"`}]`:(i?`${i}.`:"")+t});return(u,p,f)=>this.resolve(d)._validate(l,d,p,f)}validate(t,r){var n;let i=this.resolve(Object.assign({},r,{value:t})),o=(n=r==null?void 0:r.disableStackTrace)!=null?n:i.spec.disableStackTrace;return new Promise((s,a)=>i._validate(t,r,(c,l)=>{To.isError(c)&&(c.value=l),a(c)},(c,l)=>{c.length?a(new To(c,l,void 0,void 0,o)):s(l)}))}validateSync(t,r){var n;let i=this.resolve(Object.assign({},r,{value:t})),o,s=(n=r==null?void 0:r.disableStackTrace)!=null?n:i.spec.disableStackTrace;return i._validate(t,Object.assign({},r,{sync:!0}),(a,c)=>{throw To.isError(a)&&(a.value=c),a},(a,c)=>{if(a.length)throw new To(a,t,void 0,void 0,s);o=c}),o}isValid(t,r){return this.validate(t,r).then(()=>!0,n=>{if(To.isError(n))return!1;throw n})}isValidSync(t,r){try{return this.validateSync(t,r),!0}catch(n){if(To.isError(n))return!1;throw n}}_getDefault(t){let r=this.spec.default;return r==null?r:typeof r=="function"?r.call(this,t):vp(r)}getDefault(t){return this.resolve(t||{})._getDefault(t)}default(t){return arguments.length===0?this._getDefault():this.clone({default:t})}strict(t=!0){return this.clone({strict:t})}nullability(t,r){const n=this.clone({nullable:t});return n.internalTests.nullable=Lh({message:r,name:"nullable",test(i){return i===null?this.schema.spec.nullable:!0}}),n}optionality(t,r){const n=this.clone({optional:t});return n.internalTests.optionality=Lh({message:r,name:"optionality",test(i){return i===void 0?this.schema.spec.optional:!0}}),n}optional(){return this.optionality(!0)}defined(t=tc.defined){return this.optionality(!1,t)}nullable(){return this.nullability(!0)}nonNullable(t=tc.notNull){return this.nullability(!1,t)}required(t=tc.required){return this.clone().withMutation(r=>r.nonNullable(t).defined(t))}notRequired(){return this.clone().withMutation(t=>t.nullable().optional())}transform(t){let r=this.clone();return r.transforms.push(t),r}test(...t){let r;if(t.length===1?typeof t[0]=="function"?r={test:t[0]}:r=t[0]:t.length===2?r={name:t[0],test:t[1]}:r={name:t[0],message:t[1],test:t[2]},r.message===void 0&&(r.message=tc.default),typeof r.test!="function")throw new TypeError("`test` is a required parameters");let n=this.clone(),i=Lh(r),o=r.exclusive||r.name&&n.exclusiveTests[r.name]===!0;if(r.exclusive&&!r.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return r.name&&(n.exclusiveTests[r.name]=!!r.exclusive),n.tests=n.tests.filter(s=>!(s.OPTIONS.name===r.name&&(o||s.OPTIONS.test===i.OPTIONS.test))),n.tests.push(i),n}when(t,r){!Array.isArray(t)&&typeof t!="string"&&(r=t,t=".");let n=this.clone(),i=QH(t).map(o=>new Md(o));return i.forEach(o=>{o.isSibling&&n.deps.push(o.key)}),n.conditions.push(typeof r=="function"?new J_(i,r):J_.fromOptions(i,r)),n}typeError(t){let r=this.clone();return r.internalTests.typeError=Lh({message:t,name:"typeError",skipAbsent:!0,test(n){return this.schema._typeCheck(n)?!0:this.createError({params:{type:this.schema.type}})}}),r}oneOf(t,r=tc.oneOf){let n=this.clone();return t.forEach(i=>{n._whitelist.add(i),n._blacklist.delete(i)}),n.internalTests.whiteList=Lh({message:r,name:"oneOf",skipAbsent:!0,test(i){let o=this.schema._whitelist,s=o.resolveAll(this.resolve);return s.includes(i)?!0:this.createError({params:{values:Array.from(o).join(", "),resolved:s}})}}),n}notOneOf(t,r=tc.notOneOf){let n=this.clone();return t.forEach(i=>{n._blacklist.add(i),n._whitelist.delete(i)}),n.internalTests.blacklist=Lh({message:r,name:"notOneOf",test(i){let o=this.schema._blacklist,s=o.resolveAll(this.resolve);return s.includes(i)?this.createError({params:{values:Array.from(o).join(", "),resolved:s}}):!0}}),n}strip(t=!0){let r=this.clone();return r.spec.strip=t,r}describe(t){const r=(t?this.resolve(t):this).clone(),{label:n,meta:i,optional:o,nullable:s}=r.spec;return{meta:i,label:n,optional:o,nullable:s,default:r.getDefault(t),type:r.type,oneOf:r._whitelist.describe(),notOneOf:r._blacklist.describe(),tests:r.tests.map(c=>({name:c.OPTIONS.name,params:c.OPTIONS.params})).filter((c,l,d)=>d.findIndex(u=>u.name===c.name)===l)}}}us.prototype.__isYupSchema__=!0;for(const e of["validate","validateSync"])us.prototype[`${e}At`]=function(t,r,n={}){const{parent:i,parentPath:o,schema:s}=Wae(this,t,r,n.context);return s[e](i&&i[o],Object.assign({},n,{parent:i,path:t}))};for(const e of["equals","is"])us.prototype[e]=us.prototype.oneOf;for(const e of["not","nope"])us.prototype[e]=us.prototype.notOneOf;const Gae=()=>!0;function nW(e){return new iW(e)}class iW extends us{constructor(t){super(typeof t=="function"?{type:"mixed",check:t}:Object.assign({type:"mixed",check:Gae},t))}}nW.prototype=iW.prototype;function hx(){return new oW}class oW extends us{constructor(){super({type:"boolean",check(t){return t instanceof Boolean&&(t=t.valueOf()),typeof t=="boolean"}}),this.withMutation(()=>{this.transform((t,r,n)=>{if(n.spec.coerce&&!n.isType(t)){if(/^(true|1)$/i.test(String(t)))return!0;if(/^(false|0)$/i.test(String(t)))return!1}return t})})}isTrue(t=ux.isValue){return this.test({message:t,name:"is-value",exclusive:!0,params:{value:"true"},test(r){return Jc(r)||r===!0}})}isFalse(t=ux.isValue){return this.test({message:t,name:"is-value",exclusive:!0,params:{value:"false"},test(r){return Jc(r)||r===!1}})}default(t){return super.default(t)}defined(t){return super.defined(t)}optional(){return super.optional()}required(t){return super.required(t)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(t){return super.nonNullable(t)}strip(t){return super.strip(t)}}hx.prototype=oW.prototype;const zae=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function Kae(e){const t=px(e);if(!t)return Date.parse?Date.parse(e):Number.NaN;if(t.z===void 0&&t.plusMinus===void 0)return new Date(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond).valueOf();let r=0;return t.z!=="Z"&&t.plusMinus!==void 0&&(r=t.hourOffset*60+t.minuteOffset,t.plusMinus==="+"&&(r=0-r)),Date.UTC(t.year,t.month,t.day,t.hour,t.minute+r,t.second,t.millisecond)}function px(e){var t,r;const n=zae.exec(e);return n?{year:Nc(n[1]),month:Nc(n[2],1)-1,day:Nc(n[3],1),hour:Nc(n[4]),minute:Nc(n[5]),second:Nc(n[6]),millisecond:n[7]?Nc(n[7].substring(0,3)):0,precision:(t=(r=n[7])==null?void 0:r.length)!=null?t:void 0,z:n[8]||void 0,plusMinus:n[9]||void 0,hourOffset:Nc(n[10]),minuteOffset:Nc(n[11])}:null}function Nc(e,t=0){return Number(e)||t}let qae=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Yae=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,Xae=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Jae="^\\d{4}-\\d{2}-\\d{2}",Qae="\\d{2}:\\d{2}:\\d{2}",Zae="(([+-]\\d{2}(:?\\d{2})?)|Z)",ece=new RegExp(`${Jae}T${Qae}(\\.\\d+)?${Zae}$`),tce=e=>Jc(e)||e===e.trim(),rce={}.toString();function kt(){return new sW}class sW extends us{constructor(){super({type:"string",check(t){return t instanceof String&&(t=t.valueOf()),typeof t=="string"}}),this.withMutation(()=>{this.transform((t,r,n)=>{if(!n.spec.coerce||n.isType(t)||Array.isArray(t))return t;const i=t!=null&&t.toString?t.toString():t;return i===rce?t:i})})}required(t){return super.required(t).withMutation(r=>r.test({message:t||tc.required,name:"required",skipAbsent:!0,test:n=>!!n.length}))}notRequired(){return super.notRequired().withMutation(t=>(t.tests=t.tests.filter(r=>r.OPTIONS.name!=="required"),t))}length(t,r=Eo.length){return this.test({message:r,name:"length",exclusive:!0,params:{length:t},skipAbsent:!0,test(n){return n.length===this.resolve(t)}})}min(t,r=Eo.min){return this.test({message:r,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(n){return n.length>=this.resolve(t)}})}max(t,r=Eo.max){return this.test({name:"max",exclusive:!0,message:r,params:{max:t},skipAbsent:!0,test(n){return n.length<=this.resolve(t)}})}matches(t,r){let n=!1,i,o;return r&&(typeof r=="object"?{excludeEmptyString:n=!1,message:i,name:o}=r:i=r),this.test({name:o||"matches",message:i||Eo.matches,params:{regex:t},skipAbsent:!0,test:s=>s===""&&n||s.search(t)!==-1})}email(t=Eo.email){return this.matches(qae,{name:"email",message:t,excludeEmptyString:!0})}url(t=Eo.url){return this.matches(Yae,{name:"url",message:t,excludeEmptyString:!0})}uuid(t=Eo.uuid){return this.matches(Xae,{name:"uuid",message:t,excludeEmptyString:!1})}datetime(t){let r="",n,i;return t&&(typeof t=="object"?{message:r="",allowOffset:n=!1,precision:i=void 0}=t:r=t),this.matches(ece,{name:"datetime",message:r||Eo.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:r||Eo.datetime_offset,params:{allowOffset:n},skipAbsent:!0,test:o=>{if(!o||n)return!0;const s=px(o);return s?!!s.z:!1}}).test({name:"datetime_precision",message:r||Eo.datetime_precision,params:{precision:i},skipAbsent:!0,test:o=>{if(!o||i==null)return!0;const s=px(o);return s?s.precision===i:!1}})}ensure(){return this.default("").transform(t=>t===null?"":t)}trim(t=Eo.trim){return this.transform(r=>r!=null?r.trim():r).test({message:t,name:"trim",test:tce})}lowercase(t=Eo.lowercase){return this.transform(r=>Jc(r)?r:r.toLowerCase()).test({message:t,name:"string_case",exclusive:!0,skipAbsent:!0,test:r=>Jc(r)||r===r.toLowerCase()})}uppercase(t=Eo.uppercase){return this.transform(r=>Jc(r)?r:r.toUpperCase()).test({message:t,name:"string_case",exclusive:!0,skipAbsent:!0,test:r=>Jc(r)||r===r.toUpperCase()})}}kt.prototype=sW.prototype;let nce=new Date(""),ice=e=>Object.prototype.toString.call(e)==="[object Date]";class qw extends us{constructor(){super({type:"date",check(t){return ice(t)&&!isNaN(t.getTime())}}),this.withMutation(()=>{this.transform((t,r,n)=>!n.spec.coerce||n.isType(t)||t===null?t:(t=Kae(t),isNaN(t)?qw.INVALID_DATE:new Date(t)))})}prepareParam(t,r){let n;if(Md.isRef(t))n=t;else{let i=this.cast(t);if(!this._typeCheck(i))throw new TypeError(`\`${r}\` must be a Date or a value that can be \`cast()\` to a Date`);n=i}return n}min(t,r=dx.min){let n=this.prepareParam(t,"min");return this.test({message:r,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(i){return i>=this.resolve(n)}})}max(t,r=dx.max){let n=this.prepareParam(t,"max");return this.test({message:r,name:"max",exclusive:!0,params:{max:t},skipAbsent:!0,test(i){return i<=this.resolve(n)}})}}qw.INVALID_DATE=nce;qw.prototype;function oce(e,t=[]){let r=[],n=new Set,i=new Set(t.map(([s,a])=>`${s}-${a}`));function o(s,a){let c=Pu.split(s)[0];n.add(c),i.has(`${a}-${c}`)||r.push([a,c])}for(const s of Object.keys(e)){let a=e[s];n.add(s),Md.isRef(a)&&a.isSibling?o(a.path,s):Kw(a)&&"deps"in a&&a.deps.forEach(c=>o(c,s))}return Dae.array(Array.from(n),r).reverse()}function mM(e,t){let r=1/0;return e.some((n,i)=>{var o;if((o=t.path)!=null&&o.includes(n))return r=i,!0}),r}function aW(e){return(t,r)=>mM(e,t)-mM(e,r)}const cW=(e,t,r)=>{if(typeof e!="string")return e;let n=e;try{n=JSON.parse(e)}catch{}return r.isType(n)?n:e};function HE(e){if("fields"in e){const t={};for(const[r,n]of Object.entries(e.fields))t[r]=HE(n);return e.setFields(t)}if(e.type==="array"){const t=e.optional();return t.innerType&&(t.innerType=HE(t.innerType)),t}return e.type==="tuple"?e.optional().clone({types:e.spec.types.map(HE)}):"optional"in e?e.optional():e}const sce=(e,t)=>{const r=[...Pu.normalizePath(t)];if(r.length===1)return r[0]in e;let n=r.pop(),i=Pu.getter(Pu.join(r),!0)(e);return!!(i&&n in i)};let gM=e=>Object.prototype.toString.call(e)==="[object Object]";function yM(e,t){let r=Object.keys(e.fields);return Object.keys(t).filter(n=>r.indexOf(n)===-1)}const ace=aW([]);function fo(e){return new lW(e)}class lW extends us{constructor(t){super({type:"object",check(r){return gM(r)||typeof r=="function"}}),this.fields=Object.create(null),this._sortErrors=ace,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{t&&this.shape(t)})}_cast(t,r={}){var n;let i=super._cast(t,r);if(i===void 0)return this.getDefault(r);if(!this._typeCheck(i))return i;let o=this.fields,s=(n=r.stripUnknown)!=null?n:this.spec.noUnknown,a=[].concat(this._nodes,Object.keys(i).filter(u=>!this._nodes.includes(u))),c={},l=Object.assign({},r,{parent:c,__validating:r.__validating||!1}),d=!1;for(const u of a){let p=o[u],f=u in i;if(p){let m,g=i[u];l.path=(r.path?`${r.path}.`:"")+u,p=p.resolve({value:g,context:r.context,parent:c});let y=p instanceof us?p.spec:void 0,v=y==null?void 0:y.strict;if(y!=null&&y.strip){d=d||u in i;continue}m=!r.__validating||!v?p.cast(i[u],l):i[u],m!==void 0&&(c[u]=m)}else f&&!s&&(c[u]=i[u]);(f!==u in c||c[u]!==i[u])&&(d=!0)}return d?c:i}_validate(t,r={},n,i){let{from:o=[],originalValue:s=t,recursive:a=this.spec.recursive}=r;r.from=[{schema:this,value:s},...o],r.__validating=!0,r.originalValue=s,super._validate(t,r,n,(c,l)=>{if(!a||!gM(l)){i(c,l);return}s=s||l;let d=[];for(let u of this._nodes){let p=this.fields[u];!p||Md.isRef(p)||d.push(p.asNestedTest({options:r,key:u,parent:l,parentPath:r.path,originalParent:s}))}this.runTests({tests:d,value:l,originalValue:s,options:r},n,u=>{i(u.sort(this._sortErrors).concat(c),l)})})}clone(t){const r=super.clone(t);return r.fields=Object.assign({},this.fields),r._nodes=this._nodes,r._excludedEdges=this._excludedEdges,r._sortErrors=this._sortErrors,r}concat(t){let r=super.concat(t),n=r.fields;for(let[i,o]of Object.entries(this.fields)){const s=n[i];n[i]=s===void 0?o:s}return r.withMutation(i=>i.setFields(n,[...this._excludedEdges,...t._excludedEdges]))}_getDefault(t){if("default"in this.spec)return super._getDefault(t);if(!this._nodes.length)return;let r={};return this._nodes.forEach(n=>{var i;const o=this.fields[n];let s=t;(i=s)!=null&&i.value&&(s=Object.assign({},s,{parent:s.value,value:s.value[n]})),r[n]=o&&"getDefault"in o?o.getDefault(s):void 0}),r}setFields(t,r){let n=this.clone();return n.fields=t,n._nodes=oce(t,r),n._sortErrors=aW(Object.keys(t)),r&&(n._excludedEdges=r),n}shape(t,r=[]){return this.clone().withMutation(n=>{let i=n._excludedEdges;return r.length&&(Array.isArray(r[0])||(r=[r]),i=[...n._excludedEdges,...r]),n.setFields(Object.assign(n.fields,t),i)})}partial(){const t={};for(const[r,n]of Object.entries(this.fields))t[r]="optional"in n&&n.optional instanceof Function?n.optional():n;return this.setFields(t)}deepPartial(){return HE(this)}pick(t){const r={};for(const n of t)this.fields[n]&&(r[n]=this.fields[n]);return this.setFields(r,this._excludedEdges.filter(([n,i])=>t.includes(n)&&t.includes(i)))}omit(t){const r=[];for(const n of Object.keys(this.fields))t.includes(n)||r.push(n);return this.pick(r)}from(t,r,n){let i=Pu.getter(t,!0);return this.transform(o=>{if(!o)return o;let s=o;return sce(o,t)&&(s=Object.assign({},o),n||delete s[t],s[r]=i(o)),s})}json(){return this.transform(cW)}exact(t){return this.test({name:"exact",exclusive:!0,message:t||BE.exact,test(r){if(r==null)return!0;const n=yM(this.schema,r);return n.length===0||this.createError({params:{properties:n.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(t=!0,r=BE.noUnknown){typeof t!="boolean"&&(r=t,t=!0);let n=this.test({name:"noUnknown",exclusive:!0,message:r,test(i){if(i==null)return!0;const o=yM(this.schema,i);return!t||o.length===0||this.createError({params:{unknown:o.join(", ")}})}});return n.spec.noUnknown=t,n}unknown(t=!0,r=BE.noUnknown){return this.noUnknown(!t,r)}transformKeys(t){return this.transform(r=>{if(!r)return r;const n={};for(const i of Object.keys(r))n[t(i)]=r[i];return n})}camelCase(){return this.transformKeys(eC.camelCase)}snakeCase(){return this.transformKeys(eC.snakeCase)}constantCase(){return this.transformKeys(t=>eC.snakeCase(t).toUpperCase())}describe(t){const r=(t?this.resolve(t):this).clone(),n=super.describe(t);n.fields={};for(const[o,s]of Object.entries(r.fields)){var i;let a=t;(i=a)!=null&&i.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[o]})),n.fields[o]=s.describe(a)}return n}}fo.prototype=lW.prototype;function dW(e){return new uW(e)}class uW extends us{constructor(t){super({type:"array",spec:{types:t},check(r){return Array.isArray(r)}}),this.innerType=void 0,this.innerType=t}_cast(t,r){const n=super._cast(t,r);if(!this._typeCheck(n)||!this.innerType)return n;let i=!1;const o=n.map((s,a)=>{const c=this.innerType.cast(s,Object.assign({},r,{path:`${r.path||""}[${a}]`}));return c!==s&&(i=!0),c});return i?o:n}_validate(t,r={},n,i){var o;let s=this.innerType,a=(o=r.recursive)!=null?o:this.spec.recursive;r.originalValue!=null&&r.originalValue,super._validate(t,r,n,(c,l)=>{var d;if(!a||!s||!this._typeCheck(l)){i(c,l);return}let u=new Array(l.length);for(let f=0;f<l.length;f++){var p;u[f]=s.asNestedTest({options:r,index:f,parent:l,parentPath:r.path,originalParent:(p=r.originalValue)!=null?p:t})}this.runTests({value:l,tests:u,originalValue:(d=r.originalValue)!=null?d:t,options:r},n,f=>i(f.concat(c),l))})}clone(t){const r=super.clone(t);return r.innerType=this.innerType,r}json(){return this.transform(cW)}concat(t){let r=super.concat(t);return r.innerType=this.innerType,t.innerType&&(r.innerType=r.innerType?r.innerType.concat(t.innerType):t.innerType),r}of(t){let r=this.clone();if(!Kw(t))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+el(t));return r.innerType=t,r.spec=Object.assign({},r.spec,{types:t}),r}length(t,r=$E.length){return this.test({message:r,name:"length",exclusive:!0,params:{length:t},skipAbsent:!0,test(n){return n.length===this.resolve(t)}})}min(t,r){return r=r||$E.min,this.test({message:r,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(n){return n.length>=this.resolve(t)}})}max(t,r){return r=r||$E.max,this.test({message:r,name:"max",exclusive:!0,params:{max:t},skipAbsent:!0,test(n){return n.length<=this.resolve(t)}})}ensure(){return this.default(()=>[]).transform((t,r)=>this._typeCheck(t)?t:r==null?[]:[].concat(r))}compact(t){let r=t?(n,i,o)=>!t(n,i,o):n=>!!n;return this.transform(n=>n!=null?n.filter(r):n)}describe(t){const r=(t?this.resolve(t):this).clone(),n=super.describe(t);if(r.innerType){var i;let o=t;(i=o)!=null&&i.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[0]})),n.innerType=r.innerType.describe(o)}return n}}dW.prototype=uW.prototype;const cce=fo().shape({username:kt().required("shouldn't be left empty").min(5,"minimum of 5 letters"),password:kt().required("Required").min(2,"shouldn't be less than 8")});function hW(e,t){return function(){return e.apply(t,arguments)}}const{toString:lce}=Object.prototype,{getPrototypeOf:wk}=Object,Yw=(e=>t=>{const r=lce.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Da=e=>(e=e.toLowerCase(),t=>Yw(t)===e),Xw=e=>t=>typeof t===e,{isArray:Vf}=Array,v0=Xw("undefined");function dce(e){return e!==null&&!v0(e)&&e.constructor!==null&&!v0(e.constructor)&&ls(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const pW=Da("ArrayBuffer");function uce(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&pW(e.buffer),t}const hce=Xw("string"),ls=Xw("function"),fW=Xw("number"),Jw=e=>e!==null&&typeof e=="object",pce=e=>e===!0||e===!1,WE=e=>{if(Yw(e)!=="object")return!1;const t=wk(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},fce=Da("Date"),mce=Da("File"),gce=Da("Blob"),yce=Da("FileList"),vce=e=>Jw(e)&&ls(e.pipe),Ece=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ls(e.append)&&((t=Yw(e))==="formdata"||t==="object"&&ls(e.toString)&&e.toString()==="[object FormData]"))},_ce=Da("URLSearchParams"),[bce,wce,Sce,Tce]=["ReadableStream","Request","Response","Headers"].map(Da),Cce=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ly(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,i;if(typeof e!="object"&&(e=[e]),Vf(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{const o=r?Object.getOwnPropertyNames(e):Object.keys(e),s=o.length;let a;for(n=0;n<s;n++)a=o[n],t.call(null,e[a],a,e)}}function mW(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,i;for(;n-- >0;)if(i=r[n],t===i.toLowerCase())return i;return null}const _u=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,gW=e=>!v0(e)&&e!==_u;function fx(){const{caseless:e}=gW(this)&&this||{},t={},r=(n,i)=>{const o=e&&mW(t,i)||i;WE(t[o])&&WE(n)?t[o]=fx(t[o],n):WE(n)?t[o]=fx({},n):Vf(n)?t[o]=n.slice():t[o]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&ly(arguments[n],r);return t}const Rce=(e,t,r,{allOwnKeys:n}={})=>(ly(t,(i,o)=>{r&&ls(i)?e[o]=hW(i,r):e[o]=i},{allOwnKeys:n}),e),Ice=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Ace=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},xce=(e,t,r,n)=>{let i,o,s;const a={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)s=i[o],(!n||n(s,e,t))&&!a[s]&&(t[s]=e[s],a[s]=!0);e=r!==!1&&wk(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Oce=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},Nce=e=>{if(!e)return null;if(Vf(e))return e;let t=e.length;if(!fW(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},kce=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&wk(Uint8Array)),Pce=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=n.next())&&!i.done;){const o=i.value;t.call(e,o[0],o[1])}},Dce=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},Lce=Da("HTMLFormElement"),Mce=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),vM=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),jce=Da("RegExp"),yW=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};ly(r,(i,o)=>{let s;(s=t(i,o,e))!==!1&&(n[o]=s||i)}),Object.defineProperties(e,n)},Uce=e=>{yW(e,(t,r)=>{if(ls(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ls(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Fce=(e,t)=>{const r={},n=i=>{i.forEach(o=>{r[o]=!0})};return Vf(e)?n(e):n(String(e).split(t)),r},Vce=()=>{},Bce=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,tC="abcdefghijklmnopqrstuvwxyz",EM="0123456789",vW={DIGIT:EM,ALPHA:tC,ALPHA_DIGIT:tC+tC.toUpperCase()+EM},$ce=(e=16,t=vW.ALPHA_DIGIT)=>{let r="";const{length:n}=t;for(;e--;)r+=t[Math.random()*n|0];return r};function Hce(e){return!!(e&&ls(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Wce=e=>{const t=new Array(10),r=(n,i)=>{if(Jw(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[i]=n;const o=Vf(n)?[]:{};return ly(n,(s,a)=>{const c=r(s,i+1);!v0(c)&&(o[a]=c)}),t[i]=void 0,o}}return n};return r(e,0)},Gce=Da("AsyncFunction"),zce=e=>e&&(Jw(e)||ls(e))&&ls(e.then)&&ls(e.catch),EW=((e,t)=>e?setImmediate:t?((r,n)=>(_u.addEventListener("message",({source:i,data:o})=>{i===_u&&o===r&&n.length&&n.shift()()},!1),i=>{n.push(i),_u.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ls(_u.postMessage)),Kce=typeof queueMicrotask<"u"?queueMicrotask.bind(_u):typeof process<"u"&&process.nextTick||EW,le={isArray:Vf,isArrayBuffer:pW,isBuffer:dce,isFormData:Ece,isArrayBufferView:uce,isString:hce,isNumber:fW,isBoolean:pce,isObject:Jw,isPlainObject:WE,isReadableStream:bce,isRequest:wce,isResponse:Sce,isHeaders:Tce,isUndefined:v0,isDate:fce,isFile:mce,isBlob:gce,isRegExp:jce,isFunction:ls,isStream:vce,isURLSearchParams:_ce,isTypedArray:kce,isFileList:yce,forEach:ly,merge:fx,extend:Rce,trim:Cce,stripBOM:Ice,inherits:Ace,toFlatObject:xce,kindOf:Yw,kindOfTest:Da,endsWith:Oce,toArray:Nce,forEachEntry:Pce,matchAll:Dce,isHTMLForm:Lce,hasOwnProperty:vM,hasOwnProp:vM,reduceDescriptors:yW,freezeMethods:Uce,toObjectSet:Fce,toCamelCase:Mce,noop:Vce,toFiniteNumber:Bce,findKey:mW,global:_u,isContextDefined:gW,ALPHABET:vW,generateString:$ce,isSpecCompliantForm:Hce,toJSONObject:Wce,isAsyncFn:Gce,isThenable:zce,setImmediate:EW,asap:Kce};function Bt(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}le.inherits(Bt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:le.toJSONObject(this.config),code:this.code,status:this.status}}});const _W=Bt.prototype,bW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{bW[e]={value:e}});Object.defineProperties(Bt,bW);Object.defineProperty(_W,"isAxiosError",{value:!0});Bt.from=(e,t,r,n,i,o)=>{const s=Object.create(_W);return le.toFlatObject(e,s,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),Bt.call(s,e.message,t,r,n,i),s.cause=e,s.name=e.name,o&&Object.assign(s,o),s};const qce=null;function mx(e){return le.isPlainObject(e)||le.isArray(e)}function wW(e){return le.endsWith(e,"[]")?e.slice(0,-2):e}function _M(e,t,r){return e?e.concat(t).map(function(i,o){return i=wW(i),!r&&o?"["+i+"]":i}).join(r?".":""):t}function Yce(e){return le.isArray(e)&&!e.some(mx)}const Xce=le.toFlatObject(le,{},null,function(t){return/^is[A-Z]/.test(t)});function Qw(e,t,r){if(!le.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=le.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!le.isUndefined(y[g])});const n=r.metaTokens,i=r.visitor||d,o=r.dots,s=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&le.isSpecCompliantForm(t);if(!le.isFunction(i))throw new TypeError("visitor must be a function");function l(m){if(m===null)return"";if(le.isDate(m))return m.toISOString();if(!c&&le.isBlob(m))throw new Bt("Blob is not supported. Use a Buffer instead.");return le.isArrayBuffer(m)||le.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,g,y){let v=m;if(m&&!y&&typeof m=="object"){if(le.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(le.isArray(m)&&Yce(m)||(le.isFileList(m)||le.endsWith(g,"[]"))&&(v=le.toArray(m)))return g=wW(g),v.forEach(function(w,S){!(le.isUndefined(w)||w===null)&&t.append(s===!0?_M([g],S,o):s===null?g:g+"[]",l(w))}),!1}return mx(m)?!0:(t.append(_M(y,g,o),l(m)),!1)}const u=[],p=Object.assign(Xce,{defaultVisitor:d,convertValue:l,isVisitable:mx});function f(m,g){if(!le.isUndefined(m)){if(u.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));u.push(m),le.forEach(m,function(v,E){(!(le.isUndefined(v)||v===null)&&i.call(t,v,le.isString(E)?E.trim():E,g,p))===!0&&f(v,g?g.concat(E):[E])}),u.pop()}}if(!le.isObject(e))throw new TypeError("data must be an object");return f(e),t}function bM(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Sk(e,t){this._pairs=[],e&&Qw(e,this,t)}const SW=Sk.prototype;SW.append=function(t,r){this._pairs.push([t,r])};SW.toString=function(t){const r=t?function(n){return t.call(this,n,bM)}:bM;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function Jce(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function TW(e,t,r){if(!t)return e;const n=r&&r.encode||Jce;le.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let o;if(i?o=i(t,r):o=le.isURLSearchParams(t)?t.toString():new Sk(t,r).toString(n),o){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class wM{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){le.forEach(this.handlers,function(n){n!==null&&t(n)})}}const CW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Qce=typeof URLSearchParams<"u"?URLSearchParams:Sk,Zce=typeof FormData<"u"?FormData:null,ele=typeof Blob<"u"?Blob:null,tle={isBrowser:!0,classes:{URLSearchParams:Qce,FormData:Zce,Blob:ele},protocols:["http","https","file","blob","url","data"]},Tk=typeof window<"u"&&typeof document<"u",gx=typeof navigator=="object"&&navigator||void 0,rle=Tk&&(!gx||["ReactNative","NativeScript","NS"].indexOf(gx.product)<0),nle=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ile=Tk&&window.location.href||"http://localhost",ole=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Tk,hasStandardBrowserEnv:rle,hasStandardBrowserWebWorkerEnv:nle,navigator:gx,origin:ile},Symbol.toStringTag,{value:"Module"})),zi={...ole,...tle};function sle(e,t){return Qw(e,new zi.classes.URLSearchParams,Object.assign({visitor:function(r,n,i,o){return zi.isNode&&le.isBuffer(r)?(this.append(n,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))}function ale(e){return le.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function cle(e){const t={},r=Object.keys(e);let n;const i=r.length;let o;for(n=0;n<i;n++)o=r[n],t[o]=e[o];return t}function RW(e){function t(r,n,i,o){let s=r[o++];if(s==="__proto__")return!0;const a=Number.isFinite(+s),c=o>=r.length;return s=!s&&le.isArray(i)?i.length:s,c?(le.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!a):((!i[s]||!le.isObject(i[s]))&&(i[s]=[]),t(r,n,i[s],o)&&le.isArray(i[s])&&(i[s]=cle(i[s])),!a)}if(le.isFormData(e)&&le.isFunction(e.entries)){const r={};return le.forEachEntry(e,(n,i)=>{t(ale(n),i,r,0)}),r}return null}function lle(e,t,r){if(le.isString(e))try{return(t||JSON.parse)(e),le.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(e)}const dy={transitional:CW,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,o=le.isObject(t);if(o&&le.isHTMLForm(t)&&(t=new FormData(t)),le.isFormData(t))return i?JSON.stringify(RW(t)):t;if(le.isArrayBuffer(t)||le.isBuffer(t)||le.isStream(t)||le.isFile(t)||le.isBlob(t)||le.isReadableStream(t))return t;if(le.isArrayBufferView(t))return t.buffer;if(le.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return sle(t,this.formSerializer).toString();if((a=le.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Qw(a?{"files[]":t}:t,c&&new c,this.formSerializer)}}return o||i?(r.setContentType("application/json",!1),lle(t)):t}],transformResponse:[function(t){const r=this.transitional||dy.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(le.isResponse(t)||le.isReadableStream(t))return t;if(t&&le.isString(t)&&(n&&!this.responseType||i)){const s=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(a){if(s)throw a.name==="SyntaxError"?Bt.from(a,Bt.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:zi.classes.FormData,Blob:zi.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};le.forEach(["delete","get","head","post","put","patch"],e=>{dy.headers[e]={}});const dle=le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ule=e=>{const t={};let r,n,i;return e&&e.split(`
`).forEach(function(s){i=s.indexOf(":"),r=s.substring(0,i).trim().toLowerCase(),n=s.substring(i+1).trim(),!(!r||t[r]&&dle[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},SM=Symbol("internals");function km(e){return e&&String(e).trim().toLowerCase()}function GE(e){return e===!1||e==null?e:le.isArray(e)?e.map(GE):String(e)}function hle(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const ple=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function rC(e,t,r,n,i){if(le.isFunction(n))return n.call(this,t,r);if(i&&(t=r),!!le.isString(t)){if(le.isString(n))return t.indexOf(n)!==-1;if(le.isRegExp(n))return n.test(t)}}function fle(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function mle(e,t){const r=le.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(i,o,s){return this[n].call(this,t,i,o,s)},configurable:!0})})}class Do{constructor(t){t&&this.set(t)}set(t,r,n){const i=this;function o(a,c,l){const d=km(c);if(!d)throw new Error("header name must be a non-empty string");const u=le.findKey(i,d);(!u||i[u]===void 0||l===!0||l===void 0&&i[u]!==!1)&&(i[u||c]=GE(a))}const s=(a,c)=>le.forEach(a,(l,d)=>o(l,d,c));if(le.isPlainObject(t)||t instanceof this.constructor)s(t,r);else if(le.isString(t)&&(t=t.trim())&&!ple(t))s(ule(t),r);else if(le.isHeaders(t))for(const[a,c]of t.entries())o(c,a,n);else t!=null&&o(r,t,n);return this}get(t,r){if(t=km(t),t){const n=le.findKey(this,t);if(n){const i=this[n];if(!r)return i;if(r===!0)return hle(i);if(le.isFunction(r))return r.call(this,i,n);if(le.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=km(t),t){const n=le.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||rC(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let i=!1;function o(s){if(s=km(s),s){const a=le.findKey(n,s);a&&(!r||rC(n,n[a],a,r))&&(delete n[a],i=!0)}}return le.isArray(t)?t.forEach(o):o(t),i}clear(t){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const o=r[n];(!t||rC(this,this[o],o,t,!0))&&(delete this[o],i=!0)}return i}normalize(t){const r=this,n={};return le.forEach(this,(i,o)=>{const s=le.findKey(n,o);if(s){r[s]=GE(i),delete r[o];return}const a=t?fle(o):String(o).trim();a!==o&&delete r[o],r[a]=GE(i),n[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return le.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=t&&le.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[SM]=this[SM]={accessors:{}}).accessors,i=this.prototype;function o(s){const a=km(s);n[a]||(mle(i,s),n[a]=!0)}return le.isArray(t)?t.forEach(o):o(t),this}}Do.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);le.reduceDescriptors(Do.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});le.freezeMethods(Do);function nC(e,t){const r=this||dy,n=t||r,i=Do.from(n.headers);let o=n.data;return le.forEach(e,function(a){o=a.call(r,o,i.normalize(),t?t.status:void 0)}),i.normalize(),o}function IW(e){return!!(e&&e.__CANCEL__)}function Bf(e,t,r){Bt.call(this,e??"canceled",Bt.ERR_CANCELED,t,r),this.name="CanceledError"}le.inherits(Bf,Bt,{__CANCEL__:!0});function AW(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Bt("Request failed with status code "+r.status,[Bt.ERR_BAD_REQUEST,Bt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function gle(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function yle(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i=0,o=0,s;return t=t!==void 0?t:1e3,function(c){const l=Date.now(),d=n[o];s||(s=l),r[i]=c,n[i]=l;let u=o,p=0;for(;u!==i;)p+=r[u++],u=u%e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),l-s<t)return;const f=d&&l-d;return f?Math.round(p*1e3/f):void 0}}function vle(e,t){let r=0,n=1e3/t,i,o;const s=(l,d=Date.now())=>{r=d,i=null,o&&(clearTimeout(o),o=null),e.apply(null,l)};return[(...l)=>{const d=Date.now(),u=d-r;u>=n?s(l,d):(i=l,o||(o=setTimeout(()=>{o=null,s(i)},n-u)))},()=>i&&s(i)]}const Z_=(e,t,r=3)=>{let n=0;const i=yle(50,250);return vle(o=>{const s=o.loaded,a=o.lengthComputable?o.total:void 0,c=s-n,l=i(c),d=s<=a;n=s;const u={loaded:s,total:a,progress:a?s/a:void 0,bytes:c,rate:l||void 0,estimated:l&&a&&d?(a-s)/l:void 0,event:o,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(u)},r)},TM=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},CM=e=>(...t)=>le.asap(()=>e(...t)),Ele=zi.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,zi.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(zi.origin),zi.navigator&&/(msie|trident)/i.test(zi.navigator.userAgent)):()=>!0,_le=zi.hasStandardBrowserEnv?{write(e,t,r,n,i,o){const s=[e+"="+encodeURIComponent(t)];le.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),le.isString(n)&&s.push("path="+n),le.isString(i)&&s.push("domain="+i),o===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ble(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function wle(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function xW(e,t){return e&&!ble(t)?wle(e,t):t}const RM=e=>e instanceof Do?{...e}:e;function Yu(e,t){t=t||{};const r={};function n(l,d,u,p){return le.isPlainObject(l)&&le.isPlainObject(d)?le.merge.call({caseless:p},l,d):le.isPlainObject(d)?le.merge({},d):le.isArray(d)?d.slice():d}function i(l,d,u,p){if(le.isUndefined(d)){if(!le.isUndefined(l))return n(void 0,l,u,p)}else return n(l,d,u,p)}function o(l,d){if(!le.isUndefined(d))return n(void 0,d)}function s(l,d){if(le.isUndefined(d)){if(!le.isUndefined(l))return n(void 0,l)}else return n(void 0,d)}function a(l,d,u){if(u in t)return n(l,d);if(u in e)return n(void 0,l)}const c={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(l,d,u)=>i(RM(l),RM(d),u,!0)};return le.forEach(Object.keys(Object.assign({},e,t)),function(d){const u=c[d]||i,p=u(e[d],t[d],d);le.isUndefined(p)&&u!==a||(r[d]=p)}),r}const OW=e=>{const t=Yu({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:o,headers:s,auth:a}=t;t.headers=s=Do.from(s),t.url=TW(xW(t.baseURL,t.url),e.params,e.paramsSerializer),a&&s.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(le.isFormData(r)){if(zi.hasStandardBrowserEnv||zi.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((c=s.getContentType())!==!1){const[l,...d]=c?c.split(";").map(u=>u.trim()).filter(Boolean):[];s.setContentType([l||"multipart/form-data",...d].join("; "))}}if(zi.hasStandardBrowserEnv&&(n&&le.isFunction(n)&&(n=n(t)),n||n!==!1&&Ele(t.url))){const l=i&&o&&_le.read(o);l&&s.set(i,l)}return t},Sle=typeof XMLHttpRequest<"u",Tle=Sle&&function(e){return new Promise(function(r,n){const i=OW(e);let o=i.data;const s=Do.from(i.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:l}=i,d,u,p,f,m;function g(){f&&f(),m&&m(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function v(){if(!y)return;const w=Do.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),A={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:w,config:e,request:y};AW(function(L){r(L),g()},function(L){n(L),g()},A),y=null}"onloadend"in y?y.onloadend=v:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(v)},y.onabort=function(){y&&(n(new Bt("Request aborted",Bt.ECONNABORTED,e,y)),y=null)},y.onerror=function(){n(new Bt("Network Error",Bt.ERR_NETWORK,e,y)),y=null},y.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const A=i.transitional||CW;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),n(new Bt(S,A.clarifyTimeoutError?Bt.ETIMEDOUT:Bt.ECONNABORTED,e,y)),y=null},o===void 0&&s.setContentType(null),"setRequestHeader"in y&&le.forEach(s.toJSON(),function(S,A){y.setRequestHeader(A,S)}),le.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),a&&a!=="json"&&(y.responseType=i.responseType),l&&([p,m]=Z_(l,!0),y.addEventListener("progress",p)),c&&y.upload&&([u,f]=Z_(c),y.upload.addEventListener("progress",u),y.upload.addEventListener("loadend",f)),(i.cancelToken||i.signal)&&(d=w=>{y&&(n(!w||w.type?new Bf(null,e,y):w),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const E=gle(i.url);if(E&&zi.protocols.indexOf(E)===-1){n(new Bt("Unsupported protocol "+E+":",Bt.ERR_BAD_REQUEST,e));return}y.send(o||null)})},Cle=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,i;const o=function(l){if(!i){i=!0,a();const d=l instanceof Error?l:this.reason;n.abort(d instanceof Bt?d:new Bf(d instanceof Error?d.message:d))}};let s=t&&setTimeout(()=>{s=null,o(new Bt(`timeout ${t} of ms exceeded`,Bt.ETIMEDOUT))},t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(o):l.removeEventListener("abort",o)}),e=null)};e.forEach(l=>l.addEventListener("abort",o));const{signal:c}=n;return c.unsubscribe=()=>le.asap(a),c}},Rle=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,i;for(;n<r;)i=n+t,yield e.slice(n,i),n=i},Ile=async function*(e,t){for await(const r of Ale(e))yield*Rle(r,t)},Ale=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},IM=(e,t,r,n)=>{const i=Ile(e,t);let o=0,s,a=c=>{s||(s=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:l,value:d}=await i.next();if(l){a(),c.close();return}let u=d.byteLength;if(r){let p=o+=u;r(p)}c.enqueue(new Uint8Array(d))}catch(l){throw a(l),l}},cancel(c){return a(c),i.return()}},{highWaterMark:2})},Zw=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",NW=Zw&&typeof ReadableStream=="function",xle=Zw&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),kW=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Ole=NW&&kW(()=>{let e=!1;const t=new Request(zi.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),AM=64*1024,yx=NW&&kW(()=>le.isReadableStream(new Response("").body)),eb={stream:yx&&(e=>e.body)};Zw&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!eb[t]&&(eb[t]=le.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new Bt(`Response type '${t}' is not supported`,Bt.ERR_NOT_SUPPORT,n)})})})(new Response);const Nle=async e=>{if(e==null)return 0;if(le.isBlob(e))return e.size;if(le.isSpecCompliantForm(e))return(await new Request(zi.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(le.isArrayBufferView(e)||le.isArrayBuffer(e))return e.byteLength;if(le.isURLSearchParams(e)&&(e=e+""),le.isString(e))return(await xle(e)).byteLength},kle=async(e,t)=>{const r=le.toFiniteNumber(e.getContentLength());return r??Nle(t)},Ple=Zw&&(async e=>{let{url:t,method:r,data:n,signal:i,cancelToken:o,timeout:s,onDownloadProgress:a,onUploadProgress:c,responseType:l,headers:d,withCredentials:u="same-origin",fetchOptions:p}=OW(e);l=l?(l+"").toLowerCase():"text";let f=Cle([i,o&&o.toAbortSignal()],s),m;const g=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let y;try{if(c&&Ole&&r!=="get"&&r!=="head"&&(y=await kle(d,n))!==0){let A=new Request(t,{method:"POST",body:n,duplex:"half"}),N;if(le.isFormData(n)&&(N=A.headers.get("content-type"))&&d.setContentType(N),A.body){const[L,j]=TM(y,Z_(CM(c)));n=IM(A.body,AM,L,j)}}le.isString(u)||(u=u?"include":"omit");const v="credentials"in Request.prototype;m=new Request(t,{...p,signal:f,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:v?u:void 0});let E=await fetch(m);const w=yx&&(l==="stream"||l==="response");if(yx&&(a||w&&g)){const A={};["status","statusText","headers"].forEach(W=>{A[W]=E[W]});const N=le.toFiniteNumber(E.headers.get("content-length")),[L,j]=a&&TM(N,Z_(CM(a),!0))||[];E=new Response(IM(E.body,AM,L,()=>{j&&j(),g&&g()}),A)}l=l||"text";let S=await eb[le.findKey(eb,l)||"text"](E,e);return!w&&g&&g(),await new Promise((A,N)=>{AW(A,N,{data:S,headers:Do.from(E.headers),status:E.status,statusText:E.statusText,config:e,request:m})})}catch(v){throw g&&g(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new Bt("Network Error",Bt.ERR_NETWORK,e,m),{cause:v.cause||v}):Bt.from(v,v&&v.code,e,m)}}),vx={http:qce,xhr:Tle,fetch:Ple};le.forEach(vx,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const xM=e=>`- ${e}`,Dle=e=>le.isFunction(e)||e===null||e===!1,PW={getAdapter:e=>{e=le.isArray(e)?e:[e];const{length:t}=e;let r,n;const i={};for(let o=0;o<t;o++){r=e[o];let s;if(n=r,!Dle(r)&&(n=vx[(s=String(r)).toLowerCase()],n===void 0))throw new Bt(`Unknown adapter '${s}'`);if(n)break;i[s||"#"+o]=n}if(!n){const o=Object.entries(i).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let s=t?o.length>1?`since :
`+o.map(xM).join(`
`):" "+xM(o[0]):"as no adapter specified";throw new Bt("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return n},adapters:vx};function iC(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Bf(null,e)}function OM(e){return iC(e),e.headers=Do.from(e.headers),e.data=nC.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),PW.getAdapter(e.adapter||dy.adapter)(e).then(function(n){return iC(e),n.data=nC.call(e,e.transformResponse,n),n.headers=Do.from(n.headers),n},function(n){return IW(n)||(iC(e),n&&n.response&&(n.response.data=nC.call(e,e.transformResponse,n.response),n.response.headers=Do.from(n.response.headers))),Promise.reject(n)})}const DW="1.7.9",eS={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{eS[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const NM={};eS.transitional=function(t,r,n){function i(o,s){return"[Axios v"+DW+"] Transitional option '"+o+"'"+s+(n?". "+n:"")}return(o,s,a)=>{if(t===!1)throw new Bt(i(s," has been removed"+(r?" in "+r:"")),Bt.ERR_DEPRECATED);return r&&!NM[s]&&(NM[s]=!0,console.warn(i(s," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(o,s,a):!0}};eS.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Lle(e,t,r){if(typeof e!="object")throw new Bt("options must be an object",Bt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const o=n[i],s=t[o];if(s){const a=e[o],c=a===void 0||s(a,o,e);if(c!==!0)throw new Bt("option "+o+" must be "+c,Bt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Bt("Unknown option "+o,Bt.ERR_BAD_OPTION)}}const zE={assertOptions:Lle,validators:eS},Wa=zE.validators;class Du{constructor(t){this.defaults=t,this.interceptors={request:new wM,response:new wM}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Yu(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:o}=r;n!==void 0&&zE.assertOptions(n,{silentJSONParsing:Wa.transitional(Wa.boolean),forcedJSONParsing:Wa.transitional(Wa.boolean),clarifyTimeoutError:Wa.transitional(Wa.boolean)},!1),i!=null&&(le.isFunction(i)?r.paramsSerializer={serialize:i}:zE.assertOptions(i,{encode:Wa.function,serialize:Wa.function},!0)),zE.assertOptions(r,{baseUrl:Wa.spelling("baseURL"),withXsrfToken:Wa.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let s=o&&le.merge(o.common,o[r.method]);o&&le.forEach(["delete","get","head","post","put","patch","common"],m=>{delete o[m]}),r.headers=Do.concat(s,o);const a=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});const l=[];this.interceptors.response.forEach(function(g){l.push(g.fulfilled,g.rejected)});let d,u=0,p;if(!c){const m=[OM.bind(this),void 0];for(m.unshift.apply(m,a),m.push.apply(m,l),p=m.length,d=Promise.resolve(r);u<p;)d=d.then(m[u++],m[u++]);return d}p=a.length;let f=r;for(u=0;u<p;){const m=a[u++],g=a[u++];try{f=m(f)}catch(y){g.call(this,y);break}}try{d=OM.call(this,f)}catch(m){return Promise.reject(m)}for(u=0,p=l.length;u<p;)d=d.then(l[u++],l[u++]);return d}getUri(t){t=Yu(this.defaults,t);const r=xW(t.baseURL,t.url);return TW(r,t.params,t.paramsSerializer)}}le.forEach(["delete","get","head","options"],function(t){Du.prototype[t]=function(r,n){return this.request(Yu(n||{},{method:t,url:r,data:(n||{}).data}))}});le.forEach(["post","put","patch"],function(t){function r(n){return function(o,s,a){return this.request(Yu(a||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}Du.prototype[t]=r(),Du.prototype[t+"Form"]=r(!0)});class Ck{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const n=this;this.promise.then(i=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](i);n._listeners=null}),this.promise.then=i=>{let o;const s=new Promise(a=>{n.subscribe(a),o=a}).then(i);return s.cancel=function(){n.unsubscribe(o)},s},t(function(o,s,a){n.reason||(n.reason=new Bf(o,s,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Ck(function(i){t=i}),cancel:t}}}function Mle(e){return function(r){return e.apply(null,r)}}function jle(e){return le.isObject(e)&&e.isAxiosError===!0}const Ex={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ex).forEach(([e,t])=>{Ex[t]=e});function LW(e){const t=new Du(e),r=hW(Du.prototype.request,t);return le.extend(r,Du.prototype,t,{allOwnKeys:!0}),le.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return LW(Yu(e,i))},r}const Ce=LW(dy);Ce.Axios=Du;Ce.CanceledError=Bf;Ce.CancelToken=Ck;Ce.isCancel=IW;Ce.VERSION=DW;Ce.toFormData=Qw;Ce.AxiosError=Bt;Ce.Cancel=Ce.CanceledError;Ce.all=function(t){return Promise.all(t)};Ce.spread=Mle;Ce.isAxiosError=jle;Ce.mergeConfig=Yu;Ce.AxiosHeaders=Do;Ce.formToJSON=e=>RW(le.isHTMLForm(e)?new FormData(e):e);Ce.getAdapter=PW.getAdapter;Ce.HttpStatusCode=Ex;Ce.default=Ce;/*!
* sweetalert2 v11.15.2
* Released under the MIT License.
*/function MW(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function Ule(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kM(e,t){return e.get(MW(e,t))}function Fle(e,t,r){Ule(e,t),t.set(e,r)}function Vle(e,t,r){return e.set(MW(e,t),r),r}const Ble=100,gt={},$le=()=>{gt.previousActiveElement instanceof HTMLElement?(gt.previousActiveElement.focus(),gt.previousActiveElement=null):document.body&&document.body.focus()},Hle=e=>new Promise(t=>{if(!e)return t();const r=window.scrollX,n=window.scrollY;gt.restoreFocusTimeout=setTimeout(()=>{$le(),t()},Ble),window.scrollTo(r,n)}),jW="swal2-",Wle=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],ae=Wle.reduce((e,t)=>(e[t]=jW+t,e),{}),Gle=["success","warning","info","question","error"],tb=Gle.reduce((e,t)=>(e[t]=jW+t,e),{}),UW="SweetAlert2:",Rk=e=>e.charAt(0).toUpperCase()+e.slice(1),Fo=e=>{console.warn(`${UW} ${typeof e=="object"?e.join(" "):e}`)},mh=e=>{console.error(`${UW} ${e}`)},PM=[],zle=e=>{PM.includes(e)||(PM.push(e),Fo(e))},FW=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;zle(`"${e}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},tS=e=>typeof e=="function"?e():e,Ik=e=>e&&typeof e.toPromise=="function",uy=e=>Ik(e)?e.toPromise():Promise.resolve(e),Ak=e=>e&&Promise.resolve(e)===e,Vo=()=>document.body.querySelector(`.${ae.container}`),hy=e=>{const t=Vo();return t?t.querySelector(e):null},vs=e=>hy(`.${e}`),br=()=>vs(ae.popup),$f=()=>vs(ae.icon),Kle=()=>vs(ae["icon-content"]),VW=()=>vs(ae.title),xk=()=>vs(ae["html-container"]),BW=()=>vs(ae.image),Ok=()=>vs(ae["progress-steps"]),rS=()=>vs(ae["validation-message"]),gc=()=>hy(`.${ae.actions} .${ae.confirm}`),Hf=()=>hy(`.${ae.actions} .${ae.cancel}`),gh=()=>hy(`.${ae.actions} .${ae.deny}`),qle=()=>vs(ae["input-label"]),Wf=()=>hy(`.${ae.loader}`),py=()=>vs(ae.actions),$W=()=>vs(ae.footer),nS=()=>vs(ae["timer-progress-bar"]),Nk=()=>vs(ae.close),Yle=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,kk=()=>{const e=br();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),r=Array.from(t).sort((o,s)=>{const a=parseInt(o.getAttribute("tabindex")||"0"),c=parseInt(s.getAttribute("tabindex")||"0");return a>c?1:a<c?-1:0}),n=e.querySelectorAll(Yle),i=Array.from(n).filter(o=>o.getAttribute("tabindex")!=="-1");return[...new Set(r.concat(i))].filter(o=>Lo(o))},Pk=()=>tl(document.body,ae.shown)&&!tl(document.body,ae["toast-shown"])&&!tl(document.body,ae["no-backdrop"]),iS=()=>{const e=br();return e?tl(e,ae.toast):!1},Xle=()=>{const e=br();return e?e.hasAttribute("data-loading"):!1},Es=(e,t)=>{if(e.textContent="",t){const n=new DOMParser().parseFromString(t,"text/html"),i=n.querySelector("head");i&&Array.from(i.childNodes).forEach(s=>{e.appendChild(s)});const o=n.querySelector("body");o&&Array.from(o.childNodes).forEach(s=>{s instanceof HTMLVideoElement||s instanceof HTMLAudioElement?e.appendChild(s.cloneNode(!0)):e.appendChild(s)})}},tl=(e,t)=>{if(!t)return!1;const r=t.split(/\s+/);for(let n=0;n<r.length;n++)if(!e.classList.contains(r[n]))return!1;return!0},Jle=(e,t)=>{Array.from(e.classList).forEach(r=>{!Object.values(ae).includes(r)&&!Object.values(tb).includes(r)&&!Object.values(t.showClass||{}).includes(r)&&e.classList.remove(r)})},hs=(e,t,r)=>{if(Jle(e,t),!t.customClass)return;const n=t.customClass[r];if(n){if(typeof n!="string"&&!n.forEach){Fo(`Invalid type of customClass.${r}! Expected string or iterable object, got "${typeof n}"`);return}lr(e,n)}},oS=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(`.${ae.popup} > .${ae[t]}`);case"checkbox":return e.querySelector(`.${ae.popup} > .${ae.checkbox} input`);case"radio":return e.querySelector(`.${ae.popup} > .${ae.radio} input:checked`)||e.querySelector(`.${ae.popup} > .${ae.radio} input:first-child`);case"range":return e.querySelector(`.${ae.popup} > .${ae.range} input`);default:return e.querySelector(`.${ae.popup} > .${ae.input}`)}},HW=e=>{if(e.focus(),e.type!=="file"){const t=e.value;e.value="",e.value=t}},WW=(e,t,r)=>{!e||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(n=>{Array.isArray(e)?e.forEach(i=>{r?i.classList.add(n):i.classList.remove(n)}):r?e.classList.add(n):e.classList.remove(n)}))},lr=(e,t)=>{WW(e,t,!0)},ea=(e,t)=>{WW(e,t,!1)},Zl=(e,t)=>{const r=Array.from(e.children);for(let n=0;n<r.length;n++){const i=r[n];if(i instanceof HTMLElement&&tl(i,t))return i}},Lu=(e,t,r)=>{r===`${parseInt(r)}`&&(r=parseInt(r)),r||parseInt(r)===0?e.style.setProperty(t,typeof r=="number"?`${r}px`:r):e.style.removeProperty(t)},wi=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flex";e&&(e.style.display=t)},qi=e=>{e&&(e.style.display="none")},Dk=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"block";e&&new MutationObserver(()=>{fy(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},DM=(e,t,r,n)=>{const i=e.querySelector(t);i&&i.style.setProperty(r,n)},fy=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"flex";t?wi(e,r):qi(e)},Lo=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),Qle=()=>!Lo(gc())&&!Lo(gh())&&!Lo(Hf()),LM=e=>e.scrollHeight>e.clientHeight,GW=e=>{const t=window.getComputedStyle(e),r=parseFloat(t.getPropertyValue("animation-duration")||"0"),n=parseFloat(t.getPropertyValue("transition-duration")||"0");return r>0||n>0},Lk=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=nS();r&&Lo(r)&&(t&&(r.style.transition="none",r.style.width="100%"),setTimeout(()=>{r.style.transition=`width ${e/1e3}s linear`,r.style.width="0%"},10))},Zle=()=>{const e=nS();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const r=parseInt(window.getComputedStyle(e).width),n=t/r*100;e.style.width=`${n}%`},ede=()=>typeof window>"u"||typeof document>"u",tde=`
 <div aria-labelledby="${ae.title}" aria-describedby="${ae["html-container"]}" class="${ae.popup}" tabindex="-1">
   <button type="button" class="${ae.close}"></button>
   <ul class="${ae["progress-steps"]}"></ul>
   <div class="${ae.icon}"></div>
   <img class="${ae.image}" />
   <h2 class="${ae.title}" id="${ae.title}"></h2>
   <div class="${ae["html-container"]}" id="${ae["html-container"]}"></div>
   <input class="${ae.input}" id="${ae.input}" />
   <input type="file" class="${ae.file}" />
   <div class="${ae.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${ae.select}" id="${ae.select}"></select>
   <div class="${ae.radio}"></div>
   <label class="${ae.checkbox}">
     <input type="checkbox" id="${ae.checkbox}" />
     <span class="${ae.label}"></span>
   </label>
   <textarea class="${ae.textarea}" id="${ae.textarea}"></textarea>
   <div class="${ae["validation-message"]}" id="${ae["validation-message"]}"></div>
   <div class="${ae.actions}">
     <div class="${ae.loader}"></div>
     <button type="button" class="${ae.confirm}"></button>
     <button type="button" class="${ae.deny}"></button>
     <button type="button" class="${ae.cancel}"></button>
   </div>
   <div class="${ae.footer}"></div>
   <div class="${ae["timer-progress-bar-container"]}">
     <div class="${ae["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),rde=()=>{const e=Vo();return e?(e.remove(),ea([document.documentElement,document.body],[ae["no-backdrop"],ae["toast-shown"],ae["has-column"]]),!0):!1},Yd=()=>{gt.currentInstance.resetValidationMessage()},nde=()=>{const e=br(),t=Zl(e,ae.input),r=Zl(e,ae.file),n=e.querySelector(`.${ae.range} input`),i=e.querySelector(`.${ae.range} output`),o=Zl(e,ae.select),s=e.querySelector(`.${ae.checkbox} input`),a=Zl(e,ae.textarea);t.oninput=Yd,r.onchange=Yd,o.onchange=Yd,s.onchange=Yd,a.oninput=Yd,n.oninput=()=>{Yd(),i.value=n.value},n.onchange=()=>{Yd(),i.value=n.value}},ide=e=>typeof e=="string"?document.querySelector(e):e,ode=e=>{const t=br();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},sde=e=>{window.getComputedStyle(e).direction==="rtl"&&lr(Vo(),ae.rtl)},ade=e=>{const t=rde();if(ede()){mh("SweetAlert2 requires document to initialize");return}const r=document.createElement("div");r.className=ae.container,t&&lr(r,ae["no-transition"]),Es(r,tde);const n=ide(e.target);n.appendChild(r),ode(e),sde(n),nde()},Mk=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):typeof e=="object"?cde(e,t):e&&Es(t,e)},cde=(e,t)=>{e.jquery?lde(t,e):Es(t,e.toString())},lde=(e,t)=>{if(e.textContent="",0 in t)for(let r=0;r in t;r++)e.appendChild(t[r].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},dde=(e,t)=>{const r=py(),n=Wf();!r||!n||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?qi(r):wi(r),hs(r,t,"actions"),ude(r,n,t),Es(n,t.loaderHtml||""),hs(n,t,"loader"))};function ude(e,t,r){const n=gc(),i=gh(),o=Hf();!n||!i||!o||(oC(n,"confirm",r),oC(i,"deny",r),oC(o,"cancel",r),hde(n,i,o,r),r.reverseButtons&&(r.toast?(e.insertBefore(o,n),e.insertBefore(i,n)):(e.insertBefore(o,t),e.insertBefore(i,t),e.insertBefore(n,t))))}function hde(e,t,r,n){if(!n.buttonsStyling){ea([e,t,r],ae.styled);return}lr([e,t,r],ae.styled),n.confirmButtonColor&&(e.style.backgroundColor=n.confirmButtonColor,lr(e,ae["default-outline"])),n.denyButtonColor&&(t.style.backgroundColor=n.denyButtonColor,lr(t,ae["default-outline"])),n.cancelButtonColor&&(r.style.backgroundColor=n.cancelButtonColor,lr(r,ae["default-outline"]))}function oC(e,t,r){const n=Rk(t);fy(e,r[`show${n}Button`],"inline-block"),Es(e,r[`${t}ButtonText`]||""),e.setAttribute("aria-label",r[`${t}ButtonAriaLabel`]||""),e.className=ae[t],hs(e,r,`${t}Button`)}const pde=(e,t)=>{const r=Nk();r&&(Es(r,t.closeButtonHtml||""),hs(r,t,"closeButton"),fy(r,t.showCloseButton),r.setAttribute("aria-label",t.closeButtonAriaLabel||""))},fde=(e,t)=>{const r=Vo();r&&(mde(r,t.backdrop),gde(r,t.position),yde(r,t.grow),hs(r,t,"container"))};function mde(e,t){typeof t=="string"?e.style.background=t:t||lr([document.documentElement,document.body],ae["no-backdrop"])}function gde(e,t){t&&(t in ae?lr(e,ae[t]):(Fo('The "position" parameter is not valid, defaulting to "center"'),lr(e,ae.center)))}function yde(e,t){t&&lr(e,ae[`grow-${t}`])}var Qr={innerParams:new WeakMap,domCache:new WeakMap};const vde=["input","file","range","select","radio","checkbox","textarea"],Ede=(e,t)=>{const r=br();if(!r)return;const n=Qr.innerParams.get(e),i=!n||t.input!==n.input;vde.forEach(o=>{const s=Zl(r,ae[o]);s&&(wde(o,t.inputAttributes),s.className=ae[o],i&&qi(s))}),t.input&&(i&&_de(t),Sde(t))},_de=e=>{if(!e.input)return;if(!Vn[e.input]){mh(`Unexpected type of input! Expected ${Object.keys(Vn).join(" | ")}, got "${e.input}"`);return}const t=zW(e.input);if(!t)return;const r=Vn[e.input](t,e);wi(t),e.inputAutoFocus&&setTimeout(()=>{HW(r)})},bde=e=>{for(let t=0;t<e.attributes.length;t++){const r=e.attributes[t].name;["id","type","value","style"].includes(r)||e.removeAttribute(r)}},wde=(e,t)=>{const r=br();if(!r)return;const n=oS(r,e);if(n){bde(n);for(const i in t)n.setAttribute(i,t[i])}},Sde=e=>{if(!e.input)return;const t=zW(e.input);t&&hs(t,e,"input")},jk=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},my=(e,t,r)=>{if(r.inputLabel){const n=document.createElement("label"),i=ae["input-label"];n.setAttribute("for",e.id),n.className=i,typeof r.customClass=="object"&&lr(n,r.customClass.inputLabel),n.innerText=r.inputLabel,t.insertAdjacentElement("beforebegin",n)}},zW=e=>{const t=br();if(t)return Zl(t,ae[e]||ae.input)},rb=(e,t)=>{["string","number"].includes(typeof t)?e.value=`${t}`:Ak(t)||Fo(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},Vn={};Vn.text=Vn.email=Vn.password=Vn.number=Vn.tel=Vn.url=Vn.search=Vn.date=Vn["datetime-local"]=Vn.time=Vn.week=Vn.month=(e,t)=>(rb(e,t.inputValue),my(e,e,t),jk(e,t),e.type=t.input,e);Vn.file=(e,t)=>(my(e,e,t),jk(e,t),e);Vn.range=(e,t)=>{const r=e.querySelector("input"),n=e.querySelector("output");return rb(r,t.inputValue),r.type=t.input,rb(n,t.inputValue),my(r,e,t),e};Vn.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const r=document.createElement("option");Es(r,t.inputPlaceholder),r.value="",r.disabled=!0,r.selected=!0,e.appendChild(r)}return my(e,e,t),e};Vn.radio=e=>(e.textContent="",e);Vn.checkbox=(e,t)=>{const r=oS(br(),"checkbox");r.value="1",r.checked=!!t.inputValue;const n=e.querySelector("span");return Es(n,t.inputPlaceholder||t.inputLabel),r};Vn.textarea=(e,t)=>{rb(e,t.inputValue),jk(e,t),my(e,e,t);const r=n=>parseInt(window.getComputedStyle(n).marginLeft)+parseInt(window.getComputedStyle(n).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const n=parseInt(window.getComputedStyle(br()).width),i=()=>{if(!document.body.contains(e))return;const o=e.offsetWidth+r(e);o>n?br().style.width=`${o}px`:Lu(br(),"width",t.width)};new MutationObserver(i).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const Tde=(e,t)=>{const r=xk();r&&(Dk(r),hs(r,t,"htmlContainer"),t.html?(Mk(t.html,r),wi(r,"block")):t.text?(r.textContent=t.text,wi(r,"block")):qi(r),Ede(e,t))},Cde=(e,t)=>{const r=$W();r&&(Dk(r),fy(r,t.footer,"block"),t.footer&&Mk(t.footer,r),hs(r,t,"footer"))},Rde=(e,t)=>{const r=Qr.innerParams.get(e),n=$f();if(n){if(r&&t.icon===r.icon){jM(n,t),MM(n,t);return}if(!t.icon&&!t.iconHtml){qi(n);return}if(t.icon&&Object.keys(tb).indexOf(t.icon)===-1){mh(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),qi(n);return}wi(n),jM(n,t),MM(n,t),lr(n,t.showClass&&t.showClass.icon)}},MM=(e,t)=>{for(const[r,n]of Object.entries(tb))t.icon!==r&&ea(e,n);lr(e,t.icon&&tb[t.icon]),Ode(e,t),Ide(),hs(e,t,"icon")},Ide=()=>{const e=br();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),r=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let n=0;n<r.length;n++)r[n].style.backgroundColor=t},Ade=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,xde=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,jM=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let r=e.innerHTML,n="";t.iconHtml?n=UM(t.iconHtml):t.icon==="success"?(n=Ade,r=r.replace(/ style=".*?"/g,"")):t.icon==="error"?n=xde:t.icon&&(n=UM({question:"?",warning:"!",info:"i"}[t.icon])),r.trim()!==n.trim()&&Es(e,n)},Ode=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const r of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])DM(e,r,"background-color",t.iconColor);DM(e,".swal2-success-ring","border-color",t.iconColor)}},UM=e=>`<div class="${ae["icon-content"]}">${e}</div>`,Nde=(e,t)=>{const r=BW();if(r){if(!t.imageUrl){qi(r);return}wi(r,""),r.setAttribute("src",t.imageUrl),r.setAttribute("alt",t.imageAlt||""),Lu(r,"width",t.imageWidth),Lu(r,"height",t.imageHeight),r.className=ae.image,hs(r,t,"image")}};let Uk=!1,KW=0,qW=0,YW=0,XW=0;const kde=e=>{e.addEventListener("mousedown",nb),document.body.addEventListener("mousemove",ib),e.addEventListener("mouseup",ob),e.addEventListener("touchstart",nb),document.body.addEventListener("touchmove",ib),e.addEventListener("touchend",ob)},Pde=e=>{e.removeEventListener("mousedown",nb),document.body.removeEventListener("mousemove",ib),e.removeEventListener("mouseup",ob),e.removeEventListener("touchstart",nb),document.body.removeEventListener("touchmove",ib),e.removeEventListener("touchend",ob)},nb=e=>{const t=br();if(e.target===t||$f().contains(e.target)){Uk=!0;const r=JW(e);KW=r.clientX,qW=r.clientY,YW=parseInt(t.style.insetInlineStart)||0,XW=parseInt(t.style.insetBlockStart)||0,lr(t,"swal2-dragging")}},ib=e=>{const t=br();if(Uk){let{clientX:r,clientY:n}=JW(e);t.style.insetInlineStart=`${YW+(r-KW)}px`,t.style.insetBlockStart=`${XW+(n-qW)}px`}},ob=()=>{const e=br();Uk=!1,ea(e,"swal2-dragging")},JW=e=>{let t=0,r=0;return e.type.startsWith("mouse")?(t=e.clientX,r=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,r=e.touches[0].clientY),{clientX:t,clientY:r}},Dde=(e,t)=>{const r=Vo(),n=br();if(!(!r||!n)){if(t.toast){Lu(r,"width",t.width),n.style.width="100%";const i=Wf();i&&n.insertBefore(i,$f())}else Lu(n,"width",t.width);Lu(n,"padding",t.padding),t.color&&(n.style.color=t.color),t.background&&(n.style.background=t.background),qi(rS()),Lde(n,t),t.draggable&&!t.toast?(lr(n,ae.draggable),kde(n)):(ea(n,ae.draggable),Pde(n))}},Lde=(e,t)=>{const r=t.showClass||{};e.className=`${ae.popup} ${Lo(e)?r.popup:""}`,t.toast?(lr([document.documentElement,document.body],ae["toast-shown"]),lr(e,ae.toast)):lr(e,ae.modal),hs(e,t,"popup"),typeof t.customClass=="string"&&lr(e,t.customClass),t.icon&&lr(e,ae[`icon-${t.icon}`])},Mde=(e,t)=>{const r=Ok();if(!r)return;const{progressSteps:n,currentProgressStep:i}=t;if(!n||n.length===0||i===void 0){qi(r);return}wi(r),r.textContent="",i>=n.length&&Fo("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),n.forEach((o,s)=>{const a=jde(o);if(r.appendChild(a),s===i&&lr(a,ae["active-progress-step"]),s!==n.length-1){const c=Ude(t);r.appendChild(c)}})},jde=e=>{const t=document.createElement("li");return lr(t,ae["progress-step"]),Es(t,e),t},Ude=e=>{const t=document.createElement("li");return lr(t,ae["progress-step-line"]),e.progressStepsDistance&&Lu(t,"width",e.progressStepsDistance),t},Fde=(e,t)=>{const r=VW();r&&(Dk(r),fy(r,t.title||t.titleText,"block"),t.title&&Mk(t.title,r),t.titleText&&(r.innerText=t.titleText),hs(r,t,"title"))},QW=(e,t)=>{Dde(e,t),fde(e,t),Mde(e,t),Rde(e,t),Nde(e,t),Fde(e,t),pde(e,t),Tde(e,t),dde(e,t),Cde(e,t);const r=br();typeof t.didRender=="function"&&r&&t.didRender(r),gt.eventEmitter.emit("didRender",r)},Vde=()=>Lo(br()),ZW=()=>{var e;return(e=gc())===null||e===void 0?void 0:e.click()},Bde=()=>{var e;return(e=gh())===null||e===void 0?void 0:e.click()},$de=()=>{var e;return(e=Hf())===null||e===void 0?void 0:e.click()},Gf=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),eG=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},Hde=(e,t,r)=>{eG(e),t.toast||(e.keydownHandler=n=>Gde(t,n,r),e.keydownTarget=t.keydownListenerCapture?window:br(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},_x=(e,t)=>{var r;const n=kk();if(n.length){e=e+t,e===n.length?e=0:e===-1&&(e=n.length-1),n[e].focus();return}(r=br())===null||r===void 0||r.focus()},tG=["ArrowRight","ArrowDown"],Wde=["ArrowLeft","ArrowUp"],Gde=(e,t,r)=>{e&&(t.isComposing||t.keyCode===229||(e.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?zde(t,e):t.key==="Tab"?Kde(t):[...tG,...Wde].includes(t.key)?qde(t.key):t.key==="Escape"&&Yde(t,e,r)))},zde=(e,t)=>{if(!tS(t.allowEnterKey))return;const r=oS(br(),t.input);if(e.target&&r&&e.target instanceof HTMLElement&&e.target.outerHTML===r.outerHTML){if(["textarea","file"].includes(t.input))return;ZW(),e.preventDefault()}},Kde=e=>{const t=e.target,r=kk();let n=-1;for(let i=0;i<r.length;i++)if(t===r[i]){n=i;break}e.shiftKey?_x(n,-1):_x(n,1),e.stopPropagation(),e.preventDefault()},qde=e=>{const t=py(),r=gc(),n=gh(),i=Hf();if(!t||!r||!n||!i)return;const o=[r,n,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=tG.includes(e)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let c=0;c<t.children.length;c++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&Lo(a))break}a instanceof HTMLButtonElement&&a.focus()}},Yde=(e,t,r)=>{tS(t.allowEscapeKey)&&(e.preventDefault(),r(Gf.esc))};var df={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const Xde=()=>{const e=Vo();Array.from(document.body.children).forEach(r=>{r.contains(e)||(r.hasAttribute("aria-hidden")&&r.setAttribute("data-previous-aria-hidden",r.getAttribute("aria-hidden")||""),r.setAttribute("aria-hidden","true"))})},rG=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},nG=typeof window<"u"&&!!window.GestureEvent,Jde=()=>{if(nG&&!tl(document.body,ae.iosfix)){const e=document.body.scrollTop;document.body.style.top=`${e*-1}px`,lr(document.body,ae.iosfix),Qde()}},Qde=()=>{const e=Vo();if(!e)return;let t;e.ontouchstart=r=>{t=Zde(r)},e.ontouchmove=r=>{t&&(r.preventDefault(),r.stopPropagation())}},Zde=e=>{const t=e.target,r=Vo(),n=xk();return!r||!n||eue(e)||tue(e)?!1:t===r||!LM(r)&&t instanceof HTMLElement&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(LM(n)&&n.contains(t))},eue=e=>e.touches&&e.touches.length&&e.touches[0].touchType==="stylus",tue=e=>e.touches&&e.touches.length>1,rue=()=>{if(tl(document.body,ae.iosfix)){const e=parseInt(document.body.style.top,10);ea(document.body,ae.iosfix),document.body.style.top="",document.body.scrollTop=e*-1}},nue=()=>{const e=document.createElement("div");e.className=ae["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let Bp=null;const iue=e=>{Bp===null&&(document.body.scrollHeight>window.innerHeight||e==="scroll")&&(Bp=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Bp+nue()}px`)},oue=()=>{Bp!==null&&(document.body.style.paddingRight=`${Bp}px`,Bp=null)};function iG(e,t,r,n){iS()?FM(e,n):(Hle(r).then(()=>FM(e,n)),eG(gt)),nG?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),Pk()&&(oue(),rue(),rG()),sue()}function sue(){ea([document.documentElement,document.body],[ae.shown,ae["height-auto"],ae["no-backdrop"],ae["toast-shown"]])}function ed(e){e=cue(e);const t=df.swalPromiseResolve.get(this),r=aue(this);this.isAwaitingPromise?e.isDismissed||(gy(this),t(e)):r&&t(e)}const aue=e=>{const t=br();if(!t)return!1;const r=Qr.innerParams.get(e);if(!r||tl(t,r.hideClass.popup))return!1;ea(t,r.showClass.popup),lr(t,r.hideClass.popup);const n=Vo();return ea(n,r.showClass.backdrop),lr(n,r.hideClass.backdrop),lue(e,t,r),!0};function oG(e){const t=df.swalPromiseReject.get(this);gy(this),t&&t(e)}const gy=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,Qr.innerParams.get(e)||e._destroy())},cue=e=>typeof e>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),lue=(e,t,r)=>{var n;const i=Vo(),o=GW(t);typeof r.willClose=="function"&&r.willClose(t),(n=gt.eventEmitter)===null||n===void 0||n.emit("willClose",t),o?due(e,t,i,r.returnFocus,r.didClose):iG(e,i,r.returnFocus,r.didClose)},due=(e,t,r,n,i)=>{gt.swalCloseEventFinishedCallback=iG.bind(null,e,r,n,i);const o=function(s){if(s.target===t){var a;(a=gt.swalCloseEventFinishedCallback)===null||a===void 0||a.call(gt),delete gt.swalCloseEventFinishedCallback,t.removeEventListener("animationend",o),t.removeEventListener("transitionend",o)}};t.addEventListener("animationend",o),t.addEventListener("transitionend",o)},FM=(e,t)=>{setTimeout(()=>{var r;typeof t=="function"&&t.bind(e.params)(),(r=gt.eventEmitter)===null||r===void 0||r.emit("didClose"),e._destroy&&e._destroy()})},uf=e=>{let t=br();if(t||new oe,t=br(),!t)return;const r=Wf();iS()?qi($f()):uue(t,e),wi(r),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},uue=(e,t)=>{const r=py(),n=Wf();!r||!n||(!t&&Lo(gc())&&(t=gc()),wi(r),t&&(qi(t),n.setAttribute("data-button-to-replace",t.className),r.insertBefore(n,t)),lr([e,r],ae.loading))},hue=(e,t)=>{t.input==="select"||t.input==="radio"?yue(e,t):["text","email","number","tel","textarea"].some(r=>r===t.input)&&(Ik(t.inputValue)||Ak(t.inputValue))&&(uf(gc()),vue(e,t))},pue=(e,t)=>{const r=e.getInput();if(!r)return null;switch(t.input){case"checkbox":return fue(r);case"radio":return mue(r);case"file":return gue(r);default:return t.inputAutoTrim?r.value.trim():r.value}},fue=e=>e.checked?1:0,mue=e=>e.checked?e.value:null,gue=e=>e.files&&e.files.length?e.getAttribute("multiple")!==null?e.files:e.files[0]:null,yue=(e,t)=>{const r=br();if(!r)return;const n=i=>{t.input==="select"?Eue(r,sb(i),t):t.input==="radio"&&_ue(r,sb(i),t)};Ik(t.inputOptions)||Ak(t.inputOptions)?(uf(gc()),uy(t.inputOptions).then(i=>{e.hideLoading(),n(i)})):typeof t.inputOptions=="object"?n(t.inputOptions):mh(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},vue=(e,t)=>{const r=e.getInput();r&&(qi(r),uy(t.inputValue).then(n=>{r.value=t.input==="number"?`${parseFloat(n)||0}`:`${n}`,wi(r),r.focus(),e.hideLoading()}).catch(n=>{mh(`Error in inputValue promise: ${n}`),r.value="",wi(r),r.focus(),e.hideLoading()}))};function Eue(e,t,r){const n=Zl(e,ae.select);if(!n)return;const i=(o,s,a)=>{const c=document.createElement("option");c.value=a,Es(c,s),c.selected=sG(a,r.inputValue),o.appendChild(c)};t.forEach(o=>{const s=o[0],a=o[1];if(Array.isArray(a)){const c=document.createElement("optgroup");c.label=s,c.disabled=!1,n.appendChild(c),a.forEach(l=>i(c,l[1],l[0]))}else i(n,a,s)}),n.focus()}function _ue(e,t,r){const n=Zl(e,ae.radio);if(!n)return;t.forEach(o=>{const s=o[0],a=o[1],c=document.createElement("input"),l=document.createElement("label");c.type="radio",c.name=ae.radio,c.value=s,sG(s,r.inputValue)&&(c.checked=!0);const d=document.createElement("span");Es(d,a),d.className=ae.label,l.appendChild(c),l.appendChild(d),n.appendChild(l)});const i=n.querySelectorAll("input");i.length&&i[0].focus()}const sb=e=>{const t=[];return e instanceof Map?e.forEach((r,n)=>{let i=r;typeof i=="object"&&(i=sb(i)),t.push([n,i])}):Object.keys(e).forEach(r=>{let n=e[r];typeof n=="object"&&(n=sb(n)),t.push([r,n])}),t},sG=(e,t)=>!!t&&t.toString()===e.toString(),bue=e=>{const t=Qr.innerParams.get(e);e.disableButtons(),t.input?aG(e,"confirm"):Vk(e,!0)},wue=e=>{const t=Qr.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?aG(e,"deny"):Fk(e,!1)},Sue=(e,t)=>{e.disableButtons(),t(Gf.cancel)},aG=(e,t)=>{const r=Qr.innerParams.get(e);if(!r.input){mh(`The "input" parameter is needed to be set when using returnInputValueOn${Rk(t)}`);return}const n=e.getInput(),i=pue(e,r);r.inputValidator?Tue(e,i,t):n&&!n.checkValidity()?(e.enableButtons(),e.showValidationMessage(r.validationMessage||n.validationMessage)):t==="deny"?Fk(e,i):Vk(e,i)},Tue=(e,t,r)=>{const n=Qr.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>uy(n.inputValidator(t,n.validationMessage))).then(o=>{e.enableButtons(),e.enableInput(),o?e.showValidationMessage(o):r==="deny"?Fk(e,t):Vk(e,t)})},Fk=(e,t)=>{const r=Qr.innerParams.get(e||void 0);r.showLoaderOnDeny&&uf(gh()),r.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>uy(r.preDeny(t,r.validationMessage))).then(i=>{i===!1?(e.hideLoading(),gy(e)):e.close({isDenied:!0,value:typeof i>"u"?t:i})}).catch(i=>cG(e||void 0,i))):e.close({isDenied:!0,value:t})},VM=(e,t)=>{e.close({isConfirmed:!0,value:t})},cG=(e,t)=>{e.rejectPromise(t)},Vk=(e,t)=>{const r=Qr.innerParams.get(e||void 0);r.showLoaderOnConfirm&&uf(),r.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>uy(r.preConfirm(t,r.validationMessage))).then(i=>{Lo(rS())||i===!1?(e.hideLoading(),gy(e)):VM(e,typeof i>"u"?t:i)}).catch(i=>cG(e||void 0,i))):VM(e,t)};function ab(){const e=Qr.innerParams.get(this);if(!e)return;const t=Qr.domCache.get(this);qi(t.loader),iS()?e.icon&&wi($f()):Cue(t),ea([t.popup,t.actions],ae.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const Cue=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?wi(t[0],"inline-block"):Qle()&&qi(e.actions)};function lG(){const e=Qr.innerParams.get(this),t=Qr.domCache.get(this);return t?oS(t.popup,e.input):null}function dG(e,t,r){const n=Qr.domCache.get(e);t.forEach(i=>{n[i].disabled=r})}function uG(e,t){const r=br();if(!(!r||!e))if(e.type==="radio"){const n=r.querySelectorAll(`[name="${ae.radio}"]`);for(let i=0;i<n.length;i++)n[i].disabled=t}else e.disabled=t}function hG(){dG(this,["confirmButton","denyButton","cancelButton"],!1)}function pG(){dG(this,["confirmButton","denyButton","cancelButton"],!0)}function fG(){uG(this.getInput(),!1)}function mG(){uG(this.getInput(),!0)}function gG(e){const t=Qr.domCache.get(this),r=Qr.innerParams.get(this);Es(t.validationMessage,e),t.validationMessage.className=ae["validation-message"],r.customClass&&r.customClass.validationMessage&&lr(t.validationMessage,r.customClass.validationMessage),wi(t.validationMessage);const n=this.getInput();n&&(n.setAttribute("aria-invalid","true"),n.setAttribute("aria-describedby",ae["validation-message"]),HW(n),lr(n,ae.inputerror))}function yG(){const e=Qr.domCache.get(this);e.validationMessage&&qi(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),ea(t,ae.inputerror))}const $p={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},Rue=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Iue={allowEnterKey:void 0},Aue=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],vG=e=>Object.prototype.hasOwnProperty.call($p,e),EG=e=>Rue.indexOf(e)!==-1,_G=e=>Iue[e],xue=e=>{vG(e)||Fo(`Unknown parameter "${e}"`)},Oue=e=>{Aue.includes(e)&&Fo(`The parameter "${e}" is incompatible with toasts`)},Nue=e=>{const t=_G(e);t&&FW(e,t)},kue=e=>{e.backdrop===!1&&e.allowOutsideClick&&Fo('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const t in e)xue(t),e.toast&&Oue(t),Nue(t)};function bG(e){const t=br(),r=Qr.innerParams.get(this);if(!t||tl(t,r.hideClass.popup)){Fo("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const n=Pue(e),i=Object.assign({},r,n);QW(this,i),Qr.innerParams.set(this,i),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const Pue=e=>{const t={};return Object.keys(e).forEach(r=>{EG(r)?t[r]=e[r]:Fo(`Invalid parameter to update: ${r}`)}),t};function wG(){const e=Qr.domCache.get(this),t=Qr.innerParams.get(this);if(!t){SG(this);return}e.popup&&gt.swalCloseEventFinishedCallback&&(gt.swalCloseEventFinishedCallback(),delete gt.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),gt.eventEmitter.emit("didDestroy"),Due(this)}const Due=e=>{SG(e),delete e.params,delete gt.keydownHandler,delete gt.keydownTarget,delete gt.currentInstance},SG=e=>{e.isAwaitingPromise?(sC(Qr,e),e.isAwaitingPromise=!0):(sC(df,e),sC(Qr,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},sC=(e,t)=>{for(const r in e)e[r].delete(t)};var Lue=Object.freeze({__proto__:null,_destroy:wG,close:ed,closeModal:ed,closePopup:ed,closeToast:ed,disableButtons:pG,disableInput:mG,disableLoading:ab,enableButtons:hG,enableInput:fG,getInput:lG,handleAwaitingPromise:gy,hideLoading:ab,rejectPromise:oG,resetValidationMessage:yG,showValidationMessage:gG,update:bG});const Mue=(e,t,r)=>{e.toast?jue(e,t,r):(Fue(t),Vue(t),Bue(e,t,r))},jue=(e,t,r)=>{t.popup.onclick=()=>{e&&(Uue(e)||e.timer||e.input)||r(Gf.close)}},Uue=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let cb=!1;const Fue=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(cb=!0)}}},Vue=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(r){e.popup.onmouseup=()=>{},(r.target===e.popup||r.target instanceof HTMLElement&&e.popup.contains(r.target))&&(cb=!0)}}},Bue=(e,t,r)=>{t.container.onclick=n=>{if(cb){cb=!1;return}n.target===t.container&&tS(e.allowOutsideClick)&&r(Gf.backdrop)}},$ue=e=>typeof e=="object"&&e.jquery,BM=e=>e instanceof Element||$ue(e),Hue=e=>{const t={};return typeof e[0]=="object"&&!BM(e[0])?Object.assign(t,e[0]):["title","html","icon"].forEach((r,n)=>{const i=e[n];typeof i=="string"||BM(i)?t[r]=i:i!==void 0&&mh(`Unexpected type of ${r}! Expected "string" or "Element", got ${typeof i}`)}),t};function Wue(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new this(...t)}function Gue(e){class t extends this{_main(n,i){return super._main(n,Object.assign({},e,i))}}return t}const zue=()=>gt.timeout&&gt.timeout.getTimerLeft(),TG=()=>{if(gt.timeout)return Zle(),gt.timeout.stop()},CG=()=>{if(gt.timeout){const e=gt.timeout.start();return Lk(e),e}},Kue=()=>{const e=gt.timeout;return e&&(e.running?TG():CG())},que=e=>{if(gt.timeout){const t=gt.timeout.increase(e);return Lk(t,!0),t}},Yue=()=>!!(gt.timeout&&gt.timeout.isRunning());let $M=!1;const bx={};function Xue(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"data-swal-template";bx[e]=this,$M||(document.body.addEventListener("click",Jue),$M=!0)}const Jue=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const r in bx){const n=t.getAttribute(r);if(n){bx[r].fire({template:n});return}}};class Que{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,r){const n=this._getHandlersByEventName(t);n.includes(r)||n.push(r)}once(t,r){var n=this;const i=function(){n.removeListener(t,i);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];r.apply(n,s)};this.on(t,i)}emit(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this._getHandlersByEventName(t).forEach(o=>{try{o.apply(this,n)}catch(s){console.error(s)}})}removeListener(t,r){const n=this._getHandlersByEventName(t),i=n.indexOf(r);i>-1&&n.splice(i,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}gt.eventEmitter=new Que;const Zue=(e,t)=>{gt.eventEmitter.on(e,t)},ehe=(e,t)=>{gt.eventEmitter.once(e,t)},the=(e,t)=>{if(!e){gt.eventEmitter.reset();return}t?gt.eventEmitter.removeListener(e,t):gt.eventEmitter.removeAllListeners(e)};var rhe=Object.freeze({__proto__:null,argsToParams:Hue,bindClickHandler:Xue,clickCancel:$de,clickConfirm:ZW,clickDeny:Bde,enableLoading:uf,fire:Wue,getActions:py,getCancelButton:Hf,getCloseButton:Nk,getConfirmButton:gc,getContainer:Vo,getDenyButton:gh,getFocusableElements:kk,getFooter:$W,getHtmlContainer:xk,getIcon:$f,getIconContent:Kle,getImage:BW,getInputLabel:qle,getLoader:Wf,getPopup:br,getProgressSteps:Ok,getTimerLeft:zue,getTimerProgressBar:nS,getTitle:VW,getValidationMessage:rS,increaseTimer:que,isDeprecatedParameter:_G,isLoading:Xle,isTimerRunning:Yue,isUpdatableParameter:EG,isValidParameter:vG,isVisible:Vde,mixin:Gue,off:the,on:Zue,once:ehe,resumeTimer:CG,showLoading:uf,stopTimer:TG,toggleTimer:Kue});class nhe{constructor(t,r){this.callback=t,this.remaining=r,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const r=this.running;return r&&this.stop(),this.remaining+=t,r&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const RG=["swal-title","swal-html","swal-footer"],ihe=e=>{const t=typeof e.template=="string"?document.querySelector(e.template):e.template;if(!t)return{};const r=t.content;return hhe(r),Object.assign(ohe(r),she(r),ahe(r),che(r),lhe(r),dhe(r),uhe(r,RG))},ohe=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(n=>{Xu(n,["name","value"]);const i=n.getAttribute("name"),o=n.getAttribute("value");!i||!o||(typeof $p[i]=="boolean"?t[i]=o!=="false":typeof $p[i]=="object"?t[i]=JSON.parse(o):t[i]=o)}),t},she=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(n=>{const i=n.getAttribute("name"),o=n.getAttribute("value");!i||!o||(t[i]=new Function(`return ${o}`)())}),t},ahe=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(n=>{Xu(n,["type","color","aria-label"]);const i=n.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(t[`${i}ButtonText`]=n.innerHTML,t[`show${Rk(i)}Button`]=!0,n.hasAttribute("color")&&(t[`${i}ButtonColor`]=n.getAttribute("color")),n.hasAttribute("aria-label")&&(t[`${i}ButtonAriaLabel`]=n.getAttribute("aria-label")))}),t},che=e=>{const t={},r=e.querySelector("swal-image");return r&&(Xu(r,["src","width","height","alt"]),r.hasAttribute("src")&&(t.imageUrl=r.getAttribute("src")||void 0),r.hasAttribute("width")&&(t.imageWidth=r.getAttribute("width")||void 0),r.hasAttribute("height")&&(t.imageHeight=r.getAttribute("height")||void 0),r.hasAttribute("alt")&&(t.imageAlt=r.getAttribute("alt")||void 0)),t},lhe=e=>{const t={},r=e.querySelector("swal-icon");return r&&(Xu(r,["type","color"]),r.hasAttribute("type")&&(t.icon=r.getAttribute("type")),r.hasAttribute("color")&&(t.iconColor=r.getAttribute("color")),t.iconHtml=r.innerHTML),t},dhe=e=>{const t={},r=e.querySelector("swal-input");r&&(Xu(r,["type","label","placeholder","value"]),t.input=r.getAttribute("type")||"text",r.hasAttribute("label")&&(t.inputLabel=r.getAttribute("label")),r.hasAttribute("placeholder")&&(t.inputPlaceholder=r.getAttribute("placeholder")),r.hasAttribute("value")&&(t.inputValue=r.getAttribute("value")));const n=Array.from(e.querySelectorAll("swal-input-option"));return n.length&&(t.inputOptions={},n.forEach(i=>{Xu(i,["value"]);const o=i.getAttribute("value");if(!o)return;const s=i.innerHTML;t.inputOptions[o]=s})),t},uhe=(e,t)=>{const r={};for(const n in t){const i=t[n],o=e.querySelector(i);o&&(Xu(o,[]),r[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return r},hhe=e=>{const t=RG.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(r=>{const n=r.tagName.toLowerCase();t.includes(n)||Fo(`Unrecognized element <${n}>`)})},Xu=(e,t)=>{Array.from(e.attributes).forEach(r=>{t.indexOf(r.name)===-1&&Fo([`Unrecognized attribute "${r.name}" on <${e.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},IG=10,phe=e=>{const t=Vo(),r=br();typeof e.willOpen=="function"&&e.willOpen(r),gt.eventEmitter.emit("willOpen",r);const i=window.getComputedStyle(document.body).overflowY;ghe(t,r,e),setTimeout(()=>{fhe(t,r)},IG),Pk()&&(mhe(t,e.scrollbarPadding,i),Xde()),!iS()&&!gt.previousActiveElement&&(gt.previousActiveElement=document.activeElement),typeof e.didOpen=="function"&&setTimeout(()=>e.didOpen(r)),gt.eventEmitter.emit("didOpen",r),ea(t,ae["no-transition"])},lb=e=>{const t=br();if(e.target!==t)return;const r=Vo();t.removeEventListener("animationend",lb),t.removeEventListener("transitionend",lb),r.style.overflowY="auto"},fhe=(e,t)=>{GW(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",lb),t.addEventListener("transitionend",lb)):e.style.overflowY="auto"},mhe=(e,t,r)=>{Jde(),t&&r!=="hidden"&&iue(r),setTimeout(()=>{e.scrollTop=0})},ghe=(e,t,r)=>{lr(e,r.showClass.backdrop),r.animation?(t.style.setProperty("opacity","0","important"),wi(t,"grid"),setTimeout(()=>{lr(t,r.showClass.popup),t.style.removeProperty("opacity")},IG)):wi(t,"grid"),lr([document.documentElement,document.body],ae.shown),r.heightAuto&&r.backdrop&&!r.toast&&lr([document.documentElement,document.body],ae["height-auto"])};var HM={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function yhe(e){e.inputValidator||(e.input==="email"&&(e.inputValidator=HM.email),e.input==="url"&&(e.inputValidator=HM.url))}function vhe(e){(!e.target||typeof e.target=="string"&&!document.querySelector(e.target)||typeof e.target!="string"&&!e.target.appendChild)&&(Fo('Target parameter is not valid, defaulting to "body"'),e.target="body")}function Ehe(e){yhe(e),e.showLoaderOnConfirm&&!e.preConfirm&&Fo(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),vhe(e),typeof e.title=="string"&&(e.title=e.title.split(`
`).join("<br />")),ade(e)}let rc;var wv=new WeakMap;class zn{constructor(){if(Fle(this,wv,void 0),typeof window>"u")return;rc=this;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];const i=Object.freeze(this.constructor.argsToParams(r));this.params=i,this.isAwaitingPromise=!1,Vle(wv,this,this._main(rc.params))}_main(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(kue(Object.assign({},r,t)),gt.currentInstance){const o=df.swalPromiseResolve.get(gt.currentInstance),{isAwaitingPromise:s}=gt.currentInstance;gt.currentInstance._destroy(),s||o({isDismissed:!0}),Pk()&&rG()}gt.currentInstance=rc;const n=bhe(t,r);Ehe(n),Object.freeze(n),gt.timeout&&(gt.timeout.stop(),delete gt.timeout),clearTimeout(gt.restoreFocusTimeout);const i=whe(rc);return QW(rc,n),Qr.innerParams.set(rc,n),_he(rc,i,n)}then(t){return kM(wv,this).then(t)}finally(t){return kM(wv,this).finally(t)}}const _he=(e,t,r)=>new Promise((n,i)=>{const o=s=>{e.close({isDismissed:!0,dismiss:s})};df.swalPromiseResolve.set(e,n),df.swalPromiseReject.set(e,i),t.confirmButton.onclick=()=>{bue(e)},t.denyButton.onclick=()=>{wue(e)},t.cancelButton.onclick=()=>{Sue(e,o)},t.closeButton.onclick=()=>{o(Gf.close)},Mue(r,t,o),Hde(gt,r,o),hue(e,r),phe(r),She(gt,r,o),The(t,r),setTimeout(()=>{t.container.scrollTop=0})}),bhe=(e,t)=>{const r=ihe(e),n=Object.assign({},$p,t,r,e);return n.showClass=Object.assign({},$p.showClass,n.showClass),n.hideClass=Object.assign({},$p.hideClass,n.hideClass),n.animation===!1&&(n.showClass={backdrop:"swal2-noanimation"},n.hideClass={}),n},whe=e=>{const t={popup:br(),container:Vo(),actions:py(),confirmButton:gc(),denyButton:gh(),cancelButton:Hf(),loader:Wf(),closeButton:Nk(),validationMessage:rS(),progressSteps:Ok()};return Qr.domCache.set(e,t),t},She=(e,t,r)=>{const n=nS();qi(n),t.timer&&(e.timeout=new nhe(()=>{r("timer"),delete e.timeout},t.timer),t.timerProgressBar&&(wi(n),hs(n,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&Lk(t.timer)})))},The=(e,t)=>{if(!t.toast){if(!tS(t.allowEnterKey)){FW("allowEnterKey"),Ihe();return}Che(e)||Rhe(e,t)||_x(-1,1)}},Che=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const r of t)if(r instanceof HTMLElement&&Lo(r))return r.focus(),!0;return!1},Rhe=(e,t)=>t.focusDeny&&Lo(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&Lo(e.cancelButton)?(e.cancelButton.focus(),!0):t.focusConfirm&&Lo(e.confirmButton)?(e.confirmButton.focus(),!0):!1,Ihe=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const e=new Date,t=localStorage.getItem("swal-initiation");t?(e.getTime()-Date.parse(t))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const r=document.createElement("audio");r.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",r.loop=!0,document.body.appendChild(r),setTimeout(()=>{r.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${e}`)}zn.prototype.disableButtons=pG;zn.prototype.enableButtons=hG;zn.prototype.getInput=lG;zn.prototype.disableInput=mG;zn.prototype.enableInput=fG;zn.prototype.hideLoading=ab;zn.prototype.disableLoading=ab;zn.prototype.showValidationMessage=gG;zn.prototype.resetValidationMessage=yG;zn.prototype.close=ed;zn.prototype.closePopup=ed;zn.prototype.closeModal=ed;zn.prototype.closeToast=ed;zn.prototype.rejectPromise=oG;zn.prototype.update=bG;zn.prototype._destroy=wG;Object.assign(zn,rhe);Object.keys(Lue).forEach(e=>{zn[e]=function(){return rc&&rc[e]?rc[e](...arguments):null}});zn.DismissReason=Gf;zn.version="11.15.2";const oe=zn;oe.default=oe;typeof document<"u"&&function(e,t){var r=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(r),r.styleSheet)r.styleSheet.disabled||(r.styleSheet.cssText=t);else try{r.innerHTML=t}catch{r.innerText=t}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:hsl(0,0%,33%);font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):focus-visible{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):focus-visible{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):focus-visible{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus-visible{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:0;padding:1em 1.6em .3em;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid hsl(0,0%,85%);border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:hsl(0,0%,94%);color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:rgb(249.95234375,205.965625,167.74765625);color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:rgb(156.7033492823,224.2822966507,246.2966507177);color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:rgb(200.8064516129,217.9677419355,225.1935483871);color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}');const yh="http://localhost:5000/api";async function Ahe(e){try{const t=await Ce.post(`${yh}/user/login`,e);return console.log(t.data),await sessionStorage.setItem("token",t.data.jwtToken),t.data.userData}catch(t){return console.log(`error ${JSON.stringify(t)}`),t.response.status=="400"&&oe.fire({title:"Failed",icon:"error",text:"username or password is wrong"}),!1}}async function xhe(e){try{return(await Ce.post(`${yh}/user/createAccountGoogle`,e)).data.userData}catch(t){console.log(t)}}async function Ohe(e){try{return(await Ce.post(`${yh}/user/loginUsingGoogle`,e)).data.userData}catch(t){console.log(t)}}async function Nhe({email:e}){try{const t=await Ce.post(`${yh}/user/forgotPasswordOtp`,{email:e},{withCredentials:!0});return!0}catch(t){return console.log(t),!1}}async function khe({email:e,otp:t}){try{const r=await Ce.post(`${yh}/user/checkForgotPasswordOtp`,{email:e,otp:t},{withCredentials:!0});return console.log(r.data),!0}catch(r){return console.log(r),!1}}async function Phe({password:e,email:t}){try{const r=await Ce.post(`${yh}/user/forgotPassword/reset`,{email:t,password:e},{withCredentials:!0});return console.log(r.data),!0}catch(r){return console.log(r),!1}}async function Dhe({email:e,password:t}){try{const r=await Ce.post(`${yh}/user/password/reset`,{password:t,email:e},{headers:{Authorization:`bearer ${sessionStorage.getItem("token")}`}});return console.log(r.data),!0}catch(r){return console.log(r),!1}}var AG={exports:{}},xG={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy=T;function Lhe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mhe=typeof Object.is=="function"?Object.is:Lhe,jhe=yy.useSyncExternalStore,Uhe=yy.useRef,Fhe=yy.useEffect,Vhe=yy.useMemo,Bhe=yy.useDebugValue;xG.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var o=Uhe(null);if(o.current===null){var s={hasValue:!1,value:null};o.current=s}else s=o.current;o=Vhe(function(){function c(f){if(!l){if(l=!0,d=f,f=n(f),i!==void 0&&s.hasValue){var m=s.value;if(i(m,f))return u=m}return u=f}if(m=u,Mhe(d,f))return m;var g=n(f);return i!==void 0&&i(m,g)?(d=f,m):(d=f,u=g)}var l=!1,d,u,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,i]);var a=jhe(e,o[0],o[1]);return Fhe(function(){s.hasValue=!0,s.value=a},[a]),Bhe(a),a};AG.exports=xG;var $he=AG.exports;function Hhe(e){e()}function Whe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Hhe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var WM={notify(){},get:()=>[]};function Ghe(e,t){let r,n=WM,i=0,o=!1;function s(g){d();const y=n.subscribe(g);let v=!1;return()=>{v||(v=!0,y(),u())}}function a(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function l(){return o}function d(){i++,r||(r=e.subscribe(c),n=Whe())}function u(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=WM)}function p(){o||(o=!0,d())}function f(){o&&(o=!1,u())}const m={addNestedSub:s,notifyNestedSubs:a,handleChangeWrapper:c,isSubscribed:l,trySubscribe:p,tryUnsubscribe:f,getListeners:()=>n};return m}var zhe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Khe=zhe(),qhe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Yhe=qhe(),Xhe=()=>Khe||Yhe?T.useLayoutEffect:T.useEffect,Jhe=Xhe(),aC=Symbol.for("react-redux-context"),cC=typeof globalThis<"u"?globalThis:{};function Qhe(){if(!T.createContext)return{};const e=cC[aC]??(cC[aC]=new Map);let t=e.get(T.createContext);return t||(t=T.createContext(null),e.set(T.createContext,t)),t}var Rd=Qhe();function Zhe(e){const{children:t,context:r,serverState:n,store:i}=e,o=T.useMemo(()=>{const c=Ghe(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),s=T.useMemo(()=>i.getState(),[i]);Jhe(()=>{const{subscription:c}=o;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[o,s]);const a=r||Rd;return T.createElement(a.Provider,{value:o},t)}var epe=Zhe;function Bk(e=Rd){return function(){return T.useContext(e)}}var OG=Bk();function NG(e=Rd){const t=e===Rd?OG:Bk(e),r=()=>{const{store:n}=t();return n};return Object.assign(r,{withTypes:()=>r}),r}var tpe=NG();function rpe(e=Rd){const t=e===Rd?tpe:NG(e),r=()=>t().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var zf=rpe(),npe=(e,t)=>e===t;function ipe(e=Rd){const t=e===Rd?OG:Bk(e),r=(n,i={})=>{const{equalityFn:o=npe}=typeof i=="function"?{equalityFn:i}:i,s=t(),{store:a,subscription:c,getServerState:l}=s;T.useRef(!0);const d=T.useCallback({[n.name](p){return n(p)}}[n.name],[n]),u=$he.useSyncExternalStoreWithSelector(c.addNestedSub,a.getState,l||a.getState,d,o);return T.useDebugValue(u),u};return Object.assign(r,{withTypes:()=>r}),r}var lo=ipe();function Ii(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ope=typeof Symbol=="function"&&Symbol.observable||"@@observable",GM=ope,lC=()=>Math.random().toString(36).substring(7).split("").join("."),spe={INIT:`@@redux/INIT${lC()}`,REPLACE:`@@redux/REPLACE${lC()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${lC()}`},db=spe;function $k(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function kG(e,t,r){if(typeof e!="function")throw new Error(Ii(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ii(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Ii(1));return r(kG)(e,t)}let n=e,i=t,o=new Map,s=o,a=0,c=!1;function l(){s===o&&(s=new Map,o.forEach((y,v)=>{s.set(v,y)}))}function d(){if(c)throw new Error(Ii(3));return i}function u(y){if(typeof y!="function")throw new Error(Ii(4));if(c)throw new Error(Ii(5));let v=!0;l();const E=a++;return s.set(E,y),function(){if(v){if(c)throw new Error(Ii(6));v=!1,l(),s.delete(E),o=null}}}function p(y){if(!$k(y))throw new Error(Ii(7));if(typeof y.type>"u")throw new Error(Ii(8));if(typeof y.type!="string")throw new Error(Ii(17));if(c)throw new Error(Ii(9));try{c=!0,i=n(i,y)}finally{c=!1}return(o=s).forEach(E=>{E()}),y}function f(y){if(typeof y!="function")throw new Error(Ii(10));n=y,p({type:db.REPLACE})}function m(){const y=u;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(Ii(11));function E(){const S=v;S.next&&S.next(d())}return E(),{unsubscribe:y(E)}},[GM](){return this}}}return p({type:db.INIT}),{dispatch:p,subscribe:u,getState:d,replaceReducer:f,[GM]:m}}function ape(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:db.INIT})>"u")throw new Error(Ii(12));if(typeof r(void 0,{type:db.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ii(13))})}function cpe(e){const t=Object.keys(e),r={};for(let o=0;o<t.length;o++){const s=t[o];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let i;try{ape(r)}catch(o){i=o}return function(s={},a){if(i)throw i;let c=!1;const l={};for(let d=0;d<n.length;d++){const u=n[d],p=r[u],f=s[u],m=p(f,a);if(typeof m>"u")throw a&&a.type,new Error(Ii(14));l[u]=m,c=c||m!==f}return c=c||n.length!==Object.keys(s).length,c?l:s}}function ub(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function lpe(...e){return t=>(r,n)=>{const i=t(r,n);let o=()=>{throw new Error(Ii(15))};const s={getState:i.getState,dispatch:(c,...l)=>o(c,...l)},a=e.map(c=>c(s));return o=ub(...a)(i.dispatch),{...i,dispatch:o}}}function dpe(e){return $k(e)&&"type"in e&&typeof e.type=="string"}var PG=Symbol.for("immer-nothing"),zM=Symbol.for("immer-draftable"),ps=Symbol.for("immer-state");function Ca(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var hf=Object.getPrototypeOf;function Ju(e){return!!e&&!!e[ps]}function ll(e){var t;return e?DG(e)||Array.isArray(e)||!!e[zM]||!!((t=e.constructor)!=null&&t[zM])||aS(e)||cS(e):!1}var upe=Object.prototype.constructor.toString();function DG(e){if(!e||typeof e!="object")return!1;const t=hf(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===upe}function hb(e,t){sS(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function sS(e){const t=e[ps];return t?t.type_:Array.isArray(e)?1:aS(e)?2:cS(e)?3:0}function wx(e,t){return sS(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function LG(e,t,r){const n=sS(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function hpe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function aS(e){return e instanceof Map}function cS(e){return e instanceof Set}function ou(e){return e.copy_||e.base_}function Sx(e,t){if(aS(e))return new Map(e);if(cS(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=DG(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ps];let i=Reflect.ownKeys(n);for(let o=0;o<i.length;o++){const s=i[o],a=n[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[s]})}return Object.create(hf(e),n)}else{const n=hf(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function Hk(e,t=!1){return lS(e)||Ju(e)||!ll(e)||(sS(e)>1&&(e.set=e.add=e.clear=e.delete=ppe),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>Hk(n,!0))),e}function ppe(){Ca(2)}function lS(e){return Object.isFrozen(e)}var fpe={};function Qu(e){const t=fpe[e];return t||Ca(0,e),t}var E0;function MG(){return E0}function mpe(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function KM(e,t){t&&(Qu("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Tx(e){Cx(e),e.drafts_.forEach(gpe),e.drafts_=null}function Cx(e){e===E0&&(E0=e.parent_)}function qM(e){return E0=mpe(E0,e)}function gpe(e){const t=e[ps];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function YM(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ps].modified_&&(Tx(t),Ca(4)),ll(e)&&(e=pb(t,e),t.parent_||fb(t,e)),t.patches_&&Qu("Patches").generateReplacementPatches_(r[ps].base_,e,t.patches_,t.inversePatches_)):e=pb(t,r,[]),Tx(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==PG?e:void 0}function pb(e,t,r){if(lS(t))return t;const n=t[ps];if(!n)return hb(t,(i,o)=>XM(e,n,t,i,o,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return fb(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let o=i,s=!1;n.type_===3&&(o=new Set(i),i.clear(),s=!0),hb(o,(a,c)=>XM(e,n,i,a,c,r,s)),fb(e,i,!1),r&&e.patches_&&Qu("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function XM(e,t,r,n,i,o,s){if(Ju(i)){const a=o&&t&&t.type_!==3&&!wx(t.assigned_,n)?o.concat(n):void 0,c=pb(e,i,a);if(LG(r,n,c),Ju(c))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(ll(i)&&!lS(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;pb(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&fb(e,i)}}function fb(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Hk(t,r)}function ype(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:MG(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,o=Wk;r&&(i=[n],o=_0);const{revoke:s,proxy:a}=Proxy.revocable(i,o);return n.draft_=a,n.revoke_=s,a}var Wk={get(e,t){if(t===ps)return e;const r=ou(e);if(!wx(r,t))return vpe(e,r,t);const n=r[t];return e.finalized_||!ll(n)?n:n===dC(e.base_,t)?(uC(e),e.copy_[t]=Ix(n,e)):n},has(e,t){return t in ou(e)},ownKeys(e){return Reflect.ownKeys(ou(e))},set(e,t,r){const n=jG(ou(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=dC(ou(e),t),o=i==null?void 0:i[ps];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(hpe(r,i)&&(r!==void 0||wx(e.base_,t)))return!0;uC(e),Rx(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return dC(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,uC(e),Rx(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=ou(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ca(11)},getPrototypeOf(e){return hf(e.base_)},setPrototypeOf(){Ca(12)}},_0={};hb(Wk,(e,t)=>{_0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});_0.deleteProperty=function(e,t){return _0.set.call(this,e,t,void 0)};_0.set=function(e,t,r){return Wk.set.call(this,e[0],t,r,e[0])};function dC(e,t){const r=e[ps];return(r?ou(r):e)[t]}function vpe(e,t,r){var i;const n=jG(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function jG(e,t){if(!(t in e))return;let r=hf(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=hf(r)}}function Rx(e){e.modified_||(e.modified_=!0,e.parent_&&Rx(e.parent_))}function uC(e){e.copy_||(e.copy_=Sx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Epe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const o=r;r=t;const s=this;return function(c=o,...l){return s.produce(c,d=>r.call(this,d,...l))}}typeof r!="function"&&Ca(6),n!==void 0&&typeof n!="function"&&Ca(7);let i;if(ll(t)){const o=qM(this),s=Ix(t,void 0);let a=!0;try{i=r(s),a=!1}finally{a?Tx(o):Cx(o)}return KM(o,n),YM(i,o)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===PG&&(i=void 0),this.autoFreeze_&&Hk(i,!0),n){const o=[],s=[];Qu("Patches").generateReplacementPatches_(t,i,o,s),n(o,s)}return i}else Ca(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...a)=>this.produceWithPatches(s,c=>t(c,...a));let n,i;return[this.produce(t,r,(s,a)=>{n=s,i=a}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ll(e)||Ca(8),Ju(e)&&(e=_pe(e));const t=qM(this),r=Ix(e,void 0);return r[ps].isManual_=!0,Cx(t),r}finishDraft(e,t){const r=e&&e[ps];(!r||!r.isManual_)&&Ca(9);const{scope_:n}=r;return KM(n,t),YM(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=Qu("Patches").applyPatches_;return Ju(e)?n(e,t):this.produce(e,i=>n(i,t))}};function Ix(e,t){const r=aS(e)?Qu("MapSet").proxyMap_(e,t):cS(e)?Qu("MapSet").proxySet_(e,t):ype(e,t);return(t?t.scope_:MG()).drafts_.push(r),r}function _pe(e){return Ju(e)||Ca(10,e),UG(e)}function UG(e){if(!ll(e)||lS(e))return e;const t=e[ps];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Sx(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Sx(e,!0);return hb(r,(n,i)=>{LG(r,n,UG(i))}),t&&(t.finalized_=!1),r}var fs=new Epe,FG=fs.produce;fs.produceWithPatches.bind(fs);fs.setAutoFreeze.bind(fs);fs.setUseStrictShallowCopy.bind(fs);fs.applyPatches.bind(fs);fs.createDraft.bind(fs);fs.finishDraft.bind(fs);function VG(e){return({dispatch:r,getState:n})=>i=>o=>typeof o=="function"?o(r,n,e):i(o)}var bpe=VG(),wpe=VG,Spe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ub:ub.apply(null,arguments)};function JM(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(rl(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>dpe(n)&&n.type===e,r}var BG=class ng extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,ng.prototype)}static get[Symbol.species](){return ng}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new ng(...t[0].concat(this)):new ng(...t.concat(this))}};function QM(e){return ll(e)?FG(e,()=>{}):e}function ZM(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Tpe(e){return typeof e=="boolean"}var Cpe=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:o=!0}=t??{};let s=new BG;return r&&(Tpe(r)?s.push(bpe):s.push(wpe(r.extraArgument))),s},Rpe="RTK_autoBatch",ej=e=>t=>{setTimeout(t,e)},Ipe=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let i=!0,o=!1,s=!1;const a=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:ej(10):e.type==="callback"?e.queueNotification:ej(e.timeout),l=()=>{s=!1,o&&(o=!1,a.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const u=()=>i&&d(),p=n.subscribe(u);return a.add(d),()=>{p(),a.delete(d)}},dispatch(d){var u;try{return i=!((u=d==null?void 0:d.meta)!=null&&u[Rpe]),o=!i,o&&(s||(s=!0,c(l))),n.dispatch(d)}finally{i=!0}}})},Ape=e=>function(r){const{autoBatch:n=!0}=r??{};let i=new BG(e);return n&&i.push(Ipe(typeof n=="object"?n:void 0)),i};function xpe(e){const t=Cpe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:o=void 0,enhancers:s=void 0}=e||{};let a;if(typeof r=="function")a=r;else if($k(r))a=cpe(r);else throw new Error(rl(1));let c;typeof n=="function"?c=n(t):c=t();let l=ub;i&&(l=Spe({trace:!1,...typeof i=="object"&&i}));const d=lpe(...c),u=Ape(d);let p=typeof s=="function"?s(u):u();const f=l(...p);return kG(a,o,f)}function $G(e){const t={},r=[];let n;const i={addCase(o,s){const a=typeof o=="string"?o:o.type;if(!a)throw new Error(rl(28));if(a in t)throw new Error(rl(29));return t[a]=s,i},addMatcher(o,s){return r.push({matcher:o,reducer:s}),i},addDefaultCase(o){return n=o,i}};return e(i),[t,r,n]}function Ope(e){return typeof e=="function"}function Npe(e,t){let[r,n,i]=$G(t),o;if(Ope(e))o=()=>QM(e());else{const a=QM(e);o=()=>a}function s(a=o(),c){let l=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return l.filter(d=>!!d).length===0&&(l=[i]),l.reduce((d,u)=>{if(u)if(Ju(d)){const f=u(d,c);return f===void 0?d:f}else{if(ll(d))return FG(d,p=>u(p,c));{const p=u(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},a)}return s.getInitialState=o,s}var kpe=Symbol.for("rtk-slice-createasyncthunk");function Ppe(e,t){return`${e}/${t}`}function Dpe({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[kpe];return function(i){const{name:o,reducerPath:s=o}=i;if(!o)throw new Error(rl(11));typeof process<"u";const a=(typeof i.reducers=="function"?i.reducers(Mpe()):i.reducers)||{},c=Object.keys(a),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,S){const A=typeof w=="string"?w:w.type;if(!A)throw new Error(rl(12));if(A in l.sliceCaseReducersByType)throw new Error(rl(13));return l.sliceCaseReducersByType[A]=S,d},addMatcher(w,S){return l.sliceMatchers.push({matcher:w,reducer:S}),d},exposeAction(w,S){return l.actionCreators[w]=S,d},exposeCaseReducer(w,S){return l.sliceCaseReducersByName[w]=S,d}};c.forEach(w=>{const S=a[w],A={reducerName:w,type:Ppe(o,w),createNotation:typeof i.reducers=="function"};Upe(S)?Vpe(A,S,d,t):jpe(A,S,d)});function u(){const[w={},S=[],A=void 0]=typeof i.extraReducers=="function"?$G(i.extraReducers):[i.extraReducers],N={...w,...l.sliceCaseReducersByType};return Npe(i.initialState,L=>{for(let j in N)L.addCase(j,N[j]);for(let j of l.sliceMatchers)L.addMatcher(j.matcher,j.reducer);for(let j of S)L.addMatcher(j.matcher,j.reducer);A&&L.addDefaultCase(A)})}const p=w=>w,f=new Map;let m;function g(w,S){return m||(m=u()),m(w,S)}function y(){return m||(m=u()),m.getInitialState()}function v(w,S=!1){function A(L){let j=L[w];return typeof j>"u"&&S&&(j=y()),j}function N(L=p){const j=ZM(f,S,()=>new WeakMap);return ZM(j,L,()=>{const W={};for(const[V,Y]of Object.entries(i.selectors??{}))W[V]=Lpe(Y,L,y,S);return W})}return{reducerPath:w,getSelectors:N,get selectors(){return N(A)},selectSlice:A}}const E={name:o,reducer:g,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:y,...v(s),injectInto(w,{reducerPath:S,...A}={}){const N=S??s;return w.inject({reducerPath:N,reducer:g},A),{...E,...v(N,!0)}}};return E}}function Lpe(e,t,r,n){function i(o,...s){let a=t(o);return typeof a>"u"&&n&&(a=r()),e(a,...s)}return i.unwrapped=e,i}var dS=Dpe();function Mpe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function jpe({type:e,reducerName:t,createNotation:r},n,i){let o,s;if("reducer"in n){if(r&&!Fpe(n))throw new Error(rl(17));o=n.reducer,s=n.prepare}else o=n;i.addCase(e,o).exposeCaseReducer(t,o).exposeAction(t,s?JM(e,s):JM(e))}function Upe(e){return e._reducerDefinitionType==="asyncThunk"}function Fpe(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Vpe({type:e,reducerName:t},r,n,i){if(!i)throw new Error(rl(18));const{payloadCreator:o,fulfilled:s,pending:a,rejected:c,settled:l,options:d}=r,u=i(e,o,d);n.exposeAction(t,u),s&&n.addCase(u.fulfilled,s),a&&n.addCase(u.pending,a),c&&n.addCase(u.rejected,c),l&&n.addMatcher(u.settled,l),n.exposeCaseReducer(t,{fulfilled:s||Sv,pending:a||Sv,rejected:c||Sv,settled:l||Sv})}function Sv(){}function rl(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}const Bpe={username:"",email:"",role:"",isLoggedIn:!1},HG=dS({name:"user",initialState:Bpe,reducers:{setUser(e,t){e.username=t.payload.username,e.email=t.payload.email,e.role=t.payload.role,e.isLoggedIn=t.payload.role}}}),{setUser:Xs}=HG.actions,$pe=HG.reducer;var Ax={exports:{}},Zu={},WG={exports:{}},Hpe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Wpe=Hpe,Gpe=Wpe;function GG(){}function zG(){}zG.resetWarningCache=GG;var zpe=function(){function e(n,i,o,s,a,c){if(c!==Gpe){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:zG,resetWarningCache:GG};return r.PropTypes=r,r};WG.exports=zpe();var KG=WG.exports,xx={exports:{}},La={},Ox={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var r="none",n="contents",i=/^(input|select|textarea|button|object|iframe)$/;function o(u,p){return p.getPropertyValue("overflow")!=="visible"||u.scrollWidth<=0&&u.scrollHeight<=0}function s(u){var p=u.offsetWidth<=0&&u.offsetHeight<=0;if(p&&!u.innerHTML)return!0;try{var f=window.getComputedStyle(u),m=f.getPropertyValue("display");return p?m!==n&&o(u,f):m===r}catch{return console.warn("Failed to inspect element style"),!1}}function a(u){for(var p=u,f=u.getRootNode&&u.getRootNode();p&&p!==document.body;){if(f&&p===f&&(p=f.host.parentNode),s(p))return!1;p=p.parentNode}return!0}function c(u,p){var f=u.nodeName.toLowerCase(),m=i.test(f)&&!u.disabled||f==="a"&&u.href||p;return m&&a(u)}function l(u){var p=u.getAttribute("tabindex");p===null&&(p=void 0);var f=isNaN(p);return(f||p>=0)&&c(u,!f)}function d(u){var p=[].slice.call(u.querySelectorAll("*"),0).reduce(function(f,m){return f.concat(m.shadowRoot?d(m.shadowRoot):[m])},[]);return p.filter(l)}e.exports=t.default})(Ox,Ox.exports);var qG=Ox.exports;Object.defineProperty(La,"__esModule",{value:!0});La.resetState=Xpe;La.log=Jpe;La.handleBlur=b0;La.handleFocus=w0;La.markForFocusLater=Qpe;La.returnFocus=Zpe;La.popWithoutFocus=efe;La.setupScopedFocus=tfe;La.teardownScopedFocus=rfe;var Kpe=qG,qpe=Ype(Kpe);function Ype(e){return e&&e.__esModule?e:{default:e}}var pf=[],Ep=null,Nx=!1;function Xpe(){pf=[]}function Jpe(){}function b0(){Nx=!0}function w0(){if(Nx){if(Nx=!1,!Ep)return;setTimeout(function(){if(!Ep.contains(document.activeElement)){var e=(0,qpe.default)(Ep)[0]||Ep;e.focus()}},0)}}function Qpe(){pf.push(document.activeElement)}function Zpe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=null;try{pf.length!==0&&(t=pf.pop(),t.focus({preventScroll:e}));return}catch{console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}}function efe(){pf.length>0&&pf.pop()}function tfe(e){Ep=e,window.addEventListener?(window.addEventListener("blur",b0,!1),document.addEventListener("focus",w0,!0)):(window.attachEvent("onBlur",b0),document.attachEvent("onFocus",w0))}function rfe(){Ep=null,window.addEventListener?(window.removeEventListener("blur",b0),document.removeEventListener("focus",w0)):(window.detachEvent("onBlur",b0),document.detachEvent("onFocus",w0))}var kx={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var r=qG,n=i(r);function i(a){return a&&a.__esModule?a:{default:a}}function o(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return a.activeElement.shadowRoot?o(a.activeElement.shadowRoot):a.activeElement}function s(a,c){var l=(0,n.default)(a);if(!l.length){c.preventDefault();return}var d=void 0,u=c.shiftKey,p=l[0],f=l[l.length-1],m=o();if(a===m){if(!u)return;d=f}if(f===m&&!u&&(d=p),p===m&&u&&(d=f),d){c.preventDefault(),d.focus();return}var g=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),y=g!=null&&g[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(y){var v=l.indexOf(m);if(v>-1&&(v+=u?-1:1),d=l[v],typeof d>"u"){c.preventDefault(),d=u?f:p,d.focus();return}c.preventDefault(),d.focus()}}e.exports=t.default})(kx,kx.exports);var nfe=kx.exports,Ma={},ife=function(){},ofe=ife,Oa={},YG={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(e){(function(){var t=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:t,canUseWorkers:typeof Worker<"u",canUseEventListeners:t&&!!(window.addEventListener||window.attachEvent),canUseViewport:t&&!!window.screen};e.exports?e.exports=r:window.ExecutionEnvironment=r})()})(YG);var sfe=YG.exports;Object.defineProperty(Oa,"__esModule",{value:!0});Oa.canUseDOM=Oa.SafeNodeList=Oa.SafeHTMLCollection=void 0;var afe=sfe,cfe=lfe(afe);function lfe(e){return e&&e.__esModule?e:{default:e}}var uS=cfe.default,dfe=uS.canUseDOM?window.HTMLElement:{};Oa.SafeHTMLCollection=uS.canUseDOM?window.HTMLCollection:{};Oa.SafeNodeList=uS.canUseDOM?window.NodeList:{};Oa.canUseDOM=uS.canUseDOM;Oa.default=dfe;Object.defineProperty(Ma,"__esModule",{value:!0});Ma.resetState=mfe;Ma.log=gfe;Ma.assertNodeList=XG;Ma.setElement=yfe;Ma.validateElement=Gk;Ma.hide=vfe;Ma.show=Efe;Ma.documentNotReadyOrSSRTesting=_fe;var ufe=ofe,hfe=ffe(ufe),pfe=Oa;function ffe(e){return e&&e.__esModule?e:{default:e}}var Bs=null;function mfe(){Bs&&(Bs.removeAttribute?Bs.removeAttribute("aria-hidden"):Bs.length!=null?Bs.forEach(function(e){return e.removeAttribute("aria-hidden")}):document.querySelectorAll(Bs).forEach(function(e){return e.removeAttribute("aria-hidden")})),Bs=null}function gfe(){}function XG(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function yfe(e){var t=e;if(typeof t=="string"&&pfe.canUseDOM){var r=document.querySelectorAll(t);XG(r,t),t=r}return Bs=t||Bs,Bs}function Gk(e){var t=e||Bs;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,hfe.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function vfe(e){var t=!0,r=!1,n=void 0;try{for(var i=Gk(e)[Symbol.iterator](),o;!(t=(o=i.next()).done);t=!0){var s=o.value;s.setAttribute("aria-hidden","true")}}catch(a){r=!0,n=a}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}}function Efe(e){var t=!0,r=!1,n=void 0;try{for(var i=Gk(e)[Symbol.iterator](),o;!(t=(o=i.next()).done);t=!0){var s=o.value;s.removeAttribute("aria-hidden")}}catch(a){r=!0,n=a}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}}function _fe(){Bs=null}var Kf={};Object.defineProperty(Kf,"__esModule",{value:!0});Kf.resetState=bfe;Kf.log=wfe;var Og={},Ng={};function tj(e,t){e.classList.remove(t)}function bfe(){var e=document.getElementsByTagName("html")[0];for(var t in Og)tj(e,Og[t]);var r=document.body;for(var n in Ng)tj(r,Ng[n]);Og={},Ng={}}function wfe(){}var Sfe=function(t,r){return t[r]||(t[r]=0),t[r]+=1,r},Tfe=function(t,r){return t[r]&&(t[r]-=1),r},Cfe=function(t,r,n){n.forEach(function(i){Sfe(r,i),t.add(i)})},Rfe=function(t,r,n){n.forEach(function(i){Tfe(r,i),r[i]===0&&t.remove(i)})};Kf.add=function(t,r){return Cfe(t.classList,t.nodeName.toLowerCase()=="html"?Og:Ng,r.split(" "))};Kf.remove=function(t,r){return Rfe(t.classList,t.nodeName.toLowerCase()=="html"?Og:Ng,r.split(" "))};var qf={};Object.defineProperty(qf,"__esModule",{value:!0});qf.log=Afe;qf.resetState=xfe;function Ife(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var JG=function e(){var t=this;Ife(this,e),this.register=function(r){t.openInstances.indexOf(r)===-1&&(t.openInstances.push(r),t.emit("register"))},this.deregister=function(r){var n=t.openInstances.indexOf(r);n!==-1&&(t.openInstances.splice(n,1),t.emit("deregister"))},this.subscribe=function(r){t.subscribers.push(r)},this.emit=function(r){t.subscribers.forEach(function(n){return n(r,t.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},mb=new JG;function Afe(){console.log("portalOpenInstances ----------"),console.log(mb.openInstances.length),mb.openInstances.forEach(function(e){return console.log(e)}),console.log("end portalOpenInstances ----------")}function xfe(){mb=new JG}qf.default=mb;var zk={};Object.defineProperty(zk,"__esModule",{value:!0});zk.resetState=Pfe;zk.log=Dfe;var Ofe=qf,Nfe=kfe(Ofe);function kfe(e){return e&&e.__esModule?e:{default:e}}var $i=void 0,_a=void 0,Mu=[];function Pfe(){for(var e=[$i,_a],t=0;t<e.length;t++){var r=e[t];r&&r.parentNode&&r.parentNode.removeChild(r)}$i=_a=null,Mu=[]}function Dfe(){console.log("bodyTrap ----------"),console.log(Mu.length);for(var e=[$i,_a],t=0;t<e.length;t++){var r=e[t],n=r||{};console.log(n.nodeName,n.className,n.id)}console.log("edn bodyTrap ----------")}function rj(){Mu.length!==0&&Mu[Mu.length-1].focusContent()}function Lfe(e,t){!$i&&!_a&&($i=document.createElement("div"),$i.setAttribute("data-react-modal-body-trap",""),$i.style.position="absolute",$i.style.opacity="0",$i.setAttribute("tabindex","0"),$i.addEventListener("focus",rj),_a=$i.cloneNode(),_a.addEventListener("focus",rj)),Mu=t,Mu.length>0?(document.body.firstChild!==$i&&document.body.insertBefore($i,document.body.firstChild),document.body.lastChild!==_a&&document.body.appendChild(_a)):($i.parentElement&&$i.parentElement.removeChild($i),_a.parentElement&&_a.parentElement.removeChild(_a))}Nfe.default.subscribe(Lfe);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(H){for(var $=1;$<arguments.length;$++){var K=arguments[$];for(var x in K)Object.prototype.hasOwnProperty.call(K,x)&&(H[x]=K[x])}return H},n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},i=function(){function H($,K){for(var x=0;x<K.length;x++){var O=K[x];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty($,O.key,O)}}return function($,K,x){return K&&H($.prototype,K),x&&H($,x),$}}(),o=T,s=KG,a=A(s),c=La,l=S(c),d=nfe,u=A(d),p=Ma,f=S(p),m=Kf,g=S(m),y=Oa,v=A(y),E=qf,w=A(E);function S(H){if(H&&H.__esModule)return H;var $={};if(H!=null)for(var K in H)Object.prototype.hasOwnProperty.call(H,K)&&($[K]=H[K]);return $.default=H,$}function A(H){return H&&H.__esModule?H:{default:H}}function N(H,$){if(!(H instanceof $))throw new TypeError("Cannot call a class as a function")}function L(H,$){if(!H)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $&&(typeof $=="object"||typeof $=="function")?$:H}function j(H,$){if(typeof $!="function"&&$!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof $);H.prototype=Object.create($&&$.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}),$&&(Object.setPrototypeOf?Object.setPrototypeOf(H,$):H.__proto__=$)}var W={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},V=function($){return $.code==="Tab"||$.keyCode===9},Y=function($){return $.code==="Escape"||$.keyCode===27},Z=0,te=function(H){j($,H);function $(K){N(this,$);var x=L(this,($.__proto__||Object.getPrototypeOf($)).call(this,K));return x.setOverlayRef=function(O){x.overlay=O,x.props.overlayRef&&x.props.overlayRef(O)},x.setContentRef=function(O){x.content=O,x.props.contentRef&&x.props.contentRef(O)},x.afterClose=function(){var O=x.props,F=O.appElement,P=O.ariaHideApp,_=O.htmlOpenClassName,R=O.bodyOpenClassName,k=O.parentSelector,z=k&&k().ownerDocument||document;R&&g.remove(z.body,R),_&&g.remove(z.getElementsByTagName("html")[0],_),P&&Z>0&&(Z-=1,Z===0&&f.show(F)),x.props.shouldFocusAfterRender&&(x.props.shouldReturnFocusAfterClose?(l.returnFocus(x.props.preventScroll),l.teardownScopedFocus()):l.popWithoutFocus()),x.props.onAfterClose&&x.props.onAfterClose(),w.default.deregister(x)},x.open=function(){x.beforeOpen(),x.state.afterOpen&&x.state.beforeClose?(clearTimeout(x.closeTimer),x.setState({beforeClose:!1})):(x.props.shouldFocusAfterRender&&(l.setupScopedFocus(x.node),l.markForFocusLater()),x.setState({isOpen:!0},function(){x.openAnimationFrame=requestAnimationFrame(function(){x.setState({afterOpen:!0}),x.props.isOpen&&x.props.onAfterOpen&&x.props.onAfterOpen({overlayEl:x.overlay,contentEl:x.content})})}))},x.close=function(){x.props.closeTimeoutMS>0?x.closeWithTimeout():x.closeWithoutTimeout()},x.focusContent=function(){return x.content&&!x.contentHasFocus()&&x.content.focus({preventScroll:!0})},x.closeWithTimeout=function(){var O=Date.now()+x.props.closeTimeoutMS;x.setState({beforeClose:!0,closesAt:O},function(){x.closeTimer=setTimeout(x.closeWithoutTimeout,x.state.closesAt-Date.now())})},x.closeWithoutTimeout=function(){x.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},x.afterClose)},x.handleKeyDown=function(O){V(O)&&(0,u.default)(x.content,O),x.props.shouldCloseOnEsc&&Y(O)&&(O.stopPropagation(),x.requestClose(O))},x.handleOverlayOnClick=function(O){x.shouldClose===null&&(x.shouldClose=!0),x.shouldClose&&x.props.shouldCloseOnOverlayClick&&(x.ownerHandlesClose()?x.requestClose(O):x.focusContent()),x.shouldClose=null},x.handleContentOnMouseUp=function(){x.shouldClose=!1},x.handleOverlayOnMouseDown=function(O){!x.props.shouldCloseOnOverlayClick&&O.target==x.overlay&&O.preventDefault()},x.handleContentOnClick=function(){x.shouldClose=!1},x.handleContentOnMouseDown=function(){x.shouldClose=!1},x.requestClose=function(O){return x.ownerHandlesClose()&&x.props.onRequestClose(O)},x.ownerHandlesClose=function(){return x.props.onRequestClose},x.shouldBeClosed=function(){return!x.state.isOpen&&!x.state.beforeClose},x.contentHasFocus=function(){return document.activeElement===x.content||x.content.contains(document.activeElement)},x.buildClassName=function(O,F){var P=(typeof F>"u"?"undefined":n(F))==="object"?F:{base:W[O],afterOpen:W[O]+"--after-open",beforeClose:W[O]+"--before-close"},_=P.base;return x.state.afterOpen&&(_=_+" "+P.afterOpen),x.state.beforeClose&&(_=_+" "+P.beforeClose),typeof F=="string"&&F?_+" "+F:_},x.attributesFromObject=function(O,F){return Object.keys(F).reduce(function(P,_){return P[O+"-"+_]=F[_],P},{})},x.state={afterOpen:!1,beforeClose:!1},x.shouldClose=null,x.moveFromContentToOverlay=null,x}return i($,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(x,O){this.props.isOpen&&!x.isOpen?this.open():!this.props.isOpen&&x.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!O.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var x=this.props,O=x.appElement,F=x.ariaHideApp,P=x.htmlOpenClassName,_=x.bodyOpenClassName,R=x.parentSelector,k=R&&R().ownerDocument||document;_&&g.add(k.body,_),P&&g.add(k.getElementsByTagName("html")[0],P),F&&(Z+=1,f.hide(O)),w.default.register(this)}},{key:"render",value:function(){var x=this.props,O=x.id,F=x.className,P=x.overlayClassName,_=x.defaultStyles,R=x.children,k=F?{}:_.content,z=P?{}:_.overlay;if(this.shouldBeClosed())return null;var U={ref:this.setOverlayRef,className:this.buildClassName("overlay",P),style:r({},z,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},q=r({id:O,ref:this.setContentRef,style:r({},k,this.props.style.content),className:this.buildClassName("content",F),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",r({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),ie=this.props.contentElement(q,R);return this.props.overlayElement(U,ie)}}]),$}(o.Component);te.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},te.propTypes={isOpen:a.default.bool.isRequired,defaultStyles:a.default.shape({content:a.default.object,overlay:a.default.object}),style:a.default.shape({content:a.default.object,overlay:a.default.object}),className:a.default.oneOfType([a.default.string,a.default.object]),overlayClassName:a.default.oneOfType([a.default.string,a.default.object]),parentSelector:a.default.func,bodyOpenClassName:a.default.string,htmlOpenClassName:a.default.string,ariaHideApp:a.default.bool,appElement:a.default.oneOfType([a.default.instanceOf(v.default),a.default.instanceOf(y.SafeHTMLCollection),a.default.instanceOf(y.SafeNodeList),a.default.arrayOf(a.default.instanceOf(v.default))]),onAfterOpen:a.default.func,onAfterClose:a.default.func,onRequestClose:a.default.func,closeTimeoutMS:a.default.number,shouldFocusAfterRender:a.default.bool,shouldCloseOnOverlayClick:a.default.bool,shouldReturnFocusAfterClose:a.default.bool,preventScroll:a.default.bool,role:a.default.string,contentLabel:a.default.string,aria:a.default.object,data:a.default.object,children:a.default.node,shouldCloseOnEsc:a.default.bool,overlayRef:a.default.func,contentRef:a.default.func,id:a.default.string,overlayElement:a.default.func,contentElement:a.default.func,testId:a.default.string},t.default=te,e.exports=t.default})(xx,xx.exports);var Mfe=xx.exports;function QG(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function ZG(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function e9(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}QG.__suppressDeprecationWarning=!0;ZG.__suppressDeprecationWarning=!0;e9.__suppressDeprecationWarning=!0;function jfe(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,i=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?i="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(i="UNSAFE_componentWillUpdate"),r!==null||n!==null||i!==null){var o=e.displayName||e.name,s=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+s+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(i!==null?`
  `+i:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=QG,t.componentWillReceiveProps=ZG),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=e9;var a=t.componentDidUpdate;t.componentDidUpdate=function(l,d,u){var p=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:u;a.call(this,l,d,p)}}return e}const Ufe=Object.freeze(Object.defineProperty({__proto__:null,polyfill:jfe},Symbol.toStringTag,{value:"Module"})),Ffe=H8(Ufe);Object.defineProperty(Zu,"__esModule",{value:!0});Zu.bodyOpenClassName=Zu.portalClassName=void 0;var nj=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vfe=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),t9=T,gb=vy(t9),Bfe=Aw,yb=vy(Bfe),$fe=KG,Dt=vy($fe),Hfe=Mfe,ij=vy(Hfe),Wfe=Ma,Gfe=Kfe(Wfe),td=Oa,oj=vy(td),zfe=Ffe;function Kfe(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function vy(e){return e&&e.__esModule?e:{default:e}}function qfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sj(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function Yfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Xfe=Zu.portalClassName="ReactModalPortal",Jfe=Zu.bodyOpenClassName="ReactModal__Body--open",su=td.canUseDOM&&yb.default.createPortal!==void 0,aj=function(t){return document.createElement(t)},cj=function(){return su?yb.default.createPortal:yb.default.unstable_renderSubtreeIntoContainer};function Tv(e){return e()}var Ey=function(e){Yfe(t,e);function t(){var r,n,i,o;qfe(this,t);for(var s=arguments.length,a=Array(s),c=0;c<s;c++)a[c]=arguments[c];return o=(n=(i=sj(this,(r=t.__proto__||Object.getPrototypeOf(t)).call.apply(r,[this].concat(a))),i),i.removePortal=function(){!su&&yb.default.unmountComponentAtNode(i.node);var l=Tv(i.props.parentSelector);l&&l.contains(i.node)?l.removeChild(i.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},i.portalRef=function(l){i.portal=l},i.renderPortal=function(l){var d=cj(),u=d(i,gb.default.createElement(ij.default,nj({defaultStyles:t.defaultStyles},l)),i.node);i.portalRef(u)},n),sj(i,o)}return Vfe(t,[{key:"componentDidMount",value:function(){if(td.canUseDOM){su||(this.node=aj("div")),this.node.className=this.props.portalClassName;var n=Tv(this.props.parentSelector);n.appendChild(this.node),!su&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(n){var i=Tv(n.parentSelector),o=Tv(this.props.parentSelector);return{prevParent:i,nextParent:o}}},{key:"componentDidUpdate",value:function(n,i,o){if(td.canUseDOM){var s=this.props,a=s.isOpen,c=s.portalClassName;n.portalClassName!==c&&(this.node.className=c);var l=o.prevParent,d=o.nextParent;d!==l&&(l.removeChild(this.node),d.appendChild(this.node)),!(!n.isOpen&&!a)&&!su&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!td.canUseDOM||!this.node||!this.portal)){var n=this.portal.state,i=Date.now(),o=n.isOpen&&this.props.closeTimeoutMS&&(n.closesAt||i+this.props.closeTimeoutMS);o?(n.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,o-i)):this.removePortal()}}},{key:"render",value:function(){if(!td.canUseDOM||!su)return null;!this.node&&su&&(this.node=aj("div"));var n=cj();return n(gb.default.createElement(ij.default,nj({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(n){Gfe.setElement(n)}}]),t}(t9.Component);Ey.propTypes={isOpen:Dt.default.bool.isRequired,style:Dt.default.shape({content:Dt.default.object,overlay:Dt.default.object}),portalClassName:Dt.default.string,bodyOpenClassName:Dt.default.string,htmlOpenClassName:Dt.default.string,className:Dt.default.oneOfType([Dt.default.string,Dt.default.shape({base:Dt.default.string.isRequired,afterOpen:Dt.default.string.isRequired,beforeClose:Dt.default.string.isRequired})]),overlayClassName:Dt.default.oneOfType([Dt.default.string,Dt.default.shape({base:Dt.default.string.isRequired,afterOpen:Dt.default.string.isRequired,beforeClose:Dt.default.string.isRequired})]),appElement:Dt.default.oneOfType([Dt.default.instanceOf(oj.default),Dt.default.instanceOf(td.SafeHTMLCollection),Dt.default.instanceOf(td.SafeNodeList),Dt.default.arrayOf(Dt.default.instanceOf(oj.default))]),onAfterOpen:Dt.default.func,onRequestClose:Dt.default.func,closeTimeoutMS:Dt.default.number,ariaHideApp:Dt.default.bool,shouldFocusAfterRender:Dt.default.bool,shouldCloseOnOverlayClick:Dt.default.bool,shouldReturnFocusAfterClose:Dt.default.bool,preventScroll:Dt.default.bool,parentSelector:Dt.default.func,aria:Dt.default.object,data:Dt.default.object,role:Dt.default.string,contentLabel:Dt.default.string,shouldCloseOnEsc:Dt.default.bool,overlayRef:Dt.default.func,contentRef:Dt.default.func,id:Dt.default.string,overlayElement:Dt.default.func,contentElement:Dt.default.func};Ey.defaultProps={isOpen:!1,portalClassName:Xfe,bodyOpenClassName:Jfe,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(t,r){return gb.default.createElement("div",t,r)},contentElement:function(t,r){return gb.default.createElement("div",t,r)}};Ey.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}};(0,zfe.polyfill)(Ey);Zu.default=Ey;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Zu,n=i(r);function i(o){return o&&o.__esModule?o:{default:o}}t.default=n.default,e.exports=t.default})(Ax,Ax.exports);var Qfe=Ax.exports;const hS=Pa(Qfe),r9=fo().shape({password:kt().required("Enter password").matches(/[A-Z]/,"Password must contain at least one uppercase letter").matches(/[a-z]/,"Password must contain at least one lowercase letter").matches(/[0-9]/,"Password must contain at least one number").matches(/[@$!%*?&#]/,"Password must contain at least one special character"),confirmPassword:kt().required("Enter confirmpassword").oneOf([rW("password"),null],"Should be matching with password field")}),n9=e=>{try{const[t,r]=e.split("@");return`${t.slice(0,4)+"************"}@${r}`}catch(t){console.log(t)}};var i9={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},lj=Sr.createContext&&Sr.createContext(i9),Zfe=["attr","size","title"];function eme(e,t){if(e==null)return{};var r=tme(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tme(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function vb(){return vb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vb.apply(this,arguments)}function dj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Eb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dj(Object(r),!0).forEach(function(n){rme(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rme(e,t,r){return t=nme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nme(e){var t=ime(e,"string");return typeof t=="symbol"?t:t+""}function ime(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o9(e){return e&&e.map((t,r)=>Sr.createElement(t.tag,Eb({key:r},t.attr),o9(t.child)))}function di(e){return t=>Sr.createElement(ome,vb({attr:Eb({},e.attr)},t),o9(e.child))}function ome(e){var t=r=>{var{attr:n,size:i,title:o}=e,s=eme(e,Zfe),a=i||r.size||"1em",c;return r.className&&(c=r.className),e.className&&(c=(c?c+" ":"")+e.className),Sr.createElement("svg",vb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,s,{className:c,style:Eb(Eb({color:e.color||r.color},r.style),e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&Sr.createElement("title",null,o),e.children)};return lj!==void 0?Sr.createElement(lj.Consumer,null,r=>t(r)):t(i9)}function sme(e){return di({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"},child:[]}]})(e)}function ame(e){return di({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(e)}function cme(e){return di({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"},child:[]}]})(e)}function s9(e){return di({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(e)}function lme(e){return di({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"},child:[]}]})(e)}function dme(e){return di({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"},child:[]}]})(e)}function ume(e){return di({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"},child:[]}]})(e)}function hme(e){return di({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(e)}function a9(e){return di({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"},child:[]}]})(e)}function pme(e){return di({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"},child:[]}]})(e)}function c9(e){return di({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"},child:[]}]})(e)}function fme(e){return di({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"},child:[]}]})(e)}function mme(e){return di({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"},child:[]}]})(e)}const Kk="-";function gme(e){const t=vme(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;function i(s){const a=s.split(Kk);return a[0]===""&&a.length!==1&&a.shift(),l9(a,t)||yme(s)}function o(s,a){const c=r[s]||[];return a&&n[s]?[...c,...n[s]]:c}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function l9(e,t){var s;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),i=n?l9(e.slice(1),n):void 0;if(i)return i;if(t.validators.length===0)return;const o=e.join(Kk);return(s=t.validators.find(({validator:a})=>a(o)))==null?void 0:s.classGroupId}const uj=/^\[(.+)\]$/;function yme(e){if(uj.test(e)){const t=uj.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function vme(e){const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return _me(Object.entries(e.classGroups),r).forEach(([o,s])=>{Px(s,n,o,t)}),n}function Px(e,t,r,n){e.forEach(i=>{if(typeof i=="string"){const o=i===""?t:hj(t,i);o.classGroupId=r;return}if(typeof i=="function"){if(Eme(i)){Px(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([o,s])=>{Px(s,hj(t,o),r,n)})})}function hj(e,t){let r=e;return t.split(Kk).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function Eme(e){return e.isThemeGetter}function _me(e,t){return t?e.map(([r,n])=>{const i=n.map(o=>typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([s,a])=>[t+s,a])):o);return[r,i]}):e}function bme(e){if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;function i(o,s){r.set(o,s),t++,t>e&&(t=0,n=r,r=new Map)}return{get(o){let s=r.get(o);if(s!==void 0)return s;if((s=n.get(o))!==void 0)return i(o,s),s},set(o,s){r.has(o)?r.set(o,s):i(o,s)}}}const d9="!";function wme(e){const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,i=t[0],o=t.length;function s(a){const c=[];let l=0,d=0,u;for(let y=0;y<a.length;y++){let v=a[y];if(l===0){if(v===i&&(n||a.slice(y,y+o)===t)){c.push(a.slice(d,y)),d=y+o;continue}if(v==="/"){u=y;continue}}v==="["?l++:v==="]"&&l--}const p=c.length===0?a:a.substring(d),f=p.startsWith(d9),m=f?p.substring(1):p,g=u&&u>d?u-d:void 0;return{modifiers:c,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:g}}return r?function(c){return r({className:c,parseClassName:s})}:s}function Sme(e){if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t}function Tme(e){return{cache:bme(e.cacheSize),parseClassName:wme(e),...gme(e)}}const Cme=/\s+/;function Rme(e,t){const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=t,o=new Set;return e.trim().split(Cme).map(s=>{const{modifiers:a,hasImportantModifier:c,baseClassName:l,maybePostfixModifierPosition:d}=r(s);let u=!!d,p=n(u?l.substring(0,d):l);if(!p){if(!u)return{isTailwindClass:!1,originalClassName:s};if(p=n(l),!p)return{isTailwindClass:!1,originalClassName:s};u=!1}const f=Sme(a).join(":");return{isTailwindClass:!0,modifierId:c?f+d9:f,classGroupId:p,originalClassName:s,hasPostfixModifier:u}}).reverse().filter(s=>{if(!s.isTailwindClass)return!0;const{modifierId:a,classGroupId:c,hasPostfixModifier:l}=s,d=a+c;return o.has(d)?!1:(o.add(d),i(c,l).forEach(u=>o.add(a+u)),!0)}).reverse().map(s=>s.originalClassName).join(" ")}function Ime(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=u9(t))&&(n&&(n+=" "),n+=r);return n}function u9(e){if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=u9(e[n]))&&(r&&(r+=" "),r+=t);return r}function Ame(e,...t){let r,n,i,o=s;function s(c){const l=t.reduce((d,u)=>u(d),e());return r=Tme(l),n=r.cache.get,i=r.cache.set,o=a,a(c)}function a(c){const l=n(c);if(l)return l;const d=Rme(c,r);return i(c,d),d}return function(){return o(Ime.apply(null,arguments))}}function Zr(e){const t=r=>r[e]||[];return t.isThemeGetter=!0,t}const h9=/^\[(?:([a-z-]+):)?(.+)\]$/i,xme=/^\d+\/\d+$/,Ome=new Set(["px","full","screen"]),Nme=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,kme=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Pme=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Dme=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Lme=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/;function kc(e){return bu(e)||Ome.has(e)||xme.test(e)}function Rl(e){return Yf(e,"length",Hme)}function bu(e){return!!e&&!Number.isNaN(Number(e))}function Cv(e){return Yf(e,"number",bu)}function Pm(e){return!!e&&Number.isInteger(Number(e))}function Mme(e){return e.endsWith("%")&&bu(e.slice(0,-1))}function $t(e){return h9.test(e)}function Il(e){return Nme.test(e)}const jme=new Set(["length","size","percentage"]);function Ume(e){return Yf(e,jme,p9)}function Fme(e){return Yf(e,"position",p9)}const Vme=new Set(["image","url"]);function Bme(e){return Yf(e,Vme,Gme)}function $me(e){return Yf(e,"",Wme)}function Dm(){return!0}function Yf(e,t,r){const n=h9.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1}function Hme(e){return kme.test(e)&&!Pme.test(e)}function p9(){return!1}function Wme(e){return Dme.test(e)}function Gme(e){return Lme.test(e)}function zme(){const e=Zr("colors"),t=Zr("spacing"),r=Zr("blur"),n=Zr("brightness"),i=Zr("borderColor"),o=Zr("borderRadius"),s=Zr("borderSpacing"),a=Zr("borderWidth"),c=Zr("contrast"),l=Zr("grayscale"),d=Zr("hueRotate"),u=Zr("invert"),p=Zr("gap"),f=Zr("gradientColorStops"),m=Zr("gradientColorStopPositions"),g=Zr("inset"),y=Zr("margin"),v=Zr("opacity"),E=Zr("padding"),w=Zr("saturate"),S=Zr("scale"),A=Zr("sepia"),N=Zr("skew"),L=Zr("space"),j=Zr("translate"),W=()=>["auto","contain","none"],V=()=>["auto","hidden","clip","visible","scroll"],Y=()=>["auto",$t,t],Z=()=>[$t,t],te=()=>["",kc,Rl],H=()=>["auto",bu,$t],$=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],K=()=>["solid","dashed","dotted","double","none"],x=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],O=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",$t],P=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_=()=>[bu,Cv],R=()=>[bu,$t];return{cacheSize:500,separator:":",theme:{colors:[Dm],spacing:[kc,Rl],blur:["none","",Il,$t],brightness:_(),borderColor:[e],borderRadius:["none","","full",Il,$t],borderSpacing:Z(),borderWidth:te(),contrast:_(),grayscale:F(),hueRotate:R(),invert:F(),gap:Z(),gradientColorStops:[e],gradientColorStopPositions:[Mme,Rl],inset:Y(),margin:Y(),opacity:_(),padding:Z(),saturate:_(),scale:_(),sepia:F(),skew:R(),space:Z(),translate:Z()},classGroups:{aspect:[{aspect:["auto","square","video",$t]}],container:["container"],columns:[{columns:[Il]}],"break-after":[{"break-after":P()}],"break-before":[{"break-before":P()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$(),$t]}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Pm,$t]}],basis:[{basis:Y()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",$t]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",Pm,$t]}],"grid-cols":[{"grid-cols":[Dm]}],"col-start-end":[{col:["auto",{span:["full",Pm,$t]},$t]}],"col-start":[{"col-start":H()}],"col-end":[{"col-end":H()}],"grid-rows":[{"grid-rows":[Dm]}],"row-start-end":[{row:["auto",{span:[Pm,$t]},$t]}],"row-start":[{"row-start":H()}],"row-end":[{"row-end":H()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",$t]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",$t]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...O()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...O(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...O(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[E]}],px:[{px:[E]}],py:[{py:[E]}],ps:[{ps:[E]}],pe:[{pe:[E]}],pt:[{pt:[E]}],pr:[{pr:[E]}],pb:[{pb:[E]}],pl:[{pl:[E]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[L]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[L]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",$t,t]}],"min-w":[{"min-w":[$t,t,"min","max","fit"]}],"max-w":[{"max-w":[$t,t,"none","full","min","max","fit","prose",{screen:[Il]},Il]}],h:[{h:[$t,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[$t,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[$t,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[$t,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Il,Rl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Cv]}],"font-family":[{font:[Dm]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",$t]}],"line-clamp":[{"line-clamp":["none",bu,Cv]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",kc,$t]}],"list-image":[{"list-image":["none",$t]}],"list-style-type":[{list:["none","disc","decimal",$t]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...K(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",kc,Rl]}],"underline-offset":[{"underline-offset":["auto",kc,$t]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",$t]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",$t]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$(),Fme]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Ume]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Bme]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...K(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:K()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...K()]}],"outline-offset":[{"outline-offset":[kc,$t]}],"outline-w":[{outline:[kc,Rl]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:te()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[kc,Rl]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Il,$me]}],"shadow-color":[{shadow:[Dm]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...x(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":x()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Il,$t]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[u]}],saturate:[{saturate:[w]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",$t]}],duration:[{duration:R()}],ease:[{ease:["linear","in","out","in-out",$t]}],delay:[{delay:R()}],animate:[{animate:["none","spin","ping","pulse","bounce",$t]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[Pm,$t]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",$t]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",$t]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Z()}],"scroll-mx":[{"scroll-mx":Z()}],"scroll-my":[{"scroll-my":Z()}],"scroll-ms":[{"scroll-ms":Z()}],"scroll-me":[{"scroll-me":Z()}],"scroll-mt":[{"scroll-mt":Z()}],"scroll-mr":[{"scroll-mr":Z()}],"scroll-mb":[{"scroll-mb":Z()}],"scroll-ml":[{"scroll-ml":Z()}],"scroll-p":[{"scroll-p":Z()}],"scroll-px":[{"scroll-px":Z()}],"scroll-py":[{"scroll-py":Z()}],"scroll-ps":[{"scroll-ps":Z()}],"scroll-pe":[{"scroll-pe":Z()}],"scroll-pt":[{"scroll-pt":Z()}],"scroll-pr":[{"scroll-pr":Z()}],"scroll-pb":[{"scroll-pb":Z()}],"scroll-pl":[{"scroll-pl":Z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",$t]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[kc,Rl,Cv]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}const se=Ame(zme);function au(e){return e!==null&&typeof e=="object"&&e.constructor===Object}function S0(e){if(!au(e))return e;const t={};for(const r in e)t[r]=S0(e[r]);return t}function Re(e,t){if(au(t)&&Object.keys(t).length===0)return S0({...e,...t});const r={...e,...t};if(au(t)&&au(e))for(const n in t)au(t[n])&&n in e&&au(e[n])?r[n]=Re(e[n],t[n]):r[n]=au(t[n])?S0(t[n]):t[n];return r}const Kme={root:{base:"divide-y divide-gray-200 border-gray-200 dark:divide-gray-700 dark:border-gray-700",flush:{off:"rounded-lg border",on:"border-b"}},content:{base:"p-5 first:rounded-t-lg last:rounded-b-lg dark:bg-gray-900"},title:{arrow:{base:"h-6 w-6 shrink-0",open:{off:"",on:"rotate-180"}},base:"flex w-full items-center justify-between p-5 text-left font-medium text-gray-500 first:rounded-t-lg last:rounded-b-lg dark:text-gray-400",flush:{off:"hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 dark:hover:bg-gray-800 dark:focus:ring-gray-800",on:"bg-transparent dark:bg-transparent"},heading:"",open:{off:"",on:"bg-gray-100 text-gray-900 dark:bg-gray-800 dark:text-white"}}},qme={base:"flex flex-col gap-2 p-4 text-sm",borderAccent:"border-t-4",closeButton:{base:"-m-1.5 ml-auto inline-flex h-8 w-8 rounded-lg p-1.5 focus:ring-2",icon:"h-5 w-5",color:{info:"bg-cyan-100 text-cyan-500 hover:bg-cyan-200 focus:ring-cyan-400 dark:bg-cyan-200 dark:text-cyan-600 dark:hover:bg-cyan-300",gray:"bg-gray-100 text-gray-500 hover:bg-gray-200 focus:ring-gray-400 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-white",failure:"bg-red-100 text-red-500 hover:bg-red-200 focus:ring-red-400 dark:bg-red-200 dark:text-red-600 dark:hover:bg-red-300",success:"bg-green-100 text-green-500 hover:bg-green-200 focus:ring-green-400 dark:bg-green-200 dark:text-green-600 dark:hover:bg-green-300",warning:"bg-yellow-100 text-yellow-500 hover:bg-yellow-200 focus:ring-yellow-400 dark:bg-yellow-200 dark:text-yellow-600 dark:hover:bg-yellow-300",red:"bg-red-100 text-red-500 hover:bg-red-200 focus:ring-red-400 dark:bg-red-200 dark:text-red-600 dark:hover:bg-red-300",green:"bg-green-100 text-green-500 hover:bg-green-200 focus:ring-green-400 dark:bg-green-200 dark:text-green-600 dark:hover:bg-green-300",yellow:"bg-yellow-100 text-yellow-500 hover:bg-yellow-200 focus:ring-yellow-400 dark:bg-yellow-200 dark:text-yellow-600 dark:hover:bg-yellow-300",blue:"bg-blue-100 text-blue-500 hover:bg-blue-200 focus:ring-blue-400 dark:bg-blue-200 dark:text-blue-600 dark:hover:bg-blue-300",cyan:"bg-cyan-100 text-cyan-500 hover:bg-cyan-200 focus:ring-cyan-400 dark:bg-cyan-200 dark:text-cyan-600 dark:hover:bg-cyan-300",pink:"bg-pink-100 text-pink-500 hover:bg-pink-200 focus:ring-pink-400 dark:bg-pink-200 dark:text-pink-600 dark:hover:bg-pink-300",lime:"bg-lime-100 text-lime-500 hover:bg-lime-200 focus:ring-lime-400 dark:bg-lime-200 dark:text-lime-600 dark:hover:bg-lime-300",dark:"bg-gray-100 text-gray-500 hover:bg-gray-200 focus:ring-gray-400 dark:bg-gray-200 dark:text-gray-600 dark:hover:bg-gray-300",indigo:"bg-indigo-100 text-indigo-500 hover:bg-indigo-200 focus:ring-indigo-400 dark:bg-indigo-200 dark:text-indigo-600 dark:hover:bg-indigo-300",purple:"bg-purple-100 text-purple-500 hover:bg-purple-200 focus:ring-purple-400 dark:bg-purple-200 dark:text-purple-600 dark:hover:bg-purple-300",teal:"bg-teal-100 text-teal-500 hover:bg-teal-200 focus:ring-teal-400 dark:bg-teal-200 dark:text-teal-600 dark:hover:bg-teal-300",light:"bg-gray-50 text-gray-500 hover:bg-gray-100 focus:ring-gray-200 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-700 dark:hover:text-white"}},color:{info:"border-cyan-500 bg-cyan-100 text-cyan-700 dark:bg-cyan-200 dark:text-cyan-800",gray:"border-gray-500 bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",failure:"border-red-500 bg-red-100 text-red-700 dark:bg-red-200 dark:text-red-800",success:"border-green-500 bg-green-100 text-green-700 dark:bg-green-200 dark:text-green-800",warning:"border-yellow-500 bg-yellow-100 text-yellow-700 dark:bg-yellow-200 dark:text-yellow-800",red:"border-red-500 bg-red-100 text-red-700 dark:bg-red-200 dark:text-red-800",green:"border-green-500 bg-green-100 text-green-700 dark:bg-green-200 dark:text-green-800",yellow:"border-yellow-500 bg-yellow-100 text-yellow-700 dark:bg-yellow-200 dark:text-yellow-800",blue:"border-blue-500 bg-blue-100 text-blue-700 dark:bg-blue-200 dark:text-blue-800",cyan:"border-cyan-500 bg-cyan-100 text-cyan-700 dark:bg-cyan-200 dark:text-cyan-800",pink:"border-pink-500 bg-pink-100 text-pink-700 dark:bg-pink-200 dark:text-pink-800",lime:"border-lime-500 bg-lime-100 text-lime-700 dark:bg-lime-200 dark:text-lime-800",dark:"border-gray-600 bg-gray-800 text-gray-200 dark:bg-gray-900 dark:text-gray-300",indigo:"border-indigo-500 bg-indigo-100 text-indigo-700 dark:bg-indigo-200 dark:text-indigo-800",purple:"border-purple-500 bg-purple-100 text-purple-700 dark:bg-purple-200 dark:text-purple-800",teal:"border-teal-500 bg-teal-100 text-teal-700 dark:bg-teal-200 dark:text-teal-800",light:"border-gray-400 bg-gray-50 text-gray-600 dark:bg-gray-500 dark:text-gray-200"},icon:"mr-3 inline h-5 w-5 flex-shrink-0",rounded:"rounded-lg",wrapper:"flex items-center"},Yme={root:{base:"flex items-center justify-center space-x-4 rounded",bordered:"p-1 ring-2",rounded:"rounded-full",color:{dark:"ring-gray-800 dark:ring-gray-800",failure:"ring-red-500 dark:ring-red-700",gray:"ring-gray-500 dark:ring-gray-400",info:"ring-cyan-400 dark:ring-cyan-800",light:"ring-gray-300 dark:ring-gray-500",purple:"ring-purple-500 dark:ring-purple-600",success:"ring-green-500 dark:ring-green-500",warning:"ring-yellow-300 dark:ring-yellow-500",pink:"ring-pink-500 dark:ring-pink-500"},img:{base:"rounded",off:"relative overflow-hidden bg-gray-100 dark:bg-gray-600",on:"",placeholder:"absolute -bottom-1 h-auto w-auto text-gray-400"},size:{xs:"h-6 w-6",sm:"h-8 w-8",md:"h-10 w-10",lg:"h-20 w-20",xl:"h-36 w-36"},stacked:"ring-2 ring-gray-300 dark:ring-gray-500",statusPosition:{"bottom-left":"-bottom-1 -left-1","bottom-center":"-bottom-1","bottom-right":"-bottom-1 -right-1","top-left":"-left-1 -top-1","top-center":"-top-1","top-right":"-right-1 -top-1","center-right":"-right-1",center:"","center-left":"-left-1"},status:{away:"bg-yellow-400",base:"absolute h-3.5 w-3.5 rounded-full border-2 border-white dark:border-gray-800",busy:"bg-red-400",offline:"bg-gray-400",online:"bg-green-400"},initials:{text:"font-medium text-gray-600 dark:text-gray-300",base:"relative inline-flex items-center justify-center overflow-hidden bg-gray-100 dark:bg-gray-600"}},group:{base:"flex -space-x-4"},groupCounter:{base:"relative flex h-10 w-10 items-center justify-center rounded-full bg-gray-700 text-xs font-medium text-white ring-2 ring-gray-300 hover:bg-gray-600 dark:ring-gray-500"}},Xme={root:{base:"flex h-fit items-center gap-1 font-semibold",color:{info:"bg-cyan-100 text-cyan-800 group-hover:bg-cyan-200 dark:bg-cyan-200 dark:text-cyan-800 dark:group-hover:bg-cyan-300",gray:"bg-gray-100 text-gray-800 group-hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:group-hover:bg-gray-600",failure:"bg-red-100 text-red-800 group-hover:bg-red-200 dark:bg-red-200 dark:text-red-900 dark:group-hover:bg-red-300",success:"bg-green-100 text-green-800 group-hover:bg-green-200 dark:bg-green-200 dark:text-green-900 dark:group-hover:bg-green-300",warning:"bg-yellow-100 text-yellow-800 group-hover:bg-yellow-200 dark:bg-yellow-200 dark:text-yellow-900 dark:group-hover:bg-yellow-300",indigo:"bg-indigo-100 text-indigo-800 group-hover:bg-indigo-200 dark:bg-indigo-200 dark:text-indigo-900 dark:group-hover:bg-indigo-300",purple:"bg-purple-100 text-purple-800 group-hover:bg-purple-200 dark:bg-purple-200 dark:text-purple-900 dark:group-hover:bg-purple-300",pink:"bg-pink-100 text-pink-800 group-hover:bg-pink-200 dark:bg-pink-200 dark:text-pink-900 dark:group-hover:bg-pink-300",blue:"bg-blue-100 text-blue-800 group-hover:bg-blue-200 dark:bg-blue-200 dark:text-blue-900 dark:group-hover:bg-blue-300",cyan:"bg-cyan-100 text-cyan-800 group-hover:bg-cyan-200 dark:bg-cyan-200 dark:text-cyan-900 dark:group-hover:bg-cyan-300",dark:"bg-gray-600 text-gray-100 group-hover:bg-gray-500 dark:bg-gray-900 dark:text-gray-200 dark:group-hover:bg-gray-700",light:"bg-gray-200 text-gray-800 group-hover:bg-gray-300 dark:bg-gray-400 dark:text-gray-900 dark:group-hover:bg-gray-500",green:"bg-green-100 text-green-800 group-hover:bg-green-200 dark:bg-green-200 dark:text-green-900 dark:group-hover:bg-green-300",lime:"bg-lime-100 text-lime-800 group-hover:bg-lime-200 dark:bg-lime-200 dark:text-lime-900 dark:group-hover:bg-lime-300",red:"bg-red-100 text-red-800 group-hover:bg-red-200 dark:bg-red-200 dark:text-red-900 dark:group-hover:bg-red-300",teal:"bg-teal-100 text-teal-800 group-hover:bg-teal-200 dark:bg-teal-200 dark:text-teal-900 dark:group-hover:bg-teal-300",yellow:"bg-yellow-100 text-yellow-800 group-hover:bg-yellow-200 dark:bg-yellow-200 dark:text-yellow-900 dark:group-hover:bg-yellow-300"},href:"group",size:{xs:"p-1 text-xs",sm:"p-1.5 text-sm"}},icon:{off:"rounded px-2 py-0.5",on:"rounded-full p-1.5",size:{xs:"h-3 w-3",sm:"h-3.5 w-3.5"}}},Jme={root:{base:"text-xl font-semibold italic text-gray-900 dark:text-white"}},Qme={root:{base:"",list:"flex items-center"},item:{base:"group flex items-center",chevron:"mx-1 h-4 w-4 text-gray-400 group-first:hidden md:mx-2",href:{off:"flex items-center text-sm font-medium text-gray-500 dark:text-gray-400",on:"flex items-center text-sm font-medium text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white"},icon:"mr-2 h-4 w-4"}},Zme={base:"group relative flex items-stretch justify-center p-0.5 text-center font-medium transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:z-10 focus:outline-none",fullSized:"w-full",color:{dark:"border border-transparent bg-gray-800 text-white focus:ring-4 focus:ring-gray-300 enabled:hover:bg-gray-900 dark:border-gray-700 dark:bg-gray-800 dark:focus:ring-gray-800 dark:enabled:hover:bg-gray-700",failure:"border border-transparent bg-red-700 text-white focus:ring-4 focus:ring-red-300 enabled:hover:bg-red-800 dark:bg-red-600 dark:focus:ring-red-900 dark:enabled:hover:bg-red-700",gray:":ring-cyan-700 border border-gray-200 bg-white text-gray-900 focus:text-cyan-700 focus:ring-4 enabled:hover:bg-gray-100 enabled:hover:text-cyan-700 dark:border-gray-600 dark:bg-transparent dark:text-gray-400 dark:enabled:hover:bg-gray-700 dark:enabled:hover:text-white",info:"border border-transparent bg-cyan-700 text-white focus:ring-4 focus:ring-cyan-300 enabled:hover:bg-cyan-800 dark:bg-cyan-600 dark:focus:ring-cyan-800 dark:enabled:hover:bg-cyan-700",light:"border border-gray-300 bg-white text-gray-900 focus:ring-4 focus:ring-cyan-300 enabled:hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-600 dark:text-white dark:focus:ring-gray-700 dark:enabled:hover:border-gray-700 dark:enabled:hover:bg-gray-700",purple:"border border-transparent bg-purple-700 text-white focus:ring-4 focus:ring-purple-300 enabled:hover:bg-purple-800 dark:bg-purple-600 dark:focus:ring-purple-900 dark:enabled:hover:bg-purple-700",success:"border border-transparent bg-green-700 text-white focus:ring-4 focus:ring-green-300 enabled:hover:bg-green-800 dark:bg-green-600 dark:focus:ring-green-800 dark:enabled:hover:bg-green-700",warning:"border border-transparent bg-yellow-400 text-white focus:ring-4 focus:ring-yellow-300 enabled:hover:bg-yellow-500 dark:focus:ring-yellow-900",blue:"border border-transparent bg-blue-700 text-white focus:ring-4 focus:ring-blue-300 enabled:hover:bg-blue-800 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",cyan:"border border-cyan-300 bg-white text-cyan-900 focus:ring-4 focus:ring-cyan-300 enabled:hover:bg-cyan-100 dark:border-cyan-600 dark:bg-cyan-600 dark:text-white dark:focus:ring-cyan-700 dark:enabled:hover:border-cyan-700 dark:enabled:hover:bg-cyan-700",green:"border border-green-300 bg-white text-green-900 focus:ring-4 focus:ring-green-300 enabled:hover:bg-green-100 dark:border-green-600 dark:bg-green-600 dark:text-white dark:focus:ring-green-700 dark:enabled:hover:border-green-700 dark:enabled:hover:bg-green-700",indigo:"border border-indigo-300 bg-white text-indigo-900 focus:ring-4 focus:ring-indigo-300 enabled:hover:bg-indigo-100 dark:border-indigo-600 dark:bg-indigo-600 dark:text-white dark:focus:ring-indigo-700 dark:enabled:hover:border-indigo-700 dark:enabled:hover:bg-indigo-700",lime:"border border-lime-300 bg-white text-lime-900 focus:ring-4 focus:ring-lime-300 enabled:hover:bg-lime-100 dark:border-lime-600 dark:bg-lime-600 dark:text-white dark:focus:ring-lime-700 dark:enabled:hover:border-lime-700 dark:enabled:hover:bg-lime-700",pink:"border border-pink-300 bg-white text-pink-900 focus:ring-4 focus:ring-pink-300 enabled:hover:bg-pink-100 dark:border-pink-600 dark:bg-pink-600 dark:text-white dark:focus:ring-pink-700 dark:enabled:hover:border-pink-700 dark:enabled:hover:bg-pink-700",red:"border border-red-300 bg-white text-red-900 focus:ring-4 focus:ring-red-300 enabled:hover:bg-red-100 dark:border-red-600 dark:bg-red-600 dark:text-white dark:focus:ring-red-700 dark:enabled:hover:border-red-700 dark:enabled:hover:bg-red-700",teal:"border border-teal-300 bg-white text-teal-900 focus:ring-4 focus:ring-teal-300 enabled:hover:bg-teal-100 dark:border-teal-600 dark:bg-teal-600 dark:text-white dark:focus:ring-teal-700 dark:enabled:hover:border-teal-700 dark:enabled:hover:bg-teal-700",yellow:"border border-yellow-300 bg-white text-yellow-900 focus:ring-4 focus:ring-yellow-300 enabled:hover:bg-yellow-100 dark:border-yellow-600 dark:bg-yellow-600 dark:text-white dark:focus:ring-yellow-700 dark:enabled:hover:border-yellow-700 dark:enabled:hover:bg-yellow-700"},disabled:"cursor-not-allowed opacity-50",isProcessing:"cursor-wait",spinnerSlot:"absolute top-0 flex h-full items-center",spinnerLeftPosition:{xs:"left-2",sm:"left-3",md:"left-4",lg:"left-5",xl:"left-6"},gradient:{cyan:"bg-gradient-to-r from-cyan-400 via-cyan-500 to-cyan-600 text-white focus:ring-4 focus:ring-cyan-300 enabled:hover:bg-gradient-to-br dark:focus:ring-cyan-800",failure:"bg-gradient-to-r from-red-400 via-red-500 to-red-600 text-white focus:ring-4 focus:ring-red-300 enabled:hover:bg-gradient-to-br dark:focus:ring-red-800",info:"bg-gradient-to-r from-cyan-500 via-cyan-600 to-cyan-700 text-white focus:ring-4 focus:ring-cyan-300 enabled:hover:bg-gradient-to-br dark:focus:ring-cyan-800",lime:"bg-gradient-to-r from-lime-200 via-lime-400 to-lime-500 text-gray-900 focus:ring-4 focus:ring-lime-300 enabled:hover:bg-gradient-to-br dark:focus:ring-lime-800",pink:"bg-gradient-to-r from-pink-400 via-pink-500 to-pink-600 text-white focus:ring-4 focus:ring-pink-300 enabled:hover:bg-gradient-to-br dark:focus:ring-pink-800",purple:"bg-gradient-to-r from-purple-500 via-purple-600 to-purple-700 text-white focus:ring-4 focus:ring-purple-300 enabled:hover:bg-gradient-to-br dark:focus:ring-purple-800",success:"bg-gradient-to-r from-green-400 via-green-500 to-green-600 text-white focus:ring-4 focus:ring-green-300 enabled:hover:bg-gradient-to-br dark:focus:ring-green-800",teal:"bg-gradient-to-r from-teal-400 via-teal-500 to-teal-600 text-white focus:ring-4 focus:ring-teal-300 enabled:hover:bg-gradient-to-br dark:focus:ring-teal-800"},gradientDuoTone:{cyanToBlue:"bg-gradient-to-r from-cyan-500 to-cyan-500 text-white focus:ring-4 focus:ring-cyan-300 enabled:hover:bg-gradient-to-bl dark:focus:ring-cyan-800",greenToBlue:"bg-gradient-to-br from-green-400 to-cyan-600 text-white focus:ring-4 focus:ring-green-200 enabled:hover:bg-gradient-to-bl dark:focus:ring-green-800",pinkToOrange:"bg-gradient-to-br from-pink-500 to-orange-400 text-white focus:ring-4 focus:ring-pink-200 enabled:hover:bg-gradient-to-bl dark:focus:ring-pink-800",purpleToBlue:"bg-gradient-to-br from-purple-600 to-cyan-500 text-white focus:ring-4 focus:ring-cyan-300 enabled:hover:bg-gradient-to-bl dark:focus:ring-cyan-800",purpleToPink:"bg-gradient-to-r from-purple-500 to-pink-500 text-white focus:ring-4 focus:ring-purple-200 enabled:hover:bg-gradient-to-l dark:focus:ring-purple-800",redToYellow:"bg-gradient-to-r from-red-200 via-red-300 to-yellow-200 text-gray-900 focus:ring-4 focus:ring-red-100 enabled:hover:bg-gradient-to-bl dark:focus:ring-red-400",tealToLime:"bg-gradient-to-r from-teal-200 to-lime-200 text-gray-900 focus:ring-4 focus:ring-lime-200 enabled:hover:bg-gradient-to-l enabled:hover:from-teal-200 enabled:hover:to-lime-200 enabled:hover:text-gray-900 dark:focus:ring-teal-700"},inner:{base:"flex items-stretch transition-all duration-200",position:{none:"",start:"rounded-r-none",middle:"rounded-none",end:"rounded-l-none"},outline:"border border-transparent",isProcessingPadding:{xs:"pl-8",sm:"pl-10",md:"pl-12",lg:"pl-16",xl:"pl-20"}},label:"ml-2 inline-flex h-4 w-4 items-center justify-center rounded-full bg-cyan-200 text-xs font-semibold text-cyan-800",outline:{color:{gray:"border border-gray-900 dark:border-white",default:"border-0",light:""},off:"",on:"flex w-full justify-center bg-white text-gray-900 transition-all duration-75 ease-in group-enabled:group-hover:bg-opacity-0 group-enabled:group-hover:text-inherit dark:bg-gray-900 dark:text-white",pill:{off:"rounded-md",on:"rounded-full"}},pill:{off:"rounded-lg",on:"rounded-full"},size:{xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-5 py-2.5 text-base",xl:"px-6 py-3 text-base"}},ege={base:"inline-flex",position:{none:"",start:"rounded-r-none focus:ring-2",middle:"rounded-none border-l-0 pl-0 focus:ring-2",end:"rounded-l-none border-l-0 pl-0 focus:ring-2"}},tge={root:{base:"flex rounded-lg border border-gray-200 bg-white shadow-md dark:border-gray-700 dark:bg-gray-800",children:"flex h-full flex-col justify-center gap-4 p-6",horizontal:{off:"flex-col",on:"flex-col md:max-w-xl md:flex-row"},href:"hover:bg-gray-100 dark:hover:bg-gray-700"},img:{base:"",horizontal:{off:"rounded-t-lg",on:"h-96 w-full rounded-t-lg object-cover md:h-auto md:w-48 md:rounded-none md:rounded-l-lg"}}},rge={root:{base:"relative h-full w-full",leftControl:"absolute left-0 top-0 flex h-full items-center justify-center px-4 focus:outline-none",rightControl:"absolute right-0 top-0 flex h-full items-center justify-center px-4 focus:outline-none"},indicators:{active:{off:"bg-white/50 hover:bg-white dark:bg-gray-800/50 dark:hover:bg-gray-800",on:"bg-white dark:bg-gray-800"},base:"h-3 w-3 rounded-full",wrapper:"absolute bottom-5 left-1/2 flex -translate-x-1/2 space-x-3"},item:{base:"absolute left-1/2 top-1/2 block w-full -translate-x-1/2 -translate-y-1/2",wrapper:{off:"w-full flex-shrink-0 transform cursor-default snap-center",on:"w-full flex-shrink-0 transform cursor-grab snap-center"}},control:{base:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-white/30 group-hover:bg-white/50 group-focus:outline-none group-focus:ring-4 group-focus:ring-white dark:bg-gray-800/30 dark:group-hover:bg-gray-800/60 dark:group-focus:ring-gray-800/70 sm:h-10 sm:w-10",icon:"h-5 w-5 text-white dark:text-gray-800 sm:h-6 sm:w-6"},scrollContainer:{base:"flex h-full snap-mandatory overflow-y-hidden overflow-x-scroll scroll-smooth rounded-lg",snap:"snap-x"}},nge={root:{base:"h-4 w-4 rounded border border-gray-300 bg-gray-100 focus:ring-2 dark:border-gray-600 dark:bg-gray-700",color:{default:"text-cyan-600 focus:ring-cyan-600 dark:ring-offset-gray-800 dark:focus:ring-cyan-600",dark:"text-gray-800 focus:ring-gray-800 dark:ring-offset-gray-800 dark:focus:ring-gray-800",failure:"text-red-900 focus:ring-red-900 dark:ring-offset-red-900 dark:focus:ring-red-900",gray:"text-gray-900 focus:ring-gray-900 dark:ring-offset-gray-900 dark:focus:ring-gray-900",info:"text-cyan-800 focus:ring-cyan-800 dark:ring-offset-gray-800 dark:focus:ring-cyan-800",light:"text-gray-900 focus:ring-gray-900 dark:ring-offset-gray-900 dark:focus:ring-gray-900",purple:"text-purple-600 focus:ring-purple-600 dark:ring-offset-purple-600 dark:focus:ring-purple-600",success:"text-green-800 focus:ring-green-800 dark:ring-offset-green-800 dark:focus:ring-green-800",warning:"text-yellow-400 focus:ring-yellow-400 dark:ring-offset-yellow-400 dark:focus:ring-yellow-400",blue:"text-blue-700 focus:ring-blue-600 dark:ring-offset-blue-700 dark:focus:ring-blue-700",cyan:"text-cyan-600 focus:ring-cyan-600 dark:ring-offset-cyan-600 dark:focus:ring-cyan-600",green:"text-green-600 focus:ring-green-600 dark:ring-offset-green-600 dark:focus:ring-green-600",indigo:"text-indigo-700 focus:ring-indigo-700 dark:ring-offset-indigo-700 dark:focus:ring-indigo-700",lime:"text-lime-700 focus:ring-lime-700 dark:ring-offset-lime-700 dark:focus:ring-lime-700",pink:"text-pink-600 focus:ring-pink-600 dark:ring-offset-pink-600 dark:focus:ring-pink-600",red:"text-red-600 focus:ring-red-600 dark:ring-offset-red-600 dark:focus:ring-red-600",teal:"text-teal-600 focus:ring-teal-600 dark:ring-offset-teal-600 dark:focus:ring-teal-600",yellow:"text-yellow-400 focus:ring-yellow-400 dark:ring-offset-yellow-400 dark:focus:ring-yellow-400"}}},ige={button:{base:"inline-flex w-full items-center justify-center rounded-lg bg-blue-700 px-5 py-3 hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",label:"text-center text-sm font-medium text-white sm:w-auto"},withIcon:{base:"absolute end-2 top-1/2 inline-flex -translate-y-1/2 items-center justify-center rounded-lg p-2 text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800",icon:{defaultIcon:"h-4 w-4",successIcon:"h-4 w-4 text-blue-700 dark:text-blue-500"}},withIconText:{base:"absolute end-2.5 top-1/2 inline-flex -translate-y-1/2 items-center justify-center rounded-lg border border-gray-200 bg-white px-2.5 py-2 text-gray-900 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700",icon:{defaultIcon:"me-1.5 h-3 w-3",successIcon:"me-1.5 h-3 w-3 text-blue-700 dark:text-blue-500"},label:{base:"inline-flex items-center",defaultText:"text-xs font-semibold",successText:"text-xs font-semibold text-blue-700 dark:text-blue-500"}}},oge={root:{base:"rounded-lg p-2.5 text-sm text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-700",icon:"h-5 w-5"}},sge={root:{base:"relative"},popup:{root:{base:"absolute top-10 z-50 block pt-2",inline:"relative top-0 z-auto",inner:"inline-block rounded-lg bg-white p-4 shadow-lg dark:bg-gray-700"},header:{base:"",title:"px-2 py-3 text-center font-semibold text-gray-900 dark:text-white",selectors:{base:"mb-2 flex justify-between",button:{base:"rounded-lg bg-white px-5 py-2.5 text-sm font-semibold text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",prev:"",next:"",view:""}}},view:{base:"p-1"},footer:{base:"mt-2 flex space-x-2",button:{base:"w-full rounded-lg px-5 py-2 text-center text-sm font-medium focus:ring-4 focus:ring-cyan-300",today:"bg-cyan-700 text-white hover:bg-cyan-800 dark:bg-cyan-600 dark:hover:bg-cyan-700",clear:"border border-gray-300 bg-white text-gray-900 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600"}}},views:{days:{header:{base:"mb-1 grid grid-cols-7",title:"h-6 text-center text-sm font-medium leading-6 text-gray-500 dark:text-gray-400"},items:{base:"grid w-64 grid-cols-7",item:{base:"block flex-1 cursor-pointer rounded-lg border-0 text-center text-sm font-semibold leading-9 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-600",selected:"bg-cyan-700 text-white hover:bg-cyan-600",disabled:"text-gray-500"}}},months:{items:{base:"grid w-64 grid-cols-4",item:{base:"block flex-1 cursor-pointer rounded-lg border-0 text-center text-sm font-semibold leading-9 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-600",selected:"bg-cyan-700 text-white hover:bg-cyan-600",disabled:"text-gray-500"}}},years:{items:{base:"grid w-64 grid-cols-4",item:{base:"block flex-1 cursor-pointer rounded-lg border-0 text-center text-sm font-semibold leading-9 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-600",selected:"bg-cyan-700 text-white hover:bg-cyan-600",disabled:"text-gray-500"}}},decades:{items:{base:"grid w-64 grid-cols-4",item:{base:"block flex-1 cursor-pointer rounded-lg border-0 text-center text-sm font-semibold leading-9 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-600",selected:"bg-cyan-700 text-white hover:bg-cyan-600",disabled:"text-gray-500"}}}}},age={root:{base:"fixed z-40 overflow-y-auto bg-white p-4 transition-transform dark:bg-gray-800",backdrop:"fixed inset-0 z-30 bg-gray-900/50 dark:bg-gray-900/80",edge:"bottom-16",position:{top:{on:"left-0 right-0 top-0 w-full transform-none",off:"left-0 right-0 top-0 w-full -translate-y-full"},right:{on:"right-0 top-0 h-screen w-80 transform-none",off:"right-0 top-0 h-screen w-80 translate-x-full"},bottom:{on:"bottom-0 left-0 right-0 w-full transform-none",off:"bottom-0 left-0 right-0 w-full translate-y-full"},left:{on:"left-0 top-0 h-screen w-80 transform-none",off:"left-0 top-0 h-screen w-80 -translate-x-full"}}},header:{inner:{closeButton:"absolute end-2.5 top-2.5 flex h-8 w-8 items-center justify-center rounded-lg bg-transparent text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900 dark:hover:bg-gray-600 dark:hover:text-white",closeIcon:"h-4 w-4",titleIcon:"me-2.5 h-4 w-4",titleText:"mb-4 inline-flex items-center text-base font-semibold text-gray-500 dark:text-gray-400"},collapsed:{on:"hidden",off:"block"}},items:{base:""}},Ul={arrowIcon:"ml-2 h-4 w-4",content:"py-1 focus:outline-none",floating:{animation:"transition-opacity",arrow:{base:"absolute z-10 h-2 w-2 rotate-45",style:{dark:"bg-gray-900 dark:bg-gray-700",light:"bg-white",auto:"bg-white dark:bg-gray-700"},placement:"-4px"},base:"z-10 w-fit divide-y divide-gray-100 rounded shadow focus:outline-none",content:"py-1 text-sm text-gray-700 dark:text-gray-200",divider:"my-1 h-px bg-gray-100 dark:bg-gray-600",header:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-200",hidden:"invisible opacity-0",item:{container:"",base:"flex w-full cursor-pointer items-center justify-start px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 focus:bg-gray-100 focus:outline-none dark:text-gray-200 dark:hover:bg-gray-600 dark:hover:text-white dark:focus:bg-gray-600 dark:focus:text-white",icon:"mr-2 h-4 w-4"},style:{dark:"bg-gray-900 text-white dark:bg-gray-700",light:"border border-gray-200 bg-white text-gray-900",auto:"border border-gray-200 bg-white text-gray-900 dark:border-none dark:bg-gray-700 dark:text-white"},target:"w-fit"},inlineWrapper:"flex items-center"},cge={root:{base:"flex"},field:{base:"relative w-full",input:{base:"block w-full overflow-hidden rounded-lg border disabled:cursor-not-allowed disabled:opacity-50",sizes:{sm:"sm:text-xs",md:"text-sm",lg:"sm:text-base"},colors:{gray:"border-gray-300 bg-gray-50 text-gray-900 focus:border-cyan-500 focus:ring-cyan-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",info:"border-cyan-500 bg-cyan-50 text-cyan-900 placeholder-cyan-700 focus:border-cyan-500 focus:ring-cyan-500 dark:border-cyan-400 dark:bg-cyan-100 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",failure:"border-red-500 bg-red-50 text-red-900 placeholder-red-700 focus:border-red-500 focus:ring-red-500 dark:border-red-400 dark:bg-red-100 dark:focus:border-red-500 dark:focus:ring-red-500",warning:"border-yellow-500 bg-yellow-50 text-yellow-900 placeholder-yellow-700 focus:border-yellow-500 focus:ring-yellow-500 dark:border-yellow-400 dark:bg-yellow-100 dark:focus:border-yellow-500 dark:focus:ring-yellow-500",success:"border-green-500 bg-green-50 text-green-900 placeholder-green-700 focus:border-green-500 focus:ring-green-500 dark:border-green-400 dark:bg-green-100 dark:focus:border-green-500 dark:focus:ring-green-500"}}}},lge={input:{default:{filled:{sm:"peer block w-full appearance-none rounded-t-lg border-0 border-b-2 border-gray-300 bg-gray-50 px-2.5 pb-2.5 pt-5 text-xs text-gray-900 focus:border-blue-600 focus:outline-none focus:ring-0 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:focus:border-blue-500",md:"peer block w-full appearance-none rounded-t-lg border-0 border-b-2 border-gray-300 bg-gray-50 px-2.5 pb-2.5 pt-5 text-sm text-gray-900 focus:border-blue-600 focus:outline-none focus:ring-0 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:focus:border-blue-500"},outlined:{sm:"peer block w-full appearance-none rounded-lg border border-gray-300 bg-transparent px-2.5 pb-2.5 pt-4 text-xs text-gray-900 focus:border-blue-600 focus:outline-none focus:ring-0 dark:border-gray-600 dark:text-white dark:focus:border-blue-500",md:"peer block w-full appearance-none rounded-lg border border-gray-300 bg-transparent px-2.5 pb-2.5 pt-4 text-sm text-gray-900 focus:border-blue-600 focus:outline-none focus:ring-0 dark:border-gray-600 dark:text-white dark:focus:border-blue-500"},standard:{sm:"peer block w-full appearance-none border-0 border-b-2 border-gray-300 bg-transparent px-0 py-2.5 text-xs text-gray-900 focus:border-blue-600 focus:outline-none focus:ring-0 dark:border-gray-600 dark:text-white dark:focus:border-blue-500",md:"peer block w-full appearance-none border-0 border-b-2 border-gray-300 bg-transparent px-0 py-2.5 text-sm text-gray-900 focus:border-blue-600 focus:outline-none focus:ring-0 dark:border-gray-600 dark:text-white dark:focus:border-blue-500"}},success:{filled:{sm:"peer block w-full appearance-none rounded-t-lg border-0 border-b-2 border-green-600 bg-gray-50 px-2.5 pb-2.5 pt-5 text-xs text-gray-900 focus:border-green-600 focus:outline-none focus:ring-0 dark:border-green-500 dark:bg-gray-700 dark:text-white dark:focus:border-green-500",md:"peer block w-full appearance-none rounded-t-lg border-0 border-b-2 border-green-600 bg-gray-50 px-2.5 pb-2.5 pt-5 text-sm text-gray-900 focus:border-green-600 focus:outline-none focus:ring-0 dark:border-green-500 dark:bg-gray-700 dark:text-white dark:focus:border-green-500"},outlined:{sm:"peer block w-full appearance-none rounded-lg border border-green-600 bg-transparent px-2.5 pb-2.5 pt-4 text-xs text-gray-900 focus:border-green-600 focus:outline-none focus:ring-0 dark:border-green-500 dark:text-white dark:focus:border-green-500",md:"peer block w-full appearance-none rounded-lg border border-green-600 bg-transparent px-2.5 pb-2.5 pt-4 text-sm text-gray-900 focus:border-green-600 focus:outline-none focus:ring-0 dark:border-green-500 dark:text-white dark:focus:border-green-500"},standard:{sm:"peer block w-full appearance-none border-0 border-b-2 border-green-600 bg-transparent px-0 py-2.5 text-xs text-gray-900 focus:border-green-600 focus:outline-none focus:ring-0 dark:border-green-500 dark:text-white dark:focus:border-green-500",md:"peer block w-full appearance-none border-0 border-b-2 border-green-600 bg-transparent px-0 py-2.5 text-sm text-gray-900 focus:border-green-600 focus:outline-none focus:ring-0 dark:border-green-500 dark:text-white dark:focus:border-green-500"}},error:{filled:{sm:"peer block w-full appearance-none rounded-t-lg border-0 border-b-2 border-red-600 bg-gray-50 px-2.5 pb-2.5 pt-5 text-xs text-gray-900 focus:border-red-600 focus:outline-none focus:ring-0 dark:border-red-500 dark:bg-gray-700 dark:text-white dark:focus:border-red-500",md:"peer block w-full appearance-none rounded-t-lg border-0 border-b-2 border-red-600 bg-gray-50 px-2.5 pb-2.5 pt-5 text-sm text-gray-900 focus:border-red-600 focus:outline-none focus:ring-0 dark:border-red-500 dark:bg-gray-700 dark:text-white dark:focus:border-red-500"},outlined:{sm:"peer block w-full appearance-none rounded-lg border border-red-600 bg-transparent px-2.5 pb-2.5 pt-4 text-xs text-gray-900 focus:border-red-600 focus:outline-none focus:ring-0 dark:border-red-500 dark:text-white dark:focus:border-red-500",md:"peer block w-full appearance-none rounded-lg border border-red-600 bg-transparent px-2.5 pb-2.5 pt-4 text-sm text-gray-900 focus:border-red-600 focus:outline-none focus:ring-0 dark:border-red-500 dark:text-white dark:focus:border-red-500"},standard:{sm:"peer block w-full appearance-none border-0 border-b-2 border-red-600 bg-transparent px-0 py-2.5 text-xs text-gray-900 focus:border-red-600 focus:outline-none focus:ring-0 dark:border-red-500 dark:text-white dark:focus:border-red-500",md:"peer block w-full appearance-none border-0 border-b-2 border-red-600 bg-transparent px-0 py-2.5 text-sm text-gray-900 focus:border-red-600 focus:outline-none focus:ring-0 dark:border-red-500 dark:text-white dark:focus:border-red-500"}}},label:{default:{filled:{sm:"absolute left-2.5 top-4 z-10 origin-[0] -translate-y-4 scale-75 text-xs text-gray-500 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:text-blue-600 dark:text-gray-400 peer-focus:dark:text-blue-500",md:"absolute left-2.5 top-4 z-10 origin-[0] -translate-y-4 scale-75 text-sm text-gray-500 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:text-blue-600 dark:text-gray-400 peer-focus:dark:text-blue-500"},outlined:{sm:"absolute left-1 top-2 z-10 origin-[0] -translate-y-4 scale-75 bg-white px-2 text-xs text-gray-500 transition-transform duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 peer-focus:text-blue-600 dark:bg-gray-900 dark:text-gray-400 peer-focus:dark:text-blue-500",md:"absolute left-1 top-2 z-10 origin-[0] -translate-y-4 scale-75 bg-white px-2 text-sm text-gray-500 transition-transform duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 peer-focus:text-blue-600 dark:bg-gray-900 dark:text-gray-400 peer-focus:dark:text-blue-500"},standard:{sm:"absolute top-3 -z-10 origin-[0] -translate-y-6 scale-75 text-xs text-gray-500 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:left-0 peer-focus:-translate-y-6 peer-focus:scale-75 peer-focus:text-blue-600 dark:text-gray-400 peer-focus:dark:text-blue-500",md:"absolute top-3 -z-10 origin-[0] -translate-y-6 scale-75 text-sm text-gray-500 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:left-0 peer-focus:-translate-y-6 peer-focus:scale-75 peer-focus:text-blue-600 dark:text-gray-400 peer-focus:dark:text-blue-500"}},success:{filled:{sm:"absolute left-2.5 top-4 z-10 origin-[0] -translate-y-4 scale-75 text-sm text-green-600 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:-translate-y-4 peer-focus:scale-75 dark:text-green-500",md:"absolute left-2.5 top-4 z-10 origin-[0] -translate-y-4 scale-75 text-sm text-green-600 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:-translate-y-4 peer-focus:scale-75 dark:text-green-500"},outlined:{sm:"absolute left-1 top-2 z-10 origin-[0] -translate-y-4 scale-75 bg-white px-2 text-sm text-green-600 transition-transform duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 dark:bg-gray-900 dark:text-green-500",md:"absolute left-1 top-2 z-10 origin-[0] -translate-y-4 scale-75 bg-white px-2 text-sm text-green-600 transition-transform duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 dark:bg-gray-900 dark:text-green-500"},standard:{sm:"absolute top-3 -z-10 origin-[0] -translate-y-6 scale-75 text-xs text-green-600 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:left-0 peer-focus:-translate-y-6 peer-focus:scale-75 dark:text-green-500",md:"absolute top-3 -z-10 origin-[0] -translate-y-6 scale-75 text-sm text-green-600 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:left-0 peer-focus:-translate-y-6 peer-focus:scale-75 dark:text-green-500"}},error:{filled:{sm:"absolute left-2.5 top-4 z-10 origin-[0] -translate-y-4 scale-75 text-xs text-red-600 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:-translate-y-4 peer-focus:scale-75 dark:text-red-500",md:"absolute left-2.5 top-4 z-10 origin-[0] -translate-y-4 scale-75 text-xs text-red-600 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:-translate-y-4 peer-focus:scale-75 dark:text-red-500"},outlined:{sm:"absolute left-1 top-2 z-10 origin-[0] -translate-y-4 scale-75 bg-white px-2 text-xs text-red-600 transition-transform duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 dark:bg-gray-900 dark:text-red-500",md:"absolute left-1 top-2 z-10 origin-[0] -translate-y-4 scale-75 bg-white px-2 text-xs text-red-600 transition-transform duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 dark:bg-gray-900 dark:text-red-500"},standard:{sm:"absolute top-3 -z-10 origin-[0] -translate-y-6 scale-75 text-xs text-red-600 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:left-0 peer-focus:-translate-y-6 peer-focus:scale-75 dark:text-red-500",md:"absolute top-3 -z-10 origin-[0] -translate-y-6 scale-75 text-sm text-red-600 transition-transform duration-300 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:scale-100 peer-focus:left-0 peer-focus:-translate-y-6 peer-focus:scale-75 dark:text-red-500"}}},helperText:{default:"mt-2 text-xs text-gray-600 dark:text-gray-400",success:"mt-2 text-xs text-green-600 dark:text-green-400",error:"mt-2 text-xs text-red-600 dark:text-red-400"}},dge={root:{base:"w-full rounded-lg bg-white shadow dark:bg-gray-800 md:flex md:items-center md:justify-between",container:"w-full p-6",bgDark:"bg-gray-800"},groupLink:{base:"flex flex-wrap text-sm text-gray-500 dark:text-white",link:{base:"me-4 last:mr-0 md:mr-6",href:"hover:underline"},col:"flex-col space-y-4"},icon:{base:"text-gray-500 dark:hover:text-white",size:"h-5 w-5"},title:{base:"mb-6 text-sm font-semibold uppercase text-gray-500 dark:text-white"},divider:{base:"my-6 w-full border-gray-200 dark:border-gray-700 sm:mx-auto lg:my-8"},copyright:{base:"text-sm text-gray-500 dark:text-gray-400 sm:text-center",href:"ml-1 hover:underline",span:"ml-1"},brand:{base:"mb-4 flex items-center sm:mb-0",img:"mr-3 h-8",span:"self-center whitespace-nowrap text-2xl font-semibold text-gray-800 dark:text-white"}},uge={root:{base:"mt-2 text-sm",colors:{gray:"text-gray-500 dark:text-gray-400",info:"text-cyan-700 dark:text-cyan-800",success:"text-green-600 dark:text-green-500",failure:"text-red-600 dark:text-red-500",warning:"text-yellow-500 dark:text-yellow-600"}}},hge={root:{base:"my-8 h-px border-0 bg-gray-200 dark:bg-gray-700"},trimmed:{base:"mx-auto my-4 h-1 w-48 rounded border-0 bg-gray-100 dark:bg-gray-700 md:my-10"},icon:{base:"inline-flex w-full items-center justify-center",hrLine:"my-8 h-1 w-64 rounded border-0 bg-gray-200 dark:bg-gray-700",icon:{base:"absolute left-1/2 -translate-x-1/2 bg-white px-4 dark:bg-gray-900",icon:"h-4 w-4 text-gray-700 dark:text-gray-300"}},text:{base:"inline-flex w-full items-center justify-center",hrLine:"my-8 h-px w-64 border-0 bg-gray-200 dark:bg-gray-700",text:"absolute left-1/2 -translate-x-1/2 bg-white px-3 font-medium text-gray-900 dark:bg-gray-900 dark:text-white"},square:{base:"mx-auto my-8 h-8 w-8 rounded border-0 bg-gray-200 dark:bg-gray-700 md:my-12"}},pge={root:{base:"rounded-lg border border-gray-200 bg-gray-100 px-2 py-1.5 text-xs font-semibold text-gray-800 dark:border-gray-500 dark:bg-gray-600 dark:text-gray-100",icon:"inline-block"}},fge={root:{base:"text-sm font-medium",disabled:"opacity-50",colors:{default:"text-gray-900 dark:text-white",info:"text-cyan-500 dark:text-cyan-600",failure:"text-red-700 dark:text-red-500",warning:"text-yellow-500 dark:text-yellow-600",success:"text-green-700 dark:text-green-500"}}},mge={root:{base:"list-inside space-y-1 text-gray-500 dark:text-gray-400",ordered:{off:"list-disc",on:"list-decimal"},horizontal:"flex list-none flex-wrap items-center justify-center space-x-4 space-y-0",unstyled:"list-none",nested:"mt-2 ps-5"},item:{withIcon:{off:"",on:"flex items-center"},icon:"me-2 h-3.5 w-3.5 flex-shrink-0"}},gge={root:{base:"list-none rounded-lg border border-gray-200 bg-white text-left text-sm font-medium text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},item:{base:"[&>*]:first:rounded-t-lg [&>*]:last:rounded-b-lg [&>*]:last:border-b-0",link:{base:"flex w-full items-center border-b border-gray-200 px-4 py-2 dark:border-gray-600",active:{off:"hover:bg-gray-100 hover:text-cyan-700 focus:text-cyan-700 focus:outline-none focus:ring-2 focus:ring-cyan-700 dark:border-gray-600 dark:hover:bg-gray-600 dark:hover:text-white dark:focus:text-white dark:focus:ring-gray-500",on:"bg-cyan-700 text-white dark:bg-gray-800"},disabled:{off:"",on:"cursor-not-allowed bg-gray-100 text-gray-900 hover:bg-gray-100 hover:text-gray-900 focus:text-gray-900"},href:{off:"",on:""},icon:"mr-2 h-4 w-4 fill-current"}}},KE={root:{base:"bg-white px-2 py-2.5 dark:border-gray-700 dark:bg-gray-800 sm:px-4",rounded:{on:"rounded",off:""},bordered:{on:"border",off:""},inner:{base:"mx-auto flex flex-wrap items-center justify-between",fluid:{on:"",off:"container"}}},brand:{base:"flex items-center"},collapse:{base:"w-full md:block md:w-auto",list:"mt-4 flex flex-col md:mt-0 md:flex-row md:space-x-8 md:text-sm md:font-medium",hidden:{on:"hidden",off:""}},link:{base:"block py-2 pl-3 pr-4 md:p-0",active:{on:"bg-cyan-700 text-white dark:text-white md:bg-transparent md:text-cyan-700",off:"border-b border-gray-100 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white md:border-0 md:hover:bg-transparent md:hover:text-cyan-700 md:dark:hover:bg-transparent md:dark:hover:text-white"},disabled:{on:"text-gray-400 hover:cursor-not-allowed dark:text-gray-600",off:""}},toggle:{base:"inline-flex items-center rounded-lg p-2 text-sm text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 md:hidden",icon:"h-6 w-6 shrink-0"}},yge={...KE,dropdown:{base:"",toggle:{...Ul,floating:{...Ul.floating,base:se(Ul.floating.base,"mt-2 block"),content:se(Ul.floating.content,"text-gray-500 dark:text-gray-400"),style:{...Ul.floating.style,auto:se(Ul.floating.style.auto,"text-gray-500 dark:text-gray-400")}},inlineWrapper:se(Ul.inlineWrapper,"flex w-full items-center justify-between")}},dropdownToggle:{base:se(KE.link.base,KE.link.active.off,"flex w-full items-center justify-between")}},vge={root:{base:"fixed inset-x-0 top-0 z-50 h-screen overflow-y-auto overflow-x-hidden md:inset-0 md:h-full",show:{on:"flex bg-gray-900 bg-opacity-50 dark:bg-opacity-80",off:"hidden"},sizes:{sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl","4xl":"max-w-4xl","5xl":"max-w-5xl","6xl":"max-w-6xl","7xl":"max-w-7xl"},positions:{"top-left":"items-start justify-start","top-center":"items-start justify-center","top-right":"items-start justify-end","center-left":"items-center justify-start",center:"items-center justify-center","center-right":"items-center justify-end","bottom-right":"items-end justify-end","bottom-center":"items-end justify-center","bottom-left":"items-end justify-start"}},content:{base:"relative h-full w-full p-4 md:h-auto",inner:"relative flex max-h-[90dvh] flex-col rounded-lg bg-white shadow dark:bg-gray-700"},body:{base:"flex-1 overflow-auto p-6",popup:"pt-0"},header:{base:"flex items-start justify-between rounded-t border-b p-5 dark:border-gray-600",popup:"border-b-0 p-2",title:"text-xl font-medium text-gray-900 dark:text-white",close:{base:"ml-auto inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900 dark:hover:bg-gray-600 dark:hover:text-white",icon:"h-5 w-5"}},footer:{base:"flex items-center space-x-2 rounded-b border-gray-200 p-6 dark:border-gray-600",popup:"border-t"}},Ege={base:"",layout:{table:{base:"text-sm text-gray-700 dark:text-gray-400",span:"font-semibold text-gray-900 dark:text-white"}},pages:{base:"xs:mt-0 mt-2 inline-flex items-center -space-x-px",showIcon:"inline-flex",previous:{base:"ml-0 rounded-l-lg border border-gray-300 bg-white px-3 py-2 leading-tight text-gray-500 enabled:hover:bg-gray-100 enabled:hover:text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 enabled:dark:hover:bg-gray-700 enabled:dark:hover:text-white",icon:"h-5 w-5"},next:{base:"rounded-r-lg border border-gray-300 bg-white px-3 py-2 leading-tight text-gray-500 enabled:hover:bg-gray-100 enabled:hover:text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 enabled:dark:hover:bg-gray-700 enabled:dark:hover:text-white",icon:"h-5 w-5"},selector:{base:"w-12 border border-gray-300 bg-white py-2 leading-tight text-gray-500 enabled:hover:bg-gray-100 enabled:hover:text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 enabled:dark:hover:bg-gray-700 enabled:dark:hover:text-white",active:"bg-cyan-50 text-cyan-600 hover:bg-cyan-100 hover:text-cyan-700 dark:border-gray-700 dark:bg-gray-700 dark:text-white",disabled:"cursor-not-allowed opacity-50"}}},_ge={base:"absolute z-20 inline-block w-max max-w-[100vw] bg-white outline-none border border-gray-200 rounded-lg shadow-sm dark:border-gray-600 dark:bg-gray-800",content:"z-10 overflow-hidden rounded-[7px]",arrow:{base:"absolute h-2 w-2 z-0 rotate-45 mix-blend-lighten bg-white border border-gray-200 dark:border-gray-600 dark:bg-gray-800 dark:mix-blend-color",placement:"-4px"}},bge={base:"w-full overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700",label:"mb-1 flex justify-between font-medium dark:text-white",bar:"space-x-2 rounded-full text-center font-medium leading-none text-cyan-300 dark:text-cyan-100",color:{dark:"bg-gray-600 dark:bg-gray-300",blue:"bg-blue-600",red:"bg-red-600 dark:bg-red-500",green:"bg-green-600 dark:bg-green-500",yellow:"bg-yellow-400",indigo:"bg-indigo-600 dark:bg-indigo-500",purple:"bg-purple-600 dark:bg-purple-500",cyan:"bg-cyan-600",gray:"bg-gray-500",lime:"bg-lime-600",pink:"bg-pink-500",teal:"bg-teal-600"},size:{sm:"h-1.5",md:"h-2.5",lg:"h-4",xl:"h-6"}},wge={root:{base:"h-4 w-4 border border-gray-300 text-cyan-600 focus:ring-2 focus:ring-cyan-500 dark:border-gray-600 dark:bg-gray-700 dark:focus:bg-cyan-600 dark:focus:ring-cyan-600"}},Sge={root:{base:"flex"},field:{base:"relative w-full",input:{base:"w-full cursor-pointer appearance-none rounded-lg bg-gray-200 dark:bg-gray-700",sizes:{sm:"h-1",md:"h-2",lg:"h-3"}}}},Tge={root:{base:"flex items-center"},star:{empty:"text-gray-300 dark:text-gray-500",filled:"text-yellow-400",sizes:{sm:"h-5 w-5",md:"h-7 w-7",lg:"h-10 w-10"}}},Cge={base:"flex items-center",label:"text-sm font-medium text-cyan-600 dark:text-cyan-500",progress:{base:"mx-4 h-5 w-2/4 rounded bg-gray-200 dark:bg-gray-700",fill:"h-5 rounded bg-yellow-400",label:"text-sm font-medium text-cyan-600 dark:text-cyan-500"}},Rge={base:"flex",addon:"inline-flex items-center rounded-l-md border border-r-0 border-gray-300 bg-gray-200 px-3 text-sm text-gray-900 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400",field:{base:"relative w-full",icon:{base:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",svg:"h-5 w-5 text-gray-500 dark:text-gray-400"},select:{base:"block w-full border disabled:cursor-not-allowed disabled:opacity-50",withIcon:{on:"pl-10",off:""},withAddon:{on:"rounded-r-lg",off:"rounded-lg"},withShadow:{on:"shadow-sm dark:shadow-sm-light",off:""},sizes:{sm:"p-2 sm:text-xs",md:"p-2.5 text-sm",lg:"p-4 sm:text-base"},colors:{gray:"border-gray-300 bg-gray-50 text-gray-900 focus:border-cyan-500 focus:ring-cyan-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",info:"border-cyan-500 bg-cyan-50 text-cyan-900 placeholder-cyan-700 focus:border-cyan-500 focus:ring-cyan-500 dark:border-cyan-400 dark:bg-cyan-100 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",failure:"border-red-500 bg-red-50 text-red-900 placeholder-red-700 focus:border-red-500 focus:ring-red-500 dark:border-red-400 dark:bg-red-100 dark:focus:border-red-500 dark:focus:ring-red-500",warning:"border-yellow-500 bg-yellow-50 text-yellow-900 placeholder-yellow-700 focus:border-yellow-500 focus:ring-yellow-500 dark:border-yellow-400 dark:bg-yellow-100 dark:focus:border-yellow-500 dark:focus:ring-yellow-500",success:"border-green-500 bg-green-50 text-green-900 placeholder-green-700 focus:border-green-500 focus:ring-green-500 dark:border-green-400 dark:bg-green-100 dark:focus:border-green-500 dark:focus:ring-green-500"}}}},Ige={root:{base:"h-full",collapsed:{on:"w-16",off:"w-64"},inner:"h-full overflow-y-auto overflow-x-hidden rounded bg-gray-50 px-3 py-4 dark:bg-gray-800"},collapse:{button:"group flex w-full items-center rounded-lg p-2 text-base font-normal text-gray-900 transition duration-75 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700",icon:{base:"h-6 w-6 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white",open:{off:"",on:"text-gray-900"}},label:{base:"ml-3 flex-1 whitespace-nowrap text-left",icon:{base:"h-6 w-6 transition delay-0 ease-in-out",open:{on:"rotate-180",off:""}}},list:"space-y-2 py-2"},cta:{base:"mt-6 rounded-lg bg-gray-100 p-4 dark:bg-gray-700",color:{blue:"bg-cyan-50 dark:bg-cyan-900",dark:"bg-dark-50 dark:bg-dark-900",failure:"bg-red-50 dark:bg-red-900",gray:"bg-alternative-50 dark:bg-alternative-900",green:"bg-green-50 dark:bg-green-900",light:"bg-light-50 dark:bg-light-900",red:"bg-red-50 dark:bg-red-900",purple:"bg-purple-50 dark:bg-purple-900",success:"bg-green-50 dark:bg-green-900",yellow:"bg-yellow-50 dark:bg-yellow-900",warning:"bg-yellow-50 dark:bg-yellow-900"}},item:{base:"flex items-center justify-center rounded-lg p-2 text-base font-normal text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700",active:"bg-gray-100 dark:bg-gray-700",collapsed:{insideCollapse:"group w-full pl-8 transition duration-75",noIcon:"font-bold"},content:{base:"flex-1 whitespace-nowrap px-3"},icon:{base:"h-6 w-6 flex-shrink-0 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white",active:"text-gray-700 dark:text-gray-100"},label:"",listItem:""},items:{base:""},itemGroup:{base:"mt-4 space-y-2 border-t border-gray-200 pt-4 first:mt-0 first:border-t-0 first:pt-0 dark:border-gray-700"},logo:{base:"mb-5 flex items-center pl-2.5",collapsed:{on:"hidden",off:"self-center whitespace-nowrap text-xl font-semibold dark:text-white"},img:"mr-3 h-6 sm:h-7"}},Age={base:"inline animate-spin text-gray-200",color:{failure:"fill-red-600",gray:"fill-gray-600",info:"fill-cyan-600",pink:"fill-pink-600",purple:"fill-purple-600",success:"fill-green-500",warning:"fill-yellow-400"},light:{off:{base:"dark:text-gray-600",color:{failure:"",gray:"dark:fill-gray-300",info:"",pink:"",purple:"",success:"",warning:""}},on:{base:"",color:{failure:"",gray:"",info:"",pink:"",purple:"",success:"",warning:""}}},size:{xs:"h-3 w-3",sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8",xl:"h-10 w-10"}},xge={root:{base:"w-full text-left text-sm text-gray-500 dark:text-gray-400",shadow:"absolute left-0 top-0 -z-10 h-full w-full rounded-lg bg-white drop-shadow-md dark:bg-black",wrapper:"relative"},body:{base:"group/body",cell:{base:"px-6 py-4 group-first/body:group-first/row:first:rounded-tl-lg group-first/body:group-first/row:last:rounded-tr-lg group-last/body:group-last/row:first:rounded-bl-lg group-last/body:group-last/row:last:rounded-br-lg"}},head:{base:"group/head text-xs uppercase text-gray-700 dark:text-gray-400",cell:{base:"bg-gray-50 px-6 py-3 group-first/head:first:rounded-tl-lg group-first/head:last:rounded-tr-lg dark:bg-gray-700"}},row:{base:"group/row",hovered:"hover:bg-gray-50 dark:hover:bg-gray-600",striped:"odd:bg-white even:bg-gray-50 odd:dark:bg-gray-800 even:dark:bg-gray-700"}},Oge={base:"flex flex-col gap-2",tablist:{base:"flex text-center",variant:{default:"flex-wrap border-b border-gray-200 dark:border-gray-700",underline:"-mb-px flex-wrap border-b border-gray-200 dark:border-gray-700",pills:"flex-wrap space-x-2 text-sm font-medium text-gray-500 dark:text-gray-400",fullWidth:"grid w-full grid-flow-col divide-x divide-gray-200 rounded-none text-sm font-medium shadow dark:divide-gray-700 dark:text-gray-400"},tabitem:{base:"flex items-center justify-center rounded-t-lg p-4 text-sm font-medium first:ml-0 focus:outline-none focus:ring-4 focus:ring-cyan-300 disabled:cursor-not-allowed disabled:text-gray-400 disabled:dark:text-gray-500",variant:{default:{base:"rounded-t-lg",active:{on:"bg-gray-100 text-cyan-600 dark:bg-gray-800 dark:text-cyan-500",off:"text-gray-500 hover:bg-gray-50 hover:text-gray-600 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300"}},underline:{base:"rounded-t-lg",active:{on:"active rounded-t-lg border-b-2 border-cyan-600 text-cyan-600 dark:border-cyan-500 dark:text-cyan-500",off:"border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300"}},pills:{base:"",active:{on:"rounded-lg bg-cyan-600 text-white",off:"rounded-lg hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-white"}},fullWidth:{base:"ml-0 flex w-full rounded-none first:ml-0",active:{on:"active rounded-none bg-gray-100 p-4 text-gray-900 dark:bg-gray-700 dark:text-white",off:"rounded-none bg-white hover:bg-gray-50 hover:text-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-white"}}},icon:"mr-2 h-5 w-5"}},tabitemcontainer:{base:"",variant:{default:"",underline:"",pills:"",fullWidth:""}},tabpanel:"py-3"},Nge={base:"block w-full rounded-lg border text-sm disabled:cursor-not-allowed disabled:opacity-50",colors:{gray:"border-gray-300 bg-gray-50 text-gray-900 focus:border-cyan-500 focus:ring-cyan-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",info:"border-cyan-500 bg-cyan-50 text-cyan-900 placeholder-cyan-700 focus:border-cyan-500 focus:ring-cyan-500 dark:border-cyan-400 dark:bg-cyan-100 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",failure:"border-red-500 bg-red-50 text-red-900 placeholder-red-700 focus:border-red-500 focus:ring-red-500 dark:border-red-400 dark:bg-red-100 dark:focus:border-red-500 dark:focus:ring-red-500",warning:"border-yellow-500 bg-yellow-50 text-yellow-900 placeholder-yellow-700 focus:border-yellow-500 focus:ring-yellow-500 dark:border-yellow-400 dark:bg-yellow-100 dark:focus:border-yellow-500 dark:focus:ring-yellow-500",success:"border-green-500 bg-green-50 text-green-900 placeholder-green-700 focus:border-green-500 focus:ring-green-500 dark:border-green-400 dark:bg-green-100 dark:focus:border-green-500 dark:focus:ring-green-500"},withShadow:{on:"shadow-sm dark:shadow-sm-light",off:""}},kge={base:"flex",addon:"inline-flex items-center rounded-l-md border border-r-0 border-gray-300 bg-gray-200 px-3 text-sm text-gray-900 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400",field:{base:"relative w-full",icon:{base:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",svg:"h-5 w-5 text-gray-500 dark:text-gray-400"},rightIcon:{base:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",svg:"h-5 w-5 text-gray-500 dark:text-gray-400"},input:{base:"block w-full border disabled:cursor-not-allowed disabled:opacity-50",sizes:{sm:"p-2 sm:text-xs",md:"p-2.5 text-sm",lg:"p-4 sm:text-base"},colors:{gray:"border-gray-300 bg-gray-50 text-gray-900 focus:border-cyan-500 focus:ring-cyan-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",info:"border-cyan-500 bg-cyan-50 text-cyan-900 placeholder-cyan-700 focus:border-cyan-500 focus:ring-cyan-500 dark:border-cyan-400 dark:bg-cyan-100 dark:focus:border-cyan-500 dark:focus:ring-cyan-500",failure:"border-red-500 bg-red-50 text-red-900 placeholder-red-700 focus:border-red-500 focus:ring-red-500 dark:border-red-400 dark:bg-red-100 dark:focus:border-red-500 dark:focus:ring-red-500",warning:"border-yellow-500 bg-yellow-50 text-yellow-900 placeholder-yellow-700 focus:border-yellow-500 focus:ring-yellow-500 dark:border-yellow-400 dark:bg-yellow-100 dark:focus:border-yellow-500 dark:focus:ring-yellow-500",success:"border-green-500 bg-green-50 text-green-900 placeholder-green-700 focus:border-green-500 focus:ring-green-500 dark:border-green-400 dark:bg-green-100 dark:focus:border-green-500 dark:focus:ring-green-500"},withRightIcon:{on:"pr-10",off:""},withIcon:{on:"pl-10",off:""},withAddon:{on:"rounded-r-lg",off:"rounded-lg"},withShadow:{on:"shadow-sm dark:shadow-sm-light",off:""}}}},Pge={root:{direction:{horizontal:"sm:flex",vertical:"relative border-l border-gray-200 dark:border-gray-700"}},item:{root:{horizontal:"relative mb-6 sm:mb-0",vertical:"mb-10 ml-6"},content:{root:{base:"",horizontal:"mt-3 sm:pr-8",vertical:""},body:{base:"mb-4 text-base font-normal text-gray-500 dark:text-gray-400"},time:{base:"mb-1 text-sm font-normal leading-none text-gray-400 dark:text-gray-500"},title:{base:"text-lg font-semibold text-gray-900 dark:text-white"}},point:{horizontal:"flex items-center",line:"hidden h-0.5 w-full bg-gray-200 dark:bg-gray-700 sm:flex",marker:{base:{horizontal:"absolute -left-1.5 h-3 w-3 rounded-full border border-white bg-gray-200 dark:border-gray-900 dark:bg-gray-700",vertical:"absolute -left-1.5 mt-1.5 h-3 w-3 rounded-full border border-white bg-gray-200 dark:border-gray-900 dark:bg-gray-700"},icon:{base:"h-3 w-3 text-cyan-600 dark:text-cyan-300",wrapper:"absolute -left-3 flex h-6 w-6 items-center justify-center rounded-full bg-cyan-200 ring-8 ring-white dark:bg-cyan-900 dark:ring-gray-900"}},vertical:""}}},Dge={root:{base:"flex w-full max-w-xs items-center rounded-lg bg-white p-4 text-gray-500 shadow dark:bg-gray-800 dark:text-gray-400",closed:"opacity-0 ease-out"},toggle:{base:"-m-1.5 ml-auto inline-flex h-8 w-8 rounded-lg bg-white p-1.5 text-gray-400 hover:bg-gray-100 hover:text-gray-900 focus:ring-2 focus:ring-gray-300 dark:bg-gray-800 dark:text-gray-500 dark:hover:bg-gray-700 dark:hover:text-white",icon:"h-5 w-5 shrink-0"}},Lge={root:{base:"group flex rounded-lg focus:outline-none",active:{on:"cursor-pointer",off:"cursor-not-allowed opacity-50"},label:"ms-3 mt-0.5 text-start text-sm font-medium text-gray-900 dark:text-gray-300"},toggle:{base:"relative rounded-full border after:absolute after:rounded-full after:bg-white after:transition-all group-focus:ring-4 group-focus:ring-cyan-500/25",checked:{on:"after:translate-x-full after:border-white rtl:after:-translate-x-full",off:"border-gray-200 bg-gray-200 dark:border-gray-600 dark:bg-gray-700",color:{blue:"border-cyan-700 bg-cyan-700",dark:"bg-dark-700 border-dark-900",failure:"border-red-900 bg-red-700",gray:"border-gray-600 bg-gray-500",green:"border-green-700 bg-green-600",light:"bg-light-700 border-light-900",red:"border-red-900 bg-red-700",purple:"border-purple-900 bg-purple-700",success:"border-green-500 bg-green-500",yellow:"border-yellow-400 bg-yellow-400",warning:"border-yellow-600 bg-yellow-600",cyan:"border-cyan-500 bg-cyan-500",lime:"border-lime-400 bg-lime-400",indigo:"border-indigo-400 bg-indigo-400",teal:"bg-gradient-to-r from-teal-400 via-teal-500 to-teal-600 hover:bg-gradient-to-br focus:ring-4",info:"border-cyan-600 bg-cyan-600",pink:"border-pink-600 bg-pink-600"}},sizes:{sm:"h-5 w-9 min-w-9 after:left-px after:top-px after:h-4 after:w-4 rtl:after:right-px",md:"h-6 w-11 min-w-11 after:left-px after:top-px after:h-5 after:w-5 rtl:after:right-px",lg:"h-7 w-14 min-w-14 after:left-1 after:top-0.5 after:h-6 after:w-6 rtl:after:right-1"}}},Mge={target:"w-fit",animation:"transition-opacity",arrow:{base:"absolute z-10 h-2 w-2 rotate-45",style:{dark:"bg-gray-900 dark:bg-gray-700",light:"bg-white",auto:"bg-white dark:bg-gray-700"},placement:"-4px"},base:"absolute z-10 inline-block rounded-lg px-3 py-2 text-sm font-medium shadow-sm",hidden:"invisible opacity-0",style:{dark:"bg-gray-900 text-white dark:bg-gray-700",light:"border border-gray-200 bg-white text-gray-900",auto:"border border-gray-200 bg-white text-gray-900 dark:border-none dark:bg-gray-700 dark:text-white"},content:"relative z-20"},jge={accordion:Kme,alert:qme,avatar:Yme,badge:Xme,blockquote:Jme,breadcrumb:Qme,button:Zme,buttonGroup:ege,card:tge,carousel:rge,checkbox:nge,clipboard:ige,datepicker:sge,darkThemeToggle:oge,drawer:age,dropdown:Ul,fileInput:cge,floatingLabel:lge,footer:dge,helperText:uge,hr:hge,kbd:pge,label:fge,listGroup:gge,list:mge,megaMenu:yge,modal:vge,navbar:KE,pagination:Ege,popover:_ge,progress:bge,radio:wge,rangeSlider:Sge,rating:Tge,ratingAdvanced:Cge,select:Rge,textInput:kge,textarea:Nge,toggleSwitch:Lge,sidebar:Ige,spinner:Age,table:xge,tabs:Oge,timeline:Pge,toast:Dge,tooltip:Mge},Uge={theme:S0(jge)};function tt(){return S0(Uge.theme)}const f9=T.createContext(void 0);function m9(){const e=T.useContext(f9);if(!e)throw new Error("useAccordionContext should be used within the AccordionPanelContext provider!");return e}const g9=({children:e,className:t,theme:r={},...n})=>{const{isOpen:i}=m9(),o=Re(tt().accordion.content,r);return h.jsx("div",{className:se(o.base,t),"data-testid":"flowbite-accordion-content",hidden:!i,...n,children:e})},y9=({children:e,...t})=>{const{alwaysOpen:r}=t,[n,i]=T.useState(t.isOpen),o=r?{...t,isOpen:n,setOpen:()=>i(!n)}:t;return h.jsx(f9.Provider,{value:o,children:e})},v9=({as:e="h2",children:t,className:r,theme:n={},...i})=>{const{arrowIcon:o,flush:s,isOpen:a,setOpen:c}=m9(),l=()=>typeof c<"u"&&c(),d=Re(tt().accordion.title,n);return h.jsxs("button",{className:se(d.base,d.flush[s?"on":"off"],d.open[a?"on":"off"],r),onClick:l,type:"button",...i,children:[h.jsx(e,{className:d.heading,"data-testid":"flowbite-accordion-heading",children:t}),o&&h.jsx(o,{"aria-hidden":!0,className:se(d.arrow.base,d.arrow.open[a?"on":"off"]),"data-testid":"flowbite-accordion-arrow"})]})},E9=({alwaysOpen:e=!1,arrowIcon:t=s9,children:r,flush:n=!1,collapseAll:i=!1,className:o,theme:s={},...a})=>{const[c,l]=T.useState(i?-1:0),d=T.useMemo(()=>T.Children.map(r,(p,f)=>T.cloneElement(p,{alwaysOpen:e,arrowIcon:t,flush:n,isOpen:c===f,setOpen:()=>l(c===f?-1:f)})),[e,t,r,n,c]),u=Re(tt().accordion.root,s);return h.jsx("div",{className:se(u.base,u.flush[n?"on":"off"],o),"data-testid":"flowbite-accordion",...a,children:d})};E9.displayName="Accordion";y9.displayName="Accordion.Panel";v9.displayName="Accordion.Title";g9.displayName="Accordion.Content";Object.assign(E9,{Panel:y9,Title:v9,Content:g9});const _9=({children:e,className:t,theme:r={},...n})=>{const i=Re(tt().avatar.group,r);return h.jsx("div",{"data-testid":"avatar-group-element",className:se(i.base,t),...n,children:e})};_9.displayName="Avatar.Group";const b9=({className:e,href:t,theme:r={},total:n,...i})=>{const o=Re(tt().avatar.groupCounter,r);return h.jsxs("a",{href:t,className:se(o.base,e),...i,children:["+",n]})};b9.displayName="Avatar.GroupCounter";const w9=({alt:e="",bordered:t=!1,children:r,className:n,color:i="light",img:o,placeholderInitials:s="",rounded:a=!1,size:c="md",stacked:l=!1,status:d,statusPosition:u="top-left",theme:p={},...f})=>{const m=Re(tt().avatar,p),g=se(m.root.img.base,t&&m.root.bordered,t&&m.root.color[i],a&&m.root.rounded,l&&m.root.stacked,m.root.img.on,m.root.size[c]),y={className:se(g,m.root.img.on),"data-testid":"flowbite-avatar-img"};return h.jsxs("div",{className:se(m.root.base,n),"data-testid":"flowbite-avatar",...f,children:[h.jsxs("div",{className:"relative",children:[o?typeof o=="string"?h.jsx("img",{alt:e,src:o,...y}):o({alt:e,...y}):s?h.jsx("div",{className:se(m.root.img.off,m.root.initials.base,l&&m.root.stacked,t&&m.root.bordered,t&&m.root.color[i],m.root.size[c],a&&m.root.rounded),"data-testid":"flowbite-avatar-initials-placeholder",children:h.jsx("span",{className:se(m.root.initials.text),"data-testid":"flowbite-avatar-initials-placeholder-text",children:s})}):h.jsx("div",{className:se(g,m.root.img.off),"data-testid":"flowbite-avatar-img",children:h.jsx("svg",{className:m.root.img.placeholder,fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),d&&h.jsx("span",{"data-testid":"flowbite-avatar-status",className:se(m.root.status.base,m.root.status[d],m.root.statusPosition[u])})]}),r&&h.jsx("div",{children:r})]})};w9.displayName="Avatar";Object.assign(w9,{Group:_9,Counter:b9});const S9=({children:e,color:t="info",href:r,icon:n,size:i="xs",className:o,theme:s={},...a})=>{const c=Re(tt().badge,s),l=()=>h.jsxs("span",{className:se(c.root.base,c.root.color[t],c.root.size[i],c.icon[n?"on":"off"],o),"data-testid":"flowbite-badge",...a,children:[n&&h.jsx(n,{"aria-hidden":!0,className:c.icon.size[i],"data-testid":"flowbite-badge-icon"}),e&&h.jsx("span",{children:e})]});return r?h.jsx("a",{className:c.root.href,href:r,children:h.jsx(l,{})}):h.jsx(l,{})};S9.displayName="Badge";const T9=({className:e,color:t="info",light:r,size:n="md",theme:i={},...o})=>{const s=Re(tt().spinner,i);return h.jsx("span",{role:"status",...o,children:h.jsxs("svg",{fill:"none",viewBox:"0 0 100 101",className:se(s.base,s.color[t],s.light[r?"on":"off"].base,s.light[r?"on":"off"].color[t],s.size[n],e),children:[h.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),h.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]})})};T9.displayName="Spinner";const qk=T.forwardRef(({children:e,as:t,href:r,type:n="button",...i},o)=>{const s=t||(r?"a":"button");return T.createElement(s,{ref:o,href:r,type:n,...i},e)});qk.displayName="ButtonBaseComponent";const C9=(e,t,r)=>T.Children.map(e,(n,i)=>{if(T.isValidElement(n)){const o=n.type==Yk?{positionInGroup:Fge(i,T.Children.count(e))}:{};return n.props.children?T.cloneElement(n,{...n.props,children:C9(n.props.children,t,r),...o}):T.cloneElement(n,{outline:t,pill:r,...o})}return n}),Fge=(e,t)=>e===0?"start":e===t-1?"end":"middle",R9=({children:e,className:t,outline:r,pill:n,theme:i={},...o})=>{const s=T.useMemo(()=>C9(e,r,n),[e,r,n]),a=Re(tt().buttonGroup,i);return h.jsx("div",{className:se(a.base,t),role:"group",...o,children:s})};R9.displayName="Button.Group";const I9=T.forwardRef(({children:e,className:t,color:r="info",disabled:n,fullSized:i,isProcessing:o=!1,processingLabel:s="Loading...",processingSpinner:a,gradientDuoTone:c,gradientMonochrome:l,label:d,outline:u=!1,pill:p=!1,positionInGroup:f="none",size:m="md",theme:g={},...y},v)=>{const{buttonGroup:E,button:w}=tt(),S=Re(w,g),A=y;return h.jsx(qk,{ref:v,disabled:n,className:se(S.base,n&&S.disabled,!c&&!l&&S.color[r],c&&!l&&S.gradientDuoTone[c],!c&&l&&S.gradient[l],u&&(S.outline.color[r]??S.outline.color.default),S.pill[p?"on":"off"],i&&S.fullSized,E.position[f],t),...A,children:h.jsx("span",{className:se(S.inner.base,S.outline[u?"on":"off"],S.outline.pill[u&&p?"on":"off"],S.size[m],u&&!S.outline.color[r]&&S.inner.outline,o&&S.isProcessing,o&&S.inner.isProcessingPadding[m],S.inner.position[f]),children:h.jsxs(h.Fragment,{children:[o&&h.jsx("span",{className:se(S.spinnerSlot,S.spinnerLeftPosition[m]),children:a||h.jsx(T9,{size:m})}),typeof e<"u"?e:h.jsx("span",{"data-testid":"flowbite-button-label",className:se(S.label),children:o?s:d})]})})})});I9.displayName="Button";const Yk=Object.assign(I9,{Group:R9}),A9=({children:e,...t})=>{const r=n=>{const o=n.target.closest('[role="banner"]');o==null||o.remove()};return h.jsx(Yk,{onClick:r,...t,children:e})};A9.displayName="Banner.CollapseButton";const x9=({children:e,...t})=>h.jsx("div",{"data-testid":"flowbite-banner",role:"banner",tabIndex:-1,...t,children:e});x9.displayName="Banner";Object.assign(x9,{CollapseButton:A9});const O9=T.forwardRef(({children:e,className:t,href:r,icon:n,theme:i={},...o},s)=>{const a=typeof r<"u",c=a?"a":"span",l=Re(tt().breadcrumb.item,i);return h.jsxs("li",{className:se(l.base,t),...o,children:[h.jsx(c9,{"aria-hidden":!0,className:l.chevron,"data-testid":"flowbite-breadcrumb-separator"}),h.jsxs(c,{ref:s,className:l.href[a?"on":"off"],"data-testid":"flowbite-breadcrumb-item",href:r,children:[n&&h.jsx(n,{"aria-hidden":!0,className:l.icon}),e]})]})});O9.displayName="Breadcrumb.Item";const N9=({children:e,className:t,theme:r={},...n})=>{const i=Re(tt().breadcrumb.root,r);return h.jsx("nav",{"aria-label":"Breadcrumb",className:se(i.base,t),...n,children:h.jsx("ol",{className:i.list,children:e})})};N9.displayName="Breadcrumb";Object.assign(N9,{Item:O9});var k9={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var o="",s=0;s<arguments.length;s++){var a=arguments[s];a&&(o=i(o,n(a)))}return o}function n(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return r.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var s="";for(var a in o)t.call(o,a)&&o[a]&&(s=i(s,a));return s}function i(o,s){return s?o?o+" "+s:o+s:o}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(k9);var Vge=k9.exports;const Bge=Pa(Vge);var Xk={exports:{}};function P9(e,t=100,r={}){if(typeof e!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof e}\`.`);if(t<0)throw new RangeError("`wait` must not be negative.");const{immediate:n}=typeof r=="boolean"?{immediate:r}:r;let i,o,s,a,c;function l(){const p=i,f=o;return i=void 0,o=void 0,c=e.apply(p,f),c}function d(){const p=Date.now()-a;p<t&&p>=0?s=setTimeout(d,t-p):(s=void 0,n||(c=l()))}const u=function(...p){if(i&&this!==i)throw new Error("Debounced method called with different contexts.");i=this,o=p,a=Date.now();const f=n&&!s;return s||(s=setTimeout(d,t)),f&&(c=l()),c};return u.clear=()=>{s&&(clearTimeout(s),s=void 0)},u.flush=()=>{s&&u.trigger()},u.trigger=()=>{c=l(),u.clear()},u}Xk.exports.debounce=P9;Xk.exports=P9;var $ge=Xk.exports;const Hge=Pa($ge);var Wge=Object.defineProperty,Gge=(e,t,r)=>t in e?Wge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oi=(e,t,r)=>Gge(e,typeof t!="symbol"?t+"":t,r);const zge=300,Kge=0;class qge extends T.PureComponent{constructor(t){super(t),oi(this,"container"),oi(this,"scrolling"),oi(this,"started"),oi(this,"pressed"),oi(this,"isMobile",!1),oi(this,"internal"),oi(this,"scrollLeft"),oi(this,"scrollTop"),oi(this,"clientX"),oi(this,"clientY"),oi(this,"onEndScroll",()=>{this.scrolling=!1,!this.pressed&&this.started&&this.processEnd()}),oi(this,"onScroll",()=>{const r=this.container.current;(r.scrollLeft!==this.scrollLeft||r.scrollTop!==this.scrollTop)&&(this.scrolling=!0,this.processScroll(),this.onEndScroll())}),oi(this,"onTouchStart",r=>{const{nativeMobileScroll:n}=this.props;if(this.isDraggable(r.target))if(this.internal=!0,n&&this.scrolling)this.pressed=!0;else{const i=r.touches[0];this.processClick(i.clientX,i.clientY),!n&&this.props.stopPropagation&&r.stopPropagation()}}),oi(this,"onTouchEnd",()=>{const{nativeMobileScroll:r}=this.props;this.pressed&&(this.started&&(!this.scrolling||!r)?this.processEnd():this.pressed=!1,this.forceUpdate())}),oi(this,"onTouchMove",r=>{const{nativeMobileScroll:n}=this.props;if(this.pressed&&(!n||!this.isMobile)){const i=r.touches[0];i&&this.processMove(i.clientX,i.clientY),r.preventDefault(),this.props.stopPropagation&&r.stopPropagation()}}),oi(this,"onMouseDown",r=>{var n,i;this.isDraggable(r.target)&&this.isScrollable()&&(this.internal=!0,((i=(n=this.props)==null?void 0:n.buttons)==null?void 0:i.indexOf(r.button))!==-1&&(this.processClick(r.clientX,r.clientY),r.preventDefault(),this.props.stopPropagation&&r.stopPropagation()))}),oi(this,"onMouseMove",r=>{this.pressed&&(this.processMove(r.clientX,r.clientY),r.preventDefault(),this.props.stopPropagation&&r.stopPropagation())}),oi(this,"onMouseUp",r=>{this.pressed&&(this.started?this.processEnd():(this.internal=!1,this.pressed=!1,this.forceUpdate(),this.props.onClick&&this.props.onClick(r)),r.preventDefault(),this.props.stopPropagation&&r.stopPropagation())}),this.container=Sr.createRef(),this.onEndScroll=Hge(this.onEndScroll,zge),this.scrolling=!1,this.started=!1,this.pressed=!1,this.internal=!1,this.getRef=this.getRef.bind(this)}componentDidMount(){const{nativeMobileScroll:t}=this.props,r=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),r.addEventListener("touchstart",this.onTouchStart,{passive:!1}),r.addEventListener("mousedown",this.onMouseDown,{passive:!1}),t&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())}componentWillUnmount(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)}getElement(){return this.container.current}isMobileDevice(){return typeof window.orientation<"u"||navigator.userAgent.indexOf("IEMobile")!==-1}isDraggable(t){const r=this.props.ignoreElements;if(r){const n=t.closest(r);return n===null||n.contains(this.getElement())}else return!0}isScrollable(){const t=this.container.current;return t&&(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)}processClick(t,r){const n=this.container.current;this.scrollLeft=n==null?void 0:n.scrollLeft,this.scrollTop=n==null?void 0:n.scrollTop,this.clientX=t,this.clientY=r,this.pressed=!0}processStart(t=!0){const{onStartScroll:r}=this.props;this.started=!0,t&&document.body.classList.add("cursor-grab"),r&&r({external:!this.internal}),this.forceUpdate()}processScroll(){if(this.started){const{onScroll:t}=this.props;t&&t({external:!this.internal})}else this.processStart(!1)}processMove(t,r){const{horizontal:n,vertical:i,activationDistance:o,onScroll:s}=this.props,a=this.container.current;this.started?(n&&(a.scrollLeft-=t-this.clientX),i&&(a.scrollTop-=r-this.clientY),s&&s({external:!this.internal}),this.clientX=t,this.clientY=r,this.scrollLeft=a.scrollLeft,this.scrollTop=a.scrollTop):(n&&Math.abs(t-this.clientX)>o||i&&Math.abs(r-this.clientY)>o)&&(this.clientX=t,this.clientY=r,this.processStart())}processEnd(){const{onEndScroll:t}=this.props;this.container.current&&t&&t({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("cursor-grab"),this.forceUpdate()}getRef(t){[this.container,this.props.innerRef].forEach(r=>{r&&(typeof r=="function"?r(t):r.current=t)})}render(){const{children:t,draggingClassName:r,className:n,style:i,hideScrollbars:o}=this.props;return h.jsx("div",{className:Bge(n,this.pressed&&r,{"!scroll-auto [&>*]:pointer-events-none [&>*]:cursor-grab":this.pressed,"overflow-auto":this.isMobile,"overflow-hidden !overflow-x-hidden [overflow:-moz-scrollbars-none] [scrollbar-width:none]":o,"[&::-webkit-scrollbar]:[-webkit-appearance:none !important] [&::-webkit-scrollbar]:!hidden [&::-webkit-scrollbar]:!h-0 [&::-webkit-scrollbar]:!w-0 [&::-webkit-scrollbar]:!bg-transparent":o}),style:i,ref:this.getRef,onScroll:this.onScroll,children:t})}}oi(qge,"defaultProps",{nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},buttons:[Kge]});const Yge=T.forwardRef(({className:e,color:t="default",theme:r={},...n},i)=>{const o=Re(tt().checkbox,r);return h.jsx("input",{ref:i,type:"checkbox",className:se(o.root.base,o.root.color[t],e),...n})});Yge.displayName="Checkbox";function pS(){return typeof window<"u"}function jd(e){return D9(e)?(e.nodeName||"").toLowerCase():"#document"}function Mo(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function bc(e){var t;return(t=(D9(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function D9(e){return pS()?e instanceof Node||e instanceof Mo(e).Node:!1}function zr(e){return pS()?e instanceof Element||e instanceof Mo(e).Element:!1}function Wn(e){return pS()?e instanceof HTMLElement||e instanceof Mo(e).HTMLElement:!1}function Dx(e){return!pS()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Mo(e).ShadowRoot}function _y(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=ta(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function Xge(e){return["table","td","th"].includes(jd(e))}function fS(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Jk(e){const t=Qk(),r=zr(e)?ta(e):e;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function Jge(e){let t=dl(e);for(;Wn(t)&&!Id(t);){if(Jk(t))return t;if(fS(t))return null;t=dl(t)}return null}function Qk(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Id(e){return["html","body","#document"].includes(jd(e))}function ta(e){return Mo(e).getComputedStyle(e)}function mS(e){return zr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function dl(e){if(jd(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Dx(e)&&e.host||bc(e);return Dx(t)?t.host:t}function L9(e){const t=dl(e);return Id(t)?e.ownerDocument?e.ownerDocument.body:e.body:Wn(t)&&_y(t)?t:L9(t)}function gd(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=L9(e),o=i===((n=e.ownerDocument)==null?void 0:n.body),s=Mo(i);if(o){const a=Lx(s);return t.concat(s,s.visualViewport||[],_y(i)?i:[],a&&r?gd(a):[])}return t.concat(i,gd(i,[],r))}function Lx(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Ta(e){let t=e.activeElement;for(;((r=t)==null||(r=r.shadowRoot)==null?void 0:r.activeElement)!=null;){var r;t=t.shadowRoot.activeElement}return t}function Bn(e,t){if(!e||!t)return!1;const r=t.getRootNode==null?void 0:t.getRootNode();if(e.contains(t))return!0;if(r&&Dx(r)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}function Zk(){const e=navigator.userAgentData;return e!=null&&e.platform?e.platform:navigator.platform}function M9(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(t=>{let{brand:r,version:n}=t;return r+"/"+n}).join(" "):navigator.userAgent}function j9(e){return e.mozInputSource===0&&e.isTrusted?!0:Mx()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function eP(e){return Qge()?!1:!Mx()&&e.width===0&&e.height===0||Mx()&&e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType==="mouse"||e.width<1&&e.height<1&&e.pressure===0&&e.detail===0&&e.pointerType==="touch"}function tP(){return/apple/i.test(navigator.vendor)}function Mx(){const e=/android/i;return e.test(Zk())||e.test(M9())}function U9(){return Zk().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints}function Qge(){return M9().includes("jsdom/")}function T0(e,t){const r=["mouse","pen"];return t||r.push("",void 0),r.includes(e)}function Zge(e){return"nativeEvent"in e}function e0e(e){return e.matches("html,body")}function gi(e){return(e==null?void 0:e.ownerDocument)||document}function hC(e,t){if(t==null)return!1;if("composedPath"in e)return e.composedPath().includes(t);const r=e;return r.target!=null&&t.contains(r.target)}function Kc(e){return"composedPath"in e?e.composedPath()[0]:e.target}const t0e="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function rP(e){return Wn(e)&&e.matches(t0e)}function Oi(e){e.preventDefault(),e.stopPropagation()}function F9(e){return e?e.getAttribute("role")==="combobox"&&rP(e):!1}const r0e=["top","right","bottom","left"],pj=["start","end"],fj=r0e.reduce((e,t)=>e.concat(t,t+"-"+pj[0],t+"-"+pj[1]),[]),ff=Math.min,ju=Math.max,_b=Math.round,_p=Math.floor,hc=e=>({x:e,y:e}),n0e={left:"right",right:"left",bottom:"top",top:"bottom"},i0e={start:"end",end:"start"};function jx(e,t,r){return ju(e,ff(t,r))}function Xf(e,t){return typeof e=="function"?e(t):e}function ul(e){return e.split("-")[0]}function pc(e){return e.split("-")[1]}function V9(e){return e==="x"?"y":"x"}function nP(e){return e==="y"?"height":"width"}function mf(e){return["top","bottom"].includes(ul(e))?"y":"x"}function iP(e){return V9(mf(e))}function B9(e,t,r){r===void 0&&(r=!1);const n=pc(e),i=iP(e),o=nP(i);let s=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=wb(s)),[s,wb(s)]}function o0e(e){const t=wb(e);return[bb(e),t,bb(t)]}function bb(e){return e.replace(/start|end/g,t=>i0e[t])}function s0e(e,t,r){const n=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return r?t?i:n:t?n:i;case"left":case"right":return t?o:s;default:return[]}}function a0e(e,t,r,n){const i=pc(e);let o=s0e(ul(e),r==="start",n);return i&&(o=o.map(s=>s+"-"+i),t&&(o=o.concat(o.map(bb)))),o}function wb(e){return e.replace(/left|right|bottom|top/g,t=>n0e[t])}function c0e(e){return{top:0,right:0,bottom:0,left:0,...e}}function $9(e){return typeof e!="number"?c0e(e):{top:e,right:e,bottom:e,left:e}}function Sb(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var l0e=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],Tb=l0e.join(","),H9=typeof Element>"u",gf=H9?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Cb=!H9&&Element.prototype.getRootNode?function(e){var t;return e==null||(t=e.getRootNode)===null||t===void 0?void 0:t.call(e)}:function(e){return e==null?void 0:e.ownerDocument},Rb=function e(t,r){var n;r===void 0&&(r=!0);var i=t==null||(n=t.getAttribute)===null||n===void 0?void 0:n.call(t,"inert"),o=i===""||i==="true",s=o||r&&t&&e(t.parentNode);return s},d0e=function(t){var r,n=t==null||(r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"contenteditable");return n===""||n==="true"},u0e=function(t,r,n){if(Rb(t))return[];var i=Array.prototype.slice.apply(t.querySelectorAll(Tb));return r&&gf.call(t,Tb)&&i.unshift(t),i=i.filter(n),i},h0e=function e(t,r,n){for(var i=[],o=Array.from(t);o.length;){var s=o.shift();if(!Rb(s,!1))if(s.tagName==="SLOT"){var a=s.assignedElements(),c=a.length?a:s.children,l=e(c,!0,n);n.flatten?i.push.apply(i,l):i.push({scopeParent:s,candidates:l})}else{var d=gf.call(s,Tb);d&&n.filter(s)&&(r||!t.includes(s))&&i.push(s);var u=s.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(s),p=!Rb(u,!1)&&(!n.shadowRootFilter||n.shadowRootFilter(s));if(u&&p){var f=e(u===!0?s.children:u.children,!0,n);n.flatten?i.push.apply(i,f):i.push({scopeParent:s,candidates:f})}else o.unshift.apply(o,s.children)}}return i},W9=function(t){return!isNaN(parseInt(t.getAttribute("tabindex"),10))},G9=function(t){if(!t)throw new Error("No node provided");return t.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||d0e(t))&&!W9(t)?0:t.tabIndex},p0e=function(t,r){var n=G9(t);return n<0&&r&&!W9(t)?0:n},f0e=function(t,r){return t.tabIndex===r.tabIndex?t.documentOrder-r.documentOrder:t.tabIndex-r.tabIndex},z9=function(t){return t.tagName==="INPUT"},m0e=function(t){return z9(t)&&t.type==="hidden"},g0e=function(t){var r=t.tagName==="DETAILS"&&Array.prototype.slice.apply(t.children).some(function(n){return n.tagName==="SUMMARY"});return r},y0e=function(t,r){for(var n=0;n<t.length;n++)if(t[n].checked&&t[n].form===r)return t[n]},v0e=function(t){if(!t.name)return!0;var r=t.form||Cb(t),n=function(a){return r.querySelectorAll('input[type="radio"][name="'+a+'"]')},i;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")i=n(window.CSS.escape(t.name));else try{i=n(t.name)}catch(s){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",s.message),!1}var o=y0e(i,t.form);return!o||o===t},E0e=function(t){return z9(t)&&t.type==="radio"},_0e=function(t){return E0e(t)&&!v0e(t)},b0e=function(t){var r,n=t&&Cb(t),i=(r=n)===null||r===void 0?void 0:r.host,o=!1;if(n&&n!==t){var s,a,c;for(o=!!((s=i)!==null&&s!==void 0&&(a=s.ownerDocument)!==null&&a!==void 0&&a.contains(i)||t!=null&&(c=t.ownerDocument)!==null&&c!==void 0&&c.contains(t));!o&&i;){var l,d,u;n=Cb(i),i=(l=n)===null||l===void 0?void 0:l.host,o=!!((d=i)!==null&&d!==void 0&&(u=d.ownerDocument)!==null&&u!==void 0&&u.contains(i))}}return o},mj=function(t){var r=t.getBoundingClientRect(),n=r.width,i=r.height;return n===0&&i===0},w0e=function(t,r){var n=r.displayCheck,i=r.getShadowRoot;if(getComputedStyle(t).visibility==="hidden")return!0;var o=gf.call(t,"details>summary:first-of-type"),s=o?t.parentElement:t;if(gf.call(s,"details:not([open]) *"))return!0;if(!n||n==="full"||n==="legacy-full"){if(typeof i=="function"){for(var a=t;t;){var c=t.parentElement,l=Cb(t);if(c&&!c.shadowRoot&&i(c)===!0)return mj(t);t.assignedSlot?t=t.assignedSlot:!c&&l!==t.ownerDocument?t=l.host:t=c}t=a}if(b0e(t))return!t.getClientRects().length;if(n!=="legacy-full")return!0}else if(n==="non-zero-area")return mj(t);return!1},S0e=function(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var r=t.parentElement;r;){if(r.tagName==="FIELDSET"&&r.disabled){for(var n=0;n<r.children.length;n++){var i=r.children.item(n);if(i.tagName==="LEGEND")return gf.call(r,"fieldset[disabled] *")?!0:!i.contains(t)}return!0}r=r.parentElement}return!1},T0e=function(t,r){return!(r.disabled||Rb(r)||m0e(r)||w0e(r,t)||g0e(r)||S0e(r))},Ux=function(t,r){return!(_0e(r)||G9(r)<0||!T0e(t,r))},C0e=function(t){var r=parseInt(t.getAttribute("tabindex"),10);return!!(isNaN(r)||r>=0)},R0e=function e(t){var r=[],n=[];return t.forEach(function(i,o){var s=!!i.scopeParent,a=s?i.scopeParent:i,c=p0e(a,s),l=s?e(i.candidates):a;c===0?s?r.push.apply(r,l):r.push(a):n.push({documentOrder:o,tabIndex:c,item:i,isScope:s,content:l})}),n.sort(f0e).reduce(function(i,o){return o.isScope?i.push.apply(i,o.content):i.push(o.content),i},[]).concat(r)},C0=function(t,r){r=r||{};var n;return r.getShadowRoot?n=h0e([t],r.includeContainer,{filter:Ux.bind(null,r),flatten:!1,getShadowRoot:r.getShadowRoot,shadowRootFilter:C0e}):n=u0e(t,r.includeContainer,Ux.bind(null,r)),R0e(n)},I0e=function(t,r){if(r=r||{},!t)throw new Error("No node provided");return gf.call(t,Tb)===!1?!1:Ux(r,t)};function gj(e,t,r){let{reference:n,floating:i}=e;const o=mf(t),s=iP(t),a=nP(s),c=ul(t),l=o==="y",d=n.x+n.width/2-i.width/2,u=n.y+n.height/2-i.height/2,p=n[a]/2-i[a]/2;let f;switch(c){case"top":f={x:d,y:n.y-i.height};break;case"bottom":f={x:d,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:u};break;case"left":f={x:n.x-i.width,y:u};break;default:f={x:n.x,y:n.y}}switch(pc(t)){case"start":f[s]-=p*(r&&l?-1:1);break;case"end":f[s]+=p*(r&&l?-1:1);break}return f}const A0e=async(e,t,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:o=[],platform:s}=r,a=o.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(t));let l=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:d,y:u}=gj(l,n,c),p=n,f={},m=0;for(let g=0;g<a.length;g++){const{name:y,fn:v}=a[g],{x:E,y:w,data:S,reset:A}=await v({x:d,y:u,initialPlacement:n,placement:p,strategy:i,middlewareData:f,rects:l,platform:s,elements:{reference:e,floating:t}});d=E??d,u=w??u,f={...f,[y]:{...f[y],...S}},A&&m<=50&&(m++,typeof A=="object"&&(A.placement&&(p=A.placement),A.rects&&(l=A.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:i}):A.rects),{x:d,y:u}=gj(l,p,c)),g=-1)}return{x:d,y:u,placement:p,strategy:i,middlewareData:f}};async function oP(e,t){var r;t===void 0&&(t={});const{x:n,y:i,platform:o,rects:s,elements:a,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:p=!1,padding:f=0}=Xf(t,e),m=$9(f),y=a[p?u==="floating"?"reference":"floating":u],v=Sb(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(y)))==null||r?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:l,rootBoundary:d,strategy:c})),E=u==="floating"?{x:n,y:i,width:s.floating.width,height:s.floating.height}:s.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),S=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},A=Sb(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:E,offsetParent:w,strategy:c}):E);return{top:(v.top-A.top+m.top)/S.y,bottom:(A.bottom-v.bottom+m.bottom)/S.y,left:(v.left-A.left+m.left)/S.x,right:(A.right-v.right+m.right)/S.x}}const x0e=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:i,rects:o,platform:s,elements:a,middlewareData:c}=t,{element:l,padding:d=0}=Xf(e,t)||{};if(l==null)return{};const u=$9(d),p={x:r,y:n},f=iP(i),m=nP(f),g=await s.getDimensions(l),y=f==="y",v=y?"top":"left",E=y?"bottom":"right",w=y?"clientHeight":"clientWidth",S=o.reference[m]+o.reference[f]-p[f]-o.floating[m],A=p[f]-o.reference[f],N=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l));let L=N?N[w]:0;(!L||!await(s.isElement==null?void 0:s.isElement(N)))&&(L=a.floating[w]||o.floating[m]);const j=S/2-A/2,W=L/2-g[m]/2-1,V=ff(u[v],W),Y=ff(u[E],W),Z=V,te=L-g[m]-Y,H=L/2-g[m]/2+j,$=jx(Z,H,te),K=!c.arrow&&pc(i)!=null&&H!==$&&o.reference[m]/2-(H<Z?V:Y)-g[m]/2<0,x=K?H<Z?H-Z:H-te:0;return{[f]:p[f]+x,data:{[f]:$,centerOffset:H-$-x,...K&&{alignmentOffset:x}},reset:K}}});function O0e(e,t,r){return(e?[...r.filter(i=>pc(i)===e),...r.filter(i=>pc(i)!==e)]:r.filter(i=>ul(i)===i)).filter(i=>e?pc(i)===e||(t?bb(i)!==i:!1):!0)}const N0e=function(e){return e===void 0&&(e={}),{name:"autoPlacement",options:e,async fn(t){var r,n,i;const{rects:o,middlewareData:s,placement:a,platform:c,elements:l}=t,{crossAxis:d=!1,alignment:u,allowedPlacements:p=fj,autoAlignment:f=!0,...m}=Xf(e,t),g=u!==void 0||p===fj?O0e(u||null,f,p):p,y=await oP(t,m),v=((r=s.autoPlacement)==null?void 0:r.index)||0,E=g[v];if(E==null)return{};const w=B9(E,o,await(c.isRTL==null?void 0:c.isRTL(l.floating)));if(a!==E)return{reset:{placement:g[0]}};const S=[y[ul(E)],y[w[0]],y[w[1]]],A=[...((n=s.autoPlacement)==null?void 0:n.overflows)||[],{placement:E,overflows:S}],N=g[v+1];if(N)return{data:{index:v+1,overflows:A},reset:{placement:N}};const L=A.map(V=>{const Y=pc(V.placement);return[V.placement,Y&&d?V.overflows.slice(0,2).reduce((Z,te)=>Z+te,0):V.overflows[0],V.overflows]}).sort((V,Y)=>V[1]-Y[1]),W=((i=L.filter(V=>V[2].slice(0,pc(V[0])?2:3).every(Y=>Y<=0))[0])==null?void 0:i[0])||L[0][0];return W!==a?{data:{index:v+1,overflows:A},reset:{placement:W}}:{}}}},k0e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:c,elements:l}=t,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...y}=Xf(e,t);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const v=ul(i),E=mf(a),w=ul(a)===a,S=await(c.isRTL==null?void 0:c.isRTL(l.floating)),A=p||(w||!g?[wb(a)]:o0e(a)),N=m!=="none";!p&&N&&A.push(...a0e(a,g,m,S));const L=[a,...A],j=await oP(t,y),W=[];let V=((n=o.flip)==null?void 0:n.overflows)||[];if(d&&W.push(j[v]),u){const H=B9(i,s,S);W.push(j[H[0]],j[H[1]])}if(V=[...V,{placement:i,overflows:W}],!W.every(H=>H<=0)){var Y,Z;const H=(((Y=o.flip)==null?void 0:Y.index)||0)+1,$=L[H];if($)return{data:{index:H,overflows:V},reset:{placement:$}};let K=(Z=V.filter(x=>x.overflows[0]<=0).sort((x,O)=>x.overflows[1]-O.overflows[1])[0])==null?void 0:Z.placement;if(!K)switch(f){case"bestFit":{var te;const x=(te=V.filter(O=>{if(N){const F=mf(O.placement);return F===E||F==="y"}return!0}).map(O=>[O.placement,O.overflows.filter(F=>F>0).reduce((F,P)=>F+P,0)]).sort((O,F)=>O[1]-F[1])[0])==null?void 0:te[0];x&&(K=x);break}case"initialPlacement":K=a;break}if(i!==K)return{reset:{placement:K}}}return{}}}};async function P0e(e,t){const{placement:r,platform:n,elements:i}=e,o=await(n.isRTL==null?void 0:n.isRTL(i.floating)),s=ul(r),a=pc(r),c=mf(r)==="y",l=["left","top"].includes(s)?-1:1,d=o&&c?-1:1,u=Xf(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:m}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...u};return a&&typeof m=="number"&&(f=a==="end"?m*-1:m),c?{x:f*d,y:p*l}:{x:p*l,y:f*d}}const D0e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:i,y:o,placement:s,middlewareData:a}=t,c=await P0e(t,e);return s===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:i+c.x,y:o+c.y,data:{...c,placement:s}}}}},L0e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:i}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:y=>{let{x:v,y:E}=y;return{x:v,y:E}}},...c}=Xf(e,t),l={x:r,y:n},d=await oP(t,c),u=mf(ul(i)),p=V9(u);let f=l[p],m=l[u];if(o){const y=p==="y"?"top":"left",v=p==="y"?"bottom":"right",E=f+d[y],w=f-d[v];f=jx(E,f,w)}if(s){const y=u==="y"?"top":"left",v=u==="y"?"bottom":"right",E=m+d[y],w=m-d[v];m=jx(E,m,w)}const g=a.fn({...t,[p]:f,[u]:m});return{...g,data:{x:g.x-r,y:g.y-n}}}}};function K9(e){const t=ta(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=Wn(e),o=i?e.offsetWidth:r,s=i?e.offsetHeight:n,a=_b(r)!==o||_b(n)!==s;return a&&(r=o,n=s),{width:r,height:n,$:a}}function sP(e){return zr(e)?e:e.contextElement}function Hp(e){const t=sP(e);if(!Wn(t))return hc(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:o}=K9(t);let s=(o?_b(r.width):r.width)/n,a=(o?_b(r.height):r.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const M0e=hc(0);function q9(e){const t=Mo(e);return!Qk()||!t.visualViewport?M0e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function j0e(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Mo(e)?!1:t}function eh(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),o=sP(e);let s=hc(1);t&&(n?zr(n)&&(s=Hp(n)):s=Hp(e));const a=j0e(o,r,n)?q9(o):hc(0);let c=(i.left+a.x)/s.x,l=(i.top+a.y)/s.y,d=i.width/s.x,u=i.height/s.y;if(o){const p=Mo(o),f=n&&zr(n)?Mo(n):n;let m=p,g=Lx(m);for(;g&&n&&f!==m;){const y=Hp(g),v=g.getBoundingClientRect(),E=ta(g),w=v.left+(g.clientLeft+parseFloat(E.paddingLeft))*y.x,S=v.top+(g.clientTop+parseFloat(E.paddingTop))*y.y;c*=y.x,l*=y.y,d*=y.x,u*=y.y,c+=w,l+=S,m=Mo(g),g=Lx(m)}}return Sb({width:d,height:u,x:c,y:l})}function aP(e,t){const r=mS(e).scrollLeft;return t?t.left+r:eh(bc(e)).left+r}function Y9(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),i=n.left+t.scrollLeft-(r?0:aP(e,n)),o=n.top+t.scrollTop;return{x:i,y:o}}function U0e(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const o=i==="fixed",s=bc(n),a=t?fS(t.floating):!1;if(n===s||a&&o)return r;let c={scrollLeft:0,scrollTop:0},l=hc(1);const d=hc(0),u=Wn(n);if((u||!u&&!o)&&((jd(n)!=="body"||_y(s))&&(c=mS(n)),Wn(n))){const f=eh(n);l=Hp(n),d.x=f.x+n.clientLeft,d.y=f.y+n.clientTop}const p=s&&!u&&!o?Y9(s,c,!0):hc(0);return{width:r.width*l.x,height:r.height*l.y,x:r.x*l.x-c.scrollLeft*l.x+d.x+p.x,y:r.y*l.y-c.scrollTop*l.y+d.y+p.y}}function F0e(e){return Array.from(e.getClientRects())}function V0e(e){const t=bc(e),r=mS(e),n=e.ownerDocument.body,i=ju(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),o=ju(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+aP(e);const a=-r.scrollTop;return ta(n).direction==="rtl"&&(s+=ju(t.clientWidth,n.clientWidth)-i),{width:i,height:o,x:s,y:a}}function B0e(e,t){const r=Mo(e),n=bc(e),i=r.visualViewport;let o=n.clientWidth,s=n.clientHeight,a=0,c=0;if(i){o=i.width,s=i.height;const l=Qk();(!l||l&&t==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:o,height:s,x:a,y:c}}function $0e(e,t){const r=eh(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,o=Wn(e)?Hp(e):hc(1),s=e.clientWidth*o.x,a=e.clientHeight*o.y,c=i*o.x,l=n*o.y;return{width:s,height:a,x:c,y:l}}function yj(e,t,r){let n;if(t==="viewport")n=B0e(e,r);else if(t==="document")n=V0e(bc(e));else if(zr(t))n=$0e(t,r);else{const i=q9(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Sb(n)}function X9(e,t){const r=dl(e);return r===t||!zr(r)||Id(r)?!1:ta(r).position==="fixed"||X9(r,t)}function H0e(e,t){const r=t.get(e);if(r)return r;let n=gd(e,[],!1).filter(a=>zr(a)&&jd(a)!=="body"),i=null;const o=ta(e).position==="fixed";let s=o?dl(e):e;for(;zr(s)&&!Id(s);){const a=ta(s),c=Jk(s);!c&&a.position==="fixed"&&(i=null),(o?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||_y(s)&&!c&&X9(e,s))?n=n.filter(d=>d!==s):i=a,s=dl(s)}return t.set(e,n),n}function W0e(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const s=[...r==="clippingAncestors"?fS(t)?[]:H0e(t,this._c):[].concat(r),n],a=s[0],c=s.reduce((l,d)=>{const u=yj(t,d,i);return l.top=ju(u.top,l.top),l.right=ff(u.right,l.right),l.bottom=ff(u.bottom,l.bottom),l.left=ju(u.left,l.left),l},yj(t,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function G0e(e){const{width:t,height:r}=K9(e);return{width:t,height:r}}function z0e(e,t,r){const n=Wn(t),i=bc(t),o=r==="fixed",s=eh(e,!0,o,t);let a={scrollLeft:0,scrollTop:0};const c=hc(0);if(n||!n&&!o)if((jd(t)!=="body"||_y(i))&&(a=mS(t)),n){const p=eh(t,!0,o,t);c.x=p.x+t.clientLeft,c.y=p.y+t.clientTop}else i&&(c.x=aP(i));const l=i&&!n&&!o?Y9(i,a):hc(0),d=s.left+a.scrollLeft-c.x-l.x,u=s.top+a.scrollTop-c.y-l.y;return{x:d,y:u,width:s.width,height:s.height}}function pC(e){return ta(e).position==="static"}function vj(e,t){if(!Wn(e)||ta(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return bc(e)===r&&(r=r.ownerDocument.body),r}function J9(e,t){const r=Mo(e);if(fS(e))return r;if(!Wn(e)){let i=dl(e);for(;i&&!Id(i);){if(zr(i)&&!pC(i))return i;i=dl(i)}return r}let n=vj(e,t);for(;n&&Xge(n)&&pC(n);)n=vj(n,t);return n&&Id(n)&&pC(n)&&!Jk(n)?r:n||Jge(e)||r}const K0e=async function(e){const t=this.getOffsetParent||J9,r=this.getDimensions,n=await r(e.floating);return{reference:z0e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function q0e(e){return ta(e).direction==="rtl"}const Y0e={convertOffsetParentRelativeRectToViewportRelativeRect:U0e,getDocumentElement:bc,getClippingRect:W0e,getOffsetParent:J9,getElementRects:K0e,getClientRects:F0e,getDimensions:G0e,getScale:Hp,isElement:zr,isRTL:q0e};function X0e(e,t){let r=null,n;const i=bc(e);function o(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function s(a,c){a===void 0&&(a=!1),c===void 0&&(c=1),o();const{left:l,top:d,width:u,height:p}=e.getBoundingClientRect();if(a||t(),!u||!p)return;const f=_p(d),m=_p(i.clientWidth-(l+u)),g=_p(i.clientHeight-(d+p)),y=_p(l),E={rootMargin:-f+"px "+-m+"px "+-g+"px "+-y+"px",threshold:ju(0,ff(1,c))||1};let w=!0;function S(A){const N=A[0].intersectionRatio;if(N!==c){if(!w)return s();N?s(!1,N):n=setTimeout(()=>{s(!1,1e-7)},1e3)}w=!1}try{r=new IntersectionObserver(S,{...E,root:i.ownerDocument})}catch{r=new IntersectionObserver(S,E)}r.observe(e)}return s(!0),o}function Q9(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,l=sP(e),d=i||o?[...l?gd(l):[],...gd(t)]:[];d.forEach(v=>{i&&v.addEventListener("scroll",r,{passive:!0}),o&&v.addEventListener("resize",r)});const u=l&&a?X0e(l,r):null;let p=-1,f=null;s&&(f=new ResizeObserver(v=>{let[E]=v;E&&E.target===l&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var w;(w=f)==null||w.observe(t)})),r()}),l&&!c&&f.observe(l),f.observe(t));let m,g=c?eh(e):null;c&&y();function y(){const v=eh(e);g&&(v.x!==g.x||v.y!==g.y||v.width!==g.width||v.height!==g.height)&&r(),g=v,m=requestAnimationFrame(y)}return r(),()=>{var v;d.forEach(E=>{i&&E.removeEventListener("scroll",r),o&&E.removeEventListener("resize",r)}),u==null||u(),(v=f)==null||v.disconnect(),f=null,c&&cancelAnimationFrame(m)}}const J0e=D0e,Q0e=N0e,Z0e=L0e,eye=k0e,Ej=x0e,tye=(e,t,r)=>{const n=new Map,i={platform:Y0e,...r},o={...i.platform,_c:n};return A0e(e,t,{...i,platform:o})};var qE=typeof document<"u"?T.useLayoutEffect:T.useEffect;function Ib(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Ib(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){const o=i[n];if(!(o==="_owner"&&e.$$typeof)&&!Ib(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function Z9(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function _j(e,t){const r=Z9(e);return Math.round(t*r)/r}function fC(e){const t=T.useRef(e);return qE(()=>{t.current=e}),t}function rye(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:c,open:l}=e,[d,u]=T.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[p,f]=T.useState(n);Ib(p,n)||f(n);const[m,g]=T.useState(null),[y,v]=T.useState(null),E=T.useCallback(O=>{O!==N.current&&(N.current=O,g(O))},[]),w=T.useCallback(O=>{O!==L.current&&(L.current=O,v(O))},[]),S=o||m,A=s||y,N=T.useRef(null),L=T.useRef(null),j=T.useRef(d),W=c!=null,V=fC(c),Y=fC(i),Z=fC(l),te=T.useCallback(()=>{if(!N.current||!L.current)return;const O={placement:t,strategy:r,middleware:p};Y.current&&(O.platform=Y.current),tye(N.current,L.current,O).then(F=>{const P={...F,isPositioned:Z.current!==!1};H.current&&!Ib(j.current,P)&&(j.current=P,Aw.flushSync(()=>{u(P)}))})},[p,t,r,Y,Z]);qE(()=>{l===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,u(O=>({...O,isPositioned:!1})))},[l]);const H=T.useRef(!1);qE(()=>(H.current=!0,()=>{H.current=!1}),[]),qE(()=>{if(S&&(N.current=S),A&&(L.current=A),S&&A){if(V.current)return V.current(S,A,te);te()}},[S,A,te,V,W]);const $=T.useMemo(()=>({reference:N,floating:L,setReference:E,setFloating:w}),[E,w]),K=T.useMemo(()=>({reference:S,floating:A}),[S,A]),x=T.useMemo(()=>{const O={position:r,left:0,top:0};if(!K.floating)return O;const F=_j(K.floating,d.x),P=_j(K.floating,d.y);return a?{...O,transform:"translate("+F+"px, "+P+"px)",...Z9(K.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:F,top:P}},[r,a,K.floating,d.x,d.y]);return T.useMemo(()=>({...d,update:te,refs:$,elements:K,floatingStyles:x}),[d,te,$,K,x])}const nye=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:i}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?Ej({element:n.current,padding:i}).fn(r):{}:n?Ej({element:n,padding:i}).fn(r):{}}}},iye=(e,t)=>({...J0e(e),options:[e,t]}),oye=(e,t)=>({...Z0e(e),options:[e,t]}),sye=(e,t)=>({...eye(e),options:[e,t]}),aye=(e,t)=>({...Q0e(e),options:[e,t]}),cye=(e,t)=>({...nye(e),options:[e,t]});function ez(e){return T.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})},e)}const tz={...e$},lye=tz.useInsertionEffect,dye=lye||(e=>e());function ki(e){const t=T.useRef(()=>{});return dye(()=>{t.current=e}),T.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}const cP="ArrowUp",by="ArrowDown",yf="ArrowLeft",Jf="ArrowRight";function Rv(e,t,r){return Math.floor(e/t)!==r}function kg(e,t){return t<0||t>=e.current.length}function mC(e,t){return Hi(e,{disabledIndices:t})}function bj(e,t){return Hi(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:t})}function Hi(e,t){let{startingIndex:r=-1,decrement:n=!1,disabledIndices:i,amount:o=1}=t===void 0?{}:t;const s=e.current;let a=r;do a+=n?-o:o;while(a>=0&&a<=s.length-1&&YE(s,a,i));return a}function uye(e,t){let{event:r,orientation:n,loop:i,cols:o,disabledIndices:s,minIndex:a,maxIndex:c,prevIndex:l,stopEvent:d=!1}=t,u=l;if(r.key===cP){if(d&&Oi(r),l===-1)u=c;else if(u=Hi(e,{startingIndex:u,amount:o,decrement:!0,disabledIndices:s}),i&&(l-o<a||u<0)){const p=l%o,f=c%o,m=c-(f-p);f===p?u=c:u=f>p?m:m-o}kg(e,u)&&(u=l)}if(r.key===by&&(d&&Oi(r),l===-1?u=a:(u=Hi(e,{startingIndex:l,amount:o,disabledIndices:s}),i&&l+o>c&&(u=Hi(e,{startingIndex:l%o-o,amount:o,disabledIndices:s}))),kg(e,u)&&(u=l)),n==="both"){const p=_p(l/o);r.key===Jf&&(d&&Oi(r),l%o!==o-1?(u=Hi(e,{startingIndex:l,disabledIndices:s}),i&&Rv(u,o,p)&&(u=Hi(e,{startingIndex:l-l%o-1,disabledIndices:s}))):i&&(u=Hi(e,{startingIndex:l-l%o-1,disabledIndices:s})),Rv(u,o,p)&&(u=l)),r.key===yf&&(d&&Oi(r),l%o!==0?(u=Hi(e,{startingIndex:l,decrement:!0,disabledIndices:s}),i&&Rv(u,o,p)&&(u=Hi(e,{startingIndex:l+(o-l%o),decrement:!0,disabledIndices:s}))):i&&(u=Hi(e,{startingIndex:l+(o-l%o),decrement:!0,disabledIndices:s})),Rv(u,o,p)&&(u=l));const f=_p(c/o)===p;kg(e,u)&&(i&&f?u=r.key===yf?c:Hi(e,{startingIndex:l-l%o-1,disabledIndices:s}):u=l)}return u}function hye(e,t,r){const n=[];let i=0;return e.forEach((o,s)=>{let{width:a,height:c}=o,l=!1;for(r&&(i=0);!l;){const d=[];for(let u=0;u<a;u++)for(let p=0;p<c;p++)d.push(i+u+p*t);i%t+a<=t&&d.every(u=>n[u]==null)?(d.forEach(u=>{n[u]=s}),l=!0):i++}}),[...n]}function pye(e,t,r,n,i){if(e===-1)return-1;const o=r.indexOf(e),s=t[e];switch(i){case"tl":return o;case"tr":return s?o+s.width-1:o;case"bl":return s?o+(s.height-1)*n:o;case"br":return r.lastIndexOf(e)}}function fye(e,t){return t.flatMap((r,n)=>e.includes(r)?[n]:[])}function YE(e,t,r){if(r)return r.includes(t);const n=e[t];return n==null||n.hasAttribute("disabled")||n.getAttribute("aria-disabled")==="true"}let wj=0;function Hl(e,t){t===void 0&&(t={});const{preventScroll:r=!1,cancelPrevious:n=!0,sync:i=!1}=t;n&&cancelAnimationFrame(wj);const o=()=>e==null?void 0:e.focus({preventScroll:r});i?o():wj=requestAnimationFrame(o)}var Vr=typeof document<"u"?T.useLayoutEffect:T.useEffect;function mye(e,t){const r=e.compareDocumentPosition(t);return r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS?1:0}function gye(e,t){if(e.size!==t.size)return!1;for(const[r,n]of e.entries())if(n!==t.get(r))return!1;return!0}const rz=T.createContext({register:()=>{},unregister:()=>{},map:new Map,elementsRef:{current:[]}});function yye(e){const{children:t,elementsRef:r,labelsRef:n}=e,[i,o]=T.useState(()=>new Map),s=T.useCallback(c=>{o(l=>new Map(l).set(c,null))},[]),a=T.useCallback(c=>{o(l=>{const d=new Map(l);return d.delete(c),d})},[]);return Vr(()=>{const c=new Map(i);Array.from(c.keys()).sort(mye).forEach((d,u)=>{c.set(d,u)}),gye(i,c)||o(c)},[i]),T.createElement(rz.Provider,{value:T.useMemo(()=>({register:s,unregister:a,map:i,elementsRef:r,labelsRef:n}),[s,a,i,r,n])},t)}function vye(e){e===void 0&&(e={});const{label:t}=e,{register:r,unregister:n,map:i,elementsRef:o,labelsRef:s}=T.useContext(rz),[a,c]=T.useState(null),l=T.useRef(null),d=T.useCallback(u=>{if(l.current=u,a!==null&&(o.current[a]=u,s)){var p;const f=t!==void 0;s.current[a]=f?t:(p=u==null?void 0:u.textContent)!=null?p:null}},[a,o,s,t]);return Vr(()=>{const u=l.current;if(u)return r(u),()=>{n(u)}},[r,n]),Vr(()=>{const u=l.current?i.get(l.current):null;u!=null&&c(u)},[i]),T.useMemo(()=>({ref:d,index:a??-1}),[a,d])}function R0(){return R0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},R0.apply(this,arguments)}let Sj=!1,Eye=0;const Tj=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Eye++;function _ye(){const[e,t]=T.useState(()=>Sj?Tj():void 0);return Vr(()=>{e==null&&t(Tj())},[]),T.useEffect(()=>{Sj=!0},[]),e}const bye=tz.useId,gS=bye||_ye;function wye(){const e=new Map;return{emit(t,r){var n;(n=e.get(t))==null||n.forEach(i=>i(r))},on(t,r){e.set(t,[...e.get(t)||[],r])},off(t,r){var n;e.set(t,((n=e.get(t))==null?void 0:n.filter(i=>i!==r))||[])}}}const Sye=T.createContext(null),Tye=T.createContext(null),yS=()=>{var e;return((e=T.useContext(Sye))==null?void 0:e.id)||null},wy=()=>T.useContext(Tye);function Ad(e){return"data-floating-ui-"+e}function ts(e){const t=T.useRef(e);return Vr(()=>{t.current=e}),t}const Cj=Ad("safe-polygon");function gC(e,t,r){return r&&!T0(r)?0:typeof e=="number"?e:e==null?void 0:e[t]}function Cye(e,t){t===void 0&&(t={});const{open:r,onOpenChange:n,dataRef:i,events:o,elements:s}=e,{enabled:a=!0,delay:c=0,handleClose:l=null,mouseOnly:d=!1,restMs:u=0,move:p=!0}=t,f=wy(),m=yS(),g=ts(l),y=ts(c),v=ts(r),E=T.useRef(),w=T.useRef(-1),S=T.useRef(),A=T.useRef(-1),N=T.useRef(!0),L=T.useRef(!1),j=T.useRef(()=>{}),W=T.useCallback(()=>{var $;const K=($=i.current.openEvent)==null?void 0:$.type;return(K==null?void 0:K.includes("mouse"))&&K!=="mousedown"},[i]);T.useEffect(()=>{if(!a)return;function $(K){let{open:x}=K;x||(clearTimeout(w.current),clearTimeout(A.current),N.current=!0)}return o.on("openchange",$),()=>{o.off("openchange",$)}},[a,o]),T.useEffect(()=>{if(!a||!g.current||!r)return;function $(x){W()&&n(!1,x,"hover")}const K=gi(s.floating).documentElement;return K.addEventListener("mouseleave",$),()=>{K.removeEventListener("mouseleave",$)}},[s.floating,r,n,a,g,W]);const V=T.useCallback(function($,K,x){K===void 0&&(K=!0),x===void 0&&(x="hover");const O=gC(y.current,"close",E.current);O&&!S.current?(clearTimeout(w.current),w.current=window.setTimeout(()=>n(!1,$,x),O)):K&&(clearTimeout(w.current),n(!1,$,x))},[y,n]),Y=ki(()=>{j.current(),S.current=void 0}),Z=ki(()=>{if(L.current){const $=gi(s.floating).body;$.style.pointerEvents="",$.removeAttribute(Cj),L.current=!1}});T.useEffect(()=>{if(!a)return;function $(){return i.current.openEvent?["click","mousedown"].includes(i.current.openEvent.type):!1}function K(P){if(clearTimeout(w.current),N.current=!1,d&&!T0(E.current)||u>0&&!gC(y.current,"open"))return;const _=gC(y.current,"open",E.current);_?w.current=window.setTimeout(()=>{v.current||n(!0,P,"hover")},_):n(!0,P,"hover")}function x(P){if($())return;j.current();const _=gi(s.floating);if(clearTimeout(A.current),g.current&&i.current.floatingContext){r||clearTimeout(w.current),S.current=g.current({...i.current.floatingContext,tree:f,x:P.clientX,y:P.clientY,onClose(){Z(),Y(),V(P,!0,"safe-polygon")}});const k=S.current;_.addEventListener("mousemove",k),j.current=()=>{_.removeEventListener("mousemove",k)};return}(E.current==="touch"?!Bn(s.floating,P.relatedTarget):!0)&&V(P)}function O(P){$()||i.current.floatingContext&&(g.current==null||g.current({...i.current.floatingContext,tree:f,x:P.clientX,y:P.clientY,onClose(){Z(),Y(),V(P)}})(P))}if(zr(s.domReference)){var F;const P=s.domReference;return r&&P.addEventListener("mouseleave",O),(F=s.floating)==null||F.addEventListener("mouseleave",O),p&&P.addEventListener("mousemove",K,{once:!0}),P.addEventListener("mouseenter",K),P.addEventListener("mouseleave",x),()=>{var _;r&&P.removeEventListener("mouseleave",O),(_=s.floating)==null||_.removeEventListener("mouseleave",O),p&&P.removeEventListener("mousemove",K),P.removeEventListener("mouseenter",K),P.removeEventListener("mouseleave",x)}}},[s,a,e,d,u,p,V,Y,Z,n,r,v,f,y,g,i]),Vr(()=>{var $;if(a&&r&&($=g.current)!=null&&$.__options.blockPointerEvents&&W()){const x=gi(s.floating).body;x.setAttribute(Cj,""),x.style.pointerEvents="none",L.current=!0;const O=s.floating;if(zr(s.domReference)&&O){var K;const F=s.domReference,P=f==null||(K=f.nodesRef.current.find(_=>_.id===m))==null||(K=K.context)==null?void 0:K.elements.floating;return P&&(P.style.pointerEvents=""),F.style.pointerEvents="auto",O.style.pointerEvents="auto",()=>{F.style.pointerEvents="",O.style.pointerEvents=""}}}},[a,r,m,s,f,g,W]),Vr(()=>{r||(E.current=void 0,Y(),Z())},[r,Y,Z]),T.useEffect(()=>()=>{Y(),clearTimeout(w.current),clearTimeout(A.current),Z()},[a,s.domReference,Y,Z]);const te=T.useMemo(()=>{function $(K){E.current=K.pointerType}return{onPointerDown:$,onPointerEnter:$,onMouseMove(K){const{nativeEvent:x}=K;function O(){!N.current&&!v.current&&n(!0,x,"hover")}d&&!T0(E.current)||r||u===0||(clearTimeout(A.current),E.current==="touch"?O():A.current=window.setTimeout(O,u))}}},[d,n,r,v,u]),H=T.useMemo(()=>({onMouseEnter(){clearTimeout(w.current)},onMouseLeave($){V($.nativeEvent,!1)}}),[V]);return T.useMemo(()=>a?{reference:te,floating:H}:{},[a,te,H])}function Rye(e,t){var r;let n=[],i=(r=e.find(o=>o.id===t))==null?void 0:r.parentId;for(;i;){const o=e.find(s=>s.id===i);i=o==null?void 0:o.parentId,o&&(n=n.concat(o))}return n}function Uu(e,t){let r=e.filter(i=>{var o;return i.parentId===t&&((o=i.context)==null?void 0:o.open)}),n=r;for(;n.length;)n=e.filter(i=>{var o;return(o=n)==null?void 0:o.some(s=>{var a;return i.parentId===s.id&&((a=i.context)==null?void 0:a.open)})}),r=r.concat(n);return r}function Iye(e,t){let r,n=-1;function i(o,s){s>n&&(r=o,n=s),Uu(e,o).forEach(c=>{i(c.id,s+1)})}return i(t,0),e.find(o=>o.id===r)}let Mh=new WeakMap,Iv=new WeakSet,Av={},yC=0;const Aye=()=>typeof HTMLElement<"u"&&"inert"in HTMLElement.prototype,nz=e=>e&&(e.host||nz(e.parentNode)),xye=(e,t)=>t.map(r=>{if(e.contains(r))return r;const n=nz(r);return e.contains(n)?n:null}).filter(r=>r!=null);function Oye(e,t,r,n){const i="data-floating-ui-inert",o=n?"inert":r?"aria-hidden":null,s=xye(t,e),a=new Set,c=new Set(s),l=[];Av[i]||(Av[i]=new WeakMap);const d=Av[i];s.forEach(u),p(t),a.clear();function u(f){!f||a.has(f)||(a.add(f),f.parentNode&&u(f.parentNode))}function p(f){!f||c.has(f)||[].forEach.call(f.children,m=>{if(jd(m)!=="script")if(a.has(m))p(m);else{const g=o?m.getAttribute(o):null,y=g!==null&&g!=="false",v=(Mh.get(m)||0)+1,E=(d.get(m)||0)+1;Mh.set(m,v),d.set(m,E),l.push(m),v===1&&y&&Iv.add(m),E===1&&m.setAttribute(i,""),!y&&o&&m.setAttribute(o,"true")}})}return yC++,()=>{l.forEach(f=>{const m=(Mh.get(f)||0)-1,g=(d.get(f)||0)-1;Mh.set(f,m),d.set(f,g),m||(!Iv.has(f)&&o&&f.removeAttribute(o),Iv.delete(f)),g||f.removeAttribute(i)}),yC--,yC||(Mh=new WeakMap,Mh=new WeakMap,Iv=new WeakSet,Av={})}}function Rj(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);const n=gi(e[0]).body;return Oye(e.concat(Array.from(n.querySelectorAll("[aria-live]"))),n,t,r)}const vf=()=>({getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function iz(e,t){const r=C0(e,vf());t==="prev"&&r.reverse();const n=r.indexOf(Ta(gi(e)));return r.slice(n+1)[0]}function oz(){return iz(document.body,"next")}function sz(){return iz(document.body,"prev")}function Pg(e,t){const r=t||e.currentTarget,n=e.relatedTarget;return!n||!Bn(r,n)}function Nye(e){C0(e,vf()).forEach(r=>{r.dataset.tabindex=r.getAttribute("tabindex")||"",r.setAttribute("tabindex","-1")})}function kye(e){e.querySelectorAll("[data-tabindex]").forEach(r=>{const n=r.dataset.tabindex;delete r.dataset.tabindex,n?r.setAttribute("tabindex",n):r.removeAttribute("tabindex")})}function Pye(e,t,r){const n=e.indexOf(t);function i(s){const a=Ad("focus-guard");let c=n+(s?1:0),l=e[c];for(;l&&(!l.isConnected||l.hasAttribute(a)||Bn(r,l));)s?c++:c--,l=e[c];return l}const o=i(!0);return o||i(!1)}const lP={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};let Dye;function Ij(e){e.key==="Tab"&&(e.target,clearTimeout(Dye))}const Ab=T.forwardRef(function(t,r){const[n,i]=T.useState();Vr(()=>(tP()&&i("button"),document.addEventListener("keydown",Ij),()=>{document.removeEventListener("keydown",Ij)}),[]);const o={ref:r,tabIndex:0,role:n,"aria-hidden":n?void 0:!0,[Ad("focus-guard")]:"",style:lP};return T.createElement("span",R0({},t,o))}),az=T.createContext(null),Aj=Ad("portal");function Lye(e){e===void 0&&(e={});const{id:t,root:r}=e,n=gS(),i=cz(),[o,s]=T.useState(null),a=T.useRef(null);return Vr(()=>()=>{o==null||o.remove(),queueMicrotask(()=>{a.current=null})},[o]),Vr(()=>{if(!n||a.current)return;const c=t?document.getElementById(t):null;if(!c)return;const l=document.createElement("div");l.id=n,l.setAttribute(Aj,""),c.appendChild(l),a.current=l,s(l)},[t,n]),Vr(()=>{if(!n||a.current)return;let c=r||(i==null?void 0:i.portalNode);c&&!zr(c)&&(c=c.current),c=c||document.body;let l=null;t&&(l=document.createElement("div"),l.id=t,c.appendChild(l));const d=document.createElement("div");d.id=n,d.setAttribute(Aj,""),c=l||c,c.appendChild(d),a.current=d,s(d)},[t,r,n,i]),o}function Mye(e){const{children:t,id:r,root:n=null,preserveTabOrder:i=!0}=e,o=Lye({id:r,root:n}),[s,a]=T.useState(null),c=T.useRef(null),l=T.useRef(null),d=T.useRef(null),u=T.useRef(null),p=!!s&&!s.modal&&s.open&&i&&!!(n||o);return T.useEffect(()=>{if(!o||!i||s!=null&&s.modal)return;function f(m){o&&Pg(m)&&(m.type==="focusin"?kye:Nye)(o)}return o.addEventListener("focusin",f,!0),o.addEventListener("focusout",f,!0),()=>{o.removeEventListener("focusin",f,!0),o.removeEventListener("focusout",f,!0)}},[o,i,s==null?void 0:s.modal]),T.createElement(az.Provider,{value:T.useMemo(()=>({preserveTabOrder:i,beforeOutsideRef:c,afterOutsideRef:l,beforeInsideRef:d,afterInsideRef:u,portalNode:o,setFocusManagerState:a}),[i,o])},p&&o&&T.createElement(Ab,{"data-type":"outside",ref:c,onFocus:f=>{if(Pg(f,o)){var m;(m=d.current)==null||m.focus()}else{const g=sz()||(s==null?void 0:s.refs.domReference.current);g==null||g.focus()}}}),p&&o&&T.createElement("span",{"aria-owns":o.id,style:lP}),o&&Aw.createPortal(t,o),p&&o&&T.createElement(Ab,{"data-type":"outside",ref:l,onFocus:f=>{if(Pg(f,o)){var m;(m=u.current)==null||m.focus()}else{const g=oz()||(s==null?void 0:s.refs.domReference.current);g==null||g.focus(),s!=null&&s.closeOnFocusOut&&(s==null||s.onOpenChange(!1,f.nativeEvent))}}}))}const cz=()=>T.useContext(az),xj=20;let cu=[];function vC(e){cu=cu.filter(r=>r.isConnected);let t=e;if(!(!t||jd(t)==="body")){if(!I0e(t,vf())){const r=C0(t,vf())[0];r&&(t=r)}cu.push(t),cu.length>xj&&(cu=cu.slice(-xj))}}function Oj(){return cu.slice().reverse().find(e=>e.isConnected)}const jye=T.forwardRef(function(t,r){return T.createElement("button",R0({},t,{type:"button",ref:r,tabIndex:-1,style:lP}))});function lz(e){const{context:t,children:r,disabled:n=!1,order:i=["content"],guards:o=!0,initialFocus:s=0,returnFocus:a=!0,restoreFocus:c=!1,modal:l=!0,visuallyHiddenDismiss:d=!1,closeOnFocusOut:u=!0}=e,{open:p,refs:f,nodeId:m,onOpenChange:g,events:y,dataRef:v,floatingId:E,elements:{domReference:w,floating:S}}=t,A=typeof s=="number"&&s<0,N=F9(w)&&A,L=Aye()?o:!0,j=ts(i),W=ts(s),V=ts(a),Y=wy(),Z=cz(),te=T.useRef(null),H=T.useRef(null),$=T.useRef(!1),K=T.useRef(!1),x=T.useRef(-1),O=Z!=null,F=S==null?void 0:S.firstElementChild,P=(F==null?void 0:F.id)===E?F:S,_=ki(function(U){return U===void 0&&(U=P),U?C0(U,vf()):[]}),R=ki(U=>{const q=_(U);return j.current.map(ie=>w&&ie==="reference"?w:P&&ie==="floating"?P:q).filter(Boolean).flat()});T.useEffect(()=>{if(n||!l)return;function U(ie){if(ie.key==="Tab"){Bn(P,Ta(gi(P)))&&_().length===0&&!N&&Oi(ie);const ue=R(),me=Kc(ie);j.current[0]==="reference"&&me===w&&(Oi(ie),ie.shiftKey?Hl(ue[ue.length-1]):Hl(ue[1])),j.current[1]==="floating"&&me===P&&ie.shiftKey&&(Oi(ie),Hl(ue[0]))}}const q=gi(P);return q.addEventListener("keydown",U),()=>{q.removeEventListener("keydown",U)}},[n,w,P,l,j,N,_,R]),T.useEffect(()=>{if(n||!S)return;function U(q){const ie=Kc(q),me=_().indexOf(ie);me!==-1&&(x.current=me)}return S.addEventListener("focusin",U),()=>{S.removeEventListener("focusin",U)}},[n,S,_]),T.useEffect(()=>{if(n||!u)return;function U(){K.current=!0,setTimeout(()=>{K.current=!1})}function q(ie){const ue=ie.relatedTarget;queueMicrotask(()=>{const me=!(Bn(w,ue)||Bn(S,ue)||Bn(ue,S)||Bn(Z==null?void 0:Z.portalNode,ue)||ue!=null&&ue.hasAttribute(Ad("focus-guard"))||Y&&(Uu(Y.nodesRef.current,m).find(De=>{var He,Pe;return Bn((He=De.context)==null?void 0:He.elements.floating,ue)||Bn((Pe=De.context)==null?void 0:Pe.elements.domReference,ue)})||Rye(Y.nodesRef.current,m).find(De=>{var He,Pe;return((He=De.context)==null?void 0:He.elements.floating)===ue||((Pe=De.context)==null?void 0:Pe.elements.domReference)===ue})));if(c&&me&&Ta(gi(P))===gi(P).body){Wn(P)&&(P==null||P.focus());const De=x.current,He=_(),Pe=He[De]||He[He.length-1]||P;Wn(Pe)&&Pe.focus()}(N||!l)&&ue&&me&&!K.current&&ue!==Oj()&&($.current=!0,g(!1,ie))})}if(S&&Wn(w))return w.addEventListener("focusout",q),w.addEventListener("pointerdown",U),S.addEventListener("focusout",q),()=>{w.removeEventListener("focusout",q),w.removeEventListener("pointerdown",U),S.removeEventListener("focusout",q)}},[n,w,S,P,l,m,Y,Z,g,u,c,_,N]),T.useEffect(()=>{var U;if(n)return;const q=Array.from((Z==null||(U=Z.portalNode)==null?void 0:U.querySelectorAll("["+Ad("portal")+"]"))||[]);if(S){const ie=[S,...q,te.current,H.current,j.current.includes("reference")||N?w:null].filter(me=>me!=null),ue=l||N?Rj(ie,L,!L):Rj(ie);return()=>{ue()}}},[n,w,S,l,j,Z,N,L]),Vr(()=>{if(n||!Wn(P))return;const U=gi(P),q=Ta(U);queueMicrotask(()=>{const ie=R(P),ue=W.current,me=(typeof ue=="number"?ie[ue]:ue.current)||P,De=Bn(P,q);!A&&!De&&p&&Hl(me,{preventScroll:me===P})})},[n,p,P,A,R,W]),Vr(()=>{if(n||!P)return;let U=!1;const q=gi(P),ie=Ta(q);let me=v.current.openEvent;const De=f.domReference.current;vC(ie);function He(Pe){let{open:nt,reason:Rt,event:Ye,nested:_t}=Pe;nt&&(me=Ye),Rt==="escape-key"&&f.domReference.current&&vC(f.domReference.current),Rt==="hover"&&Ye.type==="mouseleave"&&($.current=!0),Rt==="outside-press"&&(_t?($.current=!1,U=!0):$.current=!(j9(Ye)||eP(Ye)))}return y.on("openchange",He),()=>{y.off("openchange",He);const Pe=Ta(q),nt=Bn(S,Pe)||Y&&Uu(Y.nodesRef.current,m).some(Te=>{var Ze;return Bn((Ze=Te.context)==null?void 0:Ze.elements.floating,Pe)});(nt||me&&["click","mousedown"].includes(me.type))&&f.domReference.current&&vC(f.domReference.current);const Ye=De||ie,_t=C0(gi(Ye).body,vf());queueMicrotask(()=>{let Te=Oj();!Te&&Wn(Ye)&&S&&(Te=Pye(_t,Ye,S)),V.current&&!$.current&&Wn(Te)&&(!(Te!==Pe&&Pe!==q.body)||nt)&&Te.focus({preventScroll:U})})}},[n,S,P,V,v,f,y,Y,m]),Vr(()=>{if(!n&&Z)return Z.setFocusManagerState({modal:l,closeOnFocusOut:u,open:p,onOpenChange:g,refs:f}),()=>{Z.setFocusManagerState(null)}},[n,Z,l,p,g,f,u]),Vr(()=>{if(n||!P||typeof MutationObserver!="function"||A)return;const U=()=>{const ie=P.getAttribute("tabindex"),ue=_(),me=Ta(gi(S)),De=ue.indexOf(me);De!==-1&&(x.current=De),j.current.includes("floating")||me!==f.domReference.current&&ue.length===0?ie!=="0"&&P.setAttribute("tabindex","0"):ie!=="-1"&&P.setAttribute("tabindex","-1")};U();const q=new MutationObserver(U);return q.observe(P,{childList:!0,subtree:!0,attributes:!0}),()=>{q.disconnect()}},[n,S,P,f,j,_,A]);function k(U){return n||!d||!l?null:T.createElement(jye,{ref:U==="start"?te:H,onClick:q=>g(!1,q.nativeEvent)},typeof d=="string"?d:"Dismiss")}const z=!n&&L&&(l?!N:!0)&&(O||l);return T.createElement(T.Fragment,null,z&&T.createElement(Ab,{"data-type":"inside",ref:Z==null?void 0:Z.beforeInsideRef,onFocus:U=>{if(l){const ie=R();Hl(i[0]==="reference"?ie[0]:ie[ie.length-1])}else if(Z!=null&&Z.preserveTabOrder&&Z.portalNode)if($.current=!1,Pg(U,Z.portalNode)){const ie=oz()||w;ie==null||ie.focus()}else{var q;(q=Z.beforeOutsideRef.current)==null||q.focus()}}}),!N&&k("start"),r,k("end"),z&&T.createElement(Ab,{"data-type":"inside",ref:Z==null?void 0:Z.afterInsideRef,onFocus:U=>{if(l)Hl(R()[0]);else if(Z!=null&&Z.preserveTabOrder&&Z.portalNode)if(u&&($.current=!0),Pg(U,Z.portalNode)){const ie=sz()||w;ie==null||ie.focus()}else{var q;(q=Z.afterOutsideRef.current)==null||q.focus()}}}))}const EC=new Set,Uye=T.forwardRef(function(t,r){const{lockScroll:n=!1,...i}=t,o=gS();return Vr(()=>{if(!n)return;EC.add(o);const s=/iP(hone|ad|od)|iOS/.test(Zk()),a=document.body.style,l=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",d=window.innerWidth-document.documentElement.clientWidth,u=a.left?parseFloat(a.left):window.scrollX,p=a.top?parseFloat(a.top):window.scrollY;if(a.overflow="hidden",d&&(a[l]=d+"px"),s){var f,m;const g=((f=window.visualViewport)==null?void 0:f.offsetLeft)||0,y=((m=window.visualViewport)==null?void 0:m.offsetTop)||0;Object.assign(a,{position:"fixed",top:-(p-Math.floor(y))+"px",left:-(u-Math.floor(g))+"px",right:"0"})}return()=>{EC.delete(o),EC.size===0&&(Object.assign(a,{overflow:"",[l]:""}),s&&(Object.assign(a,{position:"",top:"",left:"",right:""}),window.scrollTo(u,p)))}},[o,n]),T.createElement("div",R0({ref:r},i,{style:{position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0,...i.style}}))});function Nj(e){return Wn(e.target)&&e.target.tagName==="BUTTON"}function kj(e){return rP(e)}function dz(e,t){t===void 0&&(t={});const{open:r,onOpenChange:n,dataRef:i,elements:{domReference:o}}=e,{enabled:s=!0,event:a="click",toggle:c=!0,ignoreMouse:l=!1,keyboardHandlers:d=!0}=t,u=T.useRef(),p=T.useRef(!1),f=T.useMemo(()=>({onPointerDown(m){u.current=m.pointerType},onMouseDown(m){const g=u.current;m.button===0&&a!=="click"&&(T0(g,!0)&&l||(r&&c&&(!i.current.openEvent||i.current.openEvent.type==="mousedown")?n(!1,m.nativeEvent,"click"):(m.preventDefault(),n(!0,m.nativeEvent,"click"))))},onClick(m){const g=u.current;if(a==="mousedown"&&u.current){u.current=void 0;return}T0(g,!0)&&l||(r&&c&&(!i.current.openEvent||i.current.openEvent.type==="click")?n(!1,m.nativeEvent,"click"):n(!0,m.nativeEvent,"click"))},onKeyDown(m){u.current=void 0,!(m.defaultPrevented||!d||Nj(m))&&(m.key===" "&&!kj(o)&&(m.preventDefault(),p.current=!0),m.key==="Enter"&&n(!(r&&c),m.nativeEvent,"click"))},onKeyUp(m){m.defaultPrevented||!d||Nj(m)||kj(o)||m.key===" "&&p.current&&(p.current=!1,n(!(r&&c),m.nativeEvent,"click"))}}),[i,o,a,l,d,n,r,c]);return T.useMemo(()=>s?{reference:f}:{},[s,f])}const Fye={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Vye={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Pj=e=>{var t,r;return{escapeKey:typeof e=="boolean"?e:(t=e==null?void 0:e.escapeKey)!=null?t:!1,outsidePress:typeof e=="boolean"?e:(r=e==null?void 0:e.outsidePress)!=null?r:!0}};function uz(e,t){t===void 0&&(t={});const{open:r,onOpenChange:n,elements:i,dataRef:o}=e,{enabled:s=!0,escapeKey:a=!0,outsidePress:c=!0,outsidePressEvent:l="pointerdown",referencePress:d=!1,referencePressEvent:u="pointerdown",ancestorScroll:p=!1,bubbles:f,capture:m}=t,g=wy(),y=ki(typeof c=="function"?c:()=>!1),v=typeof c=="function"?y:c,E=T.useRef(!1),w=T.useRef(!1),{escapeKey:S,outsidePress:A}=Pj(f),{escapeKey:N,outsidePress:L}=Pj(m),j=ki(H=>{var $;if(!r||!s||!a||H.key!=="Escape")return;const K=($=o.current.floatingContext)==null?void 0:$.nodeId,x=g?Uu(g.nodesRef.current,K):[];if(!S&&(H.stopPropagation(),x.length>0)){let O=!0;if(x.forEach(F=>{var P;if((P=F.context)!=null&&P.open&&!F.context.dataRef.current.__escapeKeyBubbles){O=!1;return}}),!O)return}n(!1,Zge(H)?H.nativeEvent:H,"escape-key")}),W=ki(H=>{var $;const K=()=>{var x;j(H),(x=Kc(H))==null||x.removeEventListener("keydown",K)};($=Kc(H))==null||$.addEventListener("keydown",K)}),V=ki(H=>{var $;const K=E.current;E.current=!1;const x=w.current;if(w.current=!1,l==="click"&&x||K||typeof v=="function"&&!v(H))return;const O=Kc(H),F="["+Ad("inert")+"]",P=gi(i.floating).querySelectorAll(F);let _=zr(O)?O:null;for(;_&&!Id(_);){const U=dl(_);if(Id(U)||!zr(U))break;_=U}if(P.length&&zr(O)&&!e0e(O)&&!Bn(O,i.floating)&&Array.from(P).every(U=>!Bn(_,U)))return;if(Wn(O)&&te){const U=O.clientWidth>0&&O.scrollWidth>O.clientWidth,q=O.clientHeight>0&&O.scrollHeight>O.clientHeight;let ie=q&&H.offsetX>O.clientWidth;if(q&&ta(O).direction==="rtl"&&(ie=H.offsetX<=O.offsetWidth-O.clientWidth),ie||U&&H.offsetY>O.clientHeight)return}const R=($=o.current.floatingContext)==null?void 0:$.nodeId,k=g&&Uu(g.nodesRef.current,R).some(U=>{var q;return hC(H,(q=U.context)==null?void 0:q.elements.floating)});if(hC(H,i.floating)||hC(H,i.domReference)||k)return;const z=g?Uu(g.nodesRef.current,R):[];if(z.length>0){let U=!0;if(z.forEach(q=>{var ie;if((ie=q.context)!=null&&ie.open&&!q.context.dataRef.current.__outsidePressBubbles){U=!1;return}}),!U)return}n(!1,H,"outside-press")}),Y=ki(H=>{var $;const K=()=>{var x;V(H),(x=Kc(H))==null||x.removeEventListener(l,K)};($=Kc(H))==null||$.addEventListener(l,K)});T.useEffect(()=>{if(!r||!s)return;o.current.__escapeKeyBubbles=S,o.current.__outsidePressBubbles=A;function H(x){n(!1,x,"ancestor-scroll")}const $=gi(i.floating);a&&$.addEventListener("keydown",N?W:j,N),v&&$.addEventListener(l,L?Y:V,L);let K=[];return p&&(zr(i.domReference)&&(K=gd(i.domReference)),zr(i.floating)&&(K=K.concat(gd(i.floating))),!zr(i.reference)&&i.reference&&i.reference.contextElement&&(K=K.concat(gd(i.reference.contextElement)))),K=K.filter(x=>{var O;return x!==((O=$.defaultView)==null?void 0:O.visualViewport)}),K.forEach(x=>{x.addEventListener("scroll",H,{passive:!0})}),()=>{a&&$.removeEventListener("keydown",N?W:j,N),v&&$.removeEventListener(l,L?Y:V,L),K.forEach(x=>{x.removeEventListener("scroll",H)})}},[o,i,a,v,l,r,n,p,s,S,A,j,N,W,V,L,Y]),T.useEffect(()=>{E.current=!1},[v,l]);const Z=T.useMemo(()=>({onKeyDown:j,[Fye[u]]:H=>{d&&n(!1,H.nativeEvent,"reference-press")}}),[j,n,d,u]),te=T.useMemo(()=>({onKeyDown:j,onMouseDown(){w.current=!0},onMouseUp(){w.current=!0},[Vye[l]]:()=>{E.current=!0}}),[j,l]);return T.useMemo(()=>s?{reference:Z,floating:te}:{},[s,Z,te])}function Bye(e){const{open:t=!1,onOpenChange:r,elements:n}=e,i=gS(),o=T.useRef({}),[s]=T.useState(()=>wye()),a=yS()!=null,[c,l]=T.useState(n.reference),d=ki((f,m,g)=>{o.current.openEvent=f?m:void 0,s.emit("openchange",{open:f,event:m,reason:g,nested:a}),r==null||r(f,m,g)}),u=T.useMemo(()=>({setPositionReference:l}),[]),p=T.useMemo(()=>({reference:c||n.reference||null,floating:n.floating||null,domReference:n.reference}),[c,n.reference,n.floating]);return T.useMemo(()=>({dataRef:o,open:t,onOpenChange:d,elements:p,events:s,floatingId:i,refs:u}),[t,d,p,s,i,u])}function hz(e){e===void 0&&(e={});const{nodeId:t}=e,r=Bye({...e,elements:{reference:null,floating:null,...e.elements}}),n=e.rootContext||r,i=n.elements,[o,s]=T.useState(null),[a,c]=T.useState(null),d=(i==null?void 0:i.reference)||o,u=T.useRef(null),p=wy();Vr(()=>{d&&(u.current=d)},[d]);const f=rye({...e,elements:{...i,...a&&{reference:a}}}),m=T.useCallback(w=>{const S=zr(w)?{getBoundingClientRect:()=>w.getBoundingClientRect(),contextElement:w}:w;c(S),f.refs.setReference(S)},[f.refs]),g=T.useCallback(w=>{(zr(w)||w===null)&&(u.current=w,s(w)),(zr(f.refs.reference.current)||f.refs.reference.current===null||w!==null&&!zr(w))&&f.refs.setReference(w)},[f.refs]),y=T.useMemo(()=>({...f.refs,setReference:g,setPositionReference:m,domReference:u}),[f.refs,g,m]),v=T.useMemo(()=>({...f.elements,domReference:d}),[f.elements,d]),E=T.useMemo(()=>({...f,...n,refs:y,elements:v,nodeId:t}),[f,y,v,t,n]);return Vr(()=>{n.dataRef.current.floatingContext=E;const w=p==null?void 0:p.nodesRef.current.find(S=>S.id===t);w&&(w.context=E)}),T.useMemo(()=>({...f,context:E,refs:y,elements:v}),[f,y,v,E])}function $ye(e,t){t===void 0&&(t={});const{open:r,onOpenChange:n,events:i,dataRef:o,elements:s}=e,{enabled:a=!0,visibleOnly:c=!0}=t,l=T.useRef(!1),d=T.useRef(),u=T.useRef(!0);T.useEffect(()=>{if(!a)return;const f=Mo(s.domReference);function m(){!r&&Wn(s.domReference)&&s.domReference===Ta(gi(s.domReference))&&(l.current=!0)}function g(){u.current=!0}return f.addEventListener("blur",m),f.addEventListener("keydown",g,!0),()=>{f.removeEventListener("blur",m),f.removeEventListener("keydown",g,!0)}},[s.domReference,r,a]),T.useEffect(()=>{if(!a)return;function f(m){let{reason:g}=m;(g==="reference-press"||g==="escape-key")&&(l.current=!0)}return i.on("openchange",f),()=>{i.off("openchange",f)}},[i,a]),T.useEffect(()=>()=>{clearTimeout(d.current)},[]);const p=T.useMemo(()=>({onPointerDown(f){eP(f.nativeEvent)||(u.current=!1)},onMouseLeave(){l.current=!1},onFocus(f){if(l.current)return;const m=Kc(f.nativeEvent);if(c&&zr(m))try{if(tP()&&U9())throw Error();if(!m.matches(":focus-visible"))return}catch{if(!u.current&&!rP(m))return}n(!0,f.nativeEvent,"focus")},onBlur(f){l.current=!1;const m=f.relatedTarget,g=f.nativeEvent,y=zr(m)&&m.hasAttribute(Ad("focus-guard"))&&m.getAttribute("data-type")==="outside";d.current=window.setTimeout(()=>{var v;const E=Ta(s.domReference?s.domReference.ownerDocument:document);!m&&E===s.domReference||Bn((v=o.current.floatingContext)==null?void 0:v.refs.floating.current,E)||Bn(s.domReference,E)||y||n(!1,g,"focus")})}}),[o,s.domReference,n,c]);return T.useMemo(()=>a?{reference:p}:{},[a,p])}const Dj="active",Lj="selected";function _C(e,t,r){const n=new Map,i=r==="item";let o=e;if(i&&e){const{[Dj]:s,[Lj]:a,...c}=e;o=c}return{...r==="floating"&&{tabIndex:-1},...o,...t.map(s=>{const a=s?s[r]:null;return typeof a=="function"?e?a(e):null:a}).concat(e).reduce((s,a)=>(a&&Object.entries(a).forEach(c=>{let[l,d]=c;if(!(i&&[Dj,Lj].includes(l)))if(l.indexOf("on")===0){if(n.has(l)||n.set(l,[]),typeof d=="function"){var u;(u=n.get(l))==null||u.push(d),s[l]=function(){for(var p,f=arguments.length,m=new Array(f),g=0;g<f;g++)m[g]=arguments[g];return(p=n.get(l))==null?void 0:p.map(y=>y(...m)).find(y=>y!==void 0)}}}else s[l]=d}),s),{})}}function pz(e){e===void 0&&(e=[]);const t=e.map(a=>a==null?void 0:a.reference),r=e.map(a=>a==null?void 0:a.floating),n=e.map(a=>a==null?void 0:a.item),i=T.useCallback(a=>_C(a,e,"reference"),t),o=T.useCallback(a=>_C(a,e,"floating"),r),s=T.useCallback(a=>_C(a,e,"item"),n);return T.useMemo(()=>({getReferenceProps:i,getFloatingProps:o,getItemProps:s}),[i,o,s])}let Mj=!1;function vS(e,t,r){switch(e){case"vertical":return t;case"horizontal":return r;default:return t||r}}function jj(e,t){return vS(t,e===cP||e===by,e===yf||e===Jf)}function bC(e,t,r){return vS(t,e===by,r?e===yf:e===Jf)||e==="Enter"||e===" "||e===""}function Hye(e,t,r){return vS(t,r?e===yf:e===Jf,e===by)}function Uj(e,t,r){return vS(t,r?e===Jf:e===yf,e===cP)}function Wye(e,t){const{open:r,onOpenChange:n,elements:i}=e,{listRef:o,activeIndex:s,onNavigate:a=()=>{},enabled:c=!0,selectedIndex:l=null,allowEscape:d=!1,loop:u=!1,nested:p=!1,rtl:f=!1,virtual:m=!1,focusItemOnOpen:g="auto",focusItemOnHover:y=!0,openOnArrowKeyDown:v=!0,disabledIndices:E=void 0,orientation:w="vertical",cols:S=1,scrollItemIntoView:A=!0,virtualItemRef:N,itemSizes:L,dense:j=!1}=t,W=yS(),V=wy(),Y=ki(a),Z=T.useRef(g),te=T.useRef(l??-1),H=T.useRef(null),$=T.useRef(!0),K=T.useRef(Y),x=T.useRef(!!i.floating),O=T.useRef(r),F=T.useRef(!1),P=T.useRef(!1),_=ts(E),R=ts(r),k=ts(A),z=ts(i.floating),U=ts(l),[q,ie]=T.useState(),[ue,me]=T.useState(),De=ki(function(Te,Ze,Ve){Ve===void 0&&(Ve=!1);function Ke(ee){m?(ie(ee.id),V==null||V.events.emit("virtualfocus",ee),N&&(N.current=ee)):Hl(ee,{preventScroll:!0,sync:U9()&&tP()?Mj||F.current:!1})}const Ge=Te.current[Ze.current];Ge&&Ke(Ge),requestAnimationFrame(()=>{const ee=Te.current[Ze.current]||Ge;if(!ee)return;Ge||Ke(ee);const Ae=k.current;Ae&&Pe&&(Ve||!$.current)&&(ee.scrollIntoView==null||ee.scrollIntoView(typeof Ae=="boolean"?{block:"nearest",inline:"nearest"}:Ae))})});Vr(()=>{document.createElement("div").focus({get preventScroll(){return Mj=!0,!1}})},[]),Vr(()=>{c&&(r&&i.floating?Z.current&&l!=null&&(P.current=!0,te.current=l,Y(l)):x.current&&(te.current=-1,K.current(null)))},[c,r,i.floating,l,Y]),Vr(()=>{if(c&&r&&i.floating)if(s==null){if(F.current=!1,U.current!=null)return;if(x.current&&(te.current=-1,De(o,te)),(!O.current||!x.current)&&Z.current&&(H.current!=null||Z.current===!0&&H.current==null)){let Te=0;const Ze=()=>{o.current[0]==null?(Te<2&&(Te?requestAnimationFrame:queueMicrotask)(Ze),Te++):(te.current=H.current==null||bC(H.current,w,f)||p?mC(o,_.current):bj(o,_.current),H.current=null,Y(te.current))};Ze()}}else kg(o,s)||(te.current=s,De(o,te,P.current),P.current=!1)},[c,r,i.floating,s,U,p,o,w,f,Y,De,_]),Vr(()=>{var Te;if(!c||i.floating||!V||m||!x.current)return;const Ze=V.nodesRef.current,Ve=(Te=Ze.find(ee=>ee.id===W))==null||(Te=Te.context)==null?void 0:Te.elements.floating,Ke=Ta(gi(i.floating)),Ge=Ze.some(ee=>ee.context&&Bn(ee.context.elements.floating,Ke));Ve&&!Ge&&$.current&&Ve.focus({preventScroll:!0})},[c,i.floating,V,W,m]),Vr(()=>{if(!c||!V||!m||W)return;function Te(Ze){me(Ze.id),N&&(N.current=Ze)}return V.events.on("virtualfocus",Te),()=>{V.events.off("virtualfocus",Te)}},[c,V,m,W,N]),Vr(()=>{K.current=Y,x.current=!!i.floating}),Vr(()=>{r||(H.current=null)},[r]),Vr(()=>{O.current=r},[r]);const He=s!=null,Pe=T.useMemo(()=>{function Te(Ve){if(!r)return;const Ke=o.current.indexOf(Ve);Ke!==-1&&Y(Ke)}return{onFocus(Ve){let{currentTarget:Ke}=Ve;Te(Ke)},onClick:Ve=>{let{currentTarget:Ke}=Ve;return Ke.focus({preventScroll:!0})},...y&&{onMouseMove(Ve){let{currentTarget:Ke}=Ve;Te(Ke)},onPointerLeave(Ve){let{pointerType:Ke}=Ve;!$.current||Ke==="touch"||(te.current=-1,De(o,te),Y(null),m||Hl(z.current,{preventScroll:!0}))}}}},[r,z,De,y,o,Y,m]),nt=ki(Te=>{if($.current=!1,F.current=!0,!R.current&&Te.currentTarget===z.current)return;if(p&&Uj(Te.key,w,f)){Oi(Te),n(!1,Te.nativeEvent,"list-navigation"),Wn(i.domReference)&&!m&&i.domReference.focus();return}const Ze=te.current,Ve=mC(o,E),Ke=bj(o,E);if(Te.key==="Home"&&(Oi(Te),te.current=Ve,Y(te.current)),Te.key==="End"&&(Oi(Te),te.current=Ke,Y(te.current)),S>1){const Ge=L||Array.from({length:o.current.length},()=>({width:1,height:1})),ee=hye(Ge,S,j),Ae=ee.findIndex(We=>We!=null&&!YE(o.current,We,E)),Le=ee.reduce((We,dt,Gt)=>dt!=null&&!YE(o.current,dt,E)?Gt:We,-1);if(te.current=ee[uye({current:ee.map(We=>We!=null?o.current[We]:null)},{event:Te,orientation:w,loop:u,cols:S,disabledIndices:fye([...E||o.current.map((We,dt)=>YE(o.current,dt)?dt:void 0),void 0],ee),minIndex:Ae,maxIndex:Le,prevIndex:pye(te.current>Ke?Ve:te.current,Ge,ee,S,Te.key===by?"bl":Te.key===Jf?"tr":"tl"),stopEvent:!0})],Y(te.current),w==="both")return}if(jj(Te.key,w)){if(Oi(Te),r&&!m&&Ta(Te.currentTarget.ownerDocument)===Te.currentTarget){te.current=bC(Te.key,w,f)?Ve:Ke,Y(te.current);return}bC(Te.key,w,f)?u?te.current=Ze>=Ke?d&&Ze!==o.current.length?-1:Ve:Hi(o,{startingIndex:Ze,disabledIndices:E}):te.current=Math.min(Ke,Hi(o,{startingIndex:Ze,disabledIndices:E})):u?te.current=Ze<=Ve?d&&Ze!==-1?o.current.length:Ke:Hi(o,{startingIndex:Ze,decrement:!0,disabledIndices:E}):te.current=Math.max(Ve,Hi(o,{startingIndex:Ze,decrement:!0,disabledIndices:E})),kg(o,te.current)?Y(null):Y(te.current)}}),Rt=T.useMemo(()=>m&&r&&He&&{"aria-activedescendant":ue||q},[m,r,He,ue,q]),Ye=T.useMemo(()=>({"aria-orientation":w==="both"?void 0:w,...!F9(i.domReference)&&Rt,onKeyDown:nt,onPointerMove(){$.current=!0}}),[Rt,nt,i.domReference,w]),_t=T.useMemo(()=>{function Te(Ve){g==="auto"&&j9(Ve.nativeEvent)&&(Z.current=!0)}function Ze(Ve){Z.current=g,g==="auto"&&eP(Ve.nativeEvent)&&(Z.current=!0)}return{...Rt,onKeyDown(Ve){$.current=!1;const Ke=Ve.key.indexOf("Arrow")===0,Ge=Hye(Ve.key,w,f),ee=Uj(Ve.key,w,f),Ae=jj(Ve.key,w),Le=(p?Ge:Ae)||Ve.key==="Enter"||Ve.key.trim()==="";if(m&&r){const $r=V==null?void 0:V.nodesRef.current.find($o=>$o.parentId==null),fn=V&&$r?Iye(V.nodesRef.current,$r.id):null;if(Ke&&fn&&N){const $o=new KeyboardEvent("keydown",{key:Ve.key,bubbles:!0});if(Ge||ee){var We,dt;const Va=((We=fn.context)==null?void 0:We.elements.domReference)===Ve.currentTarget,Ji=ee&&!Va?(dt=fn.context)==null?void 0:dt.elements.domReference:Ge?o.current.find(Ac=>(Ac==null?void 0:Ac.id)===q):null;Ji&&(Oi(Ve),Ji.dispatchEvent($o),me(void 0))}if(Ae&&fn.context&&fn.context.open&&fn.parentId&&Ve.currentTarget!==fn.context.elements.domReference){var Gt;Oi(Ve),(Gt=fn.context.elements.domReference)==null||Gt.dispatchEvent($o);return}}return nt(Ve)}if(!(!r&&!v&&Ke)){if(Le&&(H.current=p&&Ae?null:Ve.key),p){Ge&&(Oi(Ve),r?(te.current=mC(o,_.current),Y(te.current)):n(!0,Ve.nativeEvent,"list-navigation"));return}Ae&&(l!=null&&(te.current=l),Oi(Ve),!r&&v?n(!0,Ve.nativeEvent,"list-navigation"):nt(Ve),r&&Y(te.current))}},onFocus(){r&&!m&&Y(null)},onPointerDown:Ze,onMouseDown:Te,onClick:Te}},[q,Rt,nt,_,g,o,p,Y,n,r,v,w,f,l,V,m,N]);return T.useMemo(()=>c?{reference:_t,floating:Ye,item:Pe}:{},[c,_t,Ye,Pe])}const Gye=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function fz(e,t){var r;t===void 0&&(t={});const{open:n,floatingId:i}=e,{enabled:o=!0,role:s="dialog"}=t,a=(r=Gye.get(s))!=null?r:s,c=gS(),d=yS()!=null,u=T.useMemo(()=>a==="tooltip"||s==="label"?{["aria-"+(s==="label"?"labelledby":"describedby")]:n?i:void 0}:{"aria-expanded":n?"true":"false","aria-haspopup":a==="alertdialog"?"dialog":a,"aria-controls":n?i:void 0,...a==="listbox"&&{role:"combobox"},...a==="menu"&&{id:c},...a==="menu"&&d&&{role:"menuitem"},...s==="select"&&{"aria-autocomplete":"none"},...s==="combobox"&&{"aria-autocomplete":"list"}},[a,i,d,n,c,s]),p=T.useMemo(()=>{const m={id:i,...a&&{role:a}};return a==="tooltip"||s==="label"?m:{...m,...a==="menu"&&{"aria-labelledby":c}}},[a,i,c,s]),f=T.useCallback(m=>{let{active:g,selected:y}=m;const v={role:"option",...g&&{id:i+"-option"}};switch(s){case"select":return{...v,"aria-selected":g&&y};case"combobox":return{...v,...g&&{"aria-selected":!0}}}return{}},[i,s]);return T.useMemo(()=>o?{reference:u,floating:p,item:f}:{},[o,u,p,f])}function zye(e,t){var r;const{open:n,dataRef:i}=e,{listRef:o,activeIndex:s,onMatch:a,onTypingChange:c,enabled:l=!0,findMatch:d=null,resetMs:u=750,ignoreKeys:p=[],selectedIndex:f=null}=t,m=T.useRef(),g=T.useRef(""),y=T.useRef((r=f??s)!=null?r:-1),v=T.useRef(null),E=ki(a),w=ki(c),S=ts(d),A=ts(p);Vr(()=>{n&&(clearTimeout(m.current),v.current=null,g.current="")},[n]),Vr(()=>{if(n&&g.current===""){var V;y.current=(V=f??s)!=null?V:-1}},[n,f,s]);const N=ki(V=>{V?i.current.typing||(i.current.typing=V,w(V)):i.current.typing&&(i.current.typing=V,w(V))}),L=ki(V=>{function Y(K,x,O){const F=S.current?S.current(x,O):x.find(P=>(P==null?void 0:P.toLocaleLowerCase().indexOf(O.toLocaleLowerCase()))===0);return F?K.indexOf(F):-1}const Z=o.current;if(g.current.length>0&&g.current[0]!==" "&&(Y(Z,Z,g.current)===-1?N(!1):V.key===" "&&Oi(V)),Z==null||A.current.includes(V.key)||V.key.length!==1||V.ctrlKey||V.metaKey||V.altKey)return;n&&V.key!==" "&&(Oi(V),N(!0)),Z.every(K=>{var x,O;return K?((x=K[0])==null?void 0:x.toLocaleLowerCase())!==((O=K[1])==null?void 0:O.toLocaleLowerCase()):!0})&&g.current===V.key&&(g.current="",y.current=v.current),g.current+=V.key,clearTimeout(m.current),m.current=setTimeout(()=>{g.current="",y.current=v.current,N(!1)},u);const H=y.current,$=Y(Z,[...Z.slice((H||0)+1),...Z.slice(0,(H||0)+1)],g.current);$!==-1?(E($),v.current=$):V.key!==" "&&(g.current="",N(!1))}),j=T.useMemo(()=>({onKeyDown:L}),[L]),W=T.useMemo(()=>({onKeyDown:L,onKeyUp(V){V.key===" "&&N(!1)}}),[L,N]);return T.useMemo(()=>l?{reference:j,floating:W}:{},[l,j,W])}function Fj(e,t){const[r,n]=e;let i=!1;const o=t.length;for(let s=0,a=o-1;s<o;a=s++){const[c,l]=t[s]||[0,0],[d,u]=t[a]||[0,0];l>=n!=u>=n&&r<=(d-c)*(n-l)/(u-l)+c&&(i=!i)}return i}function Kye(e,t){return e[0]>=t.x&&e[0]<=t.x+t.width&&e[1]>=t.y&&e[1]<=t.y+t.height}function qye(e){e===void 0&&(e={});const{buffer:t=.5,blockPointerEvents:r=!1,requireIntent:n=!0}=e;let i,o=!1,s=null,a=null,c=performance.now();function l(u,p){const f=performance.now(),m=f-c;if(s===null||a===null||m===0)return s=u,a=p,c=f,null;const g=u-s,y=p-a,E=Math.sqrt(g*g+y*y)/m;return s=u,a=p,c=f,E}const d=u=>{let{x:p,y:f,placement:m,elements:g,onClose:y,nodeId:v,tree:E}=u;return function(S){function A(){clearTimeout(i),y()}if(clearTimeout(i),!g.domReference||!g.floating||m==null||p==null||f==null)return;const{clientX:N,clientY:L}=S,j=[N,L],W=Kc(S),V=S.type==="mouseleave",Y=Bn(g.floating,W),Z=Bn(g.domReference,W),te=g.domReference.getBoundingClientRect(),H=g.floating.getBoundingClientRect(),$=m.split("-")[0],K=p>H.right-H.width/2,x=f>H.bottom-H.height/2,O=Kye(j,te),F=H.width>te.width,P=H.height>te.height,_=(F?te:H).left,R=(F?te:H).right,k=(P?te:H).top,z=(P?te:H).bottom;if(Y&&(o=!0,!V))return;if(Z&&(o=!1),Z&&!V){o=!0;return}if(V&&zr(S.relatedTarget)&&Bn(g.floating,S.relatedTarget)||E&&Uu(E.nodesRef.current,v).some(ie=>{let{context:ue}=ie;return ue==null?void 0:ue.open}))return;if($==="top"&&f>=te.bottom-1||$==="bottom"&&f<=te.top+1||$==="left"&&p>=te.right-1||$==="right"&&p<=te.left+1)return A();let U=[];switch($){case"top":U=[[_,te.top+1],[_,H.bottom-1],[R,H.bottom-1],[R,te.top+1]];break;case"bottom":U=[[_,H.top+1],[_,te.bottom-1],[R,te.bottom-1],[R,H.top+1]];break;case"left":U=[[H.right-1,z],[H.right-1,k],[te.left+1,k],[te.left+1,z]];break;case"right":U=[[te.right-1,z],[te.right-1,k],[H.left+1,k],[H.left+1,z]];break}function q(ie){let[ue,me]=ie;switch($){case"top":{const De=[F?ue+t/2:K?ue+t*4:ue-t*4,me+t+1],He=[F?ue-t/2:K?ue+t*4:ue-t*4,me+t+1],Pe=[[H.left,K||F?H.bottom-t:H.top],[H.right,K?F?H.bottom-t:H.top:H.bottom-t]];return[De,He,...Pe]}case"bottom":{const De=[F?ue+t/2:K?ue+t*4:ue-t*4,me-t],He=[F?ue-t/2:K?ue+t*4:ue-t*4,me-t],Pe=[[H.left,K||F?H.top+t:H.bottom],[H.right,K?F?H.top+t:H.bottom:H.top+t]];return[De,He,...Pe]}case"left":{const De=[ue+t+1,P?me+t/2:x?me+t*4:me-t*4],He=[ue+t+1,P?me-t/2:x?me+t*4:me-t*4];return[...[[x||P?H.right-t:H.left,H.top],[x?P?H.right-t:H.left:H.right-t,H.bottom]],De,He]}case"right":{const De=[ue-t,P?me+t/2:x?me+t*4:me-t*4],He=[ue-t,P?me-t/2:x?me+t*4:me-t*4],Pe=[[x||P?H.left+t:H.right,H.top],[x?P?H.left+t:H.right:H.left+t,H.bottom]];return[De,He,...Pe]}}}if(!Fj([N,L],U)){if(o&&!O)return A();if(!V&&n){const ie=l(S.clientX,S.clientY);if(ie!==null&&ie<.1)return A()}Fj([N,L],q([p,f]))?!o&&n&&(i=window.setTimeout(A,40)):A()}}};return d.__options={blockPointerEvents:r},d}const Yye=({arrowRef:e,placement:t})=>{const r=[];return r.push(iye(8)),r.push(t==="auto"?aye():sye()),r.push(oye({padding:8})),e!=null&&e.current&&r.push(cye({element:e.current})),r},Xye=({placement:e})=>e==="auto"?void 0:e,Jye=({placement:e})=>({top:"bottom",right:"left",bottom:"top",left:"right"})[e.split("-")[0]],mz=({open:e,arrowRef:t,placement:r="top",setOpen:n})=>hz({placement:Xye({placement:r}),open:e,onOpenChange:n,whileElementsMounted:Q9,middleware:Yye({placement:r,arrowRef:t})}),gz=({context:e,trigger:t,role:r="tooltip",interactions:n=[]})=>pz([dz(e,{enabled:t==="click"}),Cye(e,{enabled:t==="hover",handleClose:qye()}),uz(e),fz(e,{role:r}),...n]),Qye=({animation:e="duration-300",arrow:t=!0,children:r,className:n,content:i,placement:o="top",style:s="dark",theme:a,trigger:c="hover",minWidth:l,...d})=>{const u=T.useRef(null),[p,f]=T.useState(!1),m=mz({open:p,placement:o,arrowRef:u,setOpen:f}),{context:g,middlewareData:{arrow:{x:y,y:v}={}},refs:E,strategy:w,update:S,x:A,y:N}=m,L=$ye(g),{getFloatingProps:j,getReferenceProps:W}=gz({context:g,role:"tooltip",trigger:c,interactions:[L]});return T.useEffect(()=>{if(E.reference.current&&E.floating.current&&p)return Q9(E.reference.current,E.floating.current,S)},[p,E.floating,E.reference,S]),h.jsxs(h.Fragment,{children:[h.jsx("div",{ref:E.setReference,className:a.target,"data-testid":"flowbite-tooltip-target",...W(),children:r}),h.jsxs("div",{ref:E.setFloating,"data-testid":"flowbite-tooltip",...j({className:se(a.base,e&&`${a.animation} ${e}`,!p&&a.hidden,a.style[s],n),style:{position:w,top:N??" ",left:A??" ",minWidth:l},...d}),children:[h.jsx("div",{className:a.content,children:i}),t&&h.jsx("div",{className:se(a.arrow.base,s==="dark"&&a.arrow.style.dark,s==="light"&&a.arrow.style.light,s==="auto"&&a.arrow.style.auto),"data-testid":"flowbite-tooltip-arrow",ref:u,style:{top:v??" ",left:y??" ",right:" ",bottom:" ",[Jye({placement:m.placement})]:a.arrow.placement},children:" "})]})]})},ES=({animation:e="duration-300",arrow:t=!0,children:r,className:n,content:i,placement:o="top",style:s="dark",theme:a={},trigger:c="hover",...l})=>{const d=Re(tt().tooltip,a);return h.jsx(Qye,{animation:e,arrow:t,content:i,placement:o,style:s,theme:d,trigger:c,className:n,...l,children:r})};ES.displayName="Tooltip";function yz(e){return di({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"},child:[]}]})(e)}function vz(e){return di({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM72 272a24 24 0 1 1 48 0 24 24 0 1 1 -48 0zm104-16H304c8.8 0 16 7.2 16 16s-7.2 16-16 16H176c-8.8 0-16-7.2-16-16s7.2-16 16-16zM72 368a24 24 0 1 1 48 0 24 24 0 1 1 -48 0zm88 0c0-8.8 7.2-16 16-16H304c8.8 0 16 7.2 16 16s-7.2 16-16 16H176c-8.8 0-16-7.2-16-16z"},child:[]}]})(e)}function Zye(e){return di({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 296c0 66.3-53.7 120-120 120h-8c-17.7 0-32-14.3-32-32s14.3-32 32-32h8c30.9 0 56-25.1 56-56v-8H320c-35.3 0-64-28.7-64-64V160c0-35.3 28.7-64 64-64h64c35.3 0 64 28.7 64 64v32 32 72zm-256 0c0 66.3-53.7 120-120 120H64c-17.7 0-32-14.3-32-32s14.3-32 32-32h8c30.9 0 56-25.1 56-56v-8H64c-35.3 0-64-28.7-64-64V160c0-35.3 28.7-64 64-64h64c35.3 0 64 28.7 64 64v32 32 72z"},child:[]}]})(e)}const dP=(e,t)=>{var r;t(!0),(r=navigator==null?void 0:navigator.clipboard)==null||r.writeText(e).then(()=>{console.log("Copy Successfull")}).catch(n=>{console.error("Failed to Copy text: ",n),t(!1)}),setTimeout(()=>t(!1),4e3)},Ez=T.forwardRef(({valueToCopy:e,icon:t=vz,theme:r={},className:n,...i},o)=>{const[s,a]=T.useState(!1),c=Re(tt().clipboard.withIcon,r);return h.jsx("button",{className:se(c.base,n),onClick:()=>dP(e,a),...i,ref:o,children:s?h.jsx(yz,{"aria-hidden":!0,className:c.icon.successIcon}):h.jsx(t,{"aria-hidden":!0,className:c.icon.defaultIcon})})}),_z=T.forwardRef(({valueToCopy:e,icon:t=vz,label:r="Copy",theme:n={},className:i,...o},s)=>{const[a,c]=T.useState(!1),l=Re(tt().clipboard.withIconText,n);return h.jsx("button",{className:se(l.base,i),onClick:()=>dP(e,c),...o,ref:s,children:a?h.jsxs("span",{className:l.label.base,children:[h.jsx(yz,{"aria-hidden":!0,className:l.icon.successIcon}),h.jsx("span",{className:l.label.successText,children:"Copied"})]}):h.jsxs("span",{className:l.label.base,children:[h.jsx(t,{"aria-hidden":!0,className:l.icon.defaultIcon}),h.jsx("span",{className:l.label.defaultText,children:r})]})})}),bz=T.forwardRef(({className:e,valueToCopy:t,label:r,theme:n={},...i},o)=>{const[s,a]=T.useState(!1),c=Re(tt().clipboard.button,n);return h.jsx(ES,{content:s?"Copied":"Copy to clipboard",className:"[&_*]:cursor-pointer",children:h.jsx("button",{className:se(c.base,e),onClick:()=>dP(t,a),...i,ref:o,children:h.jsx("span",{className:c.label,children:r})})})});bz.displayName="Clipboard";Ez.displayName="Clipboard.WithIcon";_z.displayName="Clipboard.WithIconText";Object.assign(bz,{WithIcon:Ez,WithIconText:_z});const Sy=({children:e,className:t,color:r="default",theme:n={},value:i,...o})=>{const s=Re(tt().helperText,n);return h.jsx("p",{className:se(s.root.base,s.root.colors[r],t),...o,children:i??e??""})};Sy.displayName="HelperText";const wz=T.forwardRef(({addon:e,className:t,color:r="gray",helperText:n,icon:i,rightIcon:o,shadow:s,sizing:a="md",theme:c={},type:l="text",...d},u)=>{const p=Re(tt().textInput,c);return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:se(p.base,t),children:[e&&h.jsx("span",{className:p.addon,children:e}),h.jsxs("div",{className:p.field.base,children:[i&&h.jsx("div",{className:p.field.icon.base,children:h.jsx(i,{className:p.field.icon.svg})}),o&&h.jsx("div",{"data-testid":"right-icon",className:p.field.rightIcon.base,children:h.jsx(o,{className:p.field.rightIcon.svg})}),h.jsx("input",{className:se(p.field.input.base,p.field.input.colors[r],p.field.input.sizes[a],p.field.input.withIcon[i?"on":"off"],p.field.input.withRightIcon[o?"on":"off"],p.field.input.withAddon[e?"on":"off"],p.field.input.withShadow[s?"on":"off"]),type:l,...d,ref:u})]})]}),n&&h.jsx(Sy,{color:r,children:n})]})});wz.displayName="TextInput";const Sz=T.createContext(void 0);function _S(){const e=T.useContext(Sz);if(!e)throw new Error("useDatePickerContext should be used within the DatePickerContext provider!");return e}var un=(e=>(e[e.Days=0]="Days",e[e.Months=1]="Months",e[e.Years=2]="Years",e[e.Decades=3]="Decades",e))(un||{}),Tz=(e=>(e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday",e))(Tz||{});const Ef=(e,t,r)=>{const n=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime();if(t&&r){const i=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),o=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();return n>=i&&n<=o}if(t){const i=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();return n>=i}if(r){const i=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();return n<=i}return!0},I0=(e,t)=>(e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e.getTime()===t.getTime()),xv=(e,t,r)=>(Ef(e,t,r)||(t&&e<t?e=t:r&&e>r&&(e=r)),e),eve=(e,t)=>{const r=new Date(e.getFullYear(),e.getMonth(),1);let i=r.getDay()-t;return i<0&&(i+=7),uP(r,-i)},tve=(e,t)=>{const r=[],n=new Date(0);n.setDate(n.getDate()-n.getDay()+t);const i=new Intl.DateTimeFormat(e,{weekday:"short"});for(let o=0;o<7;o++)r.push(i.format(uP(n,o)));return r},uP=(e,t)=>{const r=new Date(e);return r.setDate(r.getDate()+t),r},rve=(e,t)=>{const r=new Date(e);return r.setMonth(r.getMonth()+t),r},bp=(e,t)=>{const r=new Date(e);return r.setFullYear(r.getFullYear()+t),r},wp=(e,t,r)=>{let n={day:"numeric",month:"long",year:"numeric"};return r&&(n=r),new Intl.DateTimeFormat(e,n).format(t)},Sp=(e,t)=>{const r=e.getFullYear();return Math.floor(r/t)*t},nve=(e,t)=>{const r=e.getFullYear(),n=t+9;return r>=t&&r<=n},ive=({theme:e={}})=>{const{theme:t,weekStart:r,minDate:n,maxDate:i,viewDate:o,selectedDate:s,changeSelectedDate:a,language:c}=_S(),l=Re(t.views.days,e),d=tve(c,r),u=eve(o,r);return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:l.header.base,children:d.map((p,f)=>h.jsx("span",{className:l.header.title,children:p},f))}),h.jsx("div",{className:l.items.base,children:[...Array(42)].map((p,f)=>{const m=uP(u,f),g=wp(c,m,{day:"numeric"}),y=s&&I0(s,m),v=!Ef(m,n,i);return h.jsx("button",{disabled:v,type:"button",className:se(l.items.item.base,y&&l.items.item.selected,v&&l.items.item.disabled),onClick:()=>{v||a(m,!0)},children:g},f)})})]})},ove=({theme:e={}})=>{const{theme:t,viewDate:r,selectedDate:n,minDate:i,maxDate:o,setViewDate:s,setView:a}=_S(),c=Re(t.views.decades,e),l=Sp(r,100);return h.jsx("div",{className:c.items.base,children:[...Array(12)].map((d,u)=>{const p=l-10+u*10;new Date(r.getTime()).setFullYear(p+r.getFullYear()%10);const m=new Date(p,0,1),g=bp(m,9),y=n&&nve(n,p),v=!Ef(m,i,o)&&!Ef(g,i,o);return h.jsx("button",{disabled:v,type:"button",className:se(c.items.item.base,y&&c.items.item.selected,v&&c.items.item.disabled),onClick:()=>{v||(n&&s(bp(r,p-n.getFullYear())),a(un.Years))},children:p},u)})})},sve=({theme:e={}})=>{const{theme:t,minDate:r,maxDate:n,selectedDate:i,viewDate:o,language:s,setViewDate:a,setView:c}=_S(),l=Re(t.views.months,e);return h.jsx("div",{className:l.items.base,children:[...Array(12)].map((d,u)=>{const p=new Date;p.setMonth(u,1),p.setFullYear(o.getFullYear());const f=wp(s,p,{month:"short"}),m=i&&I0(i,p),g=!Ef(p,r,n);return h.jsx("button",{disabled:g,type:"button",className:se(l.items.item.base,m&&l.items.item.selected,g&&l.items.item.disabled),onClick:()=>{g||(a(p),c(un.Days))},children:f},u)})})},ave=({theme:e={}})=>{const{theme:t,selectedDate:r,minDate:n,maxDate:i,viewDate:o,setViewDate:s,setView:a}=_S(),c=Re(t.views.years,e);return h.jsx("div",{className:c.items.base,children:[...Array(12)].map((l,d)=>{const p=Sp(o,10)+d,f=new Date(o.getTime());f.setFullYear(p);const m=r&&I0(r,f),g=!Ef(f,n,i);return h.jsx("button",{disabled:g,type:"button",className:se(c.items.item.base,m&&c.items.item.selected,g&&c.items.item.disabled),onClick:()=>{g||(s(f),a(un.Months))},children:p},d)})})},cve=({title:e,open:t,inline:r=!1,autoHide:n=!0,showClearButton:i=!0,labelClearButton:o="Clear",showTodayButton:s=!0,labelTodayButton:a="Today",defaultValue:c,minDate:l,maxDate:d,language:u="en",weekStart:p=Tz.Sunday,className:f,theme:m={},onChange:g,label:y,value:v,...E},w)=>{const S=Re(tt().datepicker,m),A=c?xv(c,l,d):null,N=T.useMemo(()=>c?xv(c,l,d):new Date,[]),[L,j]=T.useState(t),[W,V]=T.useState(un.Days),[Y,Z]=T.useState(v??A),[te,H]=T.useState(v??N),$=T.useRef(null),K=T.useRef(null),x=(z,U)=>{Z(z),(z===null||z)&&g&&g(z),n&&W===un.Days&&U==!0&&!r&&j(!1)},O=()=>{x(A,!0),c&&H(c)};T.useImperativeHandle(w,()=>({focus(){var z;(z=$.current)==null||z.focus()},clear(){O()}}));const F=z=>{switch(z){case un.Decades:return h.jsx(ove,{theme:S.views.decades});case un.Years:return h.jsx(ave,{theme:S.views.years});case un.Months:return h.jsx(sve,{theme:S.views.months});case un.Days:default:return h.jsx(ive,{theme:S.views.days})}},P=()=>{switch(W){case un.Days:return un.Months;case un.Months:return un.Years;case un.Years:return un.Decades}return W},_=()=>{switch(W){case un.Decades:return`${Sp(te,100)-10} - ${Sp(te,100)+100}`;case un.Years:return`${Sp(te,10)} - ${Sp(te,10)+11}`;case un.Months:return wp(u,te,{year:"numeric"});case un.Days:default:return wp(u,te,{month:"long",year:"numeric"})}},R=(z,U,q)=>{switch(z){case un.Days:return new Date(rve(U,q));case un.Months:return new Date(bp(U,q));case un.Years:return new Date(bp(U,q*10));case un.Decades:return new Date(bp(U,q*100));default:return new Date(bp(U,q*10))}};T.useEffect(()=>{const z=U=>{var ue,me;const q=(ue=K==null?void 0:K.current)==null?void 0:ue.contains(U.target),ie=(me=$==null?void 0:$.current)==null?void 0:me.contains(U.target);!q&&!ie&&j(!1)};return document.addEventListener("mousedown",z),()=>{document.removeEventListener("mousedown",z)}},[$,K,j]),T.useEffect(()=>{const z=v&&xv(new Date(v),l,d),U=Y&&xv(new Date(Y),l,d);U&&z&&!I0(z,U)&&Z(z),Y==null&&Z(A)},[v,Z,H,Y]);const k=v===null?y:wp(u,Y||new Date);return h.jsx(Sz.Provider,{value:{theme:S,language:u,minDate:l,maxDate:d,weekStart:p,isOpen:L,setIsOpen:j,view:W,setView:V,viewDate:te,setViewDate:H,selectedDate:Y,setSelectedDate:Z,changeSelectedDate:x},children:h.jsxs("div",{className:se(S.root.base,f),children:[!r&&h.jsx(wz,{theme:S.root.input,icon:cme,ref:$,onFocus:()=>{Y&&!I0(te,Y)&&H(Y),j(!0)},value:k,readOnly:!0,defaultValue:A?wp(u,A):y,...E}),(L||r)&&h.jsx("div",{ref:K,className:se(S.popup.root.base,r&&S.popup.root.inline),children:h.jsxs("div",{className:S.popup.root.inner,children:[h.jsxs("div",{className:S.popup.header.base,children:[e&&h.jsx("div",{className:S.popup.header.title,children:e}),h.jsxs("div",{className:S.popup.header.selectors.base,children:[h.jsx("button",{type:"button",className:se(S.popup.header.selectors.button.base,S.popup.header.selectors.button.prev),onClick:()=>H(R(W,te,-1)),children:h.jsx(sme,{})}),h.jsx("button",{type:"button",className:se(S.popup.header.selectors.button.base,S.popup.header.selectors.button.view),onClick:()=>V(P()),children:_()}),h.jsx("button",{type:"button",className:se(S.popup.header.selectors.button.base,S.popup.header.selectors.button.next),onClick:()=>H(R(W,te,1)),children:h.jsx(ame,{})})]})]}),h.jsx("div",{className:S.popup.view.base,children:F(W)}),(i||s)&&h.jsxs("div",{className:S.popup.footer.base,children:[s&&h.jsx("button",{type:"button",className:se(S.popup.footer.button.base,S.popup.footer.button.today),onClick:()=>{const z=new Date;x(z,!0),H(z)},children:a}),i&&h.jsx("button",{type:"button",className:se(S.popup.footer.button.base,S.popup.footer.button.clear),onClick:()=>{x(null,!0)},children:o})]})]})})]})})},lve=T.forwardRef(cve);lve.displayName="Datepicker";const Cz=T.createContext(void 0);function Rz(){const e=T.useContext(Cz);if(!e)throw new Error("useDrawerContext should be used within the DrawerContext provider!");return e}function dve(e){return di({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"},child:[]}]})(e)}function uve(e){return di({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(e)}const Iz=({children:e,className:t,closeIcon:r=uve,theme:n={},title:i,titleIcon:o=dve,...s})=>{const a=T.useId(),{id:c,isOpen:l,onClose:d,theme:u}=Rz(),p=Re(u.header,n);return h.jsxs("div",{className:t,...s,children:[h.jsxs("h5",{className:p.inner.titleText,id:c,children:[h.jsx(o,{"aria-hidden":!0,className:p.inner.titleIcon}),i]}),h.jsxs("button",{onClick:d,"data-testid":"close-drawer",className:p.inner.closeButton,children:[h.jsx(r,{"aria-hidden":!0,className:p.inner.closeIcon}),h.jsx("span",{className:"sr-only",children:"Close menu"})]}),h.jsx("span",{className:p.collapsed[l?"on":"off"],id:`flowbite-drawer-header-${a}`,children:e})]})};Iz.displayName="Drawer.Header";const Az=({children:e,className:t,theme:r={},...n})=>{const{theme:i}=Rz(),o=Re(i.items,r);return h.jsx("div",{"data-testid":"flowbite-drawer-items",className:se(o.base,t),...n,children:e})};Az.displayName="Drawer.Items";const xz=({backdrop:e=!0,children:t,className:r,edge:n=!1,position:i="left",onClose:o,open:s=!1,theme:a={},...c})=>{const l=T.useId(),d=Re(tt().drawer,a);return T.useEffect(()=>{const u=p=>{p.key==="Escape"&&s&&o&&o()};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[o,s]),h.jsxs(Cz.Provider,{value:{theme:d,onClose:o,isOpen:s,id:l},children:[h.jsx("div",{"aria-modal":!0,"aria-describedby":`drawer-dialog-${l}`,role:"dialog",tabIndex:-1,"data-testid":"flowbite-drawer",className:se(d.root.base,d.root.position[i][s?"on":"off"],n&&!s&&d.root.edge,r),...c,children:t}),s&&e&&h.jsx("div",{onClick:()=>o(),className:d.root.backdrop})]})};xz.displayName="Drawer";Object.assign(xz,{Header:Iz,Items:Az});const Oz=T.createContext(void 0);function hP(){const e=T.useContext(Oz);if(!e)throw new Error("useDropdownContext should be used within the DropdownContext provider!");return e}const pP=({className:e,theme:t={},...r})=>{const{theme:n}=hP(),i=t.divider??n.floating.divider;return h.jsx("div",{className:se(i,e),...r})},Nz=({children:e,className:t,theme:r={},...n})=>{const{theme:i}=hP(),o=r.header??i.floating.header;return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:se(o,t),...n,children:e}),h.jsx(pP,{})]})},kz=T.forwardRef(({children:e,className:t,icon:r,onClick:n,theme:i={},...o},s)=>{const{ref:a,index:c}=vye({label:typeof e=="string"?e:void 0}),l=ez([s,a]),{theme:d,activeIndex:u,dismissOnClick:p,getItemProps:f,handleSelect:m}=hP(),g=u===c,y=Re(d.floating.item,i),v=o;return h.jsx("li",{role:"menuitem",className:y.container,children:h.jsxs(qk,{ref:l,className:se(y.base,t),...v,...f({onClick:()=>{n==null||n(),p&&m(null)}}),tabIndex:g?0:-1,children:[r&&h.jsx(r,{className:y.icon}),e]})})});kz.displayName="DropdownItem";const hve={top:fme,right:c9,bottom:a9,left:pme},pve=({refs:e,children:t,inline:r,theme:n,disabled:i,setButtonWidth:o,getReferenceProps:s,renderTrigger:a,...c})=>{const l=e.reference,d=s();if(T.useEffect(()=>{l.current&&(o==null||o(l.current.clientWidth))},[l,o]),a){const u=a(n);return T.cloneElement(u,{ref:e.setReference,disabled:i,...d,...u.props})}return r?h.jsx("button",{type:"button",ref:e.setReference,className:n==null?void 0:n.inlineWrapper,disabled:i,...d,children:t}):h.jsx(Yk,{...c,disabled:i,type:"button",ref:e.setReference,...d,children:t})},Pz=({children:e,className:t,dismissOnClick:r=!0,theme:n={},enableTypeAhead:i=!0,renderTrigger:o,...s})=>{const[a,c]=T.useState(!1),[l,d]=T.useState(null),[u,p]=T.useState(null),[f,m]=T.useState(void 0),g=T.useRef([]),y=T.useRef([]),v=Re(tt().dropdown,n),E=s,w=s["data-testid"]||"flowbite-dropdown-target",{placement:S=s.inline?"bottom-start":"bottom",trigger:A="click",label:N,inline:L,arrowIcon:j=!0,...W}=E,V=T.useCallback(_=>{p(_),c(!1)},[]),Y=T.useCallback(_=>{a?d(_):V(_)},[a,V]),{context:Z,floatingStyles:te,refs:H}=mz({open:a,setOpen:c,placement:S}),$=Wye(Z,{listRef:g,activeIndex:l,selectedIndex:u,onNavigate:d}),K=zye(Z,{listRef:y,activeIndex:l,selectedIndex:u,onMatch:Y,enabled:i}),{getReferenceProps:x,getFloatingProps:O,getItemProps:F}=gz({context:Z,role:"menu",trigger:A,interactions:[$,K]}),P=T.useMemo(()=>{const[_]=S.split("-");return hve[_]??a9},[S]);return h.jsxs(Oz.Provider,{value:{theme:v,activeIndex:l,dismissOnClick:r,getItemProps:F,handleSelect:V},children:[h.jsxs(pve,{...W,refs:H,inline:L,theme:v,"data-testid":w,className:se(v.floating.target,W.className),setButtonWidth:m,getReferenceProps:x,renderTrigger:o,children:[N,j&&h.jsx(P,{className:v.arrowIcon})]}),a&&h.jsx(lz,{context:Z,modal:!1,children:h.jsx("div",{ref:H.setFloating,style:{...te,minWidth:f},"data-testid":"flowbite-dropdown","aria-expanded":a,...O({className:se(v.floating.base,v.floating.animation,"duration-100",!a&&v.floating.hidden,v.floating.style.auto,t)}),children:h.jsx(yye,{elementsRef:g,labelsRef:y,children:h.jsx("ul",{className:v.content,tabIndex:-1,children:e})})})})]})};Pz.displayName="Dropdown";Nz.displayName="Dropdown.Header";pP.displayName="Dropdown.Divider";const fve=Object.assign(Pz,{Item:kz,Header:Nz,Divider:pP}),Ty=T.forwardRef(({className:e,color:t="gray",helperText:r,sizing:n="md",theme:i={},...o},s)=>{const a=Re(tt().fileInput,i);return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:se(a.root.base,e),children:h.jsx("div",{className:a.field.base,children:h.jsx("input",{className:se(a.field.input.base,a.field.input.colors[t],a.field.input.sizes[n]),...o,type:"file",ref:s})})}),r&&h.jsx(Sy,{color:t,children:r})]})});Ty.displayName="FileInput";const Je=T.forwardRef(({label:e,helperText:t,color:r="default",sizing:n="md",variant:i,disabled:o=!1,theme:s={},className:a,...c},l)=>{const d=T.useId(),u=Re(tt().floatingLabel,s);return h.jsxs("div",{children:[h.jsxs("div",{className:se("relative",i==="standard"?"z-0":""),children:[h.jsx("input",{type:"text",id:c.id?c.id:"floatingLabel"+d,"aria-describedby":"outlined_success_help",className:se(u.input[r][i][n],a),placeholder:" ","data-testid":"floating-label",disabled:o,...c,ref:l}),h.jsx("label",{htmlFor:c.id?c.id:"floatingLabel"+d,className:se(u.label[r][i][n],a),children:e})]}),h.jsx("p",{id:"outlined_helper_text"+d,className:se(u.helperText[r],a),children:t})]})});Je.displayName="FloatingLabel";const Dz=({alt:e,className:t,children:r,href:n,name:i,src:o,theme:s={},...a})=>{const c=Re(tt().footer.brand,s);return h.jsx("div",{children:n?h.jsxs("a",{"data-testid":"flowbite-footer-brand",href:n,className:se(c.base,t),...a,children:[h.jsx("img",{alt:e,src:o,className:c.img}),h.jsx("span",{"data-testid":"flowbite-footer-brand-span",className:c.span,children:i}),r]}):h.jsx("img",{alt:e,"data-testid":"flowbite-footer-brand",src:o,className:se(c.img,t),...a})})},Lz=({by:e,className:t,href:r,theme:n={},year:i,...o})=>{const s=Re(tt().footer.copyright,n);return h.jsxs("div",{"data-testid":"flowbite-footer-copyright",className:se(s.base,t),...o,children:["© ",i,r?h.jsx("a",{href:r,className:s.href,children:e}):h.jsx("span",{"data-testid":"flowbite-footer-copyright-span",className:s.span,children:e})]})},Mz=({className:e,theme:t={},...r})=>{const n=Re(tt().footer.divider,t);return h.jsx("hr",{"data-testid":"footer-divider",className:se(n.base,e),...r})},jz=({ariaLabel:e,className:t,href:r,icon:n,theme:i={},...o})=>{const s=Re(tt().footer.icon,i);return h.jsx("div",{children:r?h.jsx("a",{"aria-label":e,"data-testid":"flowbite-footer-icon",href:r,className:se(s.base,t),...o,children:h.jsx(n,{className:s.size})}):h.jsx(n,{"data-testid":"flowbite-footer-icon",className:s.size,...o})})},Uz=({as:e="a",children:t,className:r,href:n,theme:i={},...o})=>{const s=Re(tt().footer.groupLink.link,i);return h.jsx("li",{className:se(s.base,r),children:h.jsx(e,{href:n,className:s.href,...o,children:t})})},Fz=({children:e,className:t,col:r=!1,theme:n={},...i})=>{const o=Re(tt().footer.groupLink,n);return h.jsx("ul",{"data-testid":"footer-groupLink",className:se(o.base,r&&o.col,t),...i,children:e})},Vz=({as:e="h2",className:t,theme:r={},title:n,...i})=>{const o=Re(tt().footer.title,r);return h.jsx(e,{"data-testid":"flowbite-footer-title",className:se(o.base,t),...i,children:n})},Bz=({bgDark:e=!1,children:t,className:r,container:n=!1,theme:i={},...o})=>{const s=Re(tt().footer,i);return h.jsx("footer",{"data-testid":"flowbite-footer",className:se(s.root.base,e&&s.root.bgDark,n&&s.root.container,r),...o,children:t})};Bz.displayName="Footer";Lz.displayName="Footer.Copyright";Uz.displayName="Footer.Link";Dz.displayName="Footer.Brand";Fz.displayName="Footer.LinkGroup";jz.displayName="Footer.Icon";Vz.displayName="Footer.Title";Mz.displayName="Footer.Divider";Object.assign(Bz,{Copyright:Lz,Link:Uz,LinkGroup:Fz,Brand:Dz,Icon:jz,Title:Vz,Divider:Mz});const $z=T.forwardRef(({theme:e={},icon:t=Zye,className:r,...n},i)=>{const o=Re(tt().hr.icon,e);return h.jsxs("div",{className:o.base,children:[h.jsx("hr",{className:se(o.hrLine,r),role:"separator","data-testid":"flowbite-hr-icon",ref:i,...n}),h.jsx("div",{className:o.icon.base,children:h.jsx(t,{"aria-hidden":!0,className:o.icon.icon})})]})}),Hz=T.forwardRef(({theme:e={},className:t,...r},n)=>{const i=Re(tt().hr.square,e);return h.jsx("hr",{className:se(i.base,t),role:"separator","data-testid":"flowbite-hr-square",ref:n,...r})}),Wz=T.forwardRef(({theme:e={},text:t,className:r,...n},i)=>{const o=Re(tt().hr.text,e);return h.jsxs("div",{className:o.base,children:[h.jsx("hr",{className:se(o.hrLine,r),"data-testid":"flowbite-hr-text",role:"separator",ref:i,...n}),h.jsx("span",{className:o.text,children:t})]})}),Gz=T.forwardRef(({theme:e={},className:t,...r},n)=>{const i=Re(tt().hr.trimmed,e);return h.jsx("hr",{className:se(i.base,t),role:"separator","data-testid":"flowbite-hr-trimmed",ref:n,...r})}),zz=T.forwardRef(({theme:e={},className:t,...r},n)=>{const i=Re(tt().hr.root,e);return h.jsx("hr",{className:se(i.base,t),role:"separator","data-testid":"flowbite-hr",ref:n,...r})});zz.displayName="HR";Gz.displayName="HR.Trimmed";$z.displayName="HR.Icon";Wz.displayName="HR.Text";Hz.displayName="HR.Square";Object.assign(zz,{Trimmed:Gz,Icon:$z,Text:Wz,Square:Hz});const Kz=({children:e,className:t,icon:r,theme:n={},...i})=>{const o=Re(tt().list.item,n);return h.jsxs("li",{className:se(o.withIcon[r?"on":"off"],t),...i,children:[r&&h.jsx(r,{className:se(o.icon)}),e]})},qz=({children:e,className:t,unstyled:r,nested:n,ordered:i,horizontal:o,theme:s={},...a})=>{const c=Re(tt().list,s),l=i?"ol":"ul";return h.jsx(l,{className:se(c.root.base,c.root.ordered[i?"on":"off"],r&&c.root.unstyled,n&&c.root.nested,o&&c.root.horizontal,t),...a,children:e})};qz.displayName="List";Kz.displayName="List.Item";Object.assign(qz,{Item:Kz});const Yz=({active:e,children:t,className:r,href:n,icon:i,onClick:o,theme:s={},disabled:a,...c})=>{const l=Re(tt().listGroup.item,s),d=typeof n<"u",u=d?"a":"button";return h.jsx("li",{className:se(l.base,r),children:h.jsxs(u,{href:n,onClick:o,type:d?void 0:"button",disabled:a,className:se(l.link.active[e?"on":"off"],l.link.disabled[a?"on":"off"],l.link.base,l.link.href[d?"on":"off"]),...c,children:[i&&h.jsx(i,{"aria-hidden":!0,"data-testid":"flowbite-list-group-item-icon",className:l.link.icon}),t]})})},Xz=({children:e,className:t,theme:r={},...n})=>{const i=Re(tt().listGroup,r);return h.jsx("ul",{className:se(i.root.base,t),...n,children:e})};Xz.displayName="ListGroup";Yz.displayName="ListGroup.Item";Object.assign(Xz,{Item:Yz});const Jz=T.createContext(void 0);function bS(){const e=T.useContext(Jz);if(!e)throw new Error("useNavBarContext should be used within the NavbarContext provider!");return e}const Qz=({as:e="a",children:t,className:r,theme:n={},...i})=>{const{theme:o}=bS(),s=Re(o.brand,n);return h.jsx(e,{className:se(s.base,r),...i,children:t})},Zz=({children:e,className:t,theme:r={},...n})=>{const{theme:i,isOpen:o}=bS(),s=Re(i.collapse,r);return h.jsx("div",{"data-testid":"flowbite-navbar-collapse",className:se(s.base,s.hidden[o?"off":"on"],t),...n,children:h.jsx("ul",{className:s.list,children:e})})},eK=({active:e,as:t="a",disabled:r,children:n,className:i,theme:o={},onClick:s,...a})=>{const{theme:c,setIsOpen:l}=bS(),d=Re(c.link,o),u=p=>{l(!1),s==null||s(p)};return h.jsx("li",{children:h.jsx(t,{className:se(d.base,e&&d.active.on,!e&&!r&&d.active.off,d.disabled[r?"on":"off"],i),onClick:u,...a,children:n})})};function mve(e){return di({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(e)}const tK=({barIcon:e=mve,className:t,theme:r={},...n})=>{const{theme:i,isOpen:o,setIsOpen:s}=bS(),a=Re(i.toggle,r),c=()=>{s(!o)};return h.jsxs("button",{"data-testid":"flowbite-navbar-toggle",onClick:c,className:se(a.base,t),...n,children:[h.jsx("span",{className:"sr-only",children:"Open main menu"}),h.jsx(e,{"aria-hidden":!0,className:a.icon})]})},rK=({border:e,children:t,className:r,fluid:n=!1,menuOpen:i,rounded:o,theme:s={},...a})=>{const[c,l]=T.useState(i),d=Re(tt().navbar,s);return h.jsx(Jz.Provider,{value:{theme:d,isOpen:c,setIsOpen:l},children:h.jsx("nav",{className:se(d.root.base,d.root.bordered[e?"on":"off"],d.root.rounded[o?"on":"off"],r),...a,children:h.jsx("div",{className:se(d.root.inner.base,d.root.inner.fluid[n?"on":"off"]),children:t})})})};rK.displayName="Navbar";Qz.displayName="Navbar.Brand";Zz.displayName="Navbar.Collapse";eK.displayName="Navbar.Link";tK.displayName="Navbar.Toggle";const gve=Object.assign(rK,{Brand:Qz,Collapse:Zz,Link:eK,Toggle:tK}),nK=({children:e,className:t,theme:r={},toggle:n,...i})=>{const[o,s]=T.useState(void 0),a=Re(tt().megaMenu.dropdown,r);if(n)return h.jsx(fve,{inline:!0,label:n,placement:"bottom",theme:a.toggle,className:se(a.base,t),children:e});const c=T.useId(),l=T.useRef(null);return T.useEffect(()=>{var u;s((u=function(){var f;const p=(f=l.current)==null?void 0:f.closest("nav");return p==null?void 0:p.querySelector('[aria-haspopup="menu"]')}())==null?void 0:u.id)},[]),h.jsx("div",{"aria-labelledby":o,id:c,ref:l,role:"menu",className:se(a.base,t),...i,children:e})};nK.displayName="MegaMenu.Dropdown";const iK=({children:e,className:t,theme:r={},...n})=>{const i=T.useId(),o=T.useRef(null),[s,a]=T.useState(void 0),[c,l]=T.useState(void 0),d=Re(tt().megaMenu.dropdownToggle,r),u=function(){var m;const f=(m=o.current)==null?void 0:m.closest("nav");return f==null?void 0:f.querySelector('[role="menu"]')},p=function(){var f;(f=u())==null||f.classList.toggle("hidden"),l(!c)};return T.useEffect(()=>{const f=u(),m=f==null?void 0:f.classList.contains("hidden");a(f==null?void 0:f.id),l(!m)},[]),h.jsx("button",{"aria-controls":s,"aria-expanded":c,"aria-haspopup":"menu",id:i,onClick:p,ref:o,className:se(d.base,t),...n,children:e})};iK.displayName="MegaMenu.DropdownToggle";const oK=({children:e,theme:t={},...r})=>{const n=Re(tt().megaMenu,t);return h.jsx(gve,{fluid:!0,theme:n,...r,children:e})};Object.assign(oK,{Dropdown:nK,DropdownToggle:iK});oK.displayName="MegaMenu";const sK=T.createContext(void 0);function fP(){const e=T.useContext(sK);if(!e)throw new Error("useModalContext should be used within the ModalContext provider!");return e}const aK=({children:e,className:t,theme:r={},...n})=>{const{theme:i,popup:o}=fP(),s=Re(i.body,r);return h.jsx("div",{className:se(s.base,o&&[s.popup],t),...n,children:e})},cK=({children:e,className:t,theme:r={},...n})=>{const{theme:i,popup:o}=fP(),s=Re(i.footer,r);return h.jsx("div",{className:se(s.base,!o&&s.popup,t),...n,children:e})},lK=({as:e="h3",children:t,className:r,theme:n={},id:i,...o})=>{const s=T.useId(),a=i||s,{theme:c,popup:l,onClose:d,setHeaderId:u}=fP(),p=Re(c.header,n);return T.useLayoutEffect(()=>(u(a),()=>u(void 0)),[a,u]),h.jsxs("div",{className:se(p.base,l&&p.popup,r),...o,children:[h.jsx(e,{id:a,className:p.title,children:t}),h.jsx("button",{"aria-label":"Close",className:p.close.base,type:"button",onClick:d,children:h.jsx(mme,{"aria-hidden":!0,className:p.close.icon})})]})},dK=T.forwardRef(({children:e,className:t,dismissible:r=!1,onClose:n,popup:i,position:o="center",root:s,show:a,size:c="2xl",theme:l={},initialFocus:d,...u},p)=>{const[f,m]=T.useState(void 0),g=Re(tt().modal,l),{context:y}=hz({open:a,onOpenChange:()=>n&&n()}),v=ez([y.refs.setFloating,p]),E=dz(y),w=uz(y,{outsidePressEvent:"mousedown",enabled:r}),S=fz(y),{getFloatingProps:A}=pz([E,w,S]);return a?h.jsx(sK.Provider,{value:{theme:g,popup:i,onClose:n,setHeaderId:m},children:h.jsx(Mye,{root:s,children:h.jsx(Uye,{lockScroll:!0,"data-testid":"modal-overlay",className:se(g.root.base,g.root.positions[o],a?g.root.show.on:g.root.show.off,t),...u,children:h.jsx(lz,{context:y,initialFocus:d,children:h.jsx("div",{ref:v,...A(u),"aria-labelledby":f,className:se(g.content.base,g.root.sizes[c]),children:h.jsx("div",{className:g.content.inner,children:e})})})})})}):null});dK.displayName="Modal";lK.displayName="Modal.Header";aK.displayName="Modal.Body";cK.displayName="Modal.Footer";const Ov=Object.assign(dK,{Header:lK,Body:aK,Footer:cK}),yve=(e,t)=>e>=t?[]:[...Array(t-e+1).keys()].map(r=>r+e),mP=({active:e,children:t,className:r,onClick:n,theme:i={},...o})=>{const s=Re(tt().pagination,i);return h.jsx("button",{type:"button",className:se(e&&s.pages.selector.active,r),onClick:n,...o,children:t})};mP.displayName="Pagination.Button";const Fx=({children:e,className:t,onClick:r,theme:n={},disabled:i=!1,...o})=>{const s=Re(tt().pagination,n);return h.jsx("button",{type:"button",className:se(i&&s.pages.selector.disabled,t),disabled:i,onClick:r,...o,children:e})};Fx.displayName="Pagination.Navigation";const uK=({className:e,currentPage:t,layout:r="pagination",nextLabel:n="Next",onPageChange:i,previousLabel:o="Previous",renderPaginationButton:s=u=>h.jsx(mP,{...u}),showIcons:a=!1,theme:c={},totalPages:l,...d})=>{const u=Re(tt().pagination,c),p=Math.min(Math.max(r==="pagination"?t+2:t+4,5),l),f=Math.max(1,p-4),m=()=>{i(Math.min(t+1,l))},g=()=>{i(Math.max(t-1,1))};return h.jsxs("nav",{className:se(u.base,e),...d,children:[r==="table"&&h.jsxs("div",{className:u.layout.table.base,children:["Showing ",h.jsx("span",{className:u.layout.table.span,children:f})," to ",h.jsx("span",{className:u.layout.table.span,children:p})," of ",h.jsx("span",{className:u.layout.table.span,children:l})," Entries"]}),h.jsxs("ul",{className:u.pages.base,children:[h.jsx("li",{children:h.jsxs(Fx,{className:se(u.pages.previous.base,a&&u.pages.showIcon),onClick:g,disabled:t===1,children:[a&&h.jsx(lme,{"aria-hidden":!0,className:u.pages.previous.icon}),o]})}),r==="pagination"&&yve(f,p).map(y=>h.jsx("li",{"aria-current":y===t?"page":void 0,children:s({className:se(u.pages.selector.base,t===y&&u.pages.selector.active),active:y===t,onClick:()=>i(y),children:y})},y)),h.jsx("li",{children:h.jsxs(Fx,{className:se(u.pages.next.base,a&&u.pages.showIcon),onClick:m,disabled:t===l,children:[n,a&&h.jsx(dme,{"aria-hidden":!0,className:u.pages.next.icon})]})})]})]})};uK.displayName="Pagination";Object.assign(uK,{Button:mP});const vve=T.forwardRef(({className:e,theme:t={},...r},n)=>{const i=Re(tt().radio,t);return h.jsx("input",{ref:n,type:"radio",className:se(i.root.base,e),...r})});vve.displayName="Radio";const Eve=T.forwardRef(({className:e,sizing:t="md",theme:r={},...n},i)=>{const o=Re(tt().rangeSlider,r);return h.jsx(h.Fragment,{children:h.jsx("div",{"data-testid":"flowbite-range-slider",className:se(o.root.base,e),children:h.jsx("div",{className:o.field.base,children:h.jsx("input",{ref:i,type:"range",className:se(o.field.input.base,o.field.input.sizes[t]),...n})})})})});Eve.displayName="RangeSlider";const hK=({children:e,className:t,percentFilled:r=0,theme:n={},...i})=>{const o=Re(tt().ratingAdvanced,n);return h.jsxs("div",{className:se(o.base,t),...i,children:[h.jsx("span",{className:o.label,children:e}),h.jsx("div",{className:o.progress.base,children:h.jsx("div",{className:o.progress.fill,"data-testid":"flowbite-rating-fill",style:{width:`${r}%`}})}),h.jsx("span",{className:o.progress.label,children:`${r}%`})]})},pK=T.createContext(void 0);function _ve(){const e=T.useContext(pK);if(!e)throw new Error("useRatingContext should be used within the RatingContext provider!");return e}const fK=({className:e,filled:t=!0,starIcon:r=ume,theme:n={},...i})=>{const{theme:o,size:s="sm"}=_ve(),a=Re(o.star,n);return h.jsx(r,{"data-testid":"flowbite-rating-star",className:se(a.sizes[s],a[t?"filled":"empty"],e),...i})},mK=({children:e,className:t,size:r="sm",theme:n={},...i})=>{const o=Re(tt().rating,n);return h.jsx(pK.Provider,{value:{theme:o,size:r},children:h.jsx("div",{className:se(o.root.base,t),...i,children:e})})};mK.displayName="Rating";fK.displayName="Rating.Star";hK.displayName="Rating.Advanced";Object.assign(mK,{Star:fK,Advanced:hK});const bve=T.forwardRef(({addon:e,children:t,className:r,color:n="gray",helperText:i,icon:o,shadow:s,sizing:a="md",theme:c={},...l},d)=>{const u=Re(tt().select,c);return h.jsxs("div",{className:se(u.base,r),children:[e&&h.jsx("span",{className:u.addon,children:e}),h.jsxs("div",{className:u.field.base,children:[o&&h.jsx("div",{className:u.field.icon.base,children:h.jsx(o,{className:u.field.icon.svg})}),h.jsx("select",{className:se(u.field.select.base,u.field.select.colors[n],u.field.select.sizes[a],u.field.select.withIcon[o?"on":"off"],u.field.select.withAddon[e?"on":"off"],u.field.select.withShadow[s?"on":"off"]),...l,ref:d,children:t}),i&&h.jsx(Sy,{color:n,children:i})]})]})});bve.displayName="Select";const gK=T.createContext(void 0);function Qf(){const e=T.useContext(gK);if(!e)throw new Error("useSidebarContext should be used within the SidebarContext provider!");return e}const gP=T.createContext(void 0);function wve(){const e=T.useContext(gP);if(!e)throw new Error("useSidebarItemContext should be used within the SidebarItemContext provider!");return e}const yK=({children:e,className:t,icon:r,label:n,chevronIcon:i=s9,renderChevronIcon:o,open:s=!1,theme:a={},...c})=>{const l=T.useId(),[d,u]=T.useState(s),{theme:p,isCollapsed:f}=Qf(),m=Re(p.collapse,a);T.useEffect(()=>u(s),[s]);const g=({children:y})=>h.jsx("li",{children:f&&!d?h.jsx(ES,{content:n,placement:"right",children:y}):y});return h.jsxs(g,{children:[h.jsxs("button",{id:`flowbite-sidebar-collapse-${l}`,onClick:()=>u(!d),title:n,type:"button",className:se(m.button,t),...c,children:[r&&h.jsx(r,{"aria-hidden":!0,"data-testid":"flowbite-sidebar-collapse-icon",className:se(m.icon.base,m.icon.open[d?"on":"off"])}),f?h.jsx("span",{className:"sr-only",children:n}):h.jsxs(h.Fragment,{children:[h.jsx("span",{"data-testid":"flowbite-sidebar-collapse-label",className:m.label.base,children:n}),o?o(m,d):h.jsx(i,{"aria-hidden":!0,className:se(m.label.icon.base,m.label.icon.open[d?"on":"off"])})]})]}),h.jsx("ul",{"aria-labelledby":`flowbite-sidebar-collapse-${l}`,hidden:!d,className:m.list,children:h.jsx(gP.Provider,{value:{isInsideCollapse:!0},children:e})})]})};yK.displayName="Sidebar.Collapse";const vK=({children:e,color:t="info",className:r,theme:n={},...i})=>{const{theme:o,isCollapsed:s}=Qf(),a=Re(o.cta,n);return h.jsx("div",{"data-testid":"sidebar-cta",hidden:s,className:se(a.base,a.color[t],r),...i,children:e})};vK.displayName="Sidebar.CTA";const Sve=({id:e,theme:t,isCollapsed:r,tooltipChildren:n,children:i,...o})=>h.jsx("li",{...o,children:r?h.jsx(ES,{content:h.jsx(EK,{id:e,theme:t,children:n}),placement:"right",children:i}):i}),EK=({id:e,theme:t,children:r})=>h.jsx("span",{"data-testid":"flowbite-sidebar-item-content",id:`flowbite-sidebar-item-${e}`,className:se(t.content.base),children:r}),_K=T.forwardRef(({active:e,as:t="a",children:r,className:n,icon:i,label:o,labelColor:s="info",theme:a={},...c},l)=>{var g,y,v,E;const d=T.useId(),{theme:u,isCollapsed:p}=Qf(),{isInsideCollapse:f}=wve(),m=Re(u.item,a);return h.jsx(Sve,{theme:m,className:m.listItem,id:d,isCollapsed:p,tooltipChildren:r,children:h.jsxs(t,{"aria-labelledby":`flowbite-sidebar-item-${d}`,ref:l,className:se(m.base,e&&m.active,!p&&f&&((g=m.collapsed)==null?void 0:g.insideCollapse),n),...c,children:[i&&h.jsx(i,{"aria-hidden":!0,"data-testid":"flowbite-sidebar-item-icon",className:se((y=m.icon)==null?void 0:y.base,e&&((v=m.icon)==null?void 0:v.active))}),p&&!i&&h.jsx("span",{className:(E=m.collapsed)==null?void 0:E.noIcon,children:r.charAt(0).toLocaleUpperCase()??"?"}),!p&&h.jsx(EK,{id:d,theme:m,children:r}),!p&&o&&h.jsx(S9,{color:s,"data-testid":"flowbite-sidebar-label",hidden:p,className:m.label,children:o})]})})});_K.displayName="Sidebar.Item";const bK=({children:e,className:t,theme:r={},...n})=>{const{theme:i}=Qf(),o=Re(i.itemGroup,r);return h.jsx("ul",{"data-testid":"flowbite-sidebar-item-group",className:se(o.base,t),...n,children:h.jsx(gP.Provider,{value:{isInsideCollapse:!1},children:e})})};bK.displayName="Sidebar.ItemGroup";const wK=({children:e,className:t,theme:r={},...n})=>{const{theme:i}=Qf(),o=Re(i.items,r);return h.jsx("div",{className:se(o.base,t),"data-testid":"flowbite-sidebar-items",...n,children:e})};wK.displayName="Sidebar.Items";const SK=({children:e,className:t,href:r,img:n,imgAlt:i="",theme:o={},...s})=>{const a=T.useId(),{theme:c,isCollapsed:l}=Qf(),d=Re(c.logo,o);return h.jsxs("a",{"aria-labelledby":`flowbite-sidebar-logo-${a}`,href:r,className:se(d.base,t),...s,children:[h.jsx("img",{alt:i,src:n,className:d.img}),h.jsx("span",{className:d.collapsed[l?"on":"off"],id:`flowbite-sidebar-logo-${a}`,children:e})]})};SK.displayName="Sidebar.Logo";const TK=({children:e,as:t="nav",collapseBehavior:r="collapse",collapsed:n=!1,theme:i={},className:o,...s})=>{const a=Re(tt().sidebar,i);return h.jsx(gK.Provider,{value:{theme:a,isCollapsed:n},children:h.jsx(t,{"aria-label":"Sidebar",hidden:n&&r==="hide",className:se(a.root.base,a.root.collapsed[n?"on":"off"],o),...s,children:h.jsx("div",{className:a.root.inner,children:e})})})};TK.displayName="Sidebar";Object.assign(TK,{Collapse:yK,CTA:vK,Item:_K,Items:wK,ItemGroup:bK,Logo:SK});const CK=T.createContext(void 0);function Tve(){const e=T.useContext(CK);if(!e)throw new Error("useTableBodyContext should be used within the TableBodyContext provider!");return e}const RK=T.createContext(void 0);function yP(){const e=T.useContext(RK);if(!e)throw new Error("useTableContext should be used within the TableContext provider!");return e}const IK=T.forwardRef(({children:e,className:t,theme:r={},...n},i)=>{const{theme:o}=yP(),s=Re(o.body,r);return h.jsx(CK.Provider,{value:{theme:s},children:h.jsx("tbody",{className:se(s.base,t),ref:i,...n,children:e})})});IK.displayName="Table.Body";const AK=T.forwardRef(({children:e,className:t,theme:r={},...n},i)=>{const{theme:o}=Tve(),s=Re(o.cell,r);return h.jsx("td",{className:se(s.base,t),ref:i,...n,children:e})});AK.displayName="Table.Cell";const xK=T.createContext(void 0);function Cve(){const e=T.useContext(xK);if(!e)throw new Error("useTableHeadContext should be used within the TableHeadContext provider!");return e}const OK=T.forwardRef(({children:e,className:t,theme:r={},...n},i)=>{const{theme:o}=yP(),s=Re(o.head,r);return h.jsx(xK.Provider,{value:{theme:s},children:h.jsx("thead",{className:se(s.base,t),ref:i,...n,children:h.jsx("tr",{children:e})})})});OK.displayName="Table.Head";const NK=T.forwardRef(({children:e,className:t,theme:r={},...n},i)=>{const{theme:o}=Cve(),s=Re(o.cell,r);return h.jsx("th",{className:se(s.base,t),ref:i,...n,children:e})});NK.displayName="Table.HeadCell";const kK=T.forwardRef(({children:e,className:t,theme:r={},...n},i)=>{const{theme:o,hoverable:s,striped:a}=yP(),c=Re(o.row,r);return h.jsx("tr",{ref:i,"data-testid":"table-row-element",className:se(c.base,a&&c.striped,s&&c.hovered,t),...n,children:e})});kK.displayName="Table.Row";const PK=T.forwardRef(({children:e,className:t,striped:r,hoverable:n,theme:i={},...o},s)=>{const a=Re(tt().table,i);return h.jsx("div",{"data-testid":"table-element",className:se(a.root.wrapper),children:h.jsxs(RK.Provider,{value:{theme:a,striped:r,hoverable:n},children:[h.jsx("div",{className:se(a.root.shadow,t)}),h.jsx("table",{className:se(a.root.base,t),...o,ref:s,children:e})]})})});PK.displayName="Table";const ur=Object.assign(PK,{Head:OK,Body:IK,Row:kK,Cell:AK,HeadCell:NK}),DK=({children:e,className:t})=>h.jsx("div",{className:t,children:e});DK.displayName="Tabs.Item";const LK=T.forwardRef(({children:e,className:t,onActiveTabChange:r,variant:n="default",theme:i={},...o},s)=>{const a=Re(tt().tabs,i),c=T.useId(),l=T.useMemo(()=>T.Children.map(T.Children.toArray(e),({props:S})=>S),[e]),d=T.useRef([]),[u,p]=T.useState(Math.max(0,l.findIndex(S=>S.active))),[f,m]=T.useState(-1),g=S=>{p(S),r&&r(S)},y=({target:S})=>{g(S),m(S)},v=({event:S,target:A})=>{S.key==="ArrowLeft"&&m(Math.max(0,f-1)),S.key==="ArrowRight"&&m(Math.min(l.length-1,f+1)),S.key==="Enter"&&(g(A),m(A))},E=a.tablist.tabitem.variant[n],w=a.tabitemcontainer.variant[n];return T.useEffect(()=>{var S;(S=d.current[f])==null||S.focus()},[f]),T.useImperativeHandle(s,()=>({setActiveTab:g})),h.jsxs("div",{className:se(a.base,t),children:[h.jsx("div",{"aria-label":"Tabs",role:"tablist",className:se(a.tablist.base,a.tablist.variant[n],t),...o,children:l.map((S,A)=>h.jsxs("button",{type:"button","aria-controls":`${c}-tabpanel-${A}`,"aria-selected":A===u,className:se(a.tablist.tabitem.base,E.base,A===u&&E.active.on,A!==u&&!S.disabled&&E.active.off),disabled:S.disabled,id:`${c}-tab-${A}`,onClick:()=>y({target:A}),onKeyDown:N=>v({event:N,target:A}),ref:N=>d.current[A]=N,role:"tab",tabIndex:A===f?0:-1,style:{zIndex:A===f?2:1},children:[S.icon&&h.jsx(S.icon,{className:a.tablist.tabitem.icon}),S.title]},A))}),h.jsx("div",{className:se(a.tabitemcontainer.base,w),children:l.map((S,A)=>h.jsx("div",{"aria-labelledby":`${c}-tab-${A}`,className:a.tabpanel,hidden:A!==u,id:`${c}-tabpanel-${A}`,role:"tabpanel",tabIndex:0,children:S.children},A))})]})});LK.displayName="Tabs";Object.assign(LK,{Item:DK});const Rve=T.forwardRef(({className:e,color:t="gray",helperText:r,shadow:n,theme:i={},...o},s)=>{const a=Re(tt().textarea,i);return h.jsxs(h.Fragment,{children:[h.jsx("textarea",{ref:s,className:se(a.base,a.colors[t],a.withShadow[n?"on":"off"],e),...o}),r&&h.jsx(Sy,{color:t,children:r})]})});Rve.displayName="Textarea";const MK=T.createContext(void 0);function vP(){const e=T.useContext(MK);if(!e)throw new Error("useTimelineContentContext should be used within the TimelineContentContext provider!");return e}const jK=({children:e,className:t,theme:r={},...n})=>{const{theme:i}=vP(),o=Re(i.body,r);return h.jsx("div",{className:se(o.base,t),...n,children:e})},UK=T.createContext(void 0);function EP(){const e=T.useContext(UK);if(!e)throw new Error("useTimelineContext should be used within the TimelineContext provider!");return e}const FK=T.createContext(void 0);function VK(){const e=T.useContext(FK);if(!e)throw new Error("useTimelineItemContext should be used within the TimelineItemContext provider!");return e}const BK=({children:e,className:t,theme:r={},...n})=>{const{horizontal:i}=EP(),{theme:o}=VK(),s=Re(o.content,r);return h.jsx(MK.Provider,{value:{theme:s},children:h.jsx("div",{"data-testid":"timeline-content",className:se(s.root.base,i?s.root.horizontal:s.root.vertical,t),...n,children:e})})},$K=({children:e,className:t,theme:r={},...n})=>{const{theme:i,horizontal:o}=EP(),s=Re(i.item,r);return h.jsx(FK.Provider,{value:{theme:s},children:h.jsx("li",{"data-testid":"timeline-item",className:se(o&&s.root.horizontal,!o&&s.root.vertical,t),...n,children:e})})},HK=({children:e,className:t,icon:r,theme:n={},...i})=>{const{horizontal:o}=EP(),{theme:s}=VK(),a=Re(s.point,n);return h.jsxs("div",{"data-testid":"timeline-point",className:se(o&&a.horizontal,!o&&a.vertical,t),...i,children:[e,r?h.jsx("span",{className:se(a.marker.icon.wrapper),children:h.jsx(r,{"aria-hidden":!0,className:se(a.marker.icon.base)})}):h.jsx("div",{className:se(o&&a.marker.base.horizontal,!o&&a.marker.base.vertical)}),o&&h.jsx("div",{className:se(a.line)})]})},WK=({children:e,className:t,theme:r={},...n})=>{const{theme:i}=vP(),o=Re(i.time,r);return h.jsx("time",{className:se(o.base,t),...n,children:e})},GK=({as:e="h3",children:t,className:r,theme:n={},...i})=>{const{theme:o}=vP(),s=Re(o.title,n);return h.jsx(e,{className:se(s.base,r),...i,children:t})},zK=({children:e,className:t,horizontal:r,theme:n={},...i})=>{const o=Re(tt().timeline,n);return h.jsx(UK.Provider,{value:{theme:o,horizontal:r},children:h.jsx("ol",{"data-testid":"timeline-component",className:se(r&&o.root.direction.horizontal,!r&&o.root.direction.vertical,t),...i,children:e})})};zK.displayName="Timeline";$K.displayName="Timeline.Item";HK.displayName="Timeline.Point";BK.displayName="Timeline.Content";WK.displayName="Timeline.Time";GK.displayName="Timeline.Title";jK.displayName="Timeline.Body";Object.assign(zK,{Item:$K,Point:HK,Content:BK,Time:WK,Title:GK,Body:jK});const KK=T.createContext(void 0);function Ive(){const e=T.useContext(KK);if(!e)throw new Error("useToastContext should be used within the ToastContext provider!");return e}const qK=({className:e,onClick:t,theme:r={},xIcon:n=hme,onDismiss:i,...o})=>{const{theme:s,duration:a,isClosed:c,isRemoved:l,setIsClosed:d,setIsRemoved:u}=Ive(),p=Re(s.toggle,r),f=m=>{if(t&&t(m),i){i();return}d(!c),setTimeout(()=>u(!l),a)};return h.jsx("button",{"aria-label":"Close",onClick:f,type:"button",className:se(p.base,e),...o,children:h.jsx(n,{"aria-hidden":!0,className:p.icon})})},Ave={75:"duration-75",100:"duration-100",150:"duration-150",200:"duration-200",300:"duration-300",500:"duration-500",700:"duration-700",1e3:"duration-1000"},YK=({children:e,className:t,duration:r=300,theme:n={},...i})=>{const[o,s]=T.useState(!1),[a,c]=T.useState(!1),l=Re(tt().toast,n);return a?null:h.jsx(KK.Provider,{value:{theme:l,duration:r,isClosed:o,isRemoved:a,setIsClosed:s,setIsRemoved:c},children:h.jsx("div",{"data-testid":"flowbite-toast",role:"alert",className:se(l.root.base,Ave[r],o&&l.root.closed,t),...i,children:e})})};YK.displayName="Toast";qK.displayName="Toast.Toggle";Object.assign(YK,{Toggle:qK});const xve=T.forwardRef(({checked:e,className:t,color:r="blue",sizing:n="md",disabled:i,label:o,name:s,onChange:a,theme:c={},...l},d)=>{const u=T.useId(),p=Re(tt().toggleSwitch,c),f=()=>a(!e),m=()=>{f()},g=y=>{y.code=="Enter"&&y.preventDefault()};return h.jsxs(h.Fragment,{children:[s&&e?h.jsx("input",{ref:d,checked:e,hidden:!0,name:s,readOnly:!0,type:"checkbox",className:"sr-only"}):null,h.jsxs("button",{"aria-checked":e,"aria-labelledby":`${u}-flowbite-toggleswitch-label`,disabled:i,id:`${u}-flowbite-toggleswitch`,onClick:m,onKeyDown:g,role:"switch",tabIndex:0,type:"button",className:se(p.root.base,p.root.active[i?"off":"on"],t),...l,children:[h.jsx("div",{"data-testid":"flowbite-toggleswitch-toggle",className:se(p.toggle.base,p.toggle.checked[e?"on":"off"],e&&p.toggle.checked.color[r],p.toggle.sizes[n])}),o!=null&&o.length?h.jsx("span",{"data-testid":"flowbite-toggleswitch-label",id:`${u}-flowbite-toggleswitch-label`,className:p.root.label,children:o}):null]})]})});xve.displayName="ToggleSwitch";const Ove={firstName:"",lastName:"",profileImage:"",weight:"",height:""},XK=dS({name:"patient",initialState:Ove,reducers:{setPatient(e,t){e.firstName=t.payload.firstName,e.lastName=t.payload.lastName,e.profileImage=t.payload.profileImage,e.weight=t.payload.weight,e.height=t.payload.height}}}),{setPatient:wC}=XK.actions,Nve=XK.reducer,kve="http://localhost:5000/api",Pve=async({token:e})=>{try{const t=await Ce.get(`${kve}/patient/getBasicDetails`,{headers:{authorization:`Bearer ${sessionStorage.getItem("token")}`}});return console.log(t.data),t.data.userData}catch(t){return console.log(t),t.response.status=="401"||t.response.status=="400",!1}},wS="http://localhost:5000/api",JK=sessionStorage.getItem("token"),Dve=async e=>{try{const t=await Ce.post(`${wS}/patient/profile/updateDetails`,e,{headers:{"content-type":" multipart/form-data",Authorization:`bearer ${sessionStorage.getItem("token")}`}});return console.log(t),oe.fire({icon:"success",text:"Profile has been Updated"}),!0}catch(t){console.log(t)}},QK=async()=>{try{const e=await Ce.get(`${wS}/patient/profile/viewDetails`,{headers:{Authorization:`bearer ${sessionStorage.getItem("token")}`}});return console.log(e),e.data.patientDetails}catch(e){console.log(e),(e.response.status=e.response.data.invalidToken)&&oe.fire({icon:"warning",text:"Login to access profile"})}},Lve=async()=>{var e,t,r,n,i,o;try{return(await Ce.get(`${wS}/patient/profile/getAddessAndPhone`,{headers:{Authorization:`bearer ${JK}`}})).data.contactDetails}catch(s){return console.log(s),((e=s==null?void 0:s.response)==null?void 0:e.status)=="500"&&((r=(t=s==null?void 0:s.response)==null?void 0:t.data)!=null&&r.errorServer)&&oe.fire("Error at the Server","","error"),((n=s==null?void 0:s.response)==null?void 0:n.status)=="400"&&((o=(i=s==null?void 0:s.response)==null?void 0:i.data)!=null&&o.invalidToken)&&oe.fire("Log in","","error"),!1}},Mve=async e=>{var t,r,n,i,o,s;try{const a=await Ce.post(`${wS}/patient/profile/updateAddessAndPhone`,e,{headers:{Authorization:`bearer ${JK}`}});return!0}catch(a){return console.log(a),((t=a==null?void 0:a.response)==null?void 0:t.status)=="500"&&((n=(r=a==null?void 0:a.response)==null?void 0:r.data)!=null&&n.errorServer)&&oe.fire("Error at the Server","","error"),((i=a==null?void 0:a.response)==null?void 0:i.status)=="400"&&((s=(o=a==null?void 0:a.response)==null?void 0:o.data)!=null&&s.invalidToken)&&oe.fire("Log in","","error"),!1}};var ZK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(cN,function(){var r=1e3,n=6e4,i=36e5,o="millisecond",s="second",a="minute",c="hour",l="day",d="week",u="month",p="quarter",f="year",m="date",g="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,E={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(H){var $=["th","st","nd","rd"],K=H%100;return"["+H+($[(K-20)%10]||$[K]||$[0])+"]"}},w=function(H,$,K){var x=String(H);return!x||x.length>=$?H:""+Array($+1-x.length).join(K)+H},S={s:w,z:function(H){var $=-H.utcOffset(),K=Math.abs($),x=Math.floor(K/60),O=K%60;return($<=0?"+":"-")+w(x,2,"0")+":"+w(O,2,"0")},m:function H($,K){if($.date()<K.date())return-H(K,$);var x=12*(K.year()-$.year())+(K.month()-$.month()),O=$.clone().add(x,u),F=K-O<0,P=$.clone().add(x+(F?-1:1),u);return+(-(x+(K-O)/(F?O-P:P-O))||0)},a:function(H){return H<0?Math.ceil(H)||0:Math.floor(H)},p:function(H){return{M:u,y:f,w:d,d:l,D:m,h:c,m:a,s,ms:o,Q:p}[H]||String(H||"").toLowerCase().replace(/s$/,"")},u:function(H){return H===void 0}},A="en",N={};N[A]=E;var L="$isDayjsObject",j=function(H){return H instanceof Z||!(!H||!H[L])},W=function H($,K,x){var O;if(!$)return A;if(typeof $=="string"){var F=$.toLowerCase();N[F]&&(O=F),K&&(N[F]=K,O=F);var P=$.split("-");if(!O&&P.length>1)return H(P[0])}else{var _=$.name;N[_]=$,O=_}return!x&&O&&(A=O),O||!x&&A},V=function(H,$){if(j(H))return H.clone();var K=typeof $=="object"?$:{};return K.date=H,K.args=arguments,new Z(K)},Y=S;Y.l=W,Y.i=j,Y.w=function(H,$){return V(H,{locale:$.$L,utc:$.$u,x:$.$x,$offset:$.$offset})};var Z=function(){function H(K){this.$L=W(K.locale,null,!0),this.parse(K),this.$x=this.$x||K.x||{},this[L]=!0}var $=H.prototype;return $.parse=function(K){this.$d=function(x){var O=x.date,F=x.utc;if(O===null)return new Date(NaN);if(Y.u(O))return new Date;if(O instanceof Date)return new Date(O);if(typeof O=="string"&&!/Z$/i.test(O)){var P=O.match(y);if(P){var _=P[2]-1||0,R=(P[7]||"0").substring(0,3);return F?new Date(Date.UTC(P[1],_,P[3]||1,P[4]||0,P[5]||0,P[6]||0,R)):new Date(P[1],_,P[3]||1,P[4]||0,P[5]||0,P[6]||0,R)}}return new Date(O)}(K),this.init()},$.init=function(){var K=this.$d;this.$y=K.getFullYear(),this.$M=K.getMonth(),this.$D=K.getDate(),this.$W=K.getDay(),this.$H=K.getHours(),this.$m=K.getMinutes(),this.$s=K.getSeconds(),this.$ms=K.getMilliseconds()},$.$utils=function(){return Y},$.isValid=function(){return this.$d.toString()!==g},$.isSame=function(K,x){var O=V(K);return this.startOf(x)<=O&&O<=this.endOf(x)},$.isAfter=function(K,x){return V(K)<this.startOf(x)},$.isBefore=function(K,x){return this.endOf(x)<V(K)},$.$g=function(K,x,O){return Y.u(K)?this[x]:this.set(O,K)},$.unix=function(){return Math.floor(this.valueOf()/1e3)},$.valueOf=function(){return this.$d.getTime()},$.startOf=function(K,x){var O=this,F=!!Y.u(x)||x,P=Y.p(K),_=function(me,De){var He=Y.w(O.$u?Date.UTC(O.$y,De,me):new Date(O.$y,De,me),O);return F?He:He.endOf(l)},R=function(me,De){return Y.w(O.toDate()[me].apply(O.toDate("s"),(F?[0,0,0,0]:[23,59,59,999]).slice(De)),O)},k=this.$W,z=this.$M,U=this.$D,q="set"+(this.$u?"UTC":"");switch(P){case f:return F?_(1,0):_(31,11);case u:return F?_(1,z):_(0,z+1);case d:var ie=this.$locale().weekStart||0,ue=(k<ie?k+7:k)-ie;return _(F?U-ue:U+(6-ue),z);case l:case m:return R(q+"Hours",0);case c:return R(q+"Minutes",1);case a:return R(q+"Seconds",2);case s:return R(q+"Milliseconds",3);default:return this.clone()}},$.endOf=function(K){return this.startOf(K,!1)},$.$set=function(K,x){var O,F=Y.p(K),P="set"+(this.$u?"UTC":""),_=(O={},O[l]=P+"Date",O[m]=P+"Date",O[u]=P+"Month",O[f]=P+"FullYear",O[c]=P+"Hours",O[a]=P+"Minutes",O[s]=P+"Seconds",O[o]=P+"Milliseconds",O)[F],R=F===l?this.$D+(x-this.$W):x;if(F===u||F===f){var k=this.clone().set(m,1);k.$d[_](R),k.init(),this.$d=k.set(m,Math.min(this.$D,k.daysInMonth())).$d}else _&&this.$d[_](R);return this.init(),this},$.set=function(K,x){return this.clone().$set(K,x)},$.get=function(K){return this[Y.p(K)]()},$.add=function(K,x){var O,F=this;K=Number(K);var P=Y.p(x),_=function(z){var U=V(F);return Y.w(U.date(U.date()+Math.round(z*K)),F)};if(P===u)return this.set(u,this.$M+K);if(P===f)return this.set(f,this.$y+K);if(P===l)return _(1);if(P===d)return _(7);var R=(O={},O[a]=n,O[c]=i,O[s]=r,O)[P]||1,k=this.$d.getTime()+K*R;return Y.w(k,this)},$.subtract=function(K,x){return this.add(-1*K,x)},$.format=function(K){var x=this,O=this.$locale();if(!this.isValid())return O.invalidDate||g;var F=K||"YYYY-MM-DDTHH:mm:ssZ",P=Y.z(this),_=this.$H,R=this.$m,k=this.$M,z=O.weekdays,U=O.months,q=O.meridiem,ie=function(De,He,Pe,nt){return De&&(De[He]||De(x,F))||Pe[He].slice(0,nt)},ue=function(De){return Y.s(_%12||12,De,"0")},me=q||function(De,He,Pe){var nt=De<12?"AM":"PM";return Pe?nt.toLowerCase():nt};return F.replace(v,function(De,He){return He||function(Pe){switch(Pe){case"YY":return String(x.$y).slice(-2);case"YYYY":return Y.s(x.$y,4,"0");case"M":return k+1;case"MM":return Y.s(k+1,2,"0");case"MMM":return ie(O.monthsShort,k,U,3);case"MMMM":return ie(U,k);case"D":return x.$D;case"DD":return Y.s(x.$D,2,"0");case"d":return String(x.$W);case"dd":return ie(O.weekdaysMin,x.$W,z,2);case"ddd":return ie(O.weekdaysShort,x.$W,z,3);case"dddd":return z[x.$W];case"H":return String(_);case"HH":return Y.s(_,2,"0");case"h":return ue(1);case"hh":return ue(2);case"a":return me(_,R,!0);case"A":return me(_,R,!1);case"m":return String(R);case"mm":return Y.s(R,2,"0");case"s":return String(x.$s);case"ss":return Y.s(x.$s,2,"0");case"SSS":return Y.s(x.$ms,3,"0");case"Z":return P}return null}(De)||P.replace(":","")})},$.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},$.diff=function(K,x,O){var F,P=this,_=Y.p(x),R=V(K),k=(R.utcOffset()-this.utcOffset())*n,z=this-R,U=function(){return Y.m(P,R)};switch(_){case f:F=U()/12;break;case u:F=U();break;case p:F=U()/3;break;case d:F=(z-k)/6048e5;break;case l:F=(z-k)/864e5;break;case c:F=z/i;break;case a:F=z/n;break;case s:F=z/r;break;default:F=z}return O?F:Y.a(F)},$.daysInMonth=function(){return this.endOf(u).$D},$.$locale=function(){return N[this.$L]},$.locale=function(K,x){if(!K)return this.$L;var O=this.clone(),F=W(K,x,!0);return F&&(O.$L=F),O},$.clone=function(){return Y.w(this.$d,this)},$.toDate=function(){return new Date(this.valueOf())},$.toJSON=function(){return this.isValid()?this.toISOString():null},$.toISOString=function(){return this.$d.toISOString()},$.toString=function(){return this.$d.toUTCString()},H}(),te=Z.prototype;return V.prototype=te,[["$ms",o],["$s",s],["$m",a],["$H",c],["$W",l],["$M",u],["$y",f],["$D",m]].forEach(function(H){te[H[1]]=function($){return this.$g($,H[0],H[1])}}),V.extend=function(H,$){return H.$i||(H($,Z,V),H.$i=!0),V},V.locale=W,V.isDayjs=j,V.unix=function(H){return V(1e3*H)},V.en=N[A],V.Ls=N,V.p={},V})})(ZK);var jve=ZK.exports;const Ct=Pa(jve);var eq={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(cN,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,o=/\d\d/,s=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,c={},l=function(y){return(y=+y)+(y>68?1900:2e3)},d=function(y){return function(v){this[y]=+v}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=function(v){if(!v||v==="Z")return 0;var E=v.match(/([+-]|\d\d)/g),w=60*E[1]+(+E[2]||0);return w===0?0:E[0]==="+"?-w:w}(y)}],p=function(y){var v=c[y];return v&&(v.indexOf?v:v.s.concat(v.f))},f=function(y,v){var E,w=c.meridiem;if(w){for(var S=1;S<=24;S+=1)if(y.indexOf(w(S,0,v))>-1){E=S>12;break}}else E=y===(v?"pm":"PM");return E},m={A:[a,function(y){this.afternoon=f(y,!1)}],a:[a,function(y){this.afternoon=f(y,!0)}],Q:[i,function(y){this.month=3*(y-1)+1}],S:[i,function(y){this.milliseconds=100*+y}],SS:[o,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[s,d("seconds")],ss:[s,d("seconds")],m:[s,d("minutes")],mm:[s,d("minutes")],H:[s,d("hours")],h:[s,d("hours")],HH:[s,d("hours")],hh:[s,d("hours")],D:[s,d("day")],DD:[o,d("day")],Do:[a,function(y){var v=c.ordinal,E=y.match(/\d+/);if(this.day=E[0],v)for(var w=1;w<=31;w+=1)v(w).replace(/\[|\]/g,"")===y&&(this.day=w)}],w:[s,d("week")],ww:[o,d("week")],M:[s,d("month")],MM:[o,d("month")],MMM:[a,function(y){var v=p("months"),E=(p("monthsShort")||v.map(function(w){return w.slice(0,3)})).indexOf(y)+1;if(E<1)throw new Error;this.month=E%12||E}],MMMM:[a,function(y){var v=p("months").indexOf(y)+1;if(v<1)throw new Error;this.month=v%12||v}],Y:[/[+-]?\d+/,d("year")],YY:[o,function(y){this.year=l(y)}],YYYY:[/\d{4}/,d("year")],Z:u,ZZ:u};function g(y){var v,E;v=y,E=c&&c.formats;for(var w=(y=v.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(V,Y,Z){var te=Z&&Z.toUpperCase();return Y||E[Z]||r[Z]||E[te].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(H,$,K){return $||K.slice(1)})})).match(n),S=w.length,A=0;A<S;A+=1){var N=w[A],L=m[N],j=L&&L[0],W=L&&L[1];w[A]=W?{regex:j,parser:W}:N.replace(/^\[|\]$/g,"")}return function(V){for(var Y={},Z=0,te=0;Z<S;Z+=1){var H=w[Z];if(typeof H=="string")te+=H.length;else{var $=H.regex,K=H.parser,x=V.slice(te),O=$.exec(x)[0];K.call(Y,O),V=V.replace(O,"")}}return function(F){var P=F.afternoon;if(P!==void 0){var _=F.hours;P?_<12&&(F.hours+=12):_===12&&(F.hours=0),delete F.afternoon}}(Y),Y}}return function(y,v,E){E.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(l=y.parseTwoDigitYear);var w=v.prototype,S=w.parse;w.parse=function(A){var N=A.date,L=A.utc,j=A.args;this.$u=L;var W=j[1];if(typeof W=="string"){var V=j[2]===!0,Y=j[3]===!0,Z=V||Y,te=j[2];Y&&(te=j[2]),c=this.$locale(),!V&&te&&(c=E.Ls[te]),this.$d=function(x,O,F,P){try{if(["x","X"].indexOf(O)>-1)return new Date((O==="X"?1e3:1)*x);var _=g(O)(x),R=_.year,k=_.month,z=_.day,U=_.hours,q=_.minutes,ie=_.seconds,ue=_.milliseconds,me=_.zone,De=_.week,He=new Date,Pe=z||(R||k?1:He.getDate()),nt=R||He.getFullYear(),Rt=0;R&&!k||(Rt=k>0?k-1:He.getMonth());var Ye,_t=U||0,Te=q||0,Ze=ie||0,Ve=ue||0;return me?new Date(Date.UTC(nt,Rt,Pe,_t,Te,Ze,Ve+60*me.offset*1e3)):F?new Date(Date.UTC(nt,Rt,Pe,_t,Te,Ze,Ve)):(Ye=new Date(nt,Rt,Pe,_t,Te,Ze,Ve),De&&(Ye=P(Ye).week(De).toDate()),Ye)}catch{return new Date("")}}(N,W,L,E),this.init(),te&&te!==!0&&(this.$L=this.locale(te).$L),Z&&N!=this.format(W)&&(this.$d=new Date("")),c={}}else if(W instanceof Array)for(var H=W.length,$=1;$<=H;$+=1){j[1]=W[$-1];var K=E.apply(this,j);if(K.isValid()){this.$d=K.$d,this.$L=K.$L,this.init();break}$===H&&(this.$d=new Date(""))}else S.call(this,A)}}})})(eq);var Uve=eq.exports;const vl=Pa(Uve);Ct.extend(vl);const Fve="ws://localhost:5000";var Nv;const Vve=async({userId:e})=>{Nv=new WebSocket(Fve),Nv.onopen=()=>{console.log("connected to websocket"),Nv.send(JSON.stringify({type:"register",clientId:e}))},Nv.onmessage=t=>{const r=JSON.parse(t==null?void 0:t.data);if(r.type=="meetingReminder"){const n=Ct().diff(Ct(`${r.booking.startTime}`,"H:mm A"),"minutes");Math.abs(n)<=60&&oe.fire(`Meeting in ${Math.abs(n)} minutes`,"","warning")}}};function _P(){const e=zf(),{username:t,email:r,role:n,isLoggedIn:i}=lo(c=>c.user),o=lo(c=>c.patient);lo(c=>c.patient_alert),console.log(t);const s=async()=>{if(sessionStorage.getItem("token")){const c=await Pve({token:sessionStorage.getItem("token")});if(c){const l=await QK();await Vve({userId:c._id}),e(Xs({username:c.username,email:c.email,role:c.role,isLoggedIn:!0})),e(wC({firstName:l.firstName,lastName:l.lastName,profileImage:l.profileImage,weight:l.weight,height:l.height,profileImage:l.profileImage}))}else Xs({}),wC({})}};T.useEffect(()=>{s()},[]);const a=Ln();return h.jsx("div",{className:"w-full h-[12vh]",children:h.jsxs("div",{className:"w-full h-[12vh] flex flex-row items-center mx-2 p-2 gap-4",children:[h.jsx("div",{className:"logo w-44 flex justify-center items-center  ",children:h.jsx("img",{src:"/logo.png",alt:""})}),h.jsx("div",{className:"items w-[50%] h-full",children:h.jsxs("div",{className:"w-full h-full flex flex-row gap-4 items-center p-5 ml-10 ",children:[h.jsx("button",{className:"font-medium text-lg p-2 ",onClick:()=>a("/"),children:"Home"}),h.jsx("button",{className:"font-medium text-lg p-2 ",id:"id_navDoctors",onClick:()=>a("/patient/doctors"),children:"Find Doctors"}),h.jsx("button",{className:"font-medium text-lg p-2 ",onClick:()=>a("/patient/medicines"),children:"Medicines"}),h.jsx("button",{className:"font-medium text-lg p-2 ",onClick:()=>a("/patient/tests"),children:"tests"}),h.jsx("button",{className:"font-medium text-lg p-2 ",onClick:()=>a("/patient/treatmentPlan"),children:"Treatment Plan"}),!1]})}),h.jsx("div",{className:"search w-[25%] h-full flex justify-center items-center",children:h.jsxs("div",{className:"w-full h-[70%] rounded-lg flex flex-row gap-2 ",children:[h.jsx("input",{type:"text",placeholder:"search",className:"border w-full h-full rounded-lg"}),h.jsx("div",{className:"h-full flex justify-center items-center bg-blue-200 p-2 rounded-lg",children:h.jsx("img",{src:"/icons/search.png",alt:"search icon",className:"h-[2em] w-10 mr-2 opacity-40 cursor-pointer"})})]})}),i?h.jsxs("div",{className:"loggedIn h-full flex justify-end w-[18%] gap-8 px-2 mr-2",children:[h.jsxs("div",{className:"h-full flex flex-col gap-2",children:[h.jsx("span",{className:"font-bold",children:`Hi, ${o.firstName}`}),h.jsx("button",{className:"p-2 border rounded-lg bg-emerald-500 p-2 font-bold ",onClick:()=>{sessionStorage.removeItem("token"),e(Xs({})),e(wC({}))},children:"log out"})]}),h.jsx("img",{src:o.profileImage,alt:"",className:"h-[100%] w-[28%] rounded-[50%] cursor-pointer",onClick:()=>{a("/patient/profile")}})]}):h.jsx("button",{type:"button",className:"h-[80%] ml-4 border rounded-[5%] bg-orange-500 p-2 font-bold ",id:"id_loginNav",onClick:()=>{a("/login")},children:"login / sign up"})]})})}hS.setAppElement("#root");function Bve(){const e=zf();lo(c=>c.user);const[t,r]=T.useState(!1),[n,i]=T.useState("jjjjjjjj"),o=Ln(),s=Yi({initialValues:{username:"",password:""},validationSchema:cce,onSubmit:async(c,l)=>{const d=await Ahe(c);if(d){if(await oe.fire({title:"Successfull",icon:"success",text:"you have been successfully logged in"}),await e(Xs({username:d.username,role:d.role,email:d.email,isLoggedIn:!0})),d.role=="2")return o("/pharmacy/home");if(d.role=="1")return o("/doctor");if(d.role=="3")return o("/laboratory");o("/")}}});T.useEffect(()=>{google.accounts.id.initialize({client_id:"981653324698-i9aagns1rnmvcudlrt3bmj87v802e737.apps.googleusercontent.com",callback:async l=>{const d=await Ohe({googleToken:l.credential});if(!d)await $ve(l);else{if(await oe.fire({title:"Successfull",icon:"success",text:"you have been successfully logged in"}),e(Xs({username:d.username,role:d.role,email:d.email})),d.role=="2")return o("/pharmacy/home");if(d.role=="3")return o("/laboratory/home");o("/")}}}),google.accounts.id.renderButton(document.getElementById("id_google"),{theme:"filled_blue",size:"large",width:350,type:"standard"})},[]);const a=async()=>{try{const{value:c}=await oe.fire({title:"forgot password",input:"email",showCancelButton:!0,inputLabel:"Enter email"});console.log(c),await i(c);const l=await Nhe({email:c});if(c&&l){const{value:d}=await oe.fire({title:"Enter Otp",input:"number",showCancelButton:!0,inputLabel:"Enter Otp"});d&&await khe({email:c,otp:d})&&await r(!0)}}catch(c){console.log(`error at handle forgot password ${c}`)}};return h.jsxs("div",{className:"homePage w-full h-full",children:[h.jsx("div",{className:"header w-full h-[12vh] shadow-lg bg-white",children:h.jsx(_P,{})}),h.jsxs("div",{className:"flex flex-row w-screen h-screen",children:[t&&h.jsx(Hve,{email:n,isOtpChecked:t,setisForgotPasswordChecked:r}),h.jsx("div",{className:"w-[40%] ",children:h.jsx("img",{src:"logo.png",alt:""})}),h.jsxs("div",{className:"w-[60%] mainContainer h-[90vh] mt-1  flex flex-col justify-start items-center text-emerald-300 gap-10 bg-sky-300 rounded-l-[5%]",children:[h.jsxs("form",{onSubmit:s.handleSubmit,className:"border w-[50%] rounded-[5%] p-20 flex flex-col gap-4 bg-white  border-emerald-300 shadow-lg shadow-emerald-500 mt-10",children:[h.jsx("div",{className:"flex justify-center",children:h.jsx("h1",{className:"text-4xl text-bold text-emerald-500 ",children:"LOGIN"})}),h.jsxs("div",{className:"flex flex-col gap-4 text-black",children:[h.jsx("input",{type:"text",name:"username",id:"id_username",onChange:s.handleChange,onBlur:s.handleBlur,className:"border p-2 rounded-lg text-center",placeholder:"email/username"}),h.jsx("p",{className:"text-red-500",children:s.touched.username&&s.errors.username&&s.errors.username}),h.jsx("input",{type:"password",name:"password",id:"id_password",onChange:s.handleChange,onBlur:s.handleBlur,className:"border p-2 rounded-lg text-center",placeholder:"password"}),h.jsx("p",{className:"text-red-500",children:s.touched.password&&s.errors.password&&s.errors.password})]}),h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsx("button",{id:"id_loginButton",className:"w-[full] h-[50%] border rounded-[5%] bg-orange-500 p-2",type:"submit",children:"login"}),h.jsxs("div",{className:"flex flex-row gap-10 h-[50%] justify-center",children:[h.jsx("h2",{className:"text-blue-400",children:"don't have account...?"}),h.jsx("button",{type:"button",onClick:()=>{o("/register")},children:"sign up"})]}),h.jsx("button",{type:"button",onClick:a,className:"w-[full] h-[50%] border rounded-[5%] bg-blue-500 p-2",children:"forgot password"})]})]}),h.jsx("div",{className:"",children:h.jsx("button",{id:"id_google"})})]})]})]})}const $ve=async e=>{const{value:t}=await oe.fire({input:"select",showCancelButton:!0,inputPlaceholder:"select role to proceed",title:"Role",inputOptions:{0:"patient",1:"doctor",2:"pharmacy",3:"laboratory"}});t&&await xhe({googleToken:e.credential,role:t})&&oe.fire({title:"Account Creation Successfull",icon:"success",text:"Account has been created"})};function Hve(e){const[t,r]=T.useState(!1),n=async()=>r(!1),i=Yi({initialValues:{password:"",confirmPassword:""},validationSchema:r9,onSubmit:async(o,s)=>{await Phe({password:o.password,email:e.email})&&oe.fire({icon:"success",html:"<b>Password has been reset</b>"}).then(async()=>{await n(),await e.setisForgotPasswordChecked(!1)})}});return T.useState(()=>{e.isOtpChecked&&r(!0),console.log("hiiiii")},[]),h.jsx("div",{className:"fixed w-screen h-screen",children:h.jsxs(hS,{isOpen:t,onRequestClose:n,overlayClassName:"fixed bg-black bg-opacity-50 inset-0 flex justify-center items-center",className:"bg-white opacity-100 mx-w-[60vw] flex flex-col gap-10 p-10 rounded-lg justify-center items-center",children:[h.jsx("h1",{className:"text-center font-bold",children:"Verification"}),h.jsxs("h3",{children:["Otp has been generated and sent to the email ",n9(e.email)]}),h.jsxs("form",{onSubmit:i.handleSubmit,className:"w-full flex flex-col gap-10 justify-center items-center",children:[h.jsxs("div",{className:"flex flex-col gap-10 w-full",children:[h.jsx(Je,{name:"password",type:"password",variant:"filled",label:"Enter the password",onChange:i.handleChange,onBlur:i.handleBlur,className:"w-[40vw]",...i.touched.password&&(i.errors.password?{color:"error",helperText:`${i.errors.password}`}:{color:"success"})}),h.jsx(Je,{name:"confirmPassword",type:"password",variant:"filled",label:"Enter the confirm password",onChange:i.handleChange,onBlur:i.handleBlur,className:"w-[40vw]",...i.touched.confirmPassword&&(i.errors.confirmPassword?{color:"error",helperText:`${i.errors.confirmPassword}`}:{color:"success"})})]}),h.jsx("button",{type:"submit",className:"w-full border rounded-[5%] bg-orange-500 p-2",children:"Submit"})]})]})})}const Wve=fo().shape({username:kt().required("Username is Required"),email:kt().email("Provide valid email").required("Email is reuired"),password:kt().required("Password is required").min(8,"must contain atleast 8 characters").matches(/[A-Z]/,"Password must contain at least one uppercase letter").matches(/[a-z]/,"Password must contain at least one lowercase letter").matches(/[0-9]/,"Password must contain at least one number").matches(/[@$!%*?&#]/,"Password must contain at least one special character"),confirmPassword:kt().required("confirm password is required").oneOf([rW("password"),null],"Password and Confirm password are not matching"),phone:kt().matches(/^[1-9][0-9]{9}$/,"Must be a valid number").required("Phone number is required"),role:kt().required("Required")}),Cy="http://localhost:5000/api";async function Gve({otp:e,email:t}){try{const r=await Ce.post(`${Cy}/user/register/createPatient`,{otp:e,email:t},{withCredentials:!0});return console.log(r.data),r.data.CreationStatus}catch(r){r.response.status=="404"&&oe.fire("Otp has been expired"),console.log(r)}}async function zve({otp:e,email:t}){try{const r=await Ce.post(`${Cy}/user/register/createDoctor`,{otp:e,email:t},{withCredentials:!0});return console.log(r.data),r.data.CreationStatus}catch(r){r.response.status=="404"&&oe.fire("Otp has been expired"),console.log(r)}}async function Kve({otp:e,email:t}){try{const r=await Ce.post(`${Cy}/user/register/createPharmacy`,{otp:e,email:t},{withCredentials:!0});return console.log(r.data),r.data.CreationStatus}catch(r){r.response.status=="404"&&oe.fire("Otp has been expired"),console.log(r)}}async function qve({otp:e,email:t}){try{console.log("entered Laboratory");const r=await Ce.post(`${Cy}/user/register/createLaboratory`,{otp:e,email:t},{withCredentials:!0});return await console.log(r.data),r.data.CreationStatus}catch(r){r.response.status=="404"&&oe.fire("Otp has been expired"),console.log(r)}}async function Yve(e){try{const t=await Ce.post(`${Cy}/user/register/otp`,e,{withCredentials:!0});return console.log(t.data),t.data.info}catch(t){t.response.status=="401"?oe.fire("User Already exist"):t.response.status=="404"?oe.fire({icon:"error",title:"Mail couldn't be send",text:"Some error occured while sending otp to mail"}):oe.fire({icon:"error",title:"Server Issue",text:"Some error Occurered in the server side , please try again..!"})}}const Xve=fo().shape({email:kt().required("email required"),otp:kt().matches(/^[0-9]{6}$/,"Must be valid").required("Otp required")});hS.setAppElement("#root");function Jve(){const[e,t]=T.useState(!1),[r,n]=T.useState(!1),i=Yi({initialValues:{username:"",email:"",password:"",confirmPassword:"",phone:"",role:""},validationSchema:Wve,onSubmit:async(o,s)=>{await Yve(o)&&await t(!0)}});return T.useEffect(()=>{r&&((async()=>await i.reset)(),n(!1))},[r]),h.jsxs("div",{className:"homePage w-full h-full",children:[h.jsx("div",{className:"header w-full h-[12vh] shadow-lg",children:h.jsx(_P,{})}),h.jsx("div",{className:"page flex w-screen h-screen",children:h.jsxs("div",{className:"flex flex-row w-screen gap-[30vh] m-10",children:[e&&h.jsx(Qve,{isOtpGenerated:!0,setisOtpGenerated:t,email:i.values.email,role:i.values.role,setIsCreated:n}),h.jsx("div",{className:"w-[40%] ",children:h.jsx("img",{src:"logo.png",alt:""})}),h.jsxs("form",{onSubmit:i.handleSubmit,className:"registerDiv w-[40%] h-auto flex flex-col gap-[3vh] p-10 border rounded-lg text-emerald-300 shadow-lg shadow-emerald-500 ",children:[h.jsx("div",{className:"flex items-center  justify-center",children:h.jsx("h2",{className:"text-4xl  text-emerald-500 ",children:"Sign Up"})}),h.jsxs("div",{className:"flex flex-row gap-4",children:[h.jsxs("select",{name:"role",onChange:i.handleChange,onBlur:i.handleBlur,id:"id_role",className:"font-bold text-black rounded-lg",children:[h.jsx("option",{className:"",children:"Select a role"}),h.jsx("option",{value:"0",children:"Patient"}),h.jsx("option",{value:"1",children:"Doctor"}),h.jsx("option",{value:"2",children:"Pharmacy"}),h.jsx("option",{value:"3",children:"Laboratory"}),h.jsx("option",{value:"4",children:"Admin"})]}),h.jsx("span",{className:"text-red-500",children:i.touched.role&&i.errors.role&&`* ${i.errors.role}`})]}),h.jsxs("div",{className:"inputSec flex flex-col gap-5",children:[h.jsx(Je,{name:"username",onChange:i.handleChange,variant:"filled",label:"username",onBlur:i.handleBlur,...i.touched.username&&(i.errors.username?{color:"error",helperText:`${i.errors.username}`}:{color:"success"})}),h.jsx(Je,{name:"email",onChange:i.handleChange,variant:"filled",label:"email",onBlur:i.handleBlur,...i.touched.email&&(i.errors.email?{color:"error",helperText:`${i.errors.email}`}:{color:"success"})}),h.jsx(Je,{name:"password",type:"password",onChange:i.handleChange,variant:"filled",label:"Password",onBlur:i.handleBlur,...i.touched.password&&(i.errors.password?{color:"error",helperText:`${i.errors.password}`}:{color:"success"})}),h.jsx(Je,{name:"confirmPassword",type:"password",variant:"filled",onChange:i.handleChange,label:"Confirm Password",onBlur:i.handleBlur,...i.touched.confirmPassword&&(i.errors.confirmPassword?{color:"error",helperText:`${i.errors.confirmPassword}`}:{color:"success"})}),h.jsx(Je,{name:"phone",variant:"filled",onChange:i.handleChange,label:"phone",onBlur:i.handleBlur,...i.touched.phone&&(i.errors.phone?{color:"error",helperText:`${i.errors.phone}`}:{color:"success"})})]}),h.jsx("button",{type:"submit",className:"w-[full] border rounded-[5%] bg-orange-500 p-2 ",children:"sign up"})]})]})})]})}function Qve(e){const[t,r]=T.useState(!1),n=Ln(),i=()=>{r(!1),e.setisOtpGenerated(!1)},o=Yi({initialValues:{email:e.email,otp:""},validationSchema:Xve,onSubmit:async(s,a)=>{var c;e.role=="0"?c=await Gve(s):e.role=="1"?c=await zve(s):e.role=="2"?c=await Kve(s):e.role=="3"&&(c=await qve(s)),c&&(i(),oe.fire({title:"Registeration Successfull",text:"You have successfully Registered",icon:"success"}).then(()=>{n("/login")}))}});return T.useEffect(()=>{e.isOtpGenerated&&r(!0)},[]),h.jsx("div",{className:"fixed w-screen h-screen",children:h.jsxs(hS,{isOpen:t,onRequestClose:i,overlayClassName:"fixed bg-black bg-opacity-50 inset-0 flex justify-center items-center",className:"bg-white opacity-100 mx-w-[60vw] flex flex-col gap-10 p-10 rounded-lg justify-center items-center ",children:[h.jsx("h1",{className:"text-center font-bold",children:"Verification"}),h.jsxs("h3",{children:["Otp has been generated and sent to the email ",n9(e.email)]}),h.jsxs("form",{onSubmit:o.handleSubmit,className:"w-full flex flex-col gap-10 justify-center items-center",children:[h.jsx("div",{className:"flex flex-row gap-10 w-full",children:h.jsx(Je,{name:"otp",variant:"filled",label:"Enter Otp",onChange:o.handleChange,onBlur:o.handleBlur,className:"w-[40vw]",...o.touched.otp&&(o.errors.otp?{color:"error",helperText:`${o.errors.otp}`}:{color:"success"})})}),h.jsx("button",{type:"submit",className:"w-full border rounded-[5%] bg-orange-500 p-2",children:"Submit"})]})]})})}var tq={exports:{}},SC={exports:{}},Tr={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var TC,Vj;function Zve(){if(Vj)return TC;Vj=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function n(o){if(o==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(o)}function i(){try{if(!Object.assign)return!1;var o=new String("abc");if(o[5]="de",Object.getOwnPropertyNames(o)[0]==="5")return!1;for(var s={},a=0;a<10;a++)s["_"+String.fromCharCode(a)]=a;var c=Object.getOwnPropertyNames(s).map(function(d){return s[d]});if(c.join("")!=="0123456789")return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(d){l[d]=d}),Object.keys(Object.assign({},l)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return TC=i()?Object.assign:function(o,s){for(var a,c=n(o),l,d=1;d<arguments.length;d++){a=Object(arguments[d]);for(var u in a)t.call(a,u)&&(c[u]=a[u]);if(e){l=e(a);for(var p=0;p<l.length;p++)r.call(a,l[p])&&(c[l[p]]=a[l[p]])}}return c},TC}/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bj;function eEe(){if(Bj)return Tr;Bj=1;var e=Zve(),t=typeof Symbol=="function"&&Symbol.for,r=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,i=t?Symbol.for("react.fragment"):60107,o=t?Symbol.for("react.strict_mode"):60108,s=t?Symbol.for("react.profiler"):60114,a=t?Symbol.for("react.provider"):60109,c=t?Symbol.for("react.context"):60110,l=t?Symbol.for("react.forward_ref"):60112,d=t?Symbol.for("react.suspense"):60113,u=t?Symbol.for("react.memo"):60115,p=t?Symbol.for("react.lazy"):60116,f=typeof Symbol=="function"&&Symbol.iterator;function m(U){for(var q="https://reactjs.org/docs/error-decoder.html?invariant="+U,ie=1;ie<arguments.length;ie++)q+="&args[]="+encodeURIComponent(arguments[ie]);return"Minified React error #"+U+"; visit "+q+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y={};function v(U,q,ie){this.props=U,this.context=q,this.refs=y,this.updater=ie||g}v.prototype.isReactComponent={},v.prototype.setState=function(U,q){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error(m(85));this.updater.enqueueSetState(this,U,q,"setState")},v.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function E(){}E.prototype=v.prototype;function w(U,q,ie){this.props=U,this.context=q,this.refs=y,this.updater=ie||g}var S=w.prototype=new E;S.constructor=w,e(S,v.prototype),S.isPureReactComponent=!0;var A={current:null},N=Object.prototype.hasOwnProperty,L={key:!0,ref:!0,__self:!0,__source:!0};function j(U,q,ie){var ue,me={},De=null,He=null;if(q!=null)for(ue in q.ref!==void 0&&(He=q.ref),q.key!==void 0&&(De=""+q.key),q)N.call(q,ue)&&!L.hasOwnProperty(ue)&&(me[ue]=q[ue]);var Pe=arguments.length-2;if(Pe===1)me.children=ie;else if(1<Pe){for(var nt=Array(Pe),Rt=0;Rt<Pe;Rt++)nt[Rt]=arguments[Rt+2];me.children=nt}if(U&&U.defaultProps)for(ue in Pe=U.defaultProps,Pe)me[ue]===void 0&&(me[ue]=Pe[ue]);return{$$typeof:r,type:U,key:De,ref:He,props:me,_owner:A.current}}function W(U,q){return{$$typeof:r,type:U.type,key:q,ref:U.ref,props:U.props,_owner:U._owner}}function V(U){return typeof U=="object"&&U!==null&&U.$$typeof===r}function Y(U){var q={"=":"=0",":":"=2"};return"$"+(""+U).replace(/[=:]/g,function(ie){return q[ie]})}var Z=/\/+/g,te=[];function H(U,q,ie,ue){if(te.length){var me=te.pop();return me.result=U,me.keyPrefix=q,me.func=ie,me.context=ue,me.count=0,me}return{result:U,keyPrefix:q,func:ie,context:ue,count:0}}function $(U){U.result=null,U.keyPrefix=null,U.func=null,U.context=null,U.count=0,10>te.length&&te.push(U)}function K(U,q,ie,ue){var me=typeof U;(me==="undefined"||me==="boolean")&&(U=null);var De=!1;if(U===null)De=!0;else switch(me){case"string":case"number":De=!0;break;case"object":switch(U.$$typeof){case r:case n:De=!0}}if(De)return ie(ue,U,q===""?"."+O(U,0):q),1;if(De=0,q=q===""?".":q+":",Array.isArray(U))for(var He=0;He<U.length;He++){me=U[He];var Pe=q+O(me,He);De+=K(me,Pe,ie,ue)}else if(U===null||typeof U!="object"?Pe=null:(Pe=f&&U[f]||U["@@iterator"],Pe=typeof Pe=="function"?Pe:null),typeof Pe=="function")for(U=Pe.call(U),He=0;!(me=U.next()).done;)me=me.value,Pe=q+O(me,He++),De+=K(me,Pe,ie,ue);else if(me==="object")throw ie=""+U,Error(m(31,ie==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":ie,""));return De}function x(U,q,ie){return U==null?0:K(U,"",q,ie)}function O(U,q){return typeof U=="object"&&U!==null&&U.key!=null?Y(U.key):q.toString(36)}function F(U,q){U.func.call(U.context,q,U.count++)}function P(U,q,ie){var ue=U.result,me=U.keyPrefix;U=U.func.call(U.context,q,U.count++),Array.isArray(U)?_(U,ue,ie,function(De){return De}):U!=null&&(V(U)&&(U=W(U,me+(!U.key||q&&q.key===U.key?"":(""+U.key).replace(Z,"$&/")+"/")+ie)),ue.push(U))}function _(U,q,ie,ue,me){var De="";ie!=null&&(De=(""+ie).replace(Z,"$&/")+"/"),q=H(q,De,ue,me),x(U,P,q),$(q)}var R={current:null};function k(){var U=R.current;if(U===null)throw Error(m(321));return U}var z={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:A,IsSomeRendererActing:{current:!1},assign:e};return Tr.Children={map:function(U,q,ie){if(U==null)return U;var ue=[];return _(U,ue,null,q,ie),ue},forEach:function(U,q,ie){if(U==null)return U;q=H(null,null,q,ie),x(U,F,q),$(q)},count:function(U){return x(U,function(){return null},null)},toArray:function(U){var q=[];return _(U,q,null,function(ie){return ie}),q},only:function(U){if(!V(U))throw Error(m(143));return U}},Tr.Component=v,Tr.Fragment=i,Tr.Profiler=s,Tr.PureComponent=w,Tr.StrictMode=o,Tr.Suspense=d,Tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,Tr.cloneElement=function(U,q,ie){if(U==null)throw Error(m(267,U));var ue=e({},U.props),me=U.key,De=U.ref,He=U._owner;if(q!=null){if(q.ref!==void 0&&(De=q.ref,He=A.current),q.key!==void 0&&(me=""+q.key),U.type&&U.type.defaultProps)var Pe=U.type.defaultProps;for(nt in q)N.call(q,nt)&&!L.hasOwnProperty(nt)&&(ue[nt]=q[nt]===void 0&&Pe!==void 0?Pe[nt]:q[nt])}var nt=arguments.length-2;if(nt===1)ue.children=ie;else if(1<nt){Pe=Array(nt);for(var Rt=0;Rt<nt;Rt++)Pe[Rt]=arguments[Rt+2];ue.children=Pe}return{$$typeof:r,type:U.type,key:me,ref:De,props:ue,_owner:He}},Tr.createContext=function(U,q){return q===void 0&&(q=null),U={$$typeof:c,_calculateChangedBits:q,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider={$$typeof:a,_context:U},U.Consumer=U},Tr.createElement=j,Tr.createFactory=function(U){var q=j.bind(null,U);return q.type=U,q},Tr.createRef=function(){return{current:null}},Tr.forwardRef=function(U){return{$$typeof:l,render:U}},Tr.isValidElement=V,Tr.lazy=function(U){return{$$typeof:p,_ctor:U,_status:-1,_result:null}},Tr.memo=function(U,q){return{$$typeof:u,type:U,compare:q===void 0?null:q}},Tr.useCallback=function(U,q){return k().useCallback(U,q)},Tr.useContext=function(U,q){return k().useContext(U,q)},Tr.useDebugValue=function(){},Tr.useEffect=function(U,q){return k().useEffect(U,q)},Tr.useImperativeHandle=function(U,q,ie){return k().useImperativeHandle(U,q,ie)},Tr.useLayoutEffect=function(U,q){return k().useLayoutEffect(U,q)},Tr.useMemo=function(U,q){return k().useMemo(U,q)},Tr.useReducer=function(U,q,ie){return k().useReducer(U,q,ie)},Tr.useRef=function(U){return k().useRef(U)},Tr.useState=function(U){return k().useState(U)},Tr.version="16.14.0",Tr}var $j;function tEe(){return $j||($j=1,SC.exports=eEe()),SC.exports}var rq={exports:{}};(function(e,t){(function(r){e.exports=r(null)})(function r(n){var i=/^\0+/g,o=/[\0\r\f]/g,s=/: */g,a=/zoo|gra/,c=/([,: ])(transform)/g,l=/,+\s*(?![^(]*[)])/g,d=/ +\s*(?![^(]*[)])/g,u=/ *[\0] */g,p=/,\r+?/g,f=/([\t\r\n ])*\f?&/g,m=/:global\(((?:[^\(\)\[\]]*|\[.*\]|\([^\(\)]*\))*)\)/g,g=/\W+/g,y=/@(k\w+)\s*(\S*)\s*/,v=/::(place)/g,E=/:(read-only)/g,w=/\s+(?=[{\];=:>])/g,S=/([[}=:>])\s+/g,A=/(\{[^{]+?);(?=\})/g,N=/\s{2,}/g,L=/([^\(])(:+) */g,j=/[svh]\w+-[tblr]{2}/,W=/\(\s*(.*)\s*\)/g,V=/([\s\S]*?);/g,Y=/-self|flex-/g,Z=/[^]*?(:[rp][el]a[\w-]+)[^]*/,te=/stretch|:\s*\w+\-(?:conte|avail)/,H=/([^-])(image-set\()/,$="-webkit-",K="-moz-",x="-ms-",O=59,F=125,P=123,_=40,R=41,k=91,z=93,U=10,q=13,ie=9,ue=64,me=32,De=38,He=45,Pe=95,nt=42,Rt=44,Ye=58,_t=39,Te=34,Ze=47,Ve=62,Ke=43,Ge=126,ee=0,Ae=12,Le=11,We=107,dt=109,Gt=115,$r=112,fn=111,$o=105,Va=99,Ji=100,Ac=112,Ci=1,ws=1,Ba=0,Ss=1,Ho=1,mm=1,Ky=0,xc=0,Wd=0,Sh=[],gm=[],Ts=0,Th=null,hT=-2,qy=-1,pT=0,Yy=1,Xy=2,fT=3,ym=0,_l=1,Ch="",ca="",Gd="";function Rh(It,st,rt,jt,Be){for(var mr,ce,er=0,Xt=0,cn=0,zt=0,Rn=0,Ur=0,tr=0,ei=0,Mi=0,$a=0,ji=0,Wo=0,zd=0,Cs=0,ir=0,qn=0,Oc=0,Sl=0,Or=0,bt=rt.length,Hr=bt-1,Yn="",Pt="",M="",B="",Q="",Se="";ir<bt;){if(tr=rt.charCodeAt(ir),ir===Hr&&Xt+zt+cn+er!==0&&(Xt!==0&&(tr=Xt===Ze?U:Ze),zt=cn=er=0,bt++,Hr++),Xt+zt+cn+er===0){if(ir===Hr&&(qn>0&&(Pt=Pt.replace(o,"")),Pt.trim().length>0)){switch(tr){case me:case ie:case O:case q:case U:break;default:Pt+=rt.charAt(ir)}tr=O}if(Oc===1)switch(tr){case P:case F:case O:case Te:case _t:case _:case R:case Rt:Oc=0;case ie:case q:case U:case me:break;default:for(Oc=0,Or=ir,Rn=tr,ir--,tr=O;Or<bt;)switch(rt.charCodeAt(Or++)){case U:case q:case O:++ir,tr=Rn,Or=bt;break;case Ye:qn>0&&(++ir,tr=Rn);case P:Or=bt}}switch(tr){case P:for(Rn=(Pt=Pt.trim()).charCodeAt(0),ji=1,Or=++ir;ir<bt;){switch(tr=rt.charCodeAt(ir)){case P:ji++;break;case F:ji--;break;case Ze:switch(Ur=rt.charCodeAt(ir+1)){case nt:case Ze:ir=Zy(Ur,ir,Hr,rt)}break;case k:tr++;case _:tr++;case Te:case _t:for(;ir++<Hr&&rt.charCodeAt(ir)!==tr;);}if(ji===0)break;ir++}switch(M=rt.substring(Or,ir),Rn===ee&&(Rn=(Pt=Pt.replace(i,"").trim()).charCodeAt(0)),Rn){case ue:switch(qn>0&&(Pt=Pt.replace(o,"")),Ur=Pt.charCodeAt(1)){case Ji:case dt:case Gt:case He:mr=st;break;default:mr=Sh}if(Or=(M=Rh(st,mr,M,Ur,Be+1)).length,Wd>0&&Or===0&&(Or=Pt.length),Ts>0&&(mr=vm(Sh,Pt,Sl),ce=bl(fT,M,mr,st,ws,Ci,Or,Ur,Be,jt),Pt=mr.join(""),ce!==void 0&&(Or=(M=ce.trim()).length)===0&&(Ur=0,M="")),Or>0)switch(Ur){case Gt:Pt=Pt.replace(W,Qy);case Ji:case dt:case He:M=Pt+"{"+M+"}";break;case We:M=(Pt=Pt.replace(y,"$1 $2"+(_l>0?Ch:"")))+"{"+M+"}",Ho===1||Ho===2&&Ah("@"+M,3)?M="@"+$+M+"@"+M:M="@"+M;break;default:M=Pt+M,jt===Ac&&(B+=M,M="")}else M="";break;default:M=Rh(st,vm(st,Pt,Sl),M,jt,Be+1)}Q+=M,Wo=0,Oc=0,Cs=0,qn=0,Sl=0,zd=0,Pt="",M="",tr=rt.charCodeAt(++ir);break;case F:case O:if((Or=(Pt=(qn>0?Pt.replace(o,""):Pt).trim()).length)>1)switch(Cs===0&&((Rn=Pt.charCodeAt(0))===He||Rn>96&&Rn<123)&&(Or=(Pt=Pt.replace(" ",":")).length),Ts>0&&(ce=bl(Yy,Pt,st,It,ws,Ci,B.length,jt,Be,jt))!==void 0&&(Or=(Pt=ce.trim()).length)===0&&(Pt="\0\0"),Rn=Pt.charCodeAt(0),Ur=Pt.charCodeAt(1),Rn){case ee:break;case ue:if(Ur===$o||Ur===Va){Se+=Pt+rt.charAt(ir);break}default:if(Pt.charCodeAt(Or-1)===Ye)break;B+=Ih(Pt,Rn,Ur,Pt.charCodeAt(2))}Wo=0,Oc=0,Cs=0,qn=0,Sl=0,Pt="",tr=rt.charCodeAt(++ir)}}switch(tr){case q:case U:if(Xt+zt+cn+er+xc===0)switch($a){case R:case _t:case Te:case ue:case Ge:case Ve:case nt:case Ke:case Ze:case He:case Ye:case Rt:case O:case P:case F:break;default:Cs>0&&(Oc=1)}Xt===Ze?Xt=0:Ss+Wo===0&&jt!==We&&Pt.length>0&&(qn=1,Pt+="\0"),Ts*ym>0&&bl(pT,Pt,st,It,ws,Ci,B.length,jt,Be,jt),Ci=1,ws++;break;case O:case F:if(Xt+zt+cn+er===0){Ci++;break}default:switch(Ci++,Yn=rt.charAt(ir),tr){case ie:case me:if(zt+er+Xt===0)switch(ei){case Rt:case Ye:case ie:case me:Yn="";break;default:tr!==me&&(Yn=" ")}break;case ee:Yn="\\0";break;case Ae:Yn="\\f";break;case Le:Yn="\\v";break;case De:zt+Xt+er===0&&Ss>0&&(Sl=1,qn=1,Yn="\f"+Yn);break;case 108:if(zt+Xt+er+Ba===0&&Cs>0)switch(ir-Cs){case 2:ei===$r&&rt.charCodeAt(ir-3)===Ye&&(Ba=ei);case 8:Mi===fn&&(Ba=Mi)}break;case Ye:zt+Xt+er===0&&(Cs=ir);break;case Rt:Xt+cn+zt+er===0&&(qn=1,Yn+="\r");break;case Te:case _t:Xt===0&&(zt=zt===tr?0:zt===0?tr:zt);break;case k:zt+Xt+cn===0&&er++;break;case z:zt+Xt+cn===0&&er--;break;case R:zt+Xt+er===0&&cn--;break;case _:if(zt+Xt+er===0){if(Wo===0)switch(2*ei+3*Mi){case 533:break;default:ji=0,Wo=1}cn++}break;case ue:Xt+cn+zt+er+Cs+zd===0&&(zd=1);break;case nt:case Ze:if(zt+er+cn>0)break;switch(Xt){case 0:switch(2*tr+3*rt.charCodeAt(ir+1)){case 235:Xt=Ze;break;case 220:Or=ir,Xt=nt}break;case nt:tr===Ze&&ei===nt&&Or+2!==ir&&(rt.charCodeAt(Or+2)===33&&(B+=rt.substring(Or,ir+1)),Yn="",Xt=0)}}if(Xt===0){if(Ss+zt+er+zd===0&&jt!==We&&tr!==O)switch(tr){case Rt:case Ge:case Ve:case Ke:case R:case _:if(Wo===0){switch(ei){case ie:case me:case U:case q:Yn+="\0";break;default:Yn="\0"+Yn+(tr===Rt?"":"\0")}qn=1}else switch(tr){case _:Cs+7===ir&&ei===108&&(Cs=0),Wo=++ji;break;case R:(Wo=--ji)==0&&(qn=1,Yn+="\0")}break;case ie:case me:switch(ei){case ee:case P:case F:case O:case Rt:case Ae:case ie:case me:case U:case q:break;default:Wo===0&&(qn=1,Yn+="\0")}}Pt+=Yn,tr!==me&&tr!==ie&&($a=tr)}}Mi=ei,ei=tr,ir++}if(Or=B.length,Wd>0&&Or===0&&Q.length===0&&st[0].length!==0&&(jt!==dt||st.length===1&&(Ss>0?ca:Gd)===st[0])&&(Or=st.join(",").length+2),Or>0){if(mr=Ss===0&&jt!==We?function($e){for(var ye,re,Xe=0,At=$e.length,be=Array(At);Xe<At;++Xe){for(var ke=$e[Xe].split(u),Ue="",ze=0,lt=0,Tt=0,vt=0,mn=ke.length;ze<mn;++ze)if(!((lt=(re=ke[ze]).length)===0&&mn>1)){if(Tt=Ue.charCodeAt(Ue.length-1),vt=re.charCodeAt(0),ye="",ze!==0)switch(Tt){case nt:case Ge:case Ve:case Ke:case me:case _:break;default:ye=" "}switch(vt){case De:re=ye+ca;case Ge:case Ve:case Ke:case me:case R:case _:break;case k:re=ye+re+ca;break;case Ye:switch(2*re.charCodeAt(1)+3*re.charCodeAt(2)){case 530:if(mm>0){re=ye+re.substring(8,lt-1);break}default:(ze<1||ke[ze-1].length<1)&&(re=ye+ca+re)}break;case Rt:ye="";default:lt>1&&re.indexOf(":")>0?re=ye+re.replace(L,"$1"+ca+"$2"):re=ye+re+ca}Ue+=re}be[Xe]=Ue.replace(o,"").trim()}return be}(st):st,Ts>0&&(ce=bl(Xy,B,mr,It,ws,Ci,Or,jt,Be,jt))!==void 0&&(B=ce).length===0)return Se+B+Q;if(B=mr.join(",")+"{"+B+"}",Ho*Ba!=0){switch(Ho===2&&!Ah(B,2)&&(Ba=0),Ba){case fn:B=B.replace(E,":"+K+"$1")+B;break;case $r:B=B.replace(v,"::"+$+"input-$1")+B.replace(v,"::"+K+"$1")+B.replace(v,":"+x+"input-$1")+B}Ba=0}}return Se+B+Q}function vm(It,st,rt){var jt=st.trim().split(p),Be=jt,mr=jt.length,ce=It.length;switch(ce){case 0:case 1:for(var er=0,Xt=ce===0?"":It[0]+" ";er<mr;++er)Be[er]=Jy(Xt,Be[er],rt,ce).trim();break;default:er=0;var cn=0;for(Be=[];er<mr;++er)for(var zt=0;zt<ce;++zt)Be[cn++]=Jy(It[zt]+" ",jt[er],rt,ce).trim()}return Be}function Jy(It,st,rt,jt){var Be=st,mr=Be.charCodeAt(0);switch(mr<33&&(mr=(Be=Be.trim()).charCodeAt(0)),mr){case De:switch(Ss+jt){case 0:case 1:if(It.trim().length===0)break;default:return Be.replace(f,"$1"+It.trim())}break;case Ye:switch(Be.charCodeAt(1)){case 103:if(mm>0&&Ss>0)return Be.replace(m,"$1").replace(f,"$1"+Gd);break;default:return It.trim()+Be.replace(f,"$1"+It.trim())}default:if(rt*Ss>0&&Be.indexOf("\f")>0)return Be.replace(f,(It.charCodeAt(0)===Ye?"":"$1")+It.trim())}return It+Be}function Ih(It,st,rt,jt){var Be,mr=0,ce=It+";",er=2*st+3*rt+4*jt;if(er===944)return function(Xt){var cn=Xt.length,zt=Xt.indexOf(":",9)+1,Rn=Xt.substring(0,zt).trim(),Ur=Xt.substring(zt,cn-1).trim();switch(Xt.charCodeAt(9)*_l){case 0:break;case He:if(Xt.charCodeAt(10)!==110)break;default:for(var tr=Ur.split((Ur="",l)),ei=0,zt=0,cn=tr.length;ei<cn;zt=0,++ei){for(var Mi=tr[ei],$a=Mi.split(d);Mi=$a[zt];){var ji=Mi.charCodeAt(0);if(_l===1&&(ji>ue&&ji<90||ji>96&&ji<123||ji===Pe||ji===He&&Mi.charCodeAt(1)!==He))switch(isNaN(parseFloat(Mi))+(Mi.indexOf("(")!==-1)){case 1:switch(Mi){case"infinite":case"alternate":case"backwards":case"running":case"normal":case"forwards":case"both":case"none":case"linear":case"ease":case"ease-in":case"ease-out":case"ease-in-out":case"paused":case"reverse":case"alternate-reverse":case"inherit":case"initial":case"unset":case"step-start":case"step-end":break;default:Mi+=Ch}}$a[zt++]=Mi}Ur+=(ei===0?"":",")+$a.join(" ")}}return Ur=Rn+Ur+";",Ho===1||Ho===2&&Ah(Ur,1)?$+Ur+Ur:Ur}(ce);if(Ho===0||Ho===2&&!Ah(ce,1))return ce;switch(er){case 1015:return ce.charCodeAt(10)===97?$+ce+ce:ce;case 951:return ce.charCodeAt(3)===116?$+ce+ce:ce;case 963:return ce.charCodeAt(5)===110?$+ce+ce:ce;case 1009:if(ce.charCodeAt(4)!==100)break;case 969:case 942:return $+ce+ce;case 978:return $+ce+K+ce+ce;case 1019:case 983:return $+ce+K+ce+x+ce+ce;case 883:return ce.charCodeAt(8)===He?$+ce+ce:ce.indexOf("image-set(",11)>0?ce.replace(H,"$1"+$+"$2")+ce:ce;case 932:if(ce.charCodeAt(4)===He)switch(ce.charCodeAt(5)){case 103:return $+"box-"+ce.replace("-grow","")+$+ce+x+ce.replace("grow","positive")+ce;case 115:return $+ce+x+ce.replace("shrink","negative")+ce;case 98:return $+ce+x+ce.replace("basis","preferred-size")+ce}return $+ce+x+ce+ce;case 964:return $+ce+x+"flex-"+ce+ce;case 1023:if(ce.charCodeAt(8)!==99)break;return Be=ce.substring(ce.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),$+"box-pack"+Be+$+ce+x+"flex-pack"+Be+ce;case 1005:return a.test(ce)?ce.replace(s,":"+$)+ce.replace(s,":"+K)+ce:ce;case 1e3:switch(mr=(Be=ce.substring(13).trim()).indexOf("-")+1,Be.charCodeAt(0)+Be.charCodeAt(mr)){case 226:Be=ce.replace(j,"tb");break;case 232:Be=ce.replace(j,"tb-rl");break;case 220:Be=ce.replace(j,"lr");break;default:return ce}return $+ce+x+Be+ce;case 1017:if(ce.indexOf("sticky",9)===-1)return ce;case 975:switch(mr=(ce=It).length-10,er=(Be=(ce.charCodeAt(mr)===33?ce.substring(0,mr):ce).substring(It.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|Be.charCodeAt(7))){case 203:if(Be.charCodeAt(8)<111)break;case 115:ce=ce.replace(Be,$+Be)+";"+ce;break;case 207:case 102:ce=ce.replace(Be,$+(er>102?"inline-":"")+"box")+";"+ce.replace(Be,$+Be)+";"+ce.replace(Be,x+Be+"box")+";"+ce}return ce+";";case 938:if(ce.charCodeAt(5)===He)switch(ce.charCodeAt(6)){case 105:return Be=ce.replace("-items",""),$+ce+$+"box-"+Be+x+"flex-"+Be+ce;case 115:return $+ce+x+"flex-item-"+ce.replace(Y,"")+ce;default:return $+ce+x+"flex-line-pack"+ce.replace("align-content","").replace(Y,"")+ce}break;case 973:case 989:if(ce.charCodeAt(3)!==He||ce.charCodeAt(4)===122)break;case 931:case 953:if(te.test(It)===!0)return(Be=It.substring(It.indexOf(":")+1)).charCodeAt(0)===115?Ih(It.replace("stretch","fill-available"),st,rt,jt).replace(":fill-available",":stretch"):ce.replace(Be,$+Be)+ce.replace(Be,K+Be.replace("fill-",""))+ce;break;case 962:if(ce=$+ce+(ce.charCodeAt(5)===102?x+ce:"")+ce,rt+jt===211&&ce.charCodeAt(13)===105&&ce.indexOf("transform",10)>0)return ce.substring(0,ce.indexOf(";",27)+1).replace(c,"$1"+$+"$2")+ce}return ce}function Ah(It,st){var rt=It.indexOf(st===1?":":"{"),jt=It.substring(0,st!==3?rt:10),Be=It.substring(rt+1,It.length-1);return Th(st!==2?jt:jt.replace(Z,"$1"),Be,st)}function Qy(It,st){var rt=Ih(st,st.charCodeAt(0),st.charCodeAt(1),st.charCodeAt(2));return rt!==st+";"?rt.replace(V," or ($1)").substring(4):"("+st+")"}function bl(It,st,rt,jt,Be,mr,ce,er,Xt,cn){for(var zt,Rn=0,Ur=st;Rn<Ts;++Rn)switch(zt=gm[Rn].call(wl,It,Ur,rt,jt,Be,mr,ce,er,Xt,cn)){case void 0:case!1:case!0:case null:break;default:Ur=zt}if(Ur!==st)return Ur}function Zy(It,st,rt,jt){for(var Be=st+1;Be<rt;++Be)switch(jt.charCodeAt(Be)){case Ze:if(It===nt&&jt.charCodeAt(Be-1)===nt&&st+2!==Be)return Be+1;break;case U:if(It===Ze)return Be+1}return Be}function xh(It){for(var st in It){var rt=It[st];switch(st){case"keyframe":_l=0|rt;break;case"global":mm=0|rt;break;case"cascade":Ss=0|rt;break;case"compress":Ky=0|rt;break;case"semicolon":xc=0|rt;break;case"preserve":Wd=0|rt;break;case"prefix":Th=null,rt?typeof rt!="function"?Ho=1:(Ho=2,Th=rt):Ho=0}}return xh}function wl(It,st){if(this!==void 0&&this.constructor===wl)return r(It);var rt=It,jt=rt.charCodeAt(0);jt<33&&(jt=(rt=rt.trim()).charCodeAt(0)),_l>0&&(Ch=rt.replace(g,jt===k?"":"-")),jt=1,Ss===1?Gd=rt:ca=rt;var Be,mr=[Gd];Ts>0&&(Be=bl(qy,st,mr,mr,ws,Ci,0,0,0,0))!==void 0&&typeof Be=="string"&&(st=Be);var ce=Rh(Sh,mr,st,0,0);return Ts>0&&(Be=bl(hT,ce,mr,mr,ws,Ci,ce.length,0,0,0))!==void 0&&typeof(ce=Be)!="string"&&(jt=0),Ch="",Gd="",ca="",Ba=0,ws=1,Ci=1,Ky*jt==0?ce:ce.replace(o,"").replace(w,"").replace(S,"$1").replace(A,"$1").replace(N," ")}return wl.use=function It(st){switch(st){case void 0:case null:Ts=gm.length=0;break;default:if(typeof st=="function")gm[Ts++]=st;else if(typeof st=="object")for(var rt=0,jt=st.length;rt<jt;++rt)It(st[rt]);else ym=0|!!st}return It},wl.set=xh,n!==void 0&&xh(n),wl})})(rq);var rEe=rq.exports;const nq=Pa(rEe);var iq={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function(r){var n="/*|*/",i=n+"}";function o(s){if(s)try{r(s+"}")}catch{}}return function(a,c,l,d,u,p,f,m,g,y){switch(a){case 1:if(g===0&&c.charCodeAt(0)===64)return r(c+";"),"";break;case 2:if(m===0)return c+n;break;case 3:switch(m){case 102:case 112:return r(l[0]+c),"";default:return c+(y===0?n:"")}case-2:c.split(i).forEach(o)}}}})})(iq);var nEe=iq.exports;const iEe=Pa(nEe);var oEe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Hj=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function sEe(e,t){return!!(e===t||Hj(e)&&Hj(t))}function aEe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!sEe(e[r],t[r]))return!1;return!0}function oq(e,t){t===void 0&&(t=aEe);var r,n=[],i,o=!1;function s(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return o&&r===this&&t(a,n)||(i=e.apply(this,a),o=!0,r=this,n=a),i}return s}function cEe(e){var t={};return function(r){return t[r]===void 0&&(t[r]=e(r)),t[r]}}var lEe=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|inert|itemProp|itemScope|itemType|itemID|itemRef|on|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,dEe=cEe(function(e){return lEe.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91});function bP(e){return Object.prototype.toString.call(e).slice(8,-1)}function ig(e){return bP(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function Wj(e){return bP(e)==="Array"}function Gj(e){return bP(e)==="Symbol"}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function zj(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}function Kj(e,t,r,n){var i=n.propertyIsEnumerable(t)?"enumerable":"nonenumerable";i==="enumerable"&&(e[t]=r),i==="nonenumerable"&&Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0,configurable:!0})}function sq(e,t,r){if(!ig(t))return r&&Wj(r)&&r.forEach(function(l){t=l(e,t)}),t;var n={};if(ig(e)){var i=Object.getOwnPropertyNames(e),o=Object.getOwnPropertySymbols(e);n=zj(i,o).reduce(function(l,d){var u=e[d];return(!Gj(d)&&!Object.getOwnPropertyNames(t).includes(d)||Gj(d)&&!Object.getOwnPropertySymbols(t).includes(d))&&Kj(l,d,u,e),l},{})}var s=Object.getOwnPropertyNames(t),a=Object.getOwnPropertySymbols(t),c=zj(s,a).reduce(function(l,d){var u=t[d],p=ig(e)?e[d]:void 0;return r&&Wj(r)&&r.forEach(function(f){u=f(p,u)}),p!==void 0&&ig(u)&&(u=sq(p,u,r)),Kj(l,d,u,t),l},n);return c}function uEe(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=null,i=e;return ig(e)&&e.extensions&&Object.keys(e).length===1&&(i={},n=e.extensions),t.reduce(function(o,s){return sq(o,s,n)},i)}var xb={},qj=function(e,t){for(var r=[e[0]],n=0,i=t.length;n<i;n+=1)r.push(t[n],e[n+1]);return r},aq=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wc=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},hEe=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),jo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ry=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},pEe=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},_f=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},wP=function(e){return(typeof e>"u"?"undefined":aq(e))==="object"&&e.constructor===Object},Ob=Object.freeze([]),Dg=Object.freeze({});function hl(e){return typeof e=="function"}function SP(e){return e.displayName||e.name||"Component"}function fEe(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)}function Iy(e){return e&&typeof e.styledComponentId=="string"}var A0=typeof process<"u"&&(xb.REACT_APP_SC_ATTR||xb.SC_ATTR)||"data-styled",SS="data-styled-version",mEe="data-styled-streamed",th=typeof window<"u"&&"HTMLElement"in window,cq=typeof SC_DISABLE_SPEEDY=="boolean"&&SC_DISABLE_SPEEDY||typeof process<"u"&&(xb.REACT_APP_SC_DISABLE_SPEEDY||xb.SC_DISABLE_SPEEDY)||!1,gEe={},yc=function(e){Ry(t,e);function t(r){wc(this,t);for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var s,s=_f(this,e.call(this,"An error occurred. See https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/utils/errors.md#"+r+" for more information."+(i.length>0?" Additional arguments: "+i.join(", "):"")));return _f(s)}return t}(Error),yEe=/^[^\S\n]*?\/\* sc-component-id:\s*(\S+)\s+\*\//gm,vEe=function(e){var t=""+(e||""),r=[];return t.replace(yEe,function(n,i,o){return r.push({componentId:i,matchIndex:o}),n}),r.map(function(n,i){var o=n.componentId,s=n.matchIndex,a=r[i+1],c=a?t.slice(s,a.matchIndex):t.slice(s);return{componentId:o,cssFromDOM:c}})},EEe=/^\s*\/\/.*$/gm,lq=new nq({global:!1,cascade:!0,keyframe:!1,prefix:!1,compress:!1,semicolon:!0}),dq=new nq({global:!1,cascade:!0,keyframe:!1,prefix:!0,compress:!1,semicolon:!1}),Vx=[],uq=function(t){if(t===-2){var r=Vx;return Vx=[],r}},hq=iEe(function(e){Vx.push(e)}),pq=void 0,Wp=void 0,fq=void 0,_Ee=function(t,r,n){return r>0&&n.slice(0,r).indexOf(Wp)!==-1&&n.slice(r-Wp.length,r)!==Wp?"."+pq:t},bEe=function(t,r,n){t===2&&n.length&&n[0].lastIndexOf(Wp)>0&&(n[0]=n[0].replace(fq,_Ee))};dq.use([bEe,hq,uq]);lq.use([hq,uq]);var wEe=function(t){return lq("",t)};function TP(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"&",i=e.join("").replace(EEe,""),o=t&&r?r+" "+t+" { "+i+" }":i;return pq=n,Wp=t,fq=new RegExp("\\"+Wp+"\\b","g"),dq(r||!t?"":t,o)}var CP=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},RP=function(t,r,n){if(n){var i=t[r]||(t[r]=Object.create(null));i[n]=!0}},Nb=function(t,r){t[r]=Object.create(null)},IP=function(t){return function(r,n){return t[r]!==void 0&&t[r][n]}},mq=function(t){var r="";for(var n in t)r+=Object.keys(t[n]).join(" ")+" ";return r.trim()},SEe=function(t){var r=Object.create(null);for(var n in t)r[n]=jo({},t[n]);return r},CC=function(t){if(t.sheet)return t.sheet;for(var r=t.ownerDocument.styleSheets.length,n=0;n<r;n+=1){var i=t.ownerDocument.styleSheets[n];if(i.ownerNode===t)return i}throw new yc(10)},TEe=function(t,r,n){if(!r)return!1;var i=t.cssRules.length;try{t.insertRule(r,n<=i?n:i)}catch{return!1}return!0},CEe=function(t,r,n){for(var i=r-n,o=r;o>i;o-=1)t.deleteRule(o)},AP=function(t){return`
/* sc-component-id: `+t+` */
`},RC=function(t,r){for(var n=0,i=0;i<=r;i+=1)n+=t[i];return n},REe=function(t,r,n){var i=document;t?i=t.ownerDocument:r&&(i=r.ownerDocument);var o=i.createElement("style");o.setAttribute(A0,""),o.setAttribute(SS,"4.4.1");var s=CP();if(s&&o.setAttribute("nonce",s),o.appendChild(i.createTextNode("")),t&&!r)t.appendChild(o);else{if(!r||!t||!r.parentNode)throw new yc(6);r.parentNode.insertBefore(o,n?r:r.nextSibling)}return o},xP=function(t,r){return function(n){var i=CP(),o=[i&&'nonce="'+i+'"',A0+'="'+mq(r)+'"',SS+'="4.4.1"',n],s=o.filter(Boolean).join(" ");return"<style "+s+">"+t()+"</style>"}},OP=function(t,r){return function(){var n,i=(n={},n[A0]=mq(r),n[SS]="4.4.1",n),o=CP();return o&&(i.nonce=o),Sr.createElement("style",jo({},i,{dangerouslySetInnerHTML:{__html:t()}}))}},NP=function(t){return function(){return Object.keys(t)}},IEe=function(t,r){var n=Object.create(null),i=Object.create(null),o=[],s=r!==void 0,a=!1,c=function(f){var m=i[f];return m!==void 0?m:(i[f]=o.length,o.push(0),Nb(n,f),i[f])},l=function(f,m,g){for(var y=c(f),v=CC(t),E=RC(o,y),w=0,S=[],A=m.length,N=0;N<A;N+=1){var L=m[N],j=s;j&&L.indexOf("@import")!==-1?S.push(L):TEe(v,L,E+w)&&(j=!1,w+=1)}s&&S.length>0&&(a=!0,r().insertRules(f+"-import",S)),o[y]+=w,RP(n,f,g)},d=function(f){var m=i[f];if(m!==void 0&&t.isConnected!==!1){var g=o[m],y=CC(t),v=RC(o,m)-1;CEe(y,v,g),o[m]=0,Nb(n,f),s&&a&&r().removeRules(f+"-import")}},u=function(){var f=CC(t),m=f.cssRules,g="";for(var y in i){g+=AP(y);for(var v=i[y],E=RC(o,v),w=o[v],S=E-w;S<E;S+=1){var A=m[S];A!==void 0&&(g+=A.cssText)}}return g};return{clone:function(){throw new yc(5)},css:u,getIds:NP(i),hasNameForId:IP(n),insertMarker:c,insertRules:l,removeRules:d,sealed:!1,styleTag:t,toElement:OP(u,n),toHTML:xP(u,n)}},Yj=function(t,r){return t.createTextNode(AP(r))},AEe=function(t,r){var n=Object.create(null),i=Object.create(null),o=r!==void 0,s=!1,a=function(p){var f=i[p];return f!==void 0?f:(i[p]=Yj(t.ownerDocument,p),t.appendChild(i[p]),n[p]=Object.create(null),i[p])},c=function(p,f,m){for(var g=a(p),y=[],v=f.length,E=0;E<v;E+=1){var w=f[E],S=o;if(S&&w.indexOf("@import")!==-1)y.push(w);else{S=!1;var A=E===v-1?"":" ";g.appendData(""+w+A)}}RP(n,p,m),o&&y.length>0&&(s=!0,r().insertRules(p+"-import",y))},l=function(p){var f=i[p];if(f!==void 0){var m=Yj(t.ownerDocument,p);t.replaceChild(m,f),i[p]=m,Nb(n,p),o&&s&&r().removeRules(p+"-import")}},d=function(){var p="";for(var f in i)p+=i[f].data;return p};return{clone:function(){throw new yc(5)},css:d,getIds:NP(i),hasNameForId:IP(n),insertMarker:a,insertRules:c,removeRules:l,sealed:!1,styleTag:t,toElement:OP(d,n),toHTML:xP(d,n)}},xEe=function e(t,r){var n=t===void 0?Object.create(null):t,i=r===void 0?Object.create(null):r,o=function(p){var f=i[p];return f!==void 0?f:i[p]=[""]},s=function(p,f,m){var g=o(p);g[0]+=f.join(" "),RP(n,p,m)},a=function(p){var f=i[p];f!==void 0&&(f[0]="",Nb(n,p))},c=function(){var p="";for(var f in i){var m=i[f][0];m&&(p+=AP(f)+m)}return p},l=function(){var p=SEe(n),f=Object.create(null);for(var m in i)f[m]=[i[m][0]];return e(p,f)},d={clone:l,css:c,getIds:NP(i),hasNameForId:IP(n),insertMarker:o,insertRules:s,removeRules:a,sealed:!1,styleTag:null,toElement:OP(c,n),toHTML:xP(c,n)};return d},Xj=function(t,r,n,i,o){if(th&&!n){var s=REe(t,r,i);return cq?AEe(s,o):IEe(s,o)}return xEe()},OEe=function(t,r,n){for(var i=0,o=n.length;i<o;i+=1){var s=n[i],a=s.componentId,c=s.cssFromDOM,l=wEe(c);t.insertRules(a,l)}for(var d=0,u=r.length;d<u;d+=1){var p=r[d];p.parentNode&&p.parentNode.removeChild(p)}},NEe=/\s+/,kb=void 0;th?kb=cq?40:1e3:kb=-1;var Jj=0,IC=void 0,pl=function(){function e(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:th?document.head:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;wc(this,e),this.getImportRuleTag=function(){var i=t.importRuleTag;if(i!==void 0)return i;var o=t.tags[0],s=!0;return t.importRuleTag=Xj(t.target,o?o.styleTag:null,t.forceServer,s)},Jj+=1,this.id=Jj,this.forceServer=n,this.target=n?null:r,this.tagMap={},this.deferred={},this.rehydratedNames={},this.ignoreRehydratedNames={},this.tags=[],this.capacity=1,this.clones=[]}return e.prototype.rehydrate=function(){if(!th||this.forceServer)return this;var r=[],n=[],i=!1,o=document.querySelectorAll("style["+A0+"]["+SS+'="4.4.1"]'),s=o.length;if(!s)return this;for(var a=0;a<s;a+=1){var c=o[a];i||(i=!!c.getAttribute(mEe));for(var l=(c.getAttribute(A0)||"").trim().split(NEe),d=l.length,u=0,p;u<d;u+=1)p=l[u],this.rehydratedNames[p]=!0;n.push.apply(n,vEe(c.textContent)),r.push(c)}var f=n.length;if(!f)return this;var m=this.makeTag(null);OEe(m,r,n),this.capacity=Math.max(1,kb-f),this.tags.push(m);for(var g=0;g<f;g+=1)this.tagMap[n[g].componentId]=m;return this},e.reset=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;IC=new e(void 0,r).rehydrate()},e.prototype.clone=function(){var r=new e(this.target,this.forceServer);return this.clones.push(r),r.tags=this.tags.map(function(n){for(var i=n.getIds(),o=n.clone(),s=0;s<i.length;s+=1)r.tagMap[i[s]]=o;return o}),r.rehydratedNames=jo({},this.rehydratedNames),r.deferred=jo({},this.deferred),r},e.prototype.sealAllTags=function(){this.capacity=1,this.tags.forEach(function(r){r.sealed=!0})},e.prototype.makeTag=function(r){var n=r?r.styleTag:null,i=!1;return Xj(this.target,n,this.forceServer,i,this.getImportRuleTag)},e.prototype.getTagForId=function(r){var n=this.tagMap[r];if(n!==void 0&&!n.sealed)return n;var i=this.tags[this.tags.length-1];return this.capacity-=1,this.capacity===0&&(this.capacity=kb,i=this.makeTag(i),this.tags.push(i)),this.tagMap[r]=i},e.prototype.hasId=function(r){return this.tagMap[r]!==void 0},e.prototype.hasNameForId=function(r,n){if(this.ignoreRehydratedNames[r]===void 0&&this.rehydratedNames[n])return!0;var i=this.tagMap[r];return i!==void 0&&i.hasNameForId(r,n)},e.prototype.deferredInject=function(r,n){if(this.tagMap[r]===void 0){for(var i=this.clones,o=0;o<i.length;o+=1)i[o].deferredInject(r,n);this.getTagForId(r).insertMarker(r),this.deferred[r]=n}},e.prototype.inject=function(r,n,i){for(var o=this.clones,s=0;s<o.length;s+=1)o[s].inject(r,n,i);var a=this.getTagForId(r);if(this.deferred[r]!==void 0){var c=this.deferred[r].concat(n);a.insertRules(r,c,i),this.deferred[r]=void 0}else a.insertRules(r,n,i)},e.prototype.remove=function(r){var n=this.tagMap[r];if(n!==void 0){for(var i=this.clones,o=0;o<i.length;o+=1)i[o].remove(r);n.removeRules(r),this.ignoreRehydratedNames[r]=!0,this.deferred[r]=void 0}},e.prototype.toHTML=function(){return this.tags.map(function(r){return r.toHTML()}).join("")},e.prototype.toReactElements=function(){var r=this.id;return this.tags.map(function(n,i){var o="sc-"+r+"-"+i;return T.cloneElement(n.toElement(),{key:o})})},hEe(e,null,[{key:"master",get:function(){return IC||(IC=new e().rehydrate())}},{key:"instance",get:function(){return e.master}}]),e}(),gq=function(){function e(t,r){var n=this;wc(this,e),this.inject=function(i){i.hasNameForId(n.id,n.name)||i.inject(n.id,n.rules,n.name)},this.toString=function(){throw new yc(12,String(n.name))},this.name=t,this.rules=r,this.id="sc-keyframes-"+t}return e.prototype.getName=function(){return this.name},e}(),kEe=/([A-Z])/g,PEe=/^ms-/;function Qj(e){return e.replace(kEe,"-$1").toLowerCase().replace(PEe,"-ms-")}function DEe(e,t){return t==null||typeof t=="boolean"||t===""?"":typeof t=="number"&&t!==0&&!(e in oEe)?t+"px":String(t).trim()}var yq=function(t){return t==null||t===!1||t===""},LEe=function e(t,r){var n=[],i=Object.keys(t);return i.forEach(function(o){if(!yq(t[o])){if(wP(t[o]))return n.push.apply(n,e(t[o],o)),n;if(hl(t[o]))return n.push(Qj(o)+":",t[o],";"),n;n.push(Qj(o)+": "+DEe(o,t[o])+";")}return n}),r?[r+" {"].concat(n,["}"]):n};function bf(e,t,r){if(Array.isArray(e)){for(var n=[],i=0,o=e.length,s;i<o;i+=1)s=bf(e[i],t,r),s!==null&&(Array.isArray(s)?n.push.apply(n,s):n.push(s));return n}if(yq(e))return null;if(Iy(e))return"."+e.styledComponentId;if(hl(e))if(fEe(e)&&t){var a=e(t);return bf(a,t,r)}else return e;return e instanceof gq?r?(e.inject(r),e.getName()):e:wP(e)?LEe(e):e.toString()}function TS(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return hl(e)||wP(e)?bf(qj(Ob,[e].concat(r))):bf(qj(e,r))}function Bx(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Dg;if(!yk.isValidElementType(t))throw new yc(1,String(t));var n=function(){return e(t,r,TS.apply(void 0,arguments))};return n.withConfig=function(i){return Bx(e,t,jo({},r,i))},n.attrs=function(i){return Bx(e,t,jo({},r,{attrs:Array.prototype.concat(r.attrs,i).filter(Boolean)}))},n}function kP(e){for(var t=e.length|0,r=t|0,n=0,i;t>=4;)i=e.charCodeAt(n)&255|(e.charCodeAt(++n)&255)<<8|(e.charCodeAt(++n)&255)<<16|(e.charCodeAt(++n)&255)<<24,i=1540483477*(i&65535)+((1540483477*(i>>>16)&65535)<<16),i^=i>>>24,i=1540483477*(i&65535)+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(r&65535)+((1540483477*(r>>>16)&65535)<<16)^i,t-=4,++n;switch(t){case 3:r^=(e.charCodeAt(n+2)&255)<<16;case 2:r^=(e.charCodeAt(n+1)&255)<<8;case 1:r^=e.charCodeAt(n)&255,r=1540483477*(r&65535)+((1540483477*(r>>>16)&65535)<<16)}return r^=r>>>13,r=1540483477*(r&65535)+((1540483477*(r>>>16)&65535)<<16),(r^r>>>15)>>>0}var kv=52,Zj=function(t){return String.fromCharCode(t+(t>25?39:97))};function vq(e){var t="",r=void 0;for(r=e;r>kv;r=Math.floor(r/kv))t=Zj(r%kv)+t;return Zj(r%kv)+t}function MEe(e){for(var t in e)if(hl(e[t]))return!0;return!1}function PP(e,t){for(var r=0;r<e.length;r+=1){var n=e[r];if(Array.isArray(n)&&!PP(n,t))return!1;if(hl(n)&&!Iy(n))return!1}return!t.some(function(i){return hl(i)||MEe(i)})}var eU=function(t){return vq(kP(t))},tU=function(){function e(t,r,n){wc(this,e),this.rules=t,this.isStatic=PP(t,r),this.componentId=n,pl.master.hasId(n)||pl.master.deferredInject(n,[])}return e.prototype.generateAndInjectStyles=function(r,n){var i=this.isStatic,o=this.componentId,s=this.lastClassName;if(th&&i&&typeof s=="string"&&n.hasNameForId(o,s))return s;var a=bf(this.rules,r,n),c=eU(this.componentId+a.join(""));return n.hasNameForId(o,c)||n.inject(this.componentId,TP(a,"."+c,void 0,o),c),this.lastClassName=c,c},e.generateName=function(r){return eU(r)},e}(),DP=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Dg,n=r?e.theme===r.theme:!1,i=e.theme&&!n?e.theme:t||r.theme;return i},jEe=/[[\].#*$><+~=|^:(),"'`-]+/g,UEe=/(^-|-$)/g;function $x(e){return e.replace(jEe,"-").replace(UEe,"")}function Pb(e){return typeof e=="string"&&!0}function FEe(e){return Pb(e)?"styled."+e:"Styled("+SP(e)+")"}var AC,rU={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDerivedStateFromProps:!0,propTypes:!0,type:!0},VEe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},nU=(AC={},AC[yk.ForwardRef]={$$typeof:!0,render:!0},AC),BEe=Object.defineProperty,$Ee=Object.getOwnPropertyNames,iU=Object.getOwnPropertySymbols,HEe=iU===void 0?function(){return[]}:iU,WEe=Object.getOwnPropertyDescriptor,GEe=Object.getPrototypeOf,zEe=Object.prototype,KEe=Array.prototype;function LP(e,t,r){if(typeof t!="string"){var n=GEe(t);n&&n!==zEe&&LP(e,n,r);for(var i=KEe.concat($Ee(t),HEe(t)),o=nU[e.$$typeof]||rU,s=nU[t.$$typeof]||rU,a=i.length,c=void 0,l=void 0;a--;)if(l=i[a],!VEe[l]&&!(r&&r[l])&&!(s&&s[l])&&!(o&&o[l])&&(c=WEe(t,l),c))try{BEe(e,l,c)}catch{}return e}return e}function qEe(e){return!!(e&&e.prototype&&e.prototype.isReactComponent)}var Db=T.createContext(),CS=Db.Consumer,YEe=function(e){Ry(t,e);function t(r){wc(this,t);var n=_f(this,e.call(this,r));return n.getContext=oq(n.getContext.bind(n)),n.renderInner=n.renderInner.bind(n),n}return t.prototype.render=function(){return this.props.children?Sr.createElement(Db.Consumer,null,this.renderInner):null},t.prototype.renderInner=function(n){var i=this.getContext(this.props.theme,n);return Sr.createElement(Db.Provider,{value:i},this.props.children)},t.prototype.getTheme=function(n,i){if(hl(n)){var o=n(i);return o}if(n===null||Array.isArray(n)||(typeof n>"u"?"undefined":aq(n))!=="object")throw new yc(8);return jo({},i,n)},t.prototype.getContext=function(n,i){return this.getTheme(n,i)},t}(T.Component),XEe=function(){function e(){wc(this,e),this.masterSheet=pl.master,this.instance=this.masterSheet.clone(),this.sealed=!1}return e.prototype.seal=function(){if(!this.sealed){var r=this.masterSheet.clones.indexOf(this.instance);this.masterSheet.clones.splice(r,1),this.sealed=!0}},e.prototype.collectStyles=function(r){if(this.sealed)throw new yc(2);return Sr.createElement(Eq,{sheet:this.instance},r)},e.prototype.getStyleTags=function(){return this.seal(),this.instance.toHTML()},e.prototype.getStyleElement=function(){return this.seal(),this.instance.toReactElements()},e.prototype.interleaveWithNodeStream=function(r){throw new yc(3)},e}(),MP=T.createContext(),jP=MP.Consumer,Eq=function(e){Ry(t,e);function t(r){wc(this,t);var n=_f(this,e.call(this,r));return n.getContext=oq(n.getContext),n}return t.prototype.getContext=function(n,i){if(n)return n;if(i)return new pl(i);throw new yc(4)},t.prototype.render=function(){var n=this.props,i=n.children,o=n.sheet,s=n.target;return Sr.createElement(MP.Provider,{value:this.getContext(o,s)},i)},t}(T.Component),oU={};function JEe(e,t,r){var n=typeof t!="string"?"sc":$x(t),i=(oU[n]||0)+1;oU[n]=i;var o=n+"-"+e.generateName(n+i);return r?r+"-"+o:o}var QEe=function(e){Ry(t,e);function t(){wc(this,t);var r=_f(this,e.call(this));return r.attrs={},r.renderOuter=r.renderOuter.bind(r),r.renderInner=r.renderInner.bind(r),r}return t.prototype.render=function(){return Sr.createElement(jP,null,this.renderOuter)},t.prototype.renderOuter=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pl.master;return this.styleSheet=n,this.props.forwardedComponent.componentStyle.isStatic?this.renderInner():Sr.createElement(CS,null,this.renderInner)},t.prototype.renderInner=function(n){var i=this.props.forwardedComponent,o=i.componentStyle,s=i.defaultProps;i.displayName;var a=i.foldedComponentIds,c=i.styledComponentId,l=i.target,d=void 0;o.isStatic?d=this.generateAndInjectStyles(Dg,this.props):d=this.generateAndInjectStyles(DP(this.props,n,s)||Dg,this.props);var u=this.props.as||this.attrs.as||l,p=Pb(u),f={},m=jo({},this.props,this.attrs),g=void 0;for(g in m)g==="forwardedComponent"||g==="as"||(g==="forwardedRef"?f.ref=m[g]:g==="forwardedAs"?f.as=m[g]:(!p||dEe(g))&&(f[g]=m[g]));return this.props.style&&this.attrs.style&&(f.style=jo({},this.attrs.style,this.props.style)),f.className=Array.prototype.concat(a,c,d!==c?d:null,this.props.className,this.attrs.className).filter(Boolean).join(" "),T.createElement(u,f)},t.prototype.buildExecutionContext=function(n,i,o){var s=this,a=jo({},i,{theme:n});return o.length&&(this.attrs={},o.forEach(function(c){var l=c,d=!1,u=void 0,p=void 0;hl(l)&&(l=l(a),d=!0);for(p in l)u=l[p],d||hl(u)&&!qEe(u)&&!Iy(u)&&(u=u(a)),s.attrs[p]=u,a[p]=u})),a},t.prototype.generateAndInjectStyles=function(n,i){var o=i.forwardedComponent,s=o.attrs,a=o.componentStyle;if(o.warnTooManyClasses,a.isStatic&&!s.length)return a.generateAndInjectStyles(Dg,this.styleSheet);var c=a.generateAndInjectStyles(this.buildExecutionContext(n,i,s),this.styleSheet);return c},t}(T.Component);function _q(e,t,r){var n=Iy(e),i=!Pb(e),o=t.displayName,s=o===void 0?FEe(e):o,a=t.componentId,c=a===void 0?JEe(tU,t.displayName,t.parentComponentId):a,l=t.ParentComponent,d=l===void 0?QEe:l,u=t.attrs,p=u===void 0?Ob:u,f=t.displayName&&t.componentId?$x(t.displayName)+"-"+t.componentId:t.componentId||c,m=n&&e.attrs?Array.prototype.concat(e.attrs,p).filter(Boolean):p,g=new tU(n?e.componentStyle.rules.concat(r):r,m,f),y=void 0,v=function(w,S){return Sr.createElement(d,jo({},w,{forwardedComponent:y,forwardedRef:S}))};return v.displayName=s,y=Sr.forwardRef(v),y.displayName=s,y.attrs=m,y.componentStyle=g,y.foldedComponentIds=n?Array.prototype.concat(e.foldedComponentIds,e.styledComponentId):Ob,y.styledComponentId=f,y.target=n?e.target:e,y.withComponent=function(w){var S=t.componentId,A=pEe(t,["componentId"]),N=S&&S+"-"+(Pb(w)?w:$x(SP(w))),L=jo({},A,{attrs:m,componentId:N,ParentComponent:d});return _q(w,L,r)},Object.defineProperty(y,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(w){this._foldedDefaultProps=n?uEe(e.defaultProps,w):w}}),y.toString=function(){return"."+y.styledComponentId},i&&LP(y,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,styledComponentId:!0,target:!0,withComponent:!0}),y}var ZEe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Hx=function(t){return Bx(_q,t)};ZEe.forEach(function(e){Hx[e]=Hx(e)});var e_e=function(){function e(t,r){wc(this,e),this.rules=t,this.componentId=r,this.isStatic=PP(t,Ob),pl.master.hasId(r)||pl.master.deferredInject(r,[])}return e.prototype.createStyles=function(r,n){var i=bf(this.rules,r,n),o=TP(i,"");n.inject(this.componentId,o)},e.prototype.removeStyles=function(r){var n=this.componentId;r.hasId(n)&&r.remove(n)},e.prototype.renderStyles=function(r,n){this.removeStyles(n),this.createStyles(r,n)},e}();th&&(window.scCGSHMRCache={});function t_e(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=TS.apply(void 0,[e].concat(r)),o="sc-global-"+kP(JSON.stringify(i)),s=new e_e(i,o),a=function(c){Ry(l,c);function l(d){wc(this,l);var u=_f(this,c.call(this,d)),p=u.constructor,f=p.globalStyle,m=p.styledComponentId;return th&&(window.scCGSHMRCache[m]=(window.scCGSHMRCache[m]||0)+1),u.state={globalStyle:f,styledComponentId:m},u}return l.prototype.componentWillUnmount=function(){window.scCGSHMRCache[this.state.styledComponentId]&&(window.scCGSHMRCache[this.state.styledComponentId]-=1),window.scCGSHMRCache[this.state.styledComponentId]===0&&this.state.globalStyle.removeStyles(this.styleSheet)},l.prototype.render=function(){var u=this;return Sr.createElement(jP,null,function(p){u.styleSheet=p||pl.master;var f=u.state.globalStyle;return f.isStatic?(f.renderStyles(gEe,u.styleSheet),null):Sr.createElement(CS,null,function(m){var g=u.constructor.defaultProps,y=jo({},u.props);return typeof m<"u"&&(y.theme=DP(u.props,m,g)),f.renderStyles(y,u.styleSheet),null})})},l}(Sr.Component);return a.globalStyle=s,a.styledComponentId=o,a}var r_e=function(t){return t.replace(/\s|\\n/g,"")};function n_e(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=TS.apply(void 0,[e].concat(r)),o=vq(kP(r_e(JSON.stringify(i))));return new gq(o,TP(i,o,"@keyframes"))}var i_e=function(e){var t=Sr.forwardRef(function(r,n){return Sr.createElement(CS,null,function(i){var o=e.defaultProps,s=DP(r,i,o);return Sr.createElement(e,jo({},r,{theme:s,ref:n}))})});return LP(t,e),t.displayName="WithTheme("+SP(e)+")",t},o_e={StyleSheet:pl};const s_e=Object.freeze(Object.defineProperty({__proto__:null,ServerStyleSheet:XEe,StyleSheetConsumer:jP,StyleSheetContext:MP,StyleSheetManager:Eq,ThemeConsumer:CS,ThemeContext:Db,ThemeProvider:YEe,__DO_NOT_USE_OR_YOU_WILL_BE_HAUNTED_BY_SPOOKY_GHOSTS:o_e,createGlobalStyle:t_e,css:TS,default:Hx,isStyledComponent:Iy,keyframes:n_e,withTheme:i_e},Symbol.toStringTag,{value:"Module"})),a_e=H8(s_e);(function(e,t){(function(r,n){e.exports=n(tEe(),a_e)})(typeof self<"u"?self:cN,function(r,n){return function(i){var o={};function s(a){if(o[a])return o[a].exports;var c=o[a]={i:a,l:!1,exports:{}};return i[a].call(c.exports,c,c.exports,s),c.l=!0,c.exports}return s.m=i,s.c=o,s.d=function(a,c,l){s.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:l})},s.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},s.t=function(a,c){if(1&c&&(a=s(a)),8&c||4&c&&typeof a=="object"&&a&&a.__esModule)return a;var l=Object.create(null);if(s.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:a}),2&c&&typeof a!="string")for(var d in a)s.d(l,d,(function(u){return a[u]}).bind(null,d));return l},s.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(c,"a",c),c},s.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},s.p="dist/",s(s.s=9)}([function(i,o,s){i.exports=s(5)()},function(i,o){i.exports=r},function(i,o){i.exports=n},function(i,o){var s=function(a,c){return{parse:function(f,m){var g=JSON.parse(f,p).map(u),y=g[0],v=m||l,E=typeof y=="object"&&y?function w(S,A,N,L){return Object.keys(N).reduce(function(j,W){var V=j[W];if(V instanceof a){var Y=S[V];typeof Y!="object"||A.has(Y)?j[W]=L.call(j,W,Y):(A.add(Y),j[W]=L.call(j,W,w(S,A,Y,L)))}else j[W]=L.call(j,W,V);return j},N)}(g,new Set,y,v):y;return v.call({"":E},"",E)},stringify:function(f,m,g){for(var y,v=new Map,E=[],w=[],S=m&&typeof m==typeof E?function(L,j){if(L===""||-1<m.indexOf(L))return j}:m||l,A=+d(v,E,S.call({"":f},"",f)),N=function(L,j){if(y)return y=!y,j;var W=S.call(this,L,j);switch(typeof W){case"object":if(W===null)return W;case c:return v.get(W)||d(v,E,W)}return W};A<E.length;A++)y=!0,w[A]=JSON.stringify(E[A],N,g);return"["+w.join(",")+"]"}};function l(f,m){return m}function d(f,m,g){var y=a(m.push(g)-1);return f.set(g,y),y}function u(f){return f instanceof a?a(f):f}function p(f,m){return typeof m===c?new a(m):m}}(String,"string");i.exports=s},function(i,o,s){i.exports=function(a,c){var l=["abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ","0123456789","~!@#$%^&()_+-={}[];',"],d="";(c=c||"aA0").split("").forEach(function(p){isNaN(parseInt(p))?/[a-z]/.test(p)?d+=l[0]:/[A-Z]/.test(p)?d+=l[1]:d+=l[3]:d+=l[2]}),a=a||30;for(var u="";a--;)u+=d.charAt(Math.floor(Math.random()*d.length));return u}},function(i,o,s){var a=s(6),c=s(7),l=s(8);i.exports=function(){function d(f,m,g,y,v,E){E!==l&&c(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function u(){return d}d.isRequired=d;var p={array:d,bool:d,func:d,number:d,object:d,string:d,symbol:d,any:d,arrayOf:u,element:d,instanceOf:u,node:d,objectOf:u,oneOf:u,oneOfType:u,shape:u,exact:u};return p.checkPropTypes=a,p.PropTypes=p,p}},function(i,o,s){function a(l){return function(){return l}}var c=function(){};c.thatReturns=a,c.thatReturnsFalse=a(!1),c.thatReturnsTrue=a(!0),c.thatReturnsNull=a(null),c.thatReturnsThis=function(){return this},c.thatReturnsArgument=function(l){return l},i.exports=c},function(i,o,s){i.exports=function(a,c,l,d,u,p,f,m){if(!a){var g;if(c===void 0)g=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var y=[l,d,u,p,f,m],v=0;(g=new Error(c.replace(/%s/g,function(){return y[v++]}))).name="Invariant Violation"}throw g.framesToPop=1,g}}},function(i,o,s){i.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(i,o,s){s.r(o);var a=s(1),c=s.n(a),l=s(0),d=s.n(l),u=s(4),p=s.n(u),f=s(2),m=s.n(f),g=function(M){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Q=function(Se){Se=Se.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(ye,re,Xe,At){return re+re+Xe+Xe+At+At});var $e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Se);return $e?{r:parseInt($e[1],16),g:parseInt($e[2],16),b:parseInt($e[3],16)}:null}(M);return"rgba(".concat(Q.r,", ").concat(Q.g,", ").concat(Q.b,", ").concat(B,")")};function y(){var M=S([`
  0% { box-shadow: 0 0 0 0 `,`; }
  70% { box-shadow: 0 0 0 10px `,`; }
  100% { box-shadow: 0 0 0 0 `,`; }
`]);return y=function(){return M},M}function v(){var M=S([`
  25% { transform: rotate(-1deg); }
  100% { transform: rotate(1deg); }
`]);return v=function(){return M},M}function E(){var M=S([`
  100% { transform: scale(1); }
`]);return E=function(){return M},M}function w(){var M=S([`
  0% { opacity: .2; }
  20% { opacity: 1; }
  100% { opacity: .2; }
`]);return w=function(){return M},M}function S(M,B){return B||(B=M.slice(0)),Object.freeze(Object.defineProperties(M,{raw:{value:Object.freeze(B)}}))}var A=Object(f.keyframes)(w()),N=Object(f.keyframes)(E()),L=Object(f.keyframes)(v());function j(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  animation: `,` 1.4s infinite both;
  animation-delay: `,`;
`]);return j=function(){return M},M}var W=m.a.span(j(),A,function(M){return M.delay}),V=function(){return c.a.createElement("span",{className:"rsc-loading"},c.a.createElement(W,{delay:"0s"},"."),c.a.createElement(W,{delay:".2s"},"."),c.a.createElement(W,{delay:".4s"},"."))};function Y(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  background: #fff;
  border-radius: 5px;
  box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;
  display: flex;
  justify-content: center;
  margin: 0 6px 10px 6px;
  padding: 16px;
`]);return Y=function(){return M},M}var Z=m.a.div(Y());function te(M){return(te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B})(M)}function H(M,B){for(var Q=0;Q<B.length;Q++){var Se=B[Q];Se.enumerable=Se.enumerable||!1,Se.configurable=!0,"value"in Se&&(Se.writable=!0),Object.defineProperty(M,Se.key,Se)}}function $(M){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)})(M)}function K(M,B){return(K=Object.setPrototypeOf||function(Q,Se){return Q.__proto__=Se,Q})(M,B)}function x(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}function O(M,B,Q){return B in M?Object.defineProperty(M,B,{value:Q,enumerable:!0,configurable:!0,writable:!0}):M[B]=Q,M}var F=function(M){function B(){var $e,ye,re,Xe;(function(Ue,ze){if(!(Ue instanceof ze))throw new TypeError("Cannot call a class as a function")})(this,B);for(var At=arguments.length,be=new Array(At),ke=0;ke<At;ke++)be[ke]=arguments[ke];return re=this,Xe=($e=$(B)).call.apply($e,[this].concat(be)),ye=!Xe||te(Xe)!=="object"&&typeof Xe!="function"?x(re):Xe,O(x(x(ye)),"state",{loading:!0}),O(x(x(ye)),"renderComponent",function(){var Ue=ye.props,ze=Ue.step,lt=Ue.steps,Tt=Ue.previousStep,vt=Ue.triggerNextStep,mn=ze.component;return c.a.cloneElement(mn,{step:ze,steps:lt,previousStep:Tt,triggerNextStep:vt})}),ye}var Q,Se;return function($e,ye){if(typeof ye!="function"&&ye!==null)throw new TypeError("Super expression must either be null or a function");$e.prototype=Object.create(ye&&ye.prototype,{constructor:{value:$e,writable:!0,configurable:!0}}),ye&&K($e,ye)}(B,a.Component),Q=B,(Se=[{key:"componentDidMount",value:function(){var $e=this,ye=this.props,re=ye.speak,Xe=ye.step,At=ye.previousValue,be=ye.triggerNextStep,ke=Xe.delay,Ue=Xe.waitAction;setTimeout(function(){$e.setState({loading:!1},function(){Ue||Xe.rendered||be(),re(Xe,At)})},ke)}},{key:"render",value:function(){var $e=this.state.loading,ye=this.props.style;return c.a.createElement(Z,{className:"rsc-cs",style:ye},$e?c.a.createElement(V,null):this.renderComponent())}}])&&H(Q.prototype,Se),B}();F.propTypes={previousStep:d.a.objectOf(d.a.any).isRequired,previousValue:d.a.oneOfType([d.a.string,d.a.bool,d.a.number,d.a.object,d.a.array]),speak:d.a.func,step:d.a.objectOf(d.a.any).isRequired,steps:d.a.objectOf(d.a.any).isRequired,style:d.a.objectOf(d.a.any).isRequired,triggerNextStep:d.a.func.isRequired},F.defaultProps={previousValue:"",speak:function(){}};var P=F;function _(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  animation: `,` 0.3s ease forwards;
  cursor: pointer;
  display: inline-block;
  margin: 2px;
  transform: scale(0);
`]);return _=function(){return M},M}var R=m.a.li(_(),N),k={background:"#f5f8fb",fontFamily:"monospace",headerBgColor:"#6e48aa",headerFontColor:"#fff",headerFontSize:"16px",botBubbleColor:"#6E48AA",botFontColor:"#fff",userBubbleColor:"#fff",userFontColor:"#4a4a4a"};function z(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  background: `,`;
  border: 0;
  border-radius: 22px;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.15);
  color: `,`;
  display: inline-block;
  font-size: 14px;
  padding: 12px;

  &:hover {
    opacity: 0.7;
  }
  &:active,
  &:hover:focus {
    outline:none;
  }
`]);return z=function(){return M},M}var U=m.a.button(z(),function(M){return M.theme.botBubbleColor},function(M){return M.theme.botFontColor});U.defaultProps={theme:k};var q=U;function ie(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  margin: 2px 0 12px 0;
  padding: 0 6px;
`]);return ie=function(){return M},M}var ue=m.a.ul(ie());function me(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([""]);return me=function(){return M},M}var De=m.a.div(me());function He(M){return(He=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B})(M)}function Pe(M,B){for(var Q=0;Q<B.length;Q++){var Se=B[Q];Se.enumerable=Se.enumerable||!1,Se.configurable=!0,"value"in Se&&(Se.writable=!0),Object.defineProperty(M,Se.key,Se)}}function nt(M){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)})(M)}function Rt(M,B){return(Rt=Object.setPrototypeOf||function(Q,Se){return Q.__proto__=Se,Q})(M,B)}function Ye(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}function _t(M,B,Q){return B in M?Object.defineProperty(M,B,{value:Q,enumerable:!0,configurable:!0,writable:!0}):M[B]=Q,M}var Te=function(M){function B(){var $e,ye,re,Xe;(function(Ue,ze){if(!(Ue instanceof ze))throw new TypeError("Cannot call a class as a function")})(this,B);for(var At=arguments.length,be=new Array(At),ke=0;ke<At;ke++)be[ke]=arguments[ke];return re=this,Xe=($e=nt(B)).call.apply($e,[this].concat(be)),ye=!Xe||He(Xe)!=="object"&&typeof Xe!="function"?Ye(re):Xe,_t(Ye(Ye(ye)),"onOptionClick",function(Ue){var ze=Ue.value;(0,ye.props.triggerNextStep)({value:ze})}),_t(Ye(Ye(ye)),"renderOption",function(Ue){var ze=ye.props,lt=ze.bubbleOptionStyle,Tt=ze.step.user,vt=Ue.value,mn=Ue.label;return c.a.createElement(R,{key:vt,className:"rsc-os-option"},c.a.createElement(q,{className:"rsc-os-option-element",style:lt,user:Tt,onClick:function(){return ye.onOptionClick({value:vt})}},mn))}),ye}var Q,Se;return function($e,ye){if(typeof ye!="function"&&ye!==null)throw new TypeError("Super expression must either be null or a function");$e.prototype=Object.create(ye&&ye.prototype,{constructor:{value:$e,writable:!0,configurable:!0}}),ye&&Rt($e,ye)}(B,a.Component),Q=B,(Se=[{key:"render",value:function(){var $e=this.props.step.options;return c.a.createElement(De,{className:"rsc-os"},c.a.createElement(ue,{className:"rsc-os-options"},Object.keys($e).map(function(ye){return $e[ye]}).map(this.renderOption)))}}])&&Pe(Q.prototype,Se),B}();Te.propTypes={bubbleOptionStyle:d.a.objectOf(d.a.any).isRequired,step:d.a.objectOf(d.a.any).isRequired,triggerNextStep:d.a.func.isRequired};var Ze=Te;function Ve(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  animation: `,` 0.3s ease forwards;
  background: `,`;
  border-radius: `,`;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.15);
  color: `,`;
  display: inline-block;
  font-size: 14px;
  max-width: 50%;
  margin: `,`;
  overflow: hidden;
  position: relative;
  padding: 12px;
  transform: scale(0);
  transform-origin: `,`;
`]);return Ve=function(){return M},M}var Ke=m.a.div(Ve(),N,function(M){return M.user?M.theme.userBubbleColor:M.theme.botBubbleColor},function(M){var B=M.isFirst,Q=M.isLast,Se=M.user;return B||Q?!B&&Q?Se?"18px 0 18px 18px":"0 18px 18px 18px":M.user?"18px 18px 0 18px":"18px 18px 18px 0":Se?"18px 0 0 18px":"0 18px 18px 0px"},function(M){return M.user?M.theme.userFontColor:M.theme.botFontColor},function(M){var B=M.isFirst,Q=M.showAvatar,Se=M.user;return!B&&Q?Se?"-8px 46px 10px 0":"-8px 0 10px 46px":B||Q?"0 0 10px 0":Se?"-8px 0px 10px 0":"-8px 0 10px 0px"},function(M){var B=M.isFirst,Q=M.user;return B?Q?"bottom right":"bottom left":Q?"top right":"top left"});Ke.defaultProps={theme:k};var Ge=Ke;function ee(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  animation: `,` 0.3s ease forwards;
  border-radius: `,`;
  box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;
  height: 40px;
  min-width: 40px;
  padding: 3px;
  transform: scale(0);
  transform-origin: `,`;
  width: 40;
`]);return ee=function(){return M},M}var Ae=m.a.img(ee(),N,function(M){return M.user?"50% 50% 50% 0":"50% 50% 0 50%"},function(M){return M.user?"bottom left":"bottom right"});function Le(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  display: inline-block;
  order: `,`;
  padding: 6px;
`]);return Le=function(){return M},M}var We=m.a.div(Le(),function(M){return M.user?"1":"0"});function dt(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  align-items: flex-end;
  display: flex;
  justify-content: `,`;
`]);return dt=function(){return M},M}var Gt=m.a.div(dt(),function(M){return M.user?"flex-end":"flex-start"});function $r(M){return($r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B})(M)}function fn(M,B){for(var Q=0;Q<B.length;Q++){var Se=B[Q];Se.enumerable=Se.enumerable||!1,Se.configurable=!0,"value"in Se&&(Se.writable=!0),Object.defineProperty(M,Se.key,Se)}}function $o(M){return($o=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)})(M)}function Va(M,B){return(Va=Object.setPrototypeOf||function(Q,Se){return Q.__proto__=Se,Q})(M,B)}function Ji(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}function Ac(M,B,Q){return B in M?Object.defineProperty(M,B,{value:Q,enumerable:!0,configurable:!0,writable:!0}):M[B]=Q,M}var Ci=function(M){function B(){var $e,ye,re,Xe;(function(Ue,ze){if(!(Ue instanceof ze))throw new TypeError("Cannot call a class as a function")})(this,B);for(var At=arguments.length,be=new Array(At),ke=0;ke<At;ke++)be[ke]=arguments[ke];return re=this,Xe=($e=$o(B)).call.apply($e,[this].concat(be)),ye=!Xe||$r(Xe)!=="object"&&typeof Xe!="function"?Ji(re):Xe,Ac(Ji(Ji(ye)),"state",{loading:!0}),Ac(Ji(Ji(ye)),"getMessage",function(){var Ue=ye.props,ze=Ue.previousValue,lt=Ue.step.message;return lt?lt.replace(/{previousValue}/g,ze):""}),Ac(Ji(Ji(ye)),"renderMessage",function(){var Ue=ye.props,ze=Ue.step,lt=Ue.steps,Tt=Ue.previousStep,vt=Ue.triggerNextStep,mn=ze.component;return mn?c.a.cloneElement(mn,{step:ze,steps:lt,previousStep:Tt,triggerNextStep:vt}):ye.getMessage()}),ye}var Q,Se;return function($e,ye){if(typeof ye!="function"&&ye!==null)throw new TypeError("Super expression must either be null or a function");$e.prototype=Object.create(ye&&ye.prototype,{constructor:{value:$e,writable:!0,configurable:!0}}),ye&&Va($e,ye)}(B,a.Component),Q=B,(Se=[{key:"componentDidMount",value:function(){var $e=this,ye=this.props,re=ye.step,Xe=ye.speak,At=ye.previousValue,be=ye.triggerNextStep,ke=re.component,Ue=re.delay,ze=re.waitAction,lt=ke&&ze;setTimeout(function(){$e.setState({loading:!1},function(){lt||re.rendered||be(),Xe(re,At)})},Ue)}},{key:"render",value:function(){var $e=this.props,ye=$e.step,re=$e.isFirst,Xe=$e.isLast,At=$e.avatarStyle,be=$e.bubbleStyle,ke=$e.hideBotAvatar,Ue=$e.hideUserAvatar,ze=this.state.loading,lt=ye.avatar,Tt=ye.user,vt=Tt?!Ue:!ke;return c.a.createElement(Gt,{className:"rsc-ts ".concat(Tt?"rsc-ts-user":"rsc-ts-bot"),user:Tt},c.a.createElement(We,{className:"rsc-ts-image-container",user:Tt},re&&vt&&c.a.createElement(Ae,{className:"rsc-ts-image",style:At,showAvatar:vt,user:Tt,src:lt,alt:"avatar"})),c.a.createElement(Ge,{className:"rsc-ts-bubble",style:be,user:Tt,showAvatar:vt,isFirst:re,isLast:Xe},ze?c.a.createElement(V,null):this.renderMessage()))}}])&&fn(Q.prototype,Se),B}();Ci.propTypes={avatarStyle:d.a.objectOf(d.a.any).isRequired,isFirst:d.a.bool.isRequired,isLast:d.a.bool.isRequired,bubbleStyle:d.a.objectOf(d.a.any).isRequired,hideBotAvatar:d.a.bool.isRequired,hideUserAvatar:d.a.bool.isRequired,previousStep:d.a.objectOf(d.a.any),previousValue:d.a.oneOfType([d.a.string,d.a.bool,d.a.number,d.a.object,d.a.array]),speak:d.a.func,step:d.a.objectOf(d.a.any).isRequired,steps:d.a.objectOf(d.a.any),triggerNextStep:d.a.func.isRequired},Ci.defaultProps={previousStep:{},previousValue:"",speak:function(){},steps:{}};var ws=Ci,Ba=[{key:"id",types:["string","number"],required:!0},{key:"user",types:["boolean"],required:!0},{key:"trigger",types:["string","number","function"],required:!1},{key:"validator",types:["function"],required:!1},{key:"end",types:["boolean"],required:!1},{key:"placeholder",types:["string"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],Ss=[{key:"id",types:["string","number"],required:!0},{key:"message",types:["string","function"],required:!0},{key:"avatar",types:["string"],required:!1},{key:"trigger",types:["string","number","function"],required:!1},{key:"delay",types:["number"],required:!1},{key:"end",types:["boolean"],required:!1},{key:"placeholder",types:["string"],required:!1},{key:"hideInput",types:["boolean"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],Ho=[{key:"id",types:["string","number"],required:!0},{key:"options",types:["object"],required:!0},{key:"end",types:["boolean"],required:!1},{key:"placeholder",types:["string"],required:!1},{key:"hideInput",types:["boolean"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],mm=[{key:"id",types:["string","number"],required:!0},{key:"component",types:["any"],required:!0},{key:"avatar",types:["string"],required:!1},{key:"replace",types:["boolean"],required:!1},{key:"waitAction",types:["boolean"],required:!1},{key:"asMessage",types:["boolean"],required:!1},{key:"trigger",types:["string","number","function"],required:!1},{key:"delay",types:["number"],required:!1},{key:"end",types:["boolean"],required:!1},{key:"placeholder",types:["string"],required:!1},{key:"hideInput",types:["boolean"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],Ky=[{key:"id",types:["string","number"],required:!0},{key:"update",types:["string","number"],required:!0},{key:"trigger",types:["string","number","function"],required:!0},{key:"placeholder",types:["string"],required:!1},{key:"inputAttributes",types:["object"],required:!1},{key:"metadata",types:["object"],required:!1}],xc=s(3);function Wd(M){return(Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B})(M)}var Sh={parse:function(M){var B=[];if(M.user)B=Ba;else if(M.message)B=Ss;else if(M.options)B=Ho;else if(M.component)B=mm;else{if(!M.update)throw new Error("The step ".concat(Object(xc.stringify)(M)," is invalid"));B=Ky}for(var Q=0,Se=B.length;Q<Se;Q+=1){var $e=B[Q],ye=$e.key,re=$e.types,Xe=$e.required;if(!M[ye]&&Xe)throw new Error("Key '".concat(ye,"' is required in step ").concat(Object(xc.stringify)(M)));if(M[ye]&&re[0]!=="any"&&re.indexOf(Wd(M[ye]))<0)throw new Error("The type of '".concat(ye,"' value must be ").concat(re.join(" or ")," instead of ").concat(Wd(M[ye])))}var At=B.map(function(be){return be.key});for(var ye in M)At.indexOf(ye)<0&&(console.error("Invalid key '".concat(ye,"' in step '").concat(M.id,"'")),delete M[ye]);return M},checkInvalidIds:function(M){for(var B in M){var Q=M[B],Se=M[B].trigger;if(typeof Se!="function"){if(Q.options)for(var $e=Q.options.filter(function(At){return typeof At.trigger!="function"}).map(function(At){return At.trigger}),ye=0,re=$e.length;ye<re;ye+=1){var Xe=$e[ye];if(Xe&&!M[Xe])throw new Error("The id '".concat(Xe,"' triggered by option ").concat(ye+1," in step '").concat(M[B].id,"' does not exist"))}else if(Se&&!M[Se])throw new Error("The id '".concat(Se,"' triggered by step '").concat(M[B].id,"' does not exist"))}}}},gm=function(M,B){var Q=Object(xc.parse)(Object(xc.stringify)(B));for(var Se in Q)for(var $e=0,ye=Q[Se].length;$e<ye;$e+=1)Q[Se][$e].component&&(Q[Se][$e].component=Q[Se][$e].id);localStorage.setItem(M,Object(xc.stringify)(Q))};function Ts(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  background: `,`;
  border-radius: 10px;
  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.15);
  font-family: `,`;
  overflow: hidden;
  position: `,`;
  bottom: `,`;
  top: `,`;
  right: `,`;
  left: `,`;
  width: `,`;
  height: `,`;
  z-index: 999;
  transform: `,`;
  transform-origin: `,`;
  transition: transform 0.3s ease;

  @media screen and (max-width: 568px) {
    border-radius: `,`;
    bottom: 0 !important;
    left: initial !important;
    height: 100%;
    right: 0 !important;
    top: initial !important;
    width: 100%;
  }
`]);return Ts=function(){return M},M}var Th=m.a.div(Ts(),function(M){return M.theme.background},function(M){return M.theme.fontFamily},function(M){return M.floating?"fixed":"relative"},function(M){var B=M.floating,Q=M.floatingStyle;return B?Q.bottom||"32px":"initial"},function(M){var B=M.floating,Q=M.floatingStyle;return B&&Q.top||"initial"},function(M){var B=M.floating,Q=M.floatingStyle;return B?Q.right||"32px":"initial"},function(M){var B=M.floating,Q=M.floatingStyle;return B&&Q.left||"initial"},function(M){return M.width},function(M){return M.height},function(M){return M.opened?"scale(1)":"scale(0)"},function(M){return M.floatingStyle.transformOrigin||"bottom right"},function(M){return M.floating?"0":""});Th.defaultProps={theme:k};var hT=Th;function qy(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  height: calc(`," - ",`);
  overflow-y: scroll;
  margin-top: 2px;
  padding-top: 6px;

  @media screen and (max-width: 568px) {
    height: `,`;
  }
`]);return qy=function(){return M},M}var pT=m.a.div(qy(),function(M){return M.height},function(M){return M.hideInput?"56px":"112px"},function(M){return M.floating?"calc(100% - 112px)":""});function Yy(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  align-items: center;
  background: `,`;
  color: `,`;
  display: flex;
  fill: `,`;
  height: 56px;
  justify-content: space-between;
  padding: 0 10px;
`]);return Yy=function(){return M},M}var Xy=m.a.div(Yy(),function(M){return M.theme.headerBgColor},function(M){return M.theme.headerFontColor},function(M){return M.theme.headerFontColor});Xy.defaultProps={theme:k};var fT=Xy;function ym(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  margin: 0;
  font-size: `,`;
`]);return ym=function(){return M},M}var _l=m.a.h2(ym(),function(M){return M.theme.headerFontSize});_l.defaultProps={theme:k};var Ch=_l;function ca(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  cursor: pointer;
`]);return ca=function(){return M},M}var Gd=m.a.a(ca());function Rh(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  align-items: center;
  cursor: pointer;
  background: `,`;
  bottom: 32px;
  border-radius: 100%;
  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.15);
  display: flex;
  fill: `,`;
  height: 56px;
  justify-content: center;
  position: fixed;
  right: 32px;
  transform: `,`;
  transition: transform 0.3s ease;
  width: 56px;
  z-index: 999;
`]);return Rh=function(){return M},M}var vm=m.a.a(Rh(),function(M){return M.theme.headerBgColor},function(M){return M.theme.headerFontColor},function(M){return M.opened?"scale(0)":"scale(1)"});vm.defaultProps={theme:{headerBgColor:"#6e48aa",headerFontColor:"#fff"}};var Jy=vm;function Ih(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  height: 24px;
  width: 24px;
`]);return Ih=function(){return M},M}var Ah=m.a.img(Ih());function Qy(){var M=function(B,Q){return Q||(Q=B.slice(0)),Object.freeze(Object.defineProperties(B,{raw:{value:Object.freeze(Q)}}))}([`
  position: relative;
`]);return Qy=function(){return M},M}var bl=m.a.div(Qy());function Zy(){var M=wl([`
          `,` .2s ease
        `]);return Zy=function(){return M},M}function xh(){var M=wl([`
  animation: `,`;
  border: 0;
  border-radius: 0;
  border-bottom-left-radius: 10px;
  border-bottom-right-radius: 10px;
  border-top: `,`;
  box-shadow: `,`;
  box-sizing: border-box;
  color: `,`;
  font-size: 16px;
  opacity: `,`;
  outline: none;
  padding: `,`;
  width: 100%;
  -webkit-appearance: none;

  &:disabled {
    background: #fff;
  }

  @media screen and (max-width: 568px) {
    border-bottom-left-radius: `,`;
    border-bottom-right-radius: `,`;
  }
`]);return xh=function(){return M},M}function wl(M,B){return B||(B=M.slice(0)),Object.freeze(Object.defineProperties(M,{raw:{value:Object.freeze(B)}}))}var It=m.a.input(xh(),function(M){return M.invalid?Object(f.css)(Zy(),L):""},function(M){return M.invalid?"0":"1px solid #eee"},function(M){return M.invalid?"inset 0 0 2px #E53935":"none"},function(M){return M.invalid?"#E53935":""},function(M){return M.disabled&&!M.invalid?".5":"1"},function(M){return M.hasButton?"16px 52px 16px 10px":"16px 10px"},function(M){return M.floating?"0":"10px"},function(M){return M.floating?"0":"10px"});function st(){var M=jt([`
            `,` 2s ease infinite
          `]);return st=function(){return M},M}function rt(){var M=jt([`
  background-color: transparent;
  border: 0;
  border-bottom-right-radius: 10px;
  box-shadow: none;
  cursor: `,`;
  fill: `,`;
  opacity: `,`;
  outline: none;
  padding: 14px 16px 12px 16px;
  position: absolute;
  right: 0;
  top: 0;
  &:before {
    content: '';
    position: absolute;
    width: 23px;
    height: 23px;
    border-radius: 50%;
    animation: `,`;
  }
  &:not(:disabled):hover {
    opacity: 0.7;
  }
`]);return rt=function(){return M},M}function jt(M,B){return B||(B=M.slice(0)),Object.freeze(Object.defineProperties(M,{raw:{value:Object.freeze(B)}}))}var Be=m.a.button(rt(),function(M){return M.disabled?"default":"pointer"},function(M){var B=M.speaking,Q=M.invalid,Se=M.theme;return B?Se.headerBgColor:Q?"#E53935":"#4a4a4a"},function(M){return M.disabled&&!M.invalid?".5":"1"},function(M){var B,Q=M.theme;return M.speaking?Object(f.css)(st(),(B=Q.headerBgColor,Object(f.keyframes)(y(),g(B,.4),g(B,0),g(B,0)))):""});Be.defaultProps={theme:k};var mr=Be;function ce(){return(ce=Object.assign||function(M){for(var B=1;B<arguments.length;B++){var Q=arguments[B];for(var Se in Q)Object.prototype.hasOwnProperty.call(Q,Se)&&(M[Se]=Q[Se])}return M}).apply(this,arguments)}function er(M,B){for(var Q=0;Q<B.length;Q++){var Se=B[Q];Se.enumerable=Se.enumerable||!1,Se.configurable=!0,"value"in Se&&(Se.writable=!0),Object.defineProperty(M,Se.key,Se)}}function Xt(M,B,Q){return B&&er(M.prototype,B),Q&&er(M,Q),M}var cn=null,zt=function(){},Rn=function(){function M(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zt,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zt,Se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zt,$e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"en";return function(ye,re){if(!(ye instanceof re))throw new TypeError("Cannot call a class as a function")}(this,M),cn||(cn=this),this.state={inputValue:"",lang:$e,onChange:B,onEnd:Q,onStop:Se},this.onResult=this.onResult.bind(this),this.onEnd=this.onEnd.bind(this),this.setup(),cn}return Xt(M,null,[{key:"isSupported",value:function(){return"webkitSpeechRecognition"in window}}]),Xt(M,[{key:"onChange",value:function(B){var Q=this.state.onChange;this.setState({inputValue:B}),Q(B)}},{key:"onFinal",value:function(B){this.setState({inputValue:B}),this.recognition.stop()}},{key:"onEnd",value:function(){var B=this.state,Q=B.onStop,Se=B.onEnd,$e=B.force;this.setState({speaking:!1}),$e?Q():Se()}},{key:"onResult",value:function(B){for(var Q="",Se="",$e=B.resultIndex;$e<B.results.length;$e+=1)B.results[$e].isFinal?(Se+=B.results[$e][0].transcript,this.onFinal(Se)):(Q+=B.results[$e][0].transcript,this.onChange(Q))}},{key:"setState",value:function(B){this.state=ce({},this.state,B)}},{key:"setup",value:function(){if(!M.isSupported())return this;var B=window.webkitSpeechRecognition;return this.recognition=new B,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang=this.state.lang,this.recognition.onresult=this.onResult,this.recognition.onend=this.onEnd,this}},{key:"setLang",value:function(B){return this.setState({lang:B}),this.setup(),this}},{key:"speak",value:function(){return M.isSupported()?(this.state.speaking?(this.setState({force:!0}),this.recognition.stop()):(this.recognition.start(),this.setState({speaking:!0,inputValue:""})),this):this}}]),M}(),Ur=function(){return c.a.createElement("svg",{height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"}),c.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},tr=function(){return c.a.createElement("svg",{height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),c.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},ei=function(M){var B=M.size;return c.a.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:B,height:B,viewBox:"0 0 500 500"},c.a.createElement("g",null,c.a.createElement("g",null,c.a.createElement("polygon",{points:"0,497.25 535.5,267.75 0,38.25 0,216.75 382.5,267.75 0,318.75"}))))};ei.propTypes={size:d.a.number},ei.defaultProps={size:20};var Mi=ei,$a=function(M){var B=M.size;return c.a.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:B,height:B,viewBox:"0 0 400 400"},c.a.createElement("g",null,c.a.createElement("path",{d:"M290.991,240.991c0,26.392-21.602,47.999-48.002,47.999h-11.529c-26.4,0-48.002-21.607-48.002-47.999V104.002   c0-26.4,21.602-48.004,48.002-48.004h11.529c26.4,0,48.002,21.604,48.002,48.004V240.991z"}),c.a.createElement("path",{d:"M342.381,209.85h-8.961c-4.932,0-8.961,4.034-8.961,8.961v8.008c0,50.26-37.109,91.001-87.361,91.001   c-50.26,0-87.109-40.741-87.109-91.001v-8.008c0-4.927-4.029-8.961-8.961-8.961h-8.961c-4.924,0-8.961,4.034-8.961,8.961v8.008   c0,58.862,40.229,107.625,96.07,116.362v36.966h-34.412c-4.932,0-8.961,4.039-8.961,8.971v17.922c0,4.923,4.029,8.961,8.961,8.961   h104.688c4.926,0,8.961-4.038,8.961-8.961v-17.922c0-4.932-4.035-8.971-8.961-8.971h-34.43v-36.966   c55.889-8.729,96.32-57.5,96.32-116.362v-8.008C351.342,213.884,347.303,209.85,342.381,209.85z"})))};$a.propTypes={size:d.a.number},$a.defaultProps={size:20};var ji=$a,Wo=function(){return/iphone|ipod|android|ie|blackberry|fennec/i.test(navigator.userAgent)},zd=function(M){return typeof M=="string"},Cs=function(M){return function(B,Q){var Se=M.lang,$e=M.voice,ye=M.enable,re=B.user;if(window.SpeechSynthesisUtterance&&window.speechSynthesis&&!re&&ye){var Xe=function(be){var ke=be.message,Ue=be.metadata,ze=Ue===void 0?{}:Ue;return zd(ze.speak)?ze.speak:zd(ke)?ke:""}(B),At=new window.SpeechSynthesisUtterance;At.text=Xe.replace(/{previousValue}/g,Q),At.lang=Se,At.voice=$e,window.speechSynthesis.speak(At)}}};function ir(M){return(ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B})(M)}function qn(){return(qn=Object.assign||function(M){for(var B=1;B<arguments.length;B++){var Q=arguments[B];for(var Se in Q)Object.prototype.hasOwnProperty.call(Q,Se)&&(M[Se]=Q[Se])}return M}).apply(this,arguments)}function Oc(M,B){for(var Q=0;Q<B.length;Q++){var Se=B[Q];Se.enumerable=Se.enumerable||!1,Se.configurable=!0,"value"in Se&&(Se.writable=!0),Object.defineProperty(M,Se.key,Se)}}function Sl(M){return(Sl=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)})(M)}function Or(M,B){return(Or=Object.setPrototypeOf||function(Q,Se){return Q.__proto__=Se,Q})(M,B)}function bt(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}function Hr(M,B,Q){return B in M?Object.defineProperty(M,B,{value:Q,enumerable:!0,configurable:!0,writable:!0}):M[B]=Q,M}var Yn=function(M){function B(ye){var re,Xe,At;return function(be,ke){if(!(be instanceof ke))throw new TypeError("Cannot call a class as a function")}(this,B),Xe=this,At=Sl(B).call(this,ye),re=!At||ir(At)!=="object"&&typeof At!="function"?bt(Xe):At,Hr(bt(bt(re)),"onNodeInserted",function(be){var ke=be.currentTarget;re.props.enableSmoothScroll&&re.supportsScrollBehavior?ke.scroll({top:ke.scrollHeight,left:0,behavior:"smooth"}):ke.scrollTop=ke.scrollHeight}),Hr(bt(bt(re)),"onResize",function(){re.content.scrollTop=re.content.scrollHeight}),Hr(bt(bt(re)),"onRecognitionChange",function(be){re.setState({inputValue:be})}),Hr(bt(bt(re)),"onRecognitionEnd",function(){re.setState({speaking:!1}),re.handleSubmitButton()}),Hr(bt(bt(re)),"onRecognitionStop",function(){re.setState({speaking:!1})}),Hr(bt(bt(re)),"onValueChange",function(be){re.setState({inputValue:be.target.value})}),Hr(bt(bt(re)),"getTriggeredStep",function(be,ke){var Ue=re.generateRenderedStepsById();return typeof be=="function"?be({value:ke,steps:Ue}):be}),Hr(bt(bt(re)),"getStepMessage",function(be){var ke=re.state.previousSteps,Ue=ke.length>0?ke.length-1:0,ze=re.generateRenderedStepsById(),lt=ke[Ue].value;return typeof be=="function"?be({previousValue:lt,steps:ze}):be}),Hr(bt(bt(re)),"generateRenderedStepsById",function(){for(var be=re.state.previousSteps,ke={},Ue=0,ze=be.length;Ue<ze;Ue+=1){var lt=be[Ue],Tt=lt.id,vt=lt.message,mn=lt.value,gr=lt.metadata;ke[Tt]={id:Tt,message:vt,value:mn,metadata:gr}}return ke}),Hr(bt(bt(re)),"triggerNextStep",function(be){var ke=re.props.enableMobileAutoFocus,Ue=re.state,ze=Ue.defaultUserSettings,lt=Ue.previousSteps,Tt=Ue.renderedSteps,vt=Ue.steps,mn=re.state,gr=mn.currentStep,Qi=mn.previousStep,Go=gr.end;if(be&&be.value&&(gr.value=be.value),be&&be.hideInput&&(gr.hideInput=be.hideInput),be&&be.trigger&&(gr.trigger=re.getTriggeredStep(be.trigger,be.value)),Go)re.handleEnd();else if(gr.options&&be){var ti=gr.options.filter(function(_m){return _m.value===be.value})[0],Rs=re.getTriggeredStep(ti.trigger,gr.value);delete gr.options,gr=qn({},gr,ti,ze,{user:!0,message:ti.label,trigger:Rs}),Tt.pop(),lt.pop(),Tt.push(gr),lt.push(gr),re.setState({currentStep:gr,renderedSteps:Tt,previousSteps:lt})}else if(gr.trigger){gr.replace&&Tt.pop();var gn=qn({},vt[re.getTriggeredStep(gr.trigger,gr.value)]);if(gn.message)gn.message=re.getStepMessage(gn.message);else if(gn.update){var Zi=gn;if((gn=qn({},vt[Zi.update])).options)for(var eo=0,Oh=gn.options.length;eo<Oh;eo+=1)gn.options[eo].trigger=Zi.trigger;else gn.trigger=Zi.trigger}gn.key=p()(24),Qi=gr,gr=gn,re.setState({renderedSteps:Tt,currentStep:gr,previousStep:Qi},function(){gn.user?re.setState({disabled:!1},function(){!ke&&Wo()||re.input&&re.input.focus()}):(Tt.push(gn),lt.push(gn),re.setState({renderedSteps:Tt,previousSteps:lt}))})}var Nh=re.props,Tl=Nh.cache,Em=Nh.cacheName;Tl&&setTimeout(function(){gm(Em,{currentStep:gr,previousStep:Qi,previousSteps:lt,renderedSteps:Tt})},300)}),Hr(bt(bt(re)),"handleEnd",function(){var be=re.props.handleEnd;if(be){for(var ke=re.state.previousSteps,Ue=ke.map(function(ti){return{id:ti.id,message:ti.message,value:ti.value,metadata:ti.metadata}}),ze=[],lt=0,Tt=ke.length;lt<Tt;lt+=1){var vt=ke[lt],mn=vt.id,gr=vt.message,Qi=vt.value,Go=vt.metadata;ze[mn]={id:mn,message:gr,value:Qi,metadata:Go}}be({renderedSteps:Ue,steps:ze,values:ke.filter(function(ti){return ti.value}).map(function(ti){return ti.value})})}}),Hr(bt(bt(re)),"isInputValueEmpty",function(){var be=re.state.inputValue;return!be||be.length===0}),Hr(bt(bt(re)),"isLastPosition",function(be){var ke=re.state.renderedSteps,Ue=ke.length,ze=ke.map(function(Tt){return Tt.key}).indexOf(be.key);if(Ue<=1||ze+1===Ue)return!0;var lt=ke[ze+1];return!lt.message&&!lt.asMessage||be.user!==lt.user}),Hr(bt(bt(re)),"isFirstPosition",function(be){var ke=re.state.renderedSteps,Ue=ke.map(function(lt){return lt.key}).indexOf(be.key);if(Ue===0)return!0;var ze=ke[Ue-1];return!ze.message&&!ze.asMessage||be.user!==ze.user}),Hr(bt(bt(re)),"handleKeyPress",function(be){be.key==="Enter"&&re.submitUserMessage()}),Hr(bt(bt(re)),"handleSubmitButton",function(){var be=re.state,ke=be.speaking,Ue=be.recognitionEnable;if((re.isInputValueEmpty()||ke)&&Ue)return re.recognition.speak(),void(ke||re.setState({speaking:!0}));re.submitUserMessage()}),Hr(bt(bt(re)),"submitUserMessage",function(){var be=re.state,ke=be.defaultUserSettings,Ue=be.inputValue,ze=be.previousSteps,lt=be.renderedSteps,Tt=re.state.currentStep;Tt.validator&&re.checkInvalidInput()||(Tt=qn({},ke,Tt,{message:Ue,value:Ue}),lt.push(Tt),ze.push(Tt),re.setState({currentStep:Tt,renderedSteps:lt,previousSteps:ze,disabled:!0,inputValue:""},function(){re.input&&re.input.blur()}))}),Hr(bt(bt(re)),"checkInvalidInput",function(){var be=re.props.enableMobileAutoFocus,ke=re.state,Ue=ke.currentStep,ze=ke.inputValue,lt=Ue.validator(ze),Tt=ze;return(typeof lt!="boolean"||!lt)&&(re.setState({inputValue:lt.toString(),inputInvalid:!0,disabled:!0},function(){setTimeout(function(){re.setState({inputValue:Tt,inputInvalid:!1,disabled:!1},function(){!be&&Wo()||re.input&&re.input.focus()})},2e3)}),!0)}),Hr(bt(bt(re)),"toggleChatBot",function(be){var ke=re.props.toggleFloating;ke?ke({opened:be}):re.setState({opened:be})}),Hr(bt(bt(re)),"renderStep",function(be,ke){var Ue=re.state.renderedSteps,ze=re.props,lt=ze.avatarStyle,Tt=ze.bubbleStyle,vt=ze.bubbleOptionStyle,mn=ze.customStyle,gr=ze.hideBotAvatar,Qi=ze.hideUserAvatar,Go=ze.speechSynthesis,ti=be.options,Rs=be.component,gn=be.asMessage,Zi=re.generateRenderedStepsById(),eo=ke>0?Ue[ke-1]:{};return Rs&&!gn?c.a.createElement(P,{key:ke,speak:re.speak,step:be,steps:Zi,style:mn,previousStep:eo,previousValue:eo.value,triggerNextStep:re.triggerNextStep}):ti?c.a.createElement(Ze,{key:ke,step:be,speak:re.speak,previousValue:eo.value,triggerNextStep:re.triggerNextStep,bubbleOptionStyle:vt}):c.a.createElement(ws,{key:ke,step:be,steps:Zi,speak:re.speak,previousStep:eo,previousValue:eo.value,triggerNextStep:re.triggerNextStep,avatarStyle:lt,bubbleStyle:Tt,hideBotAvatar:gr,hideUserAvatar:Qi,speechSynthesis:Go,isFirst:re.isFirstPosition(be),isLast:re.isLastPosition(be)})}),re.content=null,re.input=null,re.supportsScrollBehavior=!1,re.setContentRef=function(be){re.content=be},re.setInputRef=function(be){re.input=be},re.state={renderedSteps:[],previousSteps:[],currentStep:{},previousStep:{},steps:{},disabled:!0,opened:ye.opened||!ye.floating,inputValue:"",inputInvalid:!1,speaking:!1,recognitionEnable:ye.recognitionEnable&&Rn.isSupported(),defaultUserSettings:{}},re.speak=Cs(ye.speechSynthesis),re}var Q,Se,$e;return function(ye,re){if(typeof re!="function"&&re!==null)throw new TypeError("Super expression must either be null or a function");ye.prototype=Object.create(re&&re.prototype,{constructor:{value:ye,writable:!0,configurable:!0}}),re&&Or(ye,re)}(B,a.Component),Q=B,$e=[{key:"getDerivedStateFromProps",value:function(ye,re){var Xe=ye.opened;return ye.toggleFloating!==void 0&&Xe!==void 0&&Xe!==re.opened?function(At){for(var be=1;be<arguments.length;be++){var ke=arguments[be]!=null?arguments[be]:{},Ue=Object.keys(ke);typeof Object.getOwnPropertySymbols=="function"&&(Ue=Ue.concat(Object.getOwnPropertySymbols(ke).filter(function(ze){return Object.getOwnPropertyDescriptor(ke,ze).enumerable}))),Ue.forEach(function(ze){Hr(At,ze,ke[ze])})}return At}({},re,{opened:Xe}):re}}],(Se=[{key:"componentDidMount",value:function(){for(var ye=this,re=this.props.steps,Xe=this.props,At=Xe.botDelay,be=Xe.botAvatar,ke=Xe.cache,Ue=Xe.cacheName,ze=Xe.customDelay,lt=Xe.enableMobileAutoFocus,Tt=Xe.userAvatar,vt={},mn={delay:At,avatar:be},gr={delay:Xe.userDelay,avatar:Tt,hideInput:!1},Qi={delay:ze},Go=0,ti=re.length;Go<ti;Go+=1){var Rs=re[Go],gn={};Rs.user?gn=gr:Rs.message||Rs.asMessage?gn=mn:Rs.component&&(gn=Qi),vt[Rs.id]=qn({},gn,Sh.parse(Rs))}Sh.checkInvalidIds(vt);var Zi=re[0];if(Zi.message){var eo=Zi.message;Zi.message=typeof eo=="function"?eo():eo,vt[Zi.id].message=Zi.message}var Oh=this.state.recognitionEnable,Nh=this.props.recognitionLang;Oh&&(this.recognition=new Rn(this.onRecognitionChange,this.onRecognitionEnd,this.onRecognitionStop,Nh)),this.supportsScrollBehavior="scrollBehavior"in document.documentElement.style,this.content&&(this.content.addEventListener("DOMNodeInserted",this.onNodeInserted),window.addEventListener("resize",this.onResize));var Tl=function(kh,ev){var bm=kh.cacheName,yT=kh.cache,vT=kh.firstStep,Kd=kh.steps,ET=vT,u1=[Kd[ET.id]],h1=[Kd[ET.id]],p2=localStorage.getItem(bm);if(yT&&p2)try{var go=Object(xc.parse)(p2),f2=go.renderedSteps[go.renderedSteps.length-1];if(!f2||!f2.end){for(var Ph=0,p1=go.renderedSteps.length;Ph<p1;Ph+=1){var m2=go.renderedSteps[Ph];if(go.renderedSteps[Ph].delay=0,go.renderedSteps[Ph].rendered=!0,m2.component){var f1=m2.id;go.renderedSteps[Ph].component=Kd[f1].component}}var _T=go.currentStep,m1=_T.trigger,g1=_T.end,bT=_T.options,g2=go.currentStep.id;if(bT&&delete go.currentStep.rendered,!m1&&!g1)if(bT)for(var tv=0;tv<bT.length;tv+=1)go.currentStep.options[tv].trigger=Kd[g2].options[tv].trigger;else go.currentStep.trigger=Kd[g2].trigger;return go.currentStep.user&&ev(),go}localStorage.removeItem(bm)}catch(y1){console.info("Unable to parse cache named:".concat(bm,`. 
The cache where probably created with an older version of react-simple-chatbot.
`),y1)}return{currentStep:ET,previousStep:{},previousSteps:h1,renderedSteps:u1}}({cacheName:Ue,cache:ke,firstStep:Zi,steps:vt},function(){ye.setState({disabled:!1},function(){!lt&&Wo()||ye.input&&ye.input.focus()})}),Em=Tl.currentStep,_m=Tl.previousStep,mT=Tl.previousSteps,gT=Tl.renderedSteps;this.setState({currentStep:Em,defaultUserSettings:gr,previousStep:_m,previousSteps:mT,renderedSteps:gT,steps:vt})}},{key:"componentWillUnmount",value:function(){this.content&&(this.content.removeEventListener("DOMNodeInserted",this.onNodeInserted),window.removeEventListener("resize",this.onResize))}},{key:"render",value:function(){var ye=this,re=this.state,Xe=re.currentStep,At=re.disabled,be=re.inputInvalid,ke=re.inputValue,Ue=re.opened,ze=re.renderedSteps,lt=re.speaking,Tt=re.recognitionEnable,vt=this.props,mn=vt.className,gr=vt.contentStyle,Qi=vt.floating,Go=vt.floatingIcon,ti=vt.floatingStyle,Rs=vt.footerStyle,gn=vt.headerComponent,Zi=vt.headerTitle,eo=vt.hideHeader,Oh=vt.hideSubmitButton,Nh=vt.inputStyle,Tl=vt.placeholder,Em=vt.inputAttributes,_m=vt.recognitionPlaceholder,mT=vt.style,gT=vt.submitButtonStyle,kh=vt.width,ev=vt.height,bm=gn||c.a.createElement(fT,{className:"rsc-header"},c.a.createElement(Ch,{className:"rsc-header-title"},Zi),Qi&&c.a.createElement(Gd,{className:"rsc-header-close-button",onClick:function(){return ye.toggleChatBot(!1)}},c.a.createElement(tr,null))),yT=(this.isInputValueEmpty()||lt)&&Tt?c.a.createElement(ji,null):c.a.createElement(Mi,null),vT=lt?_m:Xe.placeholder||Tl,Kd=Xe.inputAttributes||Em;return c.a.createElement("div",{className:"rsc ".concat(mn)},Qi&&c.a.createElement(Jy,{className:"rsc-float-button",style:ti,opened:Ue,onClick:function(){return ye.toggleChatBot(!0)}},typeof Go=="string"?c.a.createElement(Ah,{src:Go}):Go),c.a.createElement(hT,{className:"rsc-container",floating:Qi,floatingStyle:ti,opened:Ue,style:mT,width:kh,height:ev},!eo&&bm,c.a.createElement(pT,{className:"rsc-content",ref:this.setContentRef,floating:Qi,style:gr,height:ev,hideInput:Xe.hideInput},ze.map(this.renderStep)),c.a.createElement(bl,{className:"rsc-footer",style:Rs},!Xe.hideInput&&c.a.createElement(It,qn({type:"textarea",style:Nh,ref:this.setInputRef,className:"rsc-input",placeholder:be?"":vT,onKeyPress:this.handleKeyPress,onChange:this.onValueChange,value:ke,floating:Qi,invalid:be,disabled:At,hasButton:!Oh},Kd)),!Xe.hideInput&&!Oh&&c.a.createElement(mr,{className:"rsc-submit-button",style:gT,onClick:this.handleSubmitButton,invalid:be,disabled:At,speaking:lt},yT))))}}])&&Oc(Q.prototype,Se),$e&&Oc(Q,$e),B}();Yn.propTypes={avatarStyle:d.a.objectOf(d.a.any),botAvatar:d.a.string,botDelay:d.a.number,bubbleOptionStyle:d.a.objectOf(d.a.any),bubbleStyle:d.a.objectOf(d.a.any),cache:d.a.bool,cacheName:d.a.string,className:d.a.string,contentStyle:d.a.objectOf(d.a.any),customDelay:d.a.number,customStyle:d.a.objectOf(d.a.any),enableMobileAutoFocus:d.a.bool,enableSmoothScroll:d.a.bool,floating:d.a.bool,floatingIcon:d.a.oneOfType([d.a.string,d.a.element]),floatingStyle:d.a.objectOf(d.a.any),footerStyle:d.a.objectOf(d.a.any),handleEnd:d.a.func,headerComponent:d.a.element,headerTitle:d.a.string,height:d.a.string,hideBotAvatar:d.a.bool,hideHeader:d.a.bool,hideSubmitButton:d.a.bool,hideUserAvatar:d.a.bool,inputAttributes:d.a.objectOf(d.a.any),inputStyle:d.a.objectOf(d.a.any),opened:d.a.bool,toggleFloating:d.a.func,placeholder:d.a.string,recognitionEnable:d.a.bool,recognitionLang:d.a.string,recognitionPlaceholder:d.a.string,speechSynthesis:d.a.shape({enable:d.a.bool,lang:d.a.string,voice:typeof window<"u"?d.a.instanceOf(window.SpeechSynthesisVoice):d.a.any}),steps:d.a.arrayOf(d.a.object).isRequired,style:d.a.objectOf(d.a.any),submitButtonStyle:d.a.objectOf(d.a.any),userAvatar:d.a.string,userDelay:d.a.number,width:d.a.string},Yn.defaultProps={avatarStyle:{},botDelay:1e3,bubbleOptionStyle:{},bubbleStyle:{},cache:!1,cacheName:"rsc_cache",className:"",contentStyle:{},customStyle:{},customDelay:1e3,enableMobileAutoFocus:!1,enableSmoothScroll:!1,floating:!1,floatingIcon:c.a.createElement(Ur,null),floatingStyle:{},footerStyle:{},handleEnd:void 0,headerComponent:void 0,headerTitle:"Chat",height:"520px",hideBotAvatar:!1,hideHeader:!1,hideSubmitButton:!1,hideUserAvatar:!1,inputStyle:{},opened:void 0,placeholder:"Type the message ...",inputAttributes:{},recognitionEnable:!1,recognitionLang:"en",recognitionPlaceholder:"Listening ...",speechSynthesis:{enable:!1,lang:"en",voice:null},style:{},submitButtonStyle:{},toggleFloating:void 0,userDelay:1e3,width:"350px",botAvatar:"data:image/svg+xml,%3csvg version='1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3e%3cpath d='M303 70a47 47 0 1 0-70 40v84h46v-84c14-8 24-23 24-40z' fill='%2393c7ef'/%3e%3cpath d='M256 23v171h23v-84a47 47 0 0 0-23-87z' fill='%235a8bb0'/%3e%3cpath fill='%2393c7ef' d='M0 240h248v124H0z'/%3e%3cpath fill='%235a8bb0' d='M264 240h248v124H264z'/%3e%3cpath fill='%2393c7ef' d='M186 365h140v124H186z'/%3e%3cpath fill='%235a8bb0' d='M256 365h70v124h-70z'/%3e%3cpath fill='%23cce9f9' d='M47 163h419v279H47z'/%3e%3cpath fill='%2393c7ef' d='M256 163h209v279H256z'/%3e%3cpath d='M194 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%233c5d76'/%3e%3cpath d='M380 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%231e2e3b'/%3e%3cpath d='M186 349a70 70 0 1 0 140 0H186z' fill='%233c5d76'/%3e%3cpath d='M256 349v70c39 0 70-31 70-70h-70z' fill='%231e2e3b'/%3e%3c/svg%3e",userAvatar:"data:image/svg+xml,%3csvg viewBox='-208.5 21 100 100' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3ccircle cx='-158.5' cy='71' fill='%23F5EEE5' r='50'/%3e%3cdefs%3e%3ccircle cx='-158.5' cy='71' id='a' r='50'/%3e%3c/defs%3e%3cclipPath id='b'%3e%3cuse overflow='visible' xlink:href='%23a'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23b)' d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' fill='%23E6C19C'/%3e%3cg clip-path='url(%23b)'%3e%3cdefs%3e%3cpath d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' id='c'/%3e%3c/defs%3e%3cclipPath id='d'%3e%3cuse overflow='visible' xlink:href='%23c'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23d)' d='M-158.5 100.1c12.7 0 23-18.6 23-34.4 0-16.2-10.3-24.7-23-24.7s-23 8.5-23 24.7c0 15.8 10.3 34.4 23 34.4z' fill='%23D4B08C'/%3e%3c/g%3e%3cpath d='M-158.5 96c12.7 0 23-16.3 23-31 0-15.1-10.3-23-23-23s-23 7.9-23 23c0 14.7 10.3 31 23 31z' fill='%23F2CEA5'/%3e%3c/svg%3e"};var Pt=Yn;s.d(o,"Loading",function(){return V}),o.default=Pt}])})})(tq);var c_e=tq.exports;const l_e=Pa(c_e);function d_e(){const e=[{id:"0",message:"Hey Geek!",trigger:"1"},{id:"1",message:"Please write your username",trigger:"2"},{id:"2",user:!0,trigger:"3"},{id:"3",message:" hi {previousValue}, how can I help you?",trigger:4},{id:"4",options:[{value:1,label:"View Courses"},{value:2,label:"Read Articles"}],end:!0}],t={botAvatar:"/logo.png"};return h.jsx("div",{children:h.jsx(l_e,{steps:e,...t})})}function u_e(){const[e,t]=T.useState(!1);return h.jsxs("div",{className:"homePage w-full h-full",id:"id_patientDashboard",children:[h.jsx("div",{className:"header bg-white w-full h-[12vh] shadow-lg ",children:h.jsx(_P,{})}),h.jsx("div",{className:"w-full h-full p-4 ",children:h.jsx(po,{})}),h.jsx("div",{className:"chatBot fixed w-auto h-auto right-2 bottom-0",children:e?h.jsxs("div",{className:"flex gap-6 items-start ",children:[h.jsx("div",{children:h.jsx(d_e,{})}),h.jsx("button",{className:"px-6 py-3 bg-red-500 text-white font-medium rounded-tl-2xl",onClick:()=>t(!1),children:"Close"})]}):h.jsxs("div",{className:"relative w-auto h-[15vh]  right-10 bottom-0 flex flex-row gap-2",children:[h.jsx("img",{src:"/doctorBot.jpg",alt:"chatbot",className:" z-100 shadow-lg rounded-full w-[5vw] h-[10vh] cursor-pointer",onClick:()=>t(!0)}),h.jsx("span",{className:"h-[40%] p-2 rounded-tl-2xl  text-white font-medium bg-blue-500  ",children:"Hey, i'm an Ai Doctor..!!"})]})})]})}const h_e="http://localhost:5000/api",p_e=async({token:e})=>{try{const t=await Ce.get(`${h_e}/pharmacy/getBasicDetails`,{headers:{authorization:`Bearer ${e}`}});return console.log(t.data),t.data.userData}catch(t){t.response.status=="401"&&oe.fire({html:`<b>${t.response.status.message}</b>`,title:"Session Out"}),console.log(t)}};function f_e(){const e=zf(),{username:t,email:r,role:n,isLoggedIn:i}=lo(a=>a.user),o=Ln(),s=async()=>{if(sessionStorage.getItem("token")&&!i){const a=await p_e({token:sessionStorage.getItem("token")});e(Xs({username:a.username,email:a.email,role:a.role,isLoggedIn:!0}))}};return T.useEffect(()=>{s()},[]),h.jsx("div",{className:"navbarParent h-full w-full ",children:h.jsxs("div",{className:"navbar w-full h-full flex flex-col rounded-tr-[3%] bg-blue-600 bg-opacity-90 p-4 gap-10 ",children:[h.jsxs("div",{className:"w-full h-[8vh] flex justify-start items-center gap-4 ",children:[h.jsx("img",{src:"/icons/arrowBack.png",alt:"",className:"h-[5vh] w-[] p-2 ml-2 bg-white  rounded-lg"}),h.jsx("h2",{className:"text-white text-sm",children:"Minimize"}),h.jsx("div",{className:"flex-1 h-full flex justify-end items-center",children:h.jsx("img",{src:"/logo.png",alt:"",className:"w-[7vw] h-[7vh] bg-white mr-4"})})]}),h.jsxs("div",{className:"profile h-[12%] flex flex-row justify-start gap-4",children:[h.jsx("div",{className:"profileImage w-auto h-full flex ",children:h.jsx("img",{src:"/normalUser.png",alt:"image",className:"h-full w-[5vw] rounded-full "})}),h.jsxs("div",{className:"details flex-1 flex flex-col justify-center bg-white bg-opacity-10 p-2 rounded-lg gap-2 ",children:[h.jsx("span",{children:h.jsx("h2",{className:"text-white text-lg font-bold",children:t})}),h.jsx("span",{children:h.jsx("h2",{className:"text-white text-sm",children:"pharmacy"})})]})]}),h.jsx("div",{className:"search w-full h-[5%]",children:h.jsx(Je,{variant:"filled",name:"search",placeholder:"search",className:"h-full"})}),h.jsxs("div",{className:"home w-full text-white h-[80%] flex flex-col gap-4 border-slate-50",children:[h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-10 ",children:[h.jsx("img",{src:"/icons/pharmacyHome.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{o("/pharmacy/home")},children:"Home"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-10 ",children:[h.jsx("img",{src:"/icons/stock.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",id:"id_navMedicineStock",onClick:()=>{o("/pharmacy/stock/viewStocks")},children:"Medicine Stock"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-10 ",children:[h.jsx("img",{src:"/icons/pharmacyOrder.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{o("/pharmacy/order")},children:"Orders"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-10 ",children:[h.jsx("img",{src:"/icons/profileIcon.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{o("/pharmacy/profile")},children:"Profile"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-10 ",children:[h.jsx("img",{src:"/icons/logout.png",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{sessionStorage.removeItem("token"),e(Xs({})),o("/")},children:"sign out"})]})]})]})})}function bq(){const e=Ln();return h.jsxs("div",{className:"w-full h-[12vh] py-2 flex flex-row justify-end gap-20  px-10 ",children:[h.jsx("div",{className:"w-[15%] h-full",children:h.jsx("button",{className:"w-full h-full p-4 font-bold rounded-sm flex items-center  bg-green-400  drop-shadow-xl",onClick:()=>{e("/pharmacy/stock/addCategory")},children:"Add New Stock"})}),h.jsx("div",{className:"w-[15%] h-full",children:h.jsx("button",{className:"w-full h-full p-4 font-bold rounded-sm flex items-center  bg-orange-500  drop-shadow-xl",id:"id_btnViewStock",onClick:()=>{e("/pharmacy/stock/viewStocks")},children:"View Stock"})})]})}const m_e=async()=>{try{const e=await Ce.get("https://rxnav.nlm.nih.gov/REST/allconcepts.json?tty=SCD+GPCK+SBD+BPCK");return console.log(e.data.minConceptGroup.minConcept[0]),e.data.minConceptGroup.minConcept}catch(e){console.log(e)}},g_e=fo().shape({medicineName:kt().required("Required"),description:kt().required("required"),costPrice:kt(),sellingPrice:kt().required("required"),medicineType:kt().required("required"),medicineImage:nW().required("required")}),y_e=fo().shape({medicineName:kt().required("Required"),description:kt().required("required"),costPrice:kt().required("required"),sellingPrice:kt().required("required"),medicineType:kt().required("required")}),Ay="http://localhost:5000/api",v_e=async e=>{try{const t=await Ce.post(`${Ay}/pharmacy/medicine/add`,e,{headers:{"Content-Type":"multipart/form-data",authorization:`Bearer ${sessionStorage.getItem("token")}`}});return console.log(t.data),oe.fire({icon:"success",text:"Successfully Added"}),t.data.medicineDetails}catch(t){console.log(t),t.response.status=="500"&&oe.fire({icon:"error",text:"Encountered an Error on the backend"})}},E_e=async()=>{try{const e=await Ce.get(`${Ay}/pharmacy/medicine/viewStocks`,{headers:{"Content-Type":"multipart/form-data",authorization:`Bearer ${sessionStorage.getItem("token")}`}});return console.log(e.data),e.data.medicines}catch(e){console.log(e),e.response.status=="500"&&oe.fire({icon:"error",text:"Encountered an Error on the backend"})}},__e=async({inventoryId:e})=>{try{const t=await Ce.post(`${Ay}/pharmacy/medicine/deleteStock`,{inventoryId:e},{headers:{authorization:`Bearer ${sessionStorage.getItem("token")}`}});return console.log(t.data),oe.fire({icon:"success",text:"Medicine has been Deleted"}),!0}catch(t){console.log(t),t.response.status=="400"&&oe.fire({icon:"error",text:"Medicine Not Found"}),t.response.status=="500"&&oe.fire({icon:"error",text:"Encountered an Error on the backend"})}},b_e=async({inventoryId:e})=>{try{console.log(e);const t=await Ce.post(`${Ay}/pharmacy/medicine/viewDetails`,{inventoryId:e},{headers:{authorization:`Bearer ${sessionStorage.getItem("token")}`}});return console.log(t.data),t.data.medicine}catch(t){console.log(t),t.response.status=="500"&&oe.fire({icon:"error",text:"Encountered an Error on the backend"})}},w_e=async({medicine:e})=>{try{await console.log(e);const t=await Ce.post(`${Ay}/pharmacy/medicine/updateStock`,e,{headers:{"Content-Type":"multipart/form-data",authorization:`Bearer ${sessionStorage.getItem("token")}`}});return oe.fire({icon:"success",text:"Medicine has been Updated"}),console.log(t.data),t.data.updated}catch(t){console.log(t)}};function S_e(){const[e,t]=T.useState([]),r=Ln(),n=Yi({initialValues:{medicineName:"",description:"",costPrice:"",sellingPrice:"",medicineType:"",medicineImage:""},validationSchema:g_e,onSubmit:async(s,a)=>{console.log(`values ${JSON.stringify(s)}`),await v_e(s)&&r("/pharmacy/home")}}),i=async()=>{const s=await m_e();console.log(`${JSON.stringify(s)}`),await t(s)},o=(s,a)=>{try{const c=s.target.files[0];n.setFieldValue("medicineImage",c)}catch(c){console.log(c)}};return T.useEffect(()=>{i()},[]),console.log(n.errors),h.jsx("div",{className:"screen w-full h-full flex flex-row",children:h.jsx("div",{style:{backgroundImage:"url('/icons/pharmacyBg.jpg')",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"},className:"w-full h-full flex flex-1 flex-col gap-4",children:h.jsxs("div",{className:"w-full h-full overflow-y-scroll pt-4 flex flex-1 flex-col gap-4 bg-black bg-opacity-70",children:[h.jsx(bq,{}),h.jsx("div",{className:"addForm flex justify-center w-full h-[100%] mt-10 mb-[5vh]",children:h.jsxs("form",{onSubmit:n.handleSubmit,className:"w-[40%] h-[100%] p-4 flex flex-col gap-6 border shadow-xl bg-white",children:[h.jsx("span",{children:h.jsx("h1",{className:"font-bold text-xl text-emerald-500",children:"New Medicine"})}),h.jsx(Je,{list:"medicines",variant:"filled",name:"medicineName",placeholder:"medicine name",onChange:n.handleChange,onBlur:n.handleBlur,...n.touched.medicineName&&(n.errors.medicineName?{color:"error",helperText:`${n.errors.medicineName}`}:{color:"success"})}),h.jsx("div",{children:h.jsx("datalist",{id:"medicines",children:e&&e.length>0?e.map((s,a)=>h.jsx("option",{value:s.name},a)):h.jsx("option",{value:"No Medicines Available"})})}),h.jsx(Je,{variant:"filled",name:"medicineType",placeholder:"medicineType",onChange:n.handleChange,onBlur:n.handleBlur,...n.touched.medicineType&&(n.errors.medicineType?{color:"error",helperText:`${n.errors.medicineType}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"description",placeholder:"description",onChange:n.handleChange,onBlur:n.handleBlur,...n.touched.description&&(n.errors.description?{color:"error",helperText:`${n.errors.description}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"costPrice",placeholder:"cost price",onChange:n.handleChange,onBlur:n.handleBlur,...n.touched.costPrice&&(n.errors.costPrice?{color:"error",helperText:`${n.errors.costPrice}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"sellingPrice",placeholder:"selling price",onChange:n.handleChange,onBlur:n.handleBlur,...n.touched.sellingPrice&&(n.errors.sellingPrice?{color:"error",helperText:`${n.errors.sellingPrice}`}:{color:"success"})}),h.jsx("div",{children:h.jsx(Ty,{id:"id_medicineImage",accept:"image/jpeg, image/png",name:"medicineImage",helperText:"Upload Image",onChange:o,onBlur:n.handleBlur,...n.touched.medicineImage&&(n.errors.medicineImage?{color:"error",helperText:`${n.errors.medicineImage}`}:{color:"success"})})}),h.jsx("button",{type:"submit",className:"w-[full] h-[10%] border rounded-[5%] bg-orange-500 p-2 font-bold",children:"Add Medicine to the Inventory"})]})})]})})})}function T_e(){const[e,t]=T.useState([]),r=async()=>{const n=await E_e();await t(n)};return T.useEffect(()=>{r()},[]),h.jsxs("div",{className:"stockViewScreen w-full h-full p-2 flex flex-col gap-10 overflow-y-scroll",children:[h.jsx(bq,{}),h.jsxs("div",{className:"w-full h-full mt-20 flex flex-col gap-2",children:[h.jsx("div",{className:"heading w-full  ml-20 mb-10  text-lg text-emerald-400 font-bold flex",children:h.jsx("h2",{children:"Medicine Stocks"})}),e&&e.length>0?h.jsx(C_e,{medicines:e}):h.jsx("span",{className:"w-full h-[70%] mb-10 text-xl font-bold flex flex-1 justify-center items-center ",children:"No medicine Stock.....!!!"})]})]})}function C_e(e){const t=Ln(),r=async(i,o)=>{console.log(o),await __e({inventoryId:o}),t("/pharmacy/stock/viewStocks")},{medicines:n}=e;return h.jsx("div",{className:"w-full h-full mb-10 flex flex-1 justify-center ",children:h.jsxs(ur,{hoverable:!0,className:"w-full gap-x-10 ",children:[h.jsxs(ur.Head,{className:"gap-x-72",children:[h.jsx(ur.HeadCell,{children:"Medicine Name"}),h.jsx(ur.HeadCell,{children:"Description"}),h.jsx(ur.HeadCell,{children:"Type"}),h.jsx(ur.HeadCell,{children:"Stock"}),h.jsx(ur.HeadCell,{children:"cost price"}),h.jsx(ur.HeadCell,{children:"selling price"}),h.jsx(ur.HeadCell,{children:"Image"}),h.jsx(ur.HeadCell,{}),h.jsx(ur.HeadCell,{})]}),h.jsx(ur.Body,{className:"font-bold",children:n.map((i,o)=>h.jsxs(ur.Row,{className:"border-b-4",id:`id_${o}`,children:[h.jsx(ur.Cell,{children:i.medicineId.medicineName}),h.jsx(ur.Cell,{children:i.medicineId.description}),h.jsx(ur.Cell,{children:i.medicineId.medicineType}),h.jsx(ur.Cell,{children:i.stock}),h.jsx(ur.Cell,{children:i.costPrice}),h.jsx(ur.Cell,{children:i.sellingPrice}),h.jsx(ur.Cell,{children:h.jsx("img",{className:"h-14",src:i.medicineImage,alt:"productImage"})}),h.jsx(ur.Cell,{children:h.jsx("img",{className:"h-8 cursor-pointer",src:"/icons/editIcon.png",alt:"editIcon",id:`id_navEdit_${o}`,onClick:()=>{t("/pharmacy/stock/editStock",{state:{inventoryId:i._id}})}})}),h.jsx(ur.Cell,{children:h.jsx("img",{className:"h-8 cursor-pointer opacity-70",src:"/icons/deleteIcon.png",alt:"editIcon",id:`id_btnDelete_${o}`,onClick:s=>{r(s,i._id)}})})]},i._id))})]})})}function R_e(){return h.jsxs("div",{className:"screen w-screen h-screen flex flex-row",children:[h.jsx("div",{className:"fixed header w-[21%] h-[100vh] ",children:h.jsx(f_e,{})}),h.jsx("div",{className:"contentPage relative w-[79%] ml-[21vw] right-[0] h-full flex flex-1 flex-col gap-4 overflow-y-auto",children:h.jsx(po,{})})]})}function I_e(){const[e,t]=T.useState(void 0),[r,n]=T.useState(void 0),i=Yi({initialValues:{medicineName:"",description:"",costPrice:"",stock:"",sellingPrice:"",medicineType:"",medicineImage:""},validationSchema:y_e,onSubmit:async(d,u)=>{await w_e({medicine:{...d,inventoryId:s}}),await a()}}),o=Uf(),{inventoryId:s}=o.state,a=async()=>{const d=await b_e({inventoryId:s});console.log(`temp ${JSON.stringify(d)}`),i.setFieldValue("medicineName",d.medicineId.medicineName),i.setFieldValue("description",d.medicineId.description),i.setFieldValue("medicineType",d.medicineId.medicineType),i.setFieldValue("costPrice",d.costPrice),i.setFieldValue("sellingPrice",d.sellingPrice),i.setFieldValue("medicineImage",d.medicineImage),i.setFieldValue("stock",d.stock),await t(d)},c=async d=>{const u=d.target.files[0],p=new FileReader(u);p.onload=f=>{const m=f.target.result;n(m),i.setFieldValue("medicineImage",u)},p.readAsDataURL(u)},l=d=>{console.log(parseFloat(d.target.value)+1);const u=(100+parseFloat(d.target.value))/100*parseFloat(i.values.costPrice);i.setFieldValue("sellingPrice",u.toFixed(2))};return T.useEffect(()=>{a()},[]),h.jsxs("div",{className:"w-full h-full overflow-y-auto pl-4 pt-5",children:[h.jsx("div",{className:"w-full h-[10%] text-center",children:h.jsx("h2",{className:"text-[5vh] text-emerald-400 font-bold",children:"Medicine Details"})}),h.jsxs("div",{className:"w-full h-full mt-10 flex justify-center gap-10",children:[h.jsxs("form",{onSubmit:i.handleSubmit,className:"w-[50%] flex flex-col gap-5 font-bold",children:[h.jsx(Je,{variant:"filled",name:"medicineName",label:"Medicine Name",value:i.values.medicineName,onChange:i.handleChange,onBlur:i.handleBlur,...i.touched.medicineName&&(i.errors.medicineName?{color:"error",helperText:`${i.errors.medicineName}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"description",label:"Description",value:i.values.description,onChange:i.handleChange,onBlur:i.handleBlur,...i.touched.description&&(i.errors.description?{color:"error",helperText:`${i.errors.description}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"MedicineType",label:"Medicine Type",value:i.values.medicineType,onChange:i.handleChange,onBlur:i.handleBlur,...i.touched.medicineType&&(i.errors.medicineType?{color:"error",helperText:`${i.errors.medicineType}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"stock",label:"Stock",type:"number",value:i.values.stock,onChange:i.handleChange,onBlur:i.handleBlur,...i.touched.stock&&(i.errors.stock?{color:"error",helperText:`${i.errors.stock}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"margin",label:"Margin %",onChange:l}),h.jsx(Je,{variant:"filled",name:"costPrice",label:"Cost Price",value:i.values.costPrice,onChange:i.handleChange,onBlur:i.handleBlur,...i.touched.costPrice&&(i.errors.costPrice?{color:"error",helperText:`${i.errors.costPrice}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"sellingPrice",label:"Selling Price",value:i.values.sellingPrice,onChange:i.handleChange,onBlur:i.handleBlur,...i.touched.sellingPrice&&(i.errors.sellingPrice?{color:"error",helperText:`${i.errors.sellingPrice}`}:{color:"success"})}),h.jsx("button",{type:"submit",className:"w-[full] h-[5vh] border rounded-[5%] bg-orange-500 p-2",children:"Save Details"})]}),h.jsxs("div",{className:"medicineImage w-[30%] flex flex-col gap-10 h-[60%]",children:[h.jsx("img",{src:r||i.values.medicineImage,alt:"medicineImage",className:"h-[70%] w-[70%] shadow-2xl"}),h.jsx("div",{children:h.jsx(Ty,{helperText:"upload image",id:"id_medicineImage",name:"medicineImage",onChange:c,onBlur:i.handleBlur,...i.touched.medicineImage&&(i.errors.medicineImage?{color:"error",helperText:`${i.errors.medicineImage}`}:{color:"success"})})})]})]})]})}var wq={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},sU=Sr.createContext&&Sr.createContext(wq),A_e=["attr","size","title"];function x_e(e,t){if(e==null)return{};var r=O_e(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function O_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Lb(){return Lb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lb.apply(this,arguments)}function aU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Mb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aU(Object(r),!0).forEach(function(n){N_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function N_e(e,t,r){return t=k_e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k_e(e){var t=P_e(e,"string");return typeof t=="symbol"?t:t+""}function P_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sq(e){return e&&e.map((t,r)=>Sr.createElement(t.tag,Mb({key:r},t.attr),Sq(t.child)))}function pn(e){return t=>Sr.createElement(D_e,Lb({attr:Mb({},e.attr)},t),Sq(e.child))}function D_e(e){var t=r=>{var{attr:n,size:i,title:o}=e,s=x_e(e,A_e),a=i||r.size||"1em",c;return r.className&&(c=r.className),e.className&&(c=(c?c+" ":"")+e.className),Sr.createElement("svg",Lb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,s,{className:c,style:Mb(Mb({color:e.color||r.color},r.style),e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&Sr.createElement("title",null,o),e.children)};return sU!==void 0?Sr.createElement(sU.Consumer,null,r=>t(r)):t(wq)}function UP(e){return pn({tag:"svg",attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M13.5 0h-12c-0.825 0-1.5 0.675-1.5 1.5v13c0 0.825 0.675 1.5 1.5 1.5h12c0.825 0 1.5-0.675 1.5-1.5v-13c0-0.825-0.675-1.5-1.5-1.5zM13 14h-11v-12h11v12zM4 9h7v1h-7zM4 11h7v1h-7zM5 4.5c0-0.828 0.672-1.5 1.5-1.5s1.5 0.672 1.5 1.5c0 0.828-0.672 1.5-1.5 1.5s-1.5-0.672-1.5-1.5zM7.5 6h-2c-0.825 0-1.5 0.45-1.5 1v1h5v-1c0-0.55-0.675-1-1.5-1z"},child:[]}]})(e)}function L_e(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(e)}function Tq(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z"},child:[]}]})(e)}function M_e(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"},child:[]}]})(e)}function Cq(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17.5 4.5c-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .65.73.45.75.45C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.41.21.75-.19.75-.45V6c-1.49-1.12-3.63-1.5-5.5-1.5zm3.5 14c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5v11.5z"},child:[]}]})(e)}function Rq(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(e)}function Iq(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18 8H20C20.5523 8 21 8.44772 21 9V21C21 21.5523 20.5523 22 20 22H4C3.44772 22 3 21.5523 3 21V9C3 8.44772 3.44772 8 4 8H6V7C6 3.68629 8.68629 1 12 1C15.3137 1 18 3.68629 18 7V8ZM16 8V7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7V8H16ZM11 14V16H13V14H11ZM7 14V16H9V14H7ZM15 14V16H17V14H15Z"},child:[]}]})(e)}function j_e(){return h.jsxs("div",{className:"w-full h-[10vh] px-2 text-center font-bold flex justify-center items-center gap-2 ",children:[h.jsxs(Kr,{className:"options w-[35%] h-[80%] font-bold justify-center items-center p-2 bg-opacity-80 shadow-lg shadow-emerald-200 pl-4 flex items-center gap-5 border  ",to:"/pharmacy/profile/profileDetails ",children:[h.jsx(UP,{className:"h-full w-[5%]"}),h.jsx("span",{className:"flex flex-1",children:"Profile Details"})]}),h.jsxs(Kr,{className:"options w-[35%] h-[80%] font-bold justify-center items-center p-2 bg-opacity-80 shadow-lg shadow-emerald-200 pl-4 flex items-center gap-5 border  ",to:"/pharmacy/profile/contactDetails",children:[h.jsx(Cq,{className:"h-full w-[5%]"}),h.jsx("span",{className:"flex flex-1",children:"Contact Details"})]}),h.jsxs(Kr,{className:"options w-[35%] h-[80%] font-bold justify-center items-center p-2 bg-opacity-80 shadow-lg shadow-emerald-200 pl-4 flex items-center gap-5 border  ",to:"/pharmacy/profile/passwordReset",children:[h.jsx(Iq,{className:"h-full w-[5%]"}),h.jsx("span",{className:"flex flex-1",children:"Password Reset"})]})]})}function U_e(){return h.jsxs("div",{className:"w-full h-full flex flex-col overflow-y-scroll",children:[h.jsx(j_e,{}),h.jsx("div",{className:"w-full h-full mt-5 pb-2",children:h.jsx(po,{})})]})}function Aq(e){return pn({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function xq(e){return pn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.39 361.8l-112-48a24 24 0 0 0-28 6.9l-49.6 60.6A370.66 370.66 0 0 1 130.6 204.11l60.6-49.6a23.94 23.94 0 0 0 6.9-28l-48-112A24.16 24.16 0 0 0 122.6.61l-104 24A24 24 0 0 0 0 48c0 256.5 207.9 464 464 464a24 24 0 0 0 23.4-18.6l24-104a24.29 24.29 0 0 0-14.01-27.6z"},child:[]}]})(e)}function Zf(e){return pn({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M308 96c6.627 0 12-5.373 12-12V44c0-6.627-5.373-12-12-12H12C5.373 32 0 37.373 0 44v44.748c0 6.627 5.373 12 12 12h85.28c27.308 0 48.261 9.958 60.97 27.252H12c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h158.757c-6.217 36.086-32.961 58.632-74.757 58.632H12c-6.627 0-12 5.373-12 12v53.012c0 3.349 1.4 6.546 3.861 8.818l165.052 152.356a12.001 12.001 0 0 0 8.139 3.182h82.562c10.924 0 16.166-13.408 8.139-20.818L116.871 319.906c76.499-2.34 131.144-53.395 138.318-127.906H308c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12h-58.69c-3.486-11.541-8.28-22.246-14.252-32H308z"},child:[]}]})(e)}function F_e(){return h.jsx("div",{className:"w-full h-full flex flex-col justify-center items-center",children:h.jsxs("form",{className:"w-[50%] flex flex-col gap-4",children:[h.jsx("div",{className:"w-full h-[22vh] flex justify-center",children:h.jsx("img",{src:"/normalUser.png",className:"rounded-full w-1/4 shadow-2xl"})}),h.jsx(Je,{variant:"filled",label:"Pharmacy Name",name:"pharmacyName"}),h.jsx(Je,{variant:"filled",label:"Owner Name",name:"ownerName"}),h.jsxs("button",{className:"w-full h-[5vh] border rounded-[5%] bg-emerald-500 p-2 font-bold flex gap-2",children:[h.jsx(Aq,{}),h.jsx("span",{className:"flex flex-1 justify-center",children:"Edit"})]})]})})}function V_e(){return h.jsx("div",{className:"w-full h-full flex flex-col justify-center items-center",children:h.jsxs("form",{className:"w-[50%] flex flex-col gap-4",children:[h.jsx("h2",{className:"font-bold mt-5",children:"Address"}),h.jsx(Je,{variant:"filled",label:"Place",name:"place"}),h.jsx(Je,{variant:"filled",label:"state",name:"state"}),h.jsx(Je,{variant:"filled",label:"Country",name:"country"}),h.jsx(Je,{variant:"filled",label:"pincode",name:"pincode"}),h.jsx("h2",{className:"font-bold mt-5",children:"Phone"}),h.jsx(Je,{variant:"filled",label:"Phone Number",name:"phoneNumber"}),h.jsxs("button",{className:"w-full h-[5vh] border rounded-[5%] bg-emerald-500 p-2 font-bold flex gap-2",children:[h.jsx(Aq,{}),h.jsx("span",{className:"flex flex-1 justify-center",children:"Edit"})]})]})})}function FP(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Edit"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M3.548,20.938h16.9a.5.5,0,0,0,0-1H3.548a.5.5,0,0,0,0,1Z"},child:[]},{tag:"path",attr:{d:"M9.71,17.18a2.587,2.587,0,0,0,1.12-.65l9.54-9.54a1.75,1.75,0,0,0,0-2.47l-.94-.93a1.788,1.788,0,0,0-2.47,0L7.42,13.12a2.473,2.473,0,0,0-.64,1.12L6.04,17a.737.737,0,0,0,.19.72.767.767,0,0,0,.53.22Zm.41-1.36a1.468,1.468,0,0,1-.67.39l-.97.26-1-1,.26-.97a1.521,1.521,0,0,1,.39-.67l.38-.37,1.99,1.99Zm1.09-1.08L9.22,12.75l6.73-6.73,1.99,1.99Zm8.45-8.45L18.65,7.3,16.66,5.31l1.01-1.02a.748.748,0,0,1,1.06,0l.93.94A.754.754,0,0,1,19.66,6.29Z"},child:[]}]}]}]})(e)}function B_e(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Video_On"},child:[{tag:"path",attr:{d:"M21.05,5.05a1.433,1.433,0,0,0-1.48.08L16.25,7.37V6.56a2.5,2.5,0,0,0-2.5-2.5H4.69a2.5,2.5,0,0,0-2.5,2.5V17.44a2.5,2.5,0,0,0,2.5,2.5h9.06a2.5,2.5,0,0,0,2.5-2.5v-.81l3.32,2.24a1.5,1.5,0,0,0,.81.24,1.414,1.414,0,0,0,1.43-1.43V6.32A1.437,1.437,0,0,0,21.05,5.05Zm-5.8,12.39a1.5,1.5,0,0,1-1.5,1.5H4.69a1.5,1.5,0,0,1-1.5-1.5V6.56a1.5,1.5,0,0,1,1.5-1.5h9.06a1.5,1.5,0,0,1,1.5,1.5Zm5.56.24a.415.415,0,0,1-.23.38.425.425,0,0,1-.45-.02l-3.88-2.62V8.58l3.88-2.62a.425.425,0,0,1,.45-.02.415.415,0,0,1,.23.38Z"},child:[]}]}]})(e)}function Oq({username:e}){const{email:t}=lo(n=>n.user),r=Yi({initialValues:{password:"",confirmPassword:""},validationSchema:r9,onSubmit:async(n,i)=>{await Dhe({password:n.password,email:t})&&(await oe.fire({icon:"success",text:"Password has been reset"}),window.location.reload())}});return h.jsx("div",{className:"w-full h-full",children:h.jsxs("form",{onSubmit:r.handleSubmit,className:"w-full h-full flex flex-col gap-6",children:[h.jsx(Je,{variant:"filled",label:"New Password",type:"password",name:"password",onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.password&&(r.errors.password?{color:"error",helperText:`${r.errors.password}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",label:"Confirm Password",type:"password",name:"confirmPassword",onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.confirmPassword&&(r.errors.confirmPassword?{color:"error",helperText:`${r.errors.confirmPassword}`}:{color:"success"})}),h.jsxs("button",{type:"submit",className:"w-full text-lg font-sm border rounded-[5%] bg-orange-500 p-2 flex gap-4 items-center justify-center",children:[h.jsx(FP,{}),"Save"]})]})})}function $_e(){return h.jsx("div",{className:"w-full h-full flex flex-col pt-[15vh] items-center",children:h.jsxs("div",{className:"resetPassword w-[40%] h-fit flex flex-col gap-6 border shadow-lg p-5 ",children:[h.jsx("h1",{className:"text-lg font-medium",children:"Reset Password"}),h.jsx(Oq,{})]})})}function H_e(e){const{medicine:t}=e;return console.log(`medicine ${JSON.stringify(t)}`),h.jsx("div",{className:"w-[18vw] h-full flex flex-col shadow-lg rounded-lg ",children:h.jsxs("div",{className:"h-full w-full flex flex-col ",children:[h.jsx("div",{className:"w-full h-[50%] ",children:h.jsx("img",{src:t.medicineImage,className:"w-full h-full rounded-t-lg"})}),h.jsxs("div",{className:"content w-full h-[50%] flex flex-1 flex-col mt-2 ",children:[h.jsxs("div",{className:"content w-full h-full flex flex-col pl-4 gap-2  ",children:[h.jsx("h1",{className:"w-full flex justify-start font-medium text-md",children:t.medicineId.medicineName}),h.jsx("div",{className:"w-full font-medium flex flex-col gap-4 flex-1 ",children:h.jsx("div",{className:"price w-full h-[5vh]",children:h.jsxs("h1",{className:"w-full h-full flex gap-2 items-center text-xl",children:[h.jsx(Zf,{})," ",t.sellingPrice]})})})]}),h.jsx("div",{className:"w-full h-[10vh] flex  px-2 py-1 mb-2 ",children:h.jsx("button",{className:"w-full h-full  font-medium bg-orange-500  border",children:"Order Medicine"})})]})]})})}const xy="http://localhost:5000/api",VP=sessionStorage.getItem("token"),W_e=async()=>{try{const e=await Ce.get(`${xy}/patient/medicines/getAllMedicines`);return console.log(e),e.data.medicines}catch(e){console.log(e)}},G_e=async({inventoryId:e})=>{try{const t=await Ce.post(`${xy}/patient/medicines/getMedicineDetails`,{inventoryId:e});return console.log(t),t.data.medicine}catch(t){console.log(t)}},z_e=async()=>{try{return(await Ce.get(`${xy}/patient/doctor/medicine/requests`,{headers:{Authorization:`bearer ${VP}`}})).data.medicines}catch(e){return console.log(e),!1}},K_e=async({razorpay_order_id:e,razorpay_payment_id:t,razorpay_signature:r,doctorId:n,order:i,pharmacyId:o,pharmacyInventoryId:s})=>{try{const a=await Ce.post(`${xy}/patient/doctors/medicine/requests/order`,{razorpay_order_id:e,razorpay_payment_id:t,razorpay_signature:r,doctorId:n,order:i,pharmacyId:o,pharmacyInventoryId:s},{headers:{Authorization:`bearer ${VP}`}});return!0}catch(a){return console.log(a),!1}},q_e=async()=>{try{return(await Ce.get(`${xy}/patient/doctors/medicine/requests/ordered`,{headers:{Authorization:`bearer ${VP}`}})).data.medicines}catch(e){return console.log(e),!1}};function Y_e(){const e=Ln(),[t,r]=T.useState([]),n=async()=>{const o=await W_e();o.length>0&&await r(o)},i=async(o,s)=>{e({pathname:"/patient/medicines/medicineDetails",search:`?${Y_({inventoryId:encodeURIComponent(s)})}`})};return T.useEffect(()=>{n()},[]),h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"medicinesList w-full h-full flex flex px-20 py-5 ",children:h.jsx("div",{className:"w-full h-full p-4 grid grid-cols-4 justify-items-center gap-y-10 ",children:t&&t.length>0?t.map((o,s)=>h.jsx("div",{className:"w-auto h-auto flex flex-col cursor-pointer hover:bg-slate-400 rounded-lg",onClick:a=>i(a,o._id),children:h.jsx(H_e,{medicine:o},o._id)},o._id)):h.jsx("span",{className:"text-lg font-medium",children:"No Medicines.....:)"})})})})}function X_e(){const[e,t]=T.useState(void 0),[r,n]=mH(),i=async()=>{const o=await G_e({inventoryId:decodeURIComponent(r.get("inventoryId"))});t(o)};return T.useEffect(()=>{i()},[r]),h.jsx("div",{className:"w-full h-screen flex flex-col",children:h.jsxs("div",{className:"content w-full h-full grid grid-cols-2 justify-items-center gap-8  ",children:[h.jsx("div",{className:"image w-full h-[70vh] mt-2 flex justify-center ml-10   ",children:h.jsx("img",{src:e&&e.medicineImage,alt:"Medicine Image",className:"h-full w-[70%]"})}),h.jsxs("div",{className:"w-full h-full pl-4 grid grid-cols-1 gap-y-4 place-content-center ",children:[h.jsx("div",{className:"",children:h.jsx("pre",{className:"opacity-50 text-medium font-medium",children:`By pharmacy ${e&&e.pharmacyId.userId.username}`})}),h.jsx("h1",{className:"font-sm text-[6vh] text-emerald-400 ",children:e&&e.medicineId.medicineName}),h.jsx("div",{className:"price w-full h-[10vh] ",children:h.jsxs("span",{className:"w-full h-full text-2xl font-medium flex items-center gap-4",children:[h.jsx(Zf,{})," ",e&&e.sellingPrice]})}),h.jsxs("div",{className:"description w-full h-full text-black opacity-60 flex  gap-2 ",children:[h.jsx("h1",{children:"Description : "}),h.jsx("span",{className:"",children:e&&e.medicineId.description})]}),h.jsx("div",{className:"w-full h-[10vh] flex  py-1 mb-2 pr-[40%]",children:h.jsx("button",{className:"w-full h-full  font-medium bg-orange-500  border",children:"Order Medicine"})})]})]})})}function J_e(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M21 2H6a2 2 0 0 0-2 2v3H2v2h2v2H2v2h2v2H2v2h2v3a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zm-8 2.999c1.648 0 3 1.351 3 3A3.012 3.012 0 0 1 13 11c-1.647 0-3-1.353-3-3.001 0-1.649 1.353-3 3-3zM19 18H7v-.75c0-2.219 2.705-4.5 6-4.5s6 2.281 6 4.5V18z"},child:[]}]})(e)}function jb(e){return pn({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M0 64C0 46.3 14.3 32 32 32l64 0 16 0 176 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-56.2 0c9.6 14.4 16.7 30.6 20.7 48l35.6 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-35.6 0c-13.2 58.3-61.9 103.2-122.2 110.9L274.6 422c14.4 10.3 17.7 30.3 7.4 44.6s-30.3 17.7-44.6 7.4L13.4 314C2.1 306-2.7 291.5 1.5 278.2S18.1 256 32 256l80 0c32.8 0 61-19.7 73.3-48L32 208c-17.7 0-32-14.3-32-32s14.3-32 32-32l153.3 0C173 115.7 144.8 96 112 96L96 96 32 96C14.3 96 0 81.7 0 64z"},child:[]}]})(e)}function BP(e){return pn({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"},child:[]}]})(e)}function xC(e){return pn({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-96 55.2C54 332.9 0 401.3 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7c0-81-54-149.4-128-171.1l0 50.8c27.6 7.1 48 32.2 48 62l0 40c0 8.8-7.2 16-16 16l-16 0c-8.8 0-16-7.2-16-16s7.2-16 16-16l0-24c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 24c8.8 0 16 7.2 16 16s-7.2 16-16 16l-16 0c-8.8 0-16-7.2-16-16l0-40c0-29.8 20.4-54.9 48-62l0-57.1c-6-.6-12.1-.9-18.3-.9l-91.4 0c-6.2 0-12.3 .3-18.3 .9l0 65.4c23.1 6.9 40 28.3 40 53.7c0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.4 16.9-46.8 40-53.7l0-59.1zM144 448a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"},child:[]}]})(e)}function Q_e(){return h.jsxs("div",{className:"screen w-full h-full flex flex-row gap-4",children:[h.jsxs("div",{className:"sideOptions w-[18%] p-4 h-full grid grid-cols-1 gap-6 border shadow-lg shadow-emerald-300",children:[h.jsxs(Kr,{className:"options p-4 font-medium bg-emerald-400 bg-opacity-20 flex items-center gap-2 border",to:"/patient/profile/details",children:[h.jsx(UP,{className:"w-[3vw] h-[3vh]"}),"Personal Details",h.jsx("span",{})," "]}),h.jsxs(Kr,{className:"options p-4 font-medium bg-emerald-400 bg-opacity-20 flex items-center gap-2 border",to:"/patient/profile/contactDetails",children:[h.jsx(J_e,{className:"w-[3vw] h-[3vh]"}),"Contact Details",h.jsx("span",{})]}),h.jsxs(Kr,{className:"options p-4 font-medium bg-emerald-400 bg-opacity-20 flex items-center gap-2 border",to:"/patient/profile/bookings",children:[h.jsx(xC,{className:"w-[3vw] h-[3vh]"}),"Booking Details",h.jsx("span",{})]}),h.jsxs(Kr,{className:"options p-4 font-medium bg-emerald-400 bg-opacity-20 flex items-center gap-2 border",to:"/patient/profile/medicine",children:[h.jsx(xC,{className:"w-[3vw] h-[3vh]"}),"Medicines",h.jsx("span",{})]}),h.jsxs(Kr,{className:"options p-4 font-medium bg-emerald-400 bg-opacity-20 flex items-center gap-2 border",to:"/patient/profile/test",children:[h.jsx(xC,{className:"w-[3vw] h-[3vh]"}),"Lab Tests",h.jsx("span",{})]})]}),h.jsx("div",{className:"content w-[60%] flex flex-1 flex-col overflow-y-auto",children:h.jsx(po,{})})]})}const Z_e=fo().shape({firstName:kt(),lastName:kt(),bloodGroup:kt().matches(/^(A|B|AB|O)[+-]$/,"Not a valid Blood Group"),weight:kt().matches(/^[1-9][0-9]{0,5}(\.[0-9]{1,2})?$/,"Valid weight"),height:kt().matches(/^[1-9][0-9]{0,5}(\.[0-9]{1,2})?$/,"Valid height")}),ebe=fo().shape({place:kt(),state:kt(),country:kt(),pincode:kt().matches(/[1-9][0-9]{5}$/,"Valid Number"),district:kt(),phone:dW().of(kt().matches(/^[1-9][0-9]{9}$/,"not valid number"))});fo().shape({password:kt(),confirmPassword:kt()});function tbe(){T.useState(void 0);const[e,t]=T.useState(void 0),r=Yi({initialValues:{firstName:"",lastName:"",bloodGroup:"",weight:"",height:"",profileImage:""},validationSchema:Z_e,onSubmit:async(o,s)=>{console.log(o),await Dve(o)&&i()}}),n=o=>{const s=o.target.files[0],a=new FileReader;a.onload=c=>{const l=c.target.result;t(l),r.setFieldValue("profileImage",s)},a.readAsDataURL(s)},i=async()=>{const o=await QK();console.log(`temp ${JSON.stringify(o)}`),o&&(await r.setFieldValue("firstName",o.firstName),r.setFieldValue("lastName",o.lastName),r.setFieldValue("bloodGroup",o.bloodGroup),r.setFieldValue("weight",o.weight),r.setFieldValue("height",o.height),r.setFieldValue("profileImage",o.profileImage))};return T.useEffect(()=>{i()},[]),console.log(r.values),h.jsxs("form",{onSubmit:r.handleSubmit,className:"screen w-full h-full mt-5 flex flex-col gap-4",children:[h.jsxs("div",{className:"image w-full h-auto flex gap-4 justify-start pl-[20vw]",children:[h.jsx("img",{src:e||r.values.profileImage,className:"rounded-full w-[20vh] h-[20vh]"}),h.jsx("div",{className:"w-full h-auto flex flex-1 items-center ",children:h.jsx("div",{className:"flex flex-col gap-1",children:h.jsx(Ty,{id:"id_profileImage",name:"profileImage",helperText:"upload image",onChange:n,onBlur:r.handleBlur,...r.touched.profileImage&&(r.errors.profileImage?{color:"error",helperText:`${r.errors.profileImage}`}:{color:"success"})})})})]}),h.jsx("div",{className:"w-full h-full mt-10 flex justify-center  ",children:h.jsxs("div",{className:"w-[60%] h-full flex flex-col gap-4",children:[h.jsxs("div",{className:"w-full  grid grid-cols-2 gap-2 ",children:[h.jsx(Je,{variant:"filled",name:"firstName",label:"First Name",value:r.values.firstName,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.firstName&&(r.errors.firstName?{color:"error",helperText:`${r.errors.firstName}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"lastName",label:"Last Name",value:r.values.lastName,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.lastName&&(r.errors.lastName?{color:"error",helperText:`${r.errors.lastName}`}:{color:"success"})})]}),h.jsx(Je,{variant:"filled",name:"bloodGroup",label:"Blood Group",className:"w-full ",value:r.values.bloodGroup,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.bloodGroup&&(r.errors.bloodGroup?{color:"error",helperText:`${r.errors.bloodGroup}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"weight",label:"weight",className:"w-full ",value:r.values.weight,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.weight&&(r.errors.weight?{color:"error",helperText:`${r.errors.weight}`}:{color:"success"})}),h.jsx(Je,{variant:"filled",name:"height",label:"height",className:"w-full ",value:r.values.height,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.height&&(r.errors.height?{color:"error",helperText:`${r.errors.height}`}:{color:"success"})}),h.jsx("button",{type:"submit",className:"w-[full] h-[5vh] border font-medium rounded-[5%] bg-orange-500 p-2 ",children:"Save"})]})})]})}function rbe(){const[e,t]=T.useState(),r=Yi({initialValues:{place:"",state:"",country:"",pincode:"",district:"",phone:""},validationSchema:ebe,onSubmit:async(i,o)=>{console.log("values",i),await Mve(i)&&oe.fire("Profile has been Update","","success")}}),n=async()=>{const i=await Lve();r.setFieldValue("place",i._doc.place),r.setFieldValue("district",i._doc.district),r.setFieldValue("state",i._doc.state),r.setFieldValue("pincode",i._doc.pincode),r.setFieldValue("country",i._doc.country),r.setFieldValue("phone",i.phone),t(i)};return T.useEffect(()=>{n()},[]),h.jsx("div",{className:"screen w-full h-full flex flex-col p-10",children:h.jsxs("div",{className:"w-full h-full flex flex-col gap-4 justify-center pl-20  ",children:[h.jsx("h1",{className:"font-medium mb-2",children:"Address"}),h.jsxs("div",{className:"w-[60%] flex flex-col gap-2",children:[h.jsx(Je,{variant:"filled",name:"place",label:"Place",className:"w-full ",value:r.values.place,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.place&&r.errors.place?{color:"error",helperText:r.errors.place}:{color:"success"}}),h.jsx(Je,{variant:"filled",name:"state",label:"state",className:"w-full ",value:r.values.state,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.state&&r.errors.state?{color:"error",helperText:r.errors.state}:{color:"success"}}),h.jsx(Je,{variant:"filled",name:"district",label:"district",className:"w-full ",value:r.values.pincode,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.district&&r.errors.district?{color:"error",helperText:r.errors.district}:{color:"success"}}),h.jsx(Je,{variant:"filled",name:"country",label:"country",className:"w-full ",value:r.values.country,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.country&&r.errors.country?{color:"error",helperText:r.errors.country}:{color:"success"}}),h.jsx(Je,{variant:"filled",name:"pincode",label:"pincode",className:"w-full ",value:r.values.pincode,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.pincode&&r.errors.pincode?{color:"error",helperText:r.errors.pincode}:{color:"success"}})]}),h.jsx("h1",{className:"mt-5 font-medium mb-2",children:"Phone Details"}),h.jsx("div",{className:"w-[60%] flex flex-col gap-2",children:h.jsx(Je,{variant:"filled",name:"phone",label:"phone",className:"w-full ",value:r.values.phone,onChange:r.handleChange,onBlur:r.handleBlur,...r.touched.phone&&r.errors.phone?{color:"error",helperText:r.errors.phone}:{color:"success"}})}),h.jsx("button",{type:"button",onClick:r.handleSubmit,className:"w-[60%] h-[5vh] border font-medium rounded-[5%] bg-orange-500 p-2 ",children:"Save"})]})})}const nbe={firstName:"",lastName:"",profileImage:"",weight:"",height:""},Nq=dS({name:"doctor",initialState:nbe,reducers:{setDoctor(e,t){e.firstName=t.payload.firstName,e.lastName=t.payload.lastName,e.profileImage=t.payload.profileImage,e.weight=t.payload.weight,e.height=t.payload.height}}}),{setDoctor:OC}=Nq.actions,ibe=Nq.reducer,kq="http://localhost:5000/api",obe=async({token:e})=>{try{const t=await Ce.get(`${kq}/doctor/getBasicDetails`,{headers:{authorization:`Bearer ${e}`}});return console.log(t.data),t.data.userData}catch(t){return t.response.status=="401"&&oe.fire({html:`<b>${t.response.status.message}</b>`,title:"Session Out"}),console.log(t),!1}},sbe=async({token:e})=>{try{const t=await Ce.get(`${kq}/doctor/profile/viewDetails`,{headers:{authorization:`Bearer ${e}`}});return console.log(t.data),t.data.doctorDetails}catch(t){return console.log(t),t.response.status=="401"&&oe.fire({html:`<b>${t.response.status.message}</b>`,title:"Session Out"}),!1}};Ct.extend(vl);const abe="ws://localhost:5000",cbe=async({userId:e})=>{const t=new WebSocket(abe);t.onopen=()=>{console.log("connected to websocket"),t.send(JSON.stringify({type:"register",clientId:e}))},t.onmessage=r=>{const n=JSON.parse(r==null?void 0:r.data);if(n.type=="meetingReminder"){const i=Ct().diff(Ct(`${n.booking.startTime}`,"H:mm A"),"minutes");Math.abs(i)<=60&&oe.fire(`Meeting in ${Math.abs(i)} minutes`,"","warning")}}};function lbe(){const e=Ln(),t=zf(),{username:r,email:n,role:i,isLoggedIn:o}=lo(c=>c.user),s=lo(c=>c.doctor),a=async()=>{if(sessionStorage.getItem("token")){const c=await obe({token:sessionStorage.getItem("token")});if(c){const l=await sbe({token:sessionStorage.getItem("token")});await cbe({userId:c._id}),console.log(l),t(Xs({username:c.username,email:c.email,role:c.role,isLoggedIn:!0})),t(OC({firstName:l.firstName,lastName:l.lastName,profileImage:l.profileImage,weight:l.weight,height:l.height,profileImage:l.profileImage}))}else Xs({}),OC({})}};return console.log(s),T.useEffect(()=>{a()},[]),h.jsx("div",{className:"navBar w-full h-full flex flex-col",children:h.jsxs("div",{className:"w-full h-full flex flex-col gap-4 p-4 bg-slate-800 bg-opacity-90 rounded-tr-[3%]  ",children:[h.jsxs("div",{className:"w-full h-[15vh] flex flex-row items-center gap-4  p-1  ",children:[h.jsx("img",{src:s.profileImage,className:"rounded-full w-[4vw] h-[100%]"}),h.jsxs("div",{className:"h-full w-full pl-4 flex flex-1 flex-col justify-center gap-2 bg-white bg-opacity-40 rounded-lg ",children:[h.jsx("h2",{className:"text-lg font-bold",children:s&&s.firstName?s.firstName:r}),h.jsx("span",{className:" font-sm",children:"Doctor"})]})]}),h.jsx("div",{className:"search w-full h-[5%]",children:h.jsx(Je,{variant:"filled",name:"search",placeholder:"search",className:"h-full"})}),h.jsxs("div",{className:"options h-full w-full mt-10 flex flex-col gap-4 font-medium text-white ",children:[h.jsxs("div",{className:"option p-2 w-full h-[8%] flex flex-row gap-4 justify-start bg-white bg-opacity-40 shadow-lg ",children:[h.jsx("img",{src:"/icons/doctorHome.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{e("/doctor")},children:"Home"})]}),h.jsxs("div",{className:"option p-2 w-full h-[8%] flex flex-row gap-4 justify-start bg-white bg-opacity-40 shadow-lg ",children:[h.jsx("img",{src:"/icons/doctorSlotSetting.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",id:"id_navSlot",onClick:()=>{e("/doctor/slot")},children:"Slot"})]}),h.jsxs("div",{className:"option p-2 w-full h-[8%] flex flex-row gap-4 justify-start bg-white bg-opacity-40 shadow-lg ",children:[h.jsx("img",{src:"/icons/doctorBookings.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{e("/doctor/bookings")},children:"Bookings"})]}),h.jsxs("div",{className:"option p-2 w-full h-[8%] flex flex-row gap-4 justify-start bg-white bg-opacity-40 shadow-lg ",children:[h.jsx("img",{src:"/icons/profileIcon.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{e("/doctor/profile")},children:"Profile"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-10 ",children:[h.jsx("img",{src:"/icons/logout.png",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{sessionStorage.removeItem("token"),t(Xs({})),t(OC({})),e("/")},children:"sign out"})]})]})]})})}function dbe(){return h.jsxs("div",{className:"screen w-screen h-screen flex flex-row ",children:[h.jsx("div",{className:"navBar fixed w-[21%] h-[100vh] shadow-lg shadow-emerald-400 ",children:h.jsx(lbe,{})}),h.jsx("div",{className:"contentPage relative w-[79%] ml-[21vw] right-[0] h-full flex flex-1 flex-col gap-4",children:h.jsx(po,{})})]})}Ct.extend(vl);const ube=Ct(),og=[];for(var NC=0;NC<=5;NC++)og.push(ube.add(NC,"day").format("D MMM, dddd YYYY").toString());Ct.extend(vl);Ct();const hbe=["9:00 AM","11:00 AM","1:00 PM","3:00 PM","5:00 PM","7:00 PM"],$P="http://localhost:5000/api",pbe=sessionStorage.getItem("token"),fbe=async({startTime:e,slotDate:t})=>{try{const r=await Ce.post(`${$P}/doctor/slot/add`,{startTime:e,slotDate:t},{headers:{authorization:`Bearer ${sessionStorage.getItem("token")}`}});return console.log(r.data),r.data.addedSlot&&oe.fire({icon:"success",text:"Added Slot"}),r.data.addedSlot}catch(r){return console.log(`error ${r}`),!1}},cU=async({slotDate:e})=>{var t;try{console.log("token in slot",pbe);const r=await Ce.post(`${$P}/doctor/slot/viewSlots`,{slotDate:e},{headers:{authorization:`Bearer ${sessionStorage.getItem("token")}`}});return console.log(r.data),r.data.slots}catch(r){return console.log(r),((t=r.response)==null?void 0:t.status)=="401"&&oe.fire({html:`<b>${r.response.data.message}</b>`,title:"Session Out"}),r.response.status=="400"&&r.response.data.invalidToken&&oe.fire({html:`<b>${r.response.status.message}</b>`,title:"Session Out"}),!1}},mbe=async({bookingId:e})=>{try{const t=await Ce.post(`${$P}/doctor/slot/removeSlot`,{bookingId:e},{headers:{authorization:`Bearer ${sessionStorage.getItem("token")}`}});return console.log(t.data),oe.fire({icon:"success",text:"Removed the Slot"}),!0}catch(t){return console.log(`error ${t}`),!1}};Ct.extend(vl);function gbe(){const[e,t]=T.useState(void 0),[r,n]=T.useState([]);lo(s=>s.doctor);const i=async()=>{await t(og[0]);const s=await cU({slotDate:og[0]});console.log(s),await n(s)},o=async s=>{await t(s);const a=await cU({slotDate:s});console.log(a),await n(a)};return T.useEffect(()=>{t(og[0]),i()},[]),h.jsx("div",{className:"w-full h-full flex p-4",children:h.jsxs("div",{className:"w-full h-full flex flex-row gap-8",children:[h.jsxs("div",{className:"w-[20%] h-auto p-4 flex flex-col gap-2 border shadow-lg shadow-emerald-400 bg-black bg-opacity-30 rounded-2xl ",children:[h.jsx("h1",{className:"font-bold",children:"Dates"}),h.jsx("div",{className:"dates w-full h-[10%] grid grid-cols-1 justify-items-start gap-4 ",children:og.map((s,a)=>h.jsx("button",{className:"p-2 w-full h-full font-medium bg-emerald-400 bg-opacity-50 border flex justify-start pl-5 ",id:`id_slotDate_${a}`,onClick:()=>o(s),children:s},a))})]}),h.jsxs("div",{className:"w-[80%] h-full bg-black bg-opacity-30 rounded-xl  pt-10 pl-8 pr-5 flex flex-col overflow-y-scroll",children:[h.jsxs("h2",{className:"font-bold flex flex-row justify-evenly",children:["Slots ",h.jsx("span",{children:e||"date"})]}),h.jsx("div",{className:"w-full mt-10 gap-4 flex flex-col  p-8 ",children:hbe.map((s,a)=>h.jsx("div",{className:"w-auto h-auto bg-white rounded-lg",children:Ct().isBefore(Ct(Ct(`${e} ${Ct(s,"h:mm A").format("H:mm A")}`,"D MMM, dddd YYYY H:mm A").format("D MMM, dddd YYYY H:mm A"),"D MMM, dddd YYYY H:mm A"))&&(r&&r.length>0&&r.some(c=>c.startTime==Ct(s,"h:mm A").format("H:mm A").toString())?r.find(c=>c.startTime==Ct(s,"h:mm A").format("H:mm A").toString()).bookedStatus==1?h.jsx(vbe,{time:s,onLoad:i,timeIndex:a,slot:r.find(c=>c.startTime==Ct(s,"h:mm A").format("H:mm A").toString())}):h.jsx(Ebe,{timeIndex:a,time:s,slot:r.find(c=>c.startTime==Ct(s,"h:mm A").format("H:mm A").toString()),onLoad:i}):h.jsx(ybe,{timeIndex:a,time:s,selectedDate:e,onLoad:i}))},a))})]})]})})}function ybe(e){const{timeIndex:t}=e,r=async()=>{console.log(`slot date ${e.slotDate}`),await fbe({slotDate:e.selectedDate,startTime:Ct(e.time,"h:mm A").format("H:mm A").toString()})&&e.onLoad()};return h.jsxs("div",{className:"w-full h-[15vh] p-4 flex flex-row gap-2 border rounded-lg shadow-lg",children:[h.jsx("div",{className:"w-[20%] flex items-center justify-center border shadow-md",children:h.jsx("span",{className:"text-emerald-400 font-medium text-lg",children:e.time})}),h.jsx("div",{className:"flex flex-1 flex-row gap-10 items-center pl-10 border shadow-md",children:h.jsx("button",{className:"w-[30%] h-[60%] bg-green-400 font-medium border ",id:`id_btnaddslot_${t}`,onClick:r,children:"Add"})})]})}function vbe(e){return h.jsxs("div",{className:"w-full h-[20vh] p-4 bg-red-400 bg-opacity-50 flex flex-row gap-2 border rounded-lg shadow-lg",children:[h.jsx("div",{className:"w-[20%] flex items-center justify-center  shadow-md",children:h.jsx("span",{className:"text-emerald-400 font-medium text-lg",children:e.time})}),h.jsxs("div",{className:"w-full h-full flex flex-1 flex-row gap-10 items-center pl-10 py-2 shadow-md",children:[h.jsx("button",{className:"w-[30%] h-[60%] bg-red-400 font-medium border ",children:"Reschedule"}),h.jsxs("div",{className:"w-full h-full grid grid-cols-1 justify-items-center pt-2 gap-2 ",children:[h.jsx("button",{className:"w-[70%] h-full bg-green-400 font-medium ",children:"View Booking Details "}),h.jsx("span",{className:"w-[70%] h-full  text-center bg-blue-500 flex justify-center items-center text-white font-medium text-md",children:e.slot.patientId.firstName})]})]})]})}function Ebe(e){const{timeIndex:t}=e,r=async()=>{await mbe({bookingId:e.slot._id})&&e.onLoad()};return h.jsxs("div",{className:"w-full h-[15vh] p-4 bg-orange-400 bg-opacity-50 flex flex-row gap-2 border rounded-lg shadow-lg",children:[h.jsx("div",{className:"w-[20%] flex items-center justify-center border shadow-md",children:h.jsx("span",{className:"text-emerald-400 font-medium text-lg",children:e.time})}),h.jsx("div",{className:"flex flex-1 flex-row items-center pl-10 border shadow-md",children:h.jsx("button",{className:"w-[30%] h-[60%] bg-red-400 font-medium border ",id:`id_btnRemoveSlot_${t}`,onClick:r,children:"Remove"})})]})}function Pq(e){return h.jsxs("div",{className:"w-auto h-[25vh] flex flex-row gap-1 hover:bg-blue-400 hover:bg-opacity-40 border shadow-xl p-2 rounded-lg",children:[h.jsx("div",{className:"w-[30%] h-full flex gap-4 ",children:h.jsx("img",{src:e.doctor.profileImage,className:"w-full h-full rounded-md"})}),h.jsxs("div",{className:"details w-full h-full pl-2 pt-5 flex flex-row  gap-4 ",children:[h.jsxs("div",{className:"w-[50%] h-full pl-10 pt-1 flex flex-col  gap-4",children:[h.jsx("div",{className:" w-auto",children:h.jsx("span",{className:"text-sm font-medium opacity-40",children:"Cardilogy"})}),h.jsx("span",{className:"text-xl font-medium",children:`Dr. ${e.doctor.userId.username}`}),h.jsx("span",{className:"font-sm opacity-60",children:"16 years of experience"})]}),h.jsxs("div",{className:"w-[50%] h-full pb-8 flex flex-col gap-10 justify-end pr-5",children:[h.jsxs("span",{className:"text-lg font-bold opacity-80 flex justify-end items-center gap-2",children:[h.jsx("span",{className:"font-medium",children:"consultation fee"}),h.jsx(Zf,{}),h.jsx("span",{children:e.doctor.bookingPrice})]}),h.jsx("button",{className:"w-full h-[5vh] font-medium border rounded-[5%] bg-orange-500 p-2 hover:bg-opacity-50",children:"Book Consult"})]})]})]})}const HP="http://localhost:5000/api";sessionStorage.getItem("token");const _be=async()=>{try{const e=await Ce.get(`${HP}/patient/doctors/allDoctors`);return console.log(e.data),e.data.doctors}catch(e){return console.log(e),e.response.status=="401"&&oe.fire({html:`<b>${e.response.status.message}</b>`,title:"Session Out"}),!1}},lU=async({slotDate:e,doctorId:t})=>{try{const r=await Ce.post(`${HP}/patient/doctors/freeSlots`,{slotDate:e,doctorId:t});return console.log(r.data),r.data.slots}catch(r){return console.log(r),!1}},Dq=async({doctorId:e})=>{try{const t=await Ce.post(`${HP}/patient/doctors/doctorDetails`,{doctorId:e});return console.log(t.data),t.data.doctor}catch(t){return console.log(t),!1}};function bbe(){const e=Ln(),[t,r]=T.useState([]),n=async()=>{const i=await _be();await r(i)};return T.useEffect(()=>{n()},[]),h.jsx("div",{className:"w-full h-screen flex flex-col",children:h.jsxs("div",{className:"w-full h-full flex flex-row gap-10 pl-10",children:[h.jsx("div",{className:"w-[60%] h-full flex flex-1 flex-col flex-1 gap-10",children:t&&t.length>0&&t.map((i,o)=>h.jsx("div",{className:"w-auto h-auto cursor-pointer ",id:`id_doctor_${o}`,onClick:()=>e(`/patient/doctors/${i._id}`),children:h.jsx(Pq,{doctor:i})},o))}),h.jsx("div",{className:"w-[40%] h-full flex ",children:h.jsx(po,{})})]})})}Ct.extend(vl);const wbe=Ct(),Lq=[];for(var kC=0;kC<=5;kC++)Lq.push(wbe.add(kC,"day").format("D MMM, dddd YYYY").toString());function RS(e){return pn({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M960 95.888l-256.224.001V32.113c0-17.68-14.32-32-32-32s-32 14.32-32 32v63.76h-256v-63.76c0-17.68-14.32-32-32-32s-32 14.32-32 32v63.76H64c-35.344 0-64 28.656-64 64v800c0 35.343 28.656 64 64 64h896c35.344 0 64-28.657 64-64v-800c0-35.329-28.656-63.985-64-63.985zm0 863.985H64v-800h255.776v32.24c0 17.679 14.32 32 32 32s32-14.321 32-32v-32.224h256v32.24c0 17.68 14.32 32 32 32s32-14.32 32-32v-32.24H960v799.984zM736 511.888h64c17.664 0 32-14.336 32-32v-64c0-17.664-14.336-32-32-32h-64c-17.664 0-32 14.336-32 32v64c0 17.664 14.336 32 32 32zm0 255.984h64c17.664 0 32-14.32 32-32v-64c0-17.664-14.336-32-32-32h-64c-17.664 0-32 14.336-32 32v64c0 17.696 14.336 32 32 32zm-192-128h-64c-17.664 0-32 14.336-32 32v64c0 17.68 14.336 32 32 32h64c17.664 0 32-14.32 32-32v-64c0-17.648-14.336-32-32-32zm0-255.984h-64c-17.664 0-32 14.336-32 32v64c0 17.664 14.336 32 32 32h64c17.664 0 32-14.336 32-32v-64c0-17.68-14.336-32-32-32zm-256 0h-64c-17.664 0-32 14.336-32 32v64c0 17.664 14.336 32 32 32h64c17.664 0 32-14.336 32-32v-64c0-17.68-14.336-32-32-32zm0 255.984h-64c-17.664 0-32 14.336-32 32v64c0 17.68 14.336 32 32 32h64c17.664 0 32-14.32 32-32v-64c0-17.648-14.336-32-32-32z"},child:[]}]})(e)}function Sbe(e){return pn({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M8 13C7.44772 13 7 12.5523 7 12C7 11.4477 7.44772 11 8 11C8.55228 11 9 11.4477 9 12C9 12.5523 8.55228 13 8 13Z",fill:"currentColor"},child:[]},{tag:"path",attr:{d:"M8 17C7.44772 17 7 16.5523 7 16C7 15.4477 7.44772 15 8 15C8.55228 15 9 15.4477 9 16C9 16.5523 8.55228 17 8 17Z",fill:"currentColor"},child:[]},{tag:"path",attr:{d:"M11 16C11 16.5523 11.4477 17 12 17C12.5523 17 13 16.5523 13 16C13 15.4477 12.5523 15 12 15C11.4477 15 11 15.4477 11 16Z",fill:"currentColor"},child:[]},{tag:"path",attr:{d:"M16 17C15.4477 17 15 16.5523 15 16C15 15.4477 15.4477 15 16 15C16.5523 15 17 15.4477 17 16C17 16.5523 16.5523 17 16 17Z",fill:"currentColor"},child:[]},{tag:"path",attr:{d:"M11 12C11 12.5523 11.4477 13 12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12Z",fill:"currentColor"},child:[]},{tag:"path",attr:{d:"M16 13C15.4477 13 15 12.5523 15 12C15 11.4477 15.4477 11 16 11C16.5523 11 17 11.4477 17 12C17 12.5523 16.5523 13 16 13Z",fill:"currentColor"},child:[]},{tag:"path",attr:{d:"M8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9H16C16.5523 9 17 8.55228 17 8C17 7.44772 16.5523 7 16 7H8Z",fill:"currentColor"},child:[]},{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M6 3C4.34315 3 3 4.34315 3 6V18C3 19.6569 4.34315 21 6 21H18C19.6569 21 21 19.6569 21 18V6C21 4.34315 19.6569 3 18 3H6ZM18 5H6C5.44772 5 5 5.44772 5 6V18C5 18.5523 5.44772 19 6 19H18C18.5523 19 19 18.5523 19 18V6C19 5.44772 18.5523 5 18 5Z",fill:"currentColor"},child:[]}]})(e)}const Mq="http://localhost:5000/api";sessionStorage.getItem("token");const jq=async({amount:e})=>{try{return(await Ce.post(`${Mq}/patient/doctors/slots/payment/createOrder`,{amount:e},{headers:{Authorization:`bearer ${sessionStorage.getItem("token")}`}})).data.order}catch(t){return console.log(t),(t.response.status="401")?oe.fire({icon:"error",text:"Login for booking"}):(t.response.status=invalidToken)&&oe.fire({icon:"error",text:"Login for booking"}),!1}},Tbe=async({razorpay_payment_id:e,razorpay_order_id:t,razorpay_signature:r,order:n,doctorId:i,slotDetails:o})=>{try{const s=sessionStorage.getItem("token"),a=await Ce.post(`${Mq}/patient/doctors/slots/payment/paymentVerification`,{razorpay_payment_id:e,razorpay_order_id:t,razorpay_signature:r,order:n,doctorId:i,slotDetails:o},{headers:{Authorization:`bearer ${s}`}});return!0}catch(s){return console.log(s),(s.response.status="401")?oe.fire({icon:"error",text:"Login for booking"}):(s.response.status=invalidToken)?oe.fire({icon:"error",text:"Login Again"}):(s.response.status="500")&&oe.fire({icon:"error",text:"Server issue please try later"}),!1}},Cbe=fo().shape({amount:kt().matches(/^[1-9][0-9]{0,5}(\.[0-9]{1,2})?$/,"Invalid amount")}),Uq=void 0,Rbe=(e,t)=>{const{order:r,patient:n,user:i,doctor:o}=e;return{key:Uq,amount:e.amount*1e3,currency:"INR",name:"Health Companion",description:"Book Patient",image:"/logo.png",order_id:e.order.id,handler:async function(s){console.log("enterd payment handler"),await Tbe({razorpay_order_id:s.razorpay_order_id,razorpay_payment_id:s.razorpay_payment_id,razorpay_signature:s.razorpay_signature,doctorId:o._id,order:r,slotDetails:t})?oe.fire({icon:"success",text:"The slot has been booked"}):oe.fire({icon:"error",text:"The slot has been booked"})},prefill:{name:e.patient.firstName,email:e.user.email,contact:e.user.phone||"7902249173","card[number]":"4111 1111 1111 1111","card[expiry]":"12/30","card[cvv]":"123"},notes:{address:"Health Companion Office"},theme:{color:"#3399cc"}}},Ibe=(e,t)=>{var i,o,s,a;const{order:r,medicineOrder:n}=e;return{key:Uq,amount:e.amount*1e3,currency:"INR",name:"Health Companion",description:"Book Medicine",image:"/logo.png",order_id:e.order.id,handler:async function(c){await K_e({razorpay_order_id:c.razorpay_order_id,razorpay_payment_id:c.razorpay_payment_id,razorpay_signature:c.razorpay_signature,doctorId:n.pharmacyInventoryId.la,order:r,pharmacyId:n.pharmacyInventoryId.pharmacyId._id,pharmacyInventoryId:n.pharmacyInventoryId._id})&&oe.fire("Medicine has been ordere","","success")},prefill:{name:n.patientId.firstName,email:(o=(i=n==null?void 0:n.patientId)==null?void 0:i.userId)==null?void 0:o.email,contact:(a=(s=n==null?void 0:n.patientId)==null?void 0:s.userId)==null?void 0:a.phone},notes:{address:"Health Companion Office"},theme:{color:"#3399cc"}}};Ct.extend(vl);function Abe(){const[e,t]=T.useState(Ct().format("D MMM, dddd YYYY").toString()),[r,n]=T.useState(void 0),[i,o]=T.useState(void 0),[s,a]=T.useState([]),[c,l]=T.useState(void 0),[d,u]=T.useState(!1),{doctorId:p}=sy();lo(y=>y.patient),zf();const f=async()=>{const y=await Dq({doctorId:p});await l(y);const v=Ct().format("D MMM, dddd YYYY").toString();t(v);const E=await lU({slotDate:v,doctorId:p});a(E)};T.useEffect(()=>{f()},[p]);const m=async y=>{const v=JSON.parse(y.target.value);console.log(`slot ${JSON.stringify(v)}`),await o(v),await n(Ct(v.startTime,"H:mm A").format("h:mm A").toString()),await u(!d)},g=async y=>{y=Ct(y,"D ,ddd").format("D MMM, dddd YYYY").toString(),t(y);const v=await lU({slotDate:y,doctorId:p});a(v)};return h.jsxs("div",{className:"w-full h-full",children:[d&&h.jsx(xbe,{openModal:d,setOpenModal:u,time:r,slotDate:e,selectedSlot:i,doctor:c,slotTime:r}),h.jsxs("div",{className:"w-full h-full flex flex-col gap-2 pt-5 overflow-y-scroll pr-2 ",children:[h.jsxs("div",{className:"w-full h-auto px-8 bg-black bg-opacity-20 flex flex-col gap-4 border py-5 rounded-tl-xl shadow-xl",children:[h.jsxs("div",{className:"date w-full h-[10vh] bg-blue-500 rounded-md  flex gap-6 items-center",children:[h.jsx(RS,{className:"h-full w-[6vh]  p-2"}),h.jsx("h2",{className:"text-white font-medium ",children:"Dates"}),h.jsxs("div",{className:"flex flex-1 gap-5 justify-end w-full h-full items-center pr-5",children:[h.jsx("span",{className:"text-white text-md font-medium",children:c&&c.userId.username}),h.jsx("img",{src:c&&c.profileImage,alt:"profile",className:"w-[3vw] h-[7vh] rounded-full"})]})]}),h.jsx("div",{className:"w-full h-auto flex ",children:h.jsx("div",{className:"w-full h-auto grid grid-cols-3 justify-items-center gap-4 p-1",children:Lq.map((y,v)=>h.jsx("button",{className:"w-[10vw] h-[8vh] font-medium text-white bg-slate-700 bg-opacity-70 border shadow-md rounded-lg p-6",id:`id_slotDate_${v}`,onClick:()=>g(y),children:Ct(y,"D MMM, dddd YYYY").format("DD ,ddd").toString()},v))})})]}),h.jsxs("div",{className:"w-full h-full bg-black bg-opacity-20 flex flex-col gap-10 mt-5 p-5 border shadow-lg rounded-lg",children:[h.jsxs("div",{className:"w-full h-[10vh] bg-orange-500 text-white flex items-center gap-4 justify-evenly  rounded-md pl-2",children:[h.jsx(Tq,{className:"w-[5vw] h-[5vh]"}),h.jsx("h2",{className:"text-lg font-medium",children:e&&e})]}),h.jsx("div",{className:"w-full h-full grid grid-cols-3 justify-items-center content-start",children:s&&s.length>0&&s.map((y,v)=>h.jsx("button",{value:JSON.stringify(y),className:"w-auto h-auto border p-6 rounded-lg bg-green-400 font-medium shadow-lg",id:`id_slotTime_${v}`,onClick:m,children:Ct(y.startTime,"H:mm A").format("h:mm A").toString()},v))})]})]})]})}function xbe(e){const{setOpenModal:t,openModal:r,doctor:n,time:i,slotDate:o,selectedSlot:s}=e,a=lo(d=>d.patient),c=lo(d=>d.user),l=Yi({initialValues:{amount:500,patientdDescription:"",slotId:s._id},validationSchema:Cbe,onSubmit:async(d,u)=>{const p=await jq({amount:n.bookingPrice});if(await console.log("order",p),p){const f=await Rbe({order:p,patient:a,user:c,doctor:n},d);try{const m=new Razorpay(f);console.log("reached before razor pay"),await m.open()}catch(m){console.log("error during payment",m)}}t(!1)}});return T.useEffect(()=>{l.setFieldValue("slotId",s._id),l.setFieldValue("amount",n.bookingPrice)},[]),h.jsx("div",{children:h.jsxs(Ov,{show:r,onClose:()=>t(!1),children:[h.jsx(Ov.Header,{children:"Slot Details"}),h.jsxs(Ov.Body,{className:"h-auto flex flex-col gap-4",children:[h.jsx("div",{className:"w-full h-[15vh] flex justify-end pr-5",children:h.jsxs("div",{className:"flex gap-5 items-center",children:[h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("span",{className:"text-lg font-medium",children:n&&n.userId.username}),h.jsx("span",{className:"text-sm font-medium opacity-50",children:"Cardiology"})]}),h.jsx("img",{src:n.profileImage,alt:"profile",className:"h-[9vh] w-[4vw] rounded-full"})]})}),h.jsxs("div",{className:"flex gap-4 h-auto items-center bg-blue-500 p-2 text-white",children:[h.jsx(Sbe,{className:"h-full w-[3vw]"}),h.jsx("span",{className:"text-xl font-medium h-auto",children:e.slotDate})]}),h.jsxs("div",{className:"flex gap-4 h-auto items-center bg-orange-500 p-2 text-white",children:[h.jsx(Tq,{className:"h-full w-[3vw]"}),h.jsx("span",{className:"text-md font-medium h-auto",children:e.slotTime})]}),h.jsxs("div",{className:"h-[50vh]  w-full flex flex-col gap-2",children:[h.jsx("h2",{className:"font-medium opacity-40",children:"Description (Optional)"}),h.jsx("textarea",{name:"description",onChange:d=>{l.setFieldValue("patientDescription",d.target.value)},id:"id_description",placeholder:"Write down a short description on the purpose of the booking",className:"flex flex-1  "})]})]}),h.jsxs(Ov.Footer,{className:"gap-x-5 w-full flex flex-row",children:[h.jsx("button",{type:"submit",onClick:l.handleSubmit,className:"w-[40%] border rounded-[5%] bg-orange-500 p-2",id:"id_btnBookSlot",children:"Book"}),h.jsx("button",{type:"button",className:"w-[40%] border rounded-[5%] bg-red-500 p-2",onClick:()=>t(!1),children:"cancel"})]})]})})}sessionStorage.getItem("token");const Fq=async({diseaseName:e})=>{try{const t=await Ce.post("http://localhost:8000/predict",{"Medical Condition":e,"Blood Type":"O+",Gender:"Male"});return console.log(t.data),t.data.doctor}catch(t){console.log(t)}};function Obe(){T.useState();const[e,t]=T.useState(void 0);T.useState(void 0);const r=async(n,i)=>{const o=await Fq({diseaseName:i});console.log("doctor",o),window.location.reload()};return h.jsx("div",{className:"w-full h-screen pt-10 flex flex-col",children:h.jsxs("div",{className:"w-full h-full flex flex-col gap-6",children:[h.jsx("div",{className:"header w-full h-[10%] flex justify-start",children:h.jsx("span",{className:"text-2xl font-medium",children:"Treatment Suggestion "})}),h.jsxs("div",{className:"w-full h-[5vh] flex gap-5",children:[h.jsx("input",{type:"text",name:"disease",className:"w-[40%]",onChange:n=>t(n.target.value),placeholder:"type disease name"}),h.jsx("button",{className:"h-full w-[5vw] bg-orange-500 shadow-lg rounded-md",onClick:n=>r(n,e),children:"Search"})]}),h.jsx("div",{className:"w-full h-full flex border rounded-lg p-2",children:h.jsx("div",{className:"flex w-[50%] h-[50vh] bg-black bg-opacity-20",children:e&&h.jsx(Nbe,{diseaseName:e})})})]})})}function Nbe(e){const{diseaseName:t}=e,[r,n]=T.useState(void 0),i=async()=>{const o=await Fq({diseaseName:t}),s=await Dq({doctorId:o});n(s)};return T.useEffect(()=>{i()},[]),T.useEffect(()=>{i()},[t]),h.jsxs("div",{className:"w-full h-full flex flex-col gap-2 p-2",children:[h.jsx("h2",{className:"w-full h-auto p-3 flex justify-center bg-blue-500 text-lg text-white",children:"Suggested Doctors"}),h.jsx("div",{className:"suggestions w-full h-auto mt-3",children:r&&h.jsx(Pq,{doctor:r})})]})}function kbe(e){return pn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M363 277h-86v86h-42v-86h-86v-42h86v-86h42v86h86v42z"},child:[]},{tag:"path",attr:{d:"M256 90c44.3 0 86 17.3 117.4 48.6C404.7 170 422 211.7 422 256s-17.3 86-48.6 117.4C342 404.7 300.3 422 256 422c-44.3 0-86-17.3-117.4-48.6C107.3 342 90 300.3 90 256c0-44.3 17.3-86 48.6-117.4C170 107.3 211.7 90 256 90m0-42C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"},child:[]}]})(e)}function Pbe(e){return pn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M426.666 330.667a250.385 250.385 0 0 1-75.729-11.729c-7.469-2.136-16-1.073-21.332 5.333l-46.939 46.928c-60.802-30.928-109.864-80-140.802-140.803l46.939-46.927c5.332-5.333 7.462-13.864 5.332-21.333-8.537-24.531-12.802-50.136-12.802-76.803C181.333 73.604 171.734 64 160 64H85.333C73.599 64 64 73.604 64 85.333 64 285.864 226.136 448 426.666 448c11.73 0 21.334-9.604 21.334-21.333V352c0-11.729-9.604-21.333-21.334-21.333z"},child:[]}]})(e)}function Dbe(e){return pn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M113.5 281.2v85.3L256 448l142.5-81.5v-85.3L256 362.7l-142.5-81.5zM256 64L32 192l224 128 183.3-104.7v147.4H480V192L256 64z"},child:[]}]})(e)}function Lbe(e){return pn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M64 192v128h85.334L256 431.543V80.458L149.334 192H64z"},child:[]}]})(e)}function Mbe(e){return pn({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{strokeWidth:"2",d:"M15 19H2V1h16v4m0 0a5 5 0 110 10 5 5 0 010-10zm-3 9v8l3-2 3 2v-8M5 8h6m-6 3h5m-5 3h2M5 5h2"},child:[]}]})(e)}function jbe(){return h.jsxs("div",{className:"w-full h-[10vh] px-2 text-center font-bold flex justify-center items-center gap-2 ",children:[h.jsxs(Kr,{className:"options w-[35%] h-[80%] font-bold justify-center items-center p-2 bg-opacity-80 shadow-lg shadow-emerald-200 pl-4 flex items-center gap-5 border  ",to:"/doctor/profile/details",children:[h.jsx(UP,{className:"h-[3vh] w-[2vw]"}),h.jsx("span",{className:"flex flex-1",children:"Profile Details"})]}),h.jsxs(Kr,{className:"options w-[35%] h-[80%] font-bold justify-center items-center p-2 bg-opacity-80 shadow-lg shadow-emerald-200 pl-4 flex items-center gap-5 border  ",to:"/doctor/profile/contact",children:[h.jsx(Cq,{className:"h-[3vh] w-[2vw]"}),h.jsx("span",{className:"flex flex-1",children:"Contact Details"})]}),h.jsxs(Kr,{className:"options w-[35%] h-[80%] font-bold justify-center items-center p-2 bg-opacity-80 shadow-lg shadow-emerald-200 pl-4 flex items-center gap-5 border  ",to:"/doctor/profile/resetPassword",children:[h.jsx(Iq,{className:"h-[3vh] w-[2vw]"}),h.jsx("span",{className:"flex flex-1",children:"Password Reset"})]}),h.jsxs(Kr,{className:"options w-[35%] h-[80%] font-bold justify-center items-center p-2 bg-opacity-80 shadow-lg shadow-emerald-200 pl-4 flex items-center gap-5 border  ",to:"",children:[h.jsx(Dbe,{className:"h-[3vh] w-[2vw]"}),h.jsx("span",{className:"flex flex-1",children:"Educational Details"})]}),h.jsxs(Kr,{className:"options w-[35%] h-[80%] font-bold justify-center items-center p-2 bg-opacity-80 shadow-lg shadow-emerald-200 pl-4 flex items-center gap-5 border  ",to:"",children:[h.jsx(Mbe,{className:"h-[3vh] w-[2vw]"}),h.jsx("span",{className:"flex flex-1",children:"Proof Documents"})]})]})}function Ube(){return h.jsxs("div",{className:"screen w-full h-full ",children:[h.jsx("div",{children:h.jsx(jbe,{})}),h.jsx("div",{className:"content w-full h-full flex flex-1 flex-col",children:h.jsx(po,{})})]})}const IS="http://localhost:5000/api",AS=sessionStorage.getItem("token"),Fbe=async e=>{try{console.log("updateDetails",e);const t=await Ce.post(`${IS}/doctor/profile/updateDetails`,{updateDetails:e},{headers:{Authorization:`bearer ${AS}`,"Content-Type":"multipart/form-data"}});return!0}catch(t){return console.log(t),!1}},Vbe=async()=>{try{return(await Ce.get(`${IS}/doctor/profile/viewDetails`,{headers:{Authorization:`bearer ${AS}`}})).data.doctorDetails}catch(e){return console.log(e),!1}},Bbe=async()=>{try{const e=await Ce.get(`${IS}/doctor/profile/getContactDetails`,{headers:{Authorization:`bearer ${AS}`}});return console.log(e.data),e.data.contactDetails}catch(e){return console.log(e),!1}},$be=async e=>{try{const t=await Ce.post(`${IS}/doctor/profile/updateContactDetails`,e,{headers:{Authorization:`bearer ${AS}`}});return console.log(t.data),oe.fire({icon:"success",text:"Contact Details Have been Updated"}),t.data.contactDetails}catch(t){return console.log(t),!1}};function Hbe(){const[e,t]=T.useState(""),r=Yi({initialValues:{firstName:"",lastName:"",age:"",bloodGroup:"",height:"",weight:"",profileImage:""},validationSchema:fo().shape({}),onSubmit:async(o,s)=>{console.log("values",o),await Fbe(o)&&(oe.fire({icon:"success",text:"The profile has been updated"}),i())}}),n=o=>{const s=o.target.files[0],a=new FileReader;a.onload=c=>{t(c.target.result),r.setFieldValue("profileImage",s)},a.readAsDataURL(o.target.files[0])},i=async()=>{const o=await Vbe();r.setFieldValue("firstName",o.firstName),r.setFieldValue("lastName",o.lastName),r.setFieldValue("age",o.age),r.setFieldValue("bloodGroup",o.bloodGroup),r.setFieldValue("height",o.height),r.setFieldValue("weight",o.weight),r.setFieldValue("profileImage",o.profileImage),t(o.profileImage)};return T.useEffect(()=>{i()},[]),h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"w-full h-full flex flex-col items-center",children:h.jsxs("form",{className:"w-[50%] h-full flex flex-col gap-6 pt-10 ",children:[h.jsxs("div",{className:"w-full h-[15vh] flex gap-4 justify-center",children:[h.jsx("img",{src:e||"/normalUser.png",className:"w-[7vw] h-full rounded-full",name:"profileImage",id:"id_profileImage"}),h.jsx("div",{className:"h-full w-full flex flex-1 items-end",children:h.jsx("div",{className:"flex flex-col gap-1",children:h.jsx(Ty,{helperText:"Choose an Image",name:"profileImage",onChange:n})})})]}),h.jsx(Je,{variant:"filled",label:"First Name",name:"firstName",value:r.values.firstName,onChange:r.handleChange}),h.jsx(Je,{variant:"filled",label:"Last Name",name:"lastName",value:r.values.lastName,onChange:r.handleChange}),h.jsx(Je,{variant:"filled",label:"Age",name:"age",value:r.values.age,onChange:r.handleChange}),h.jsx(Je,{variant:"filled",label:"Blood Group",name:"bloodGroup",value:r.values.bloodGroup,onChange:r.handleChange}),h.jsx(Je,{variant:"filled",label:"Height",name:"height",value:r.values.height,onChange:r.handleChange}),h.jsx(Je,{variant:"filled",label:"Weight",name:"weight",value:r.values.weight,onChange:r.handleChange}),h.jsxs("button",{type:"button",onClick:r.handleSubmit,className:"w-full text-lg font-sm border rounded-[5%] bg-orange-500 p-2 flex gap-4 items-center justify-center",children:[h.jsx(FP,{}),"Save"]})]})})})}function Wbe(){const e=Yi({initialValues:{place:"",state:"",district:"",country:"",pincode:"",houseName:"",phone:""},validationSchema:fo().shape({}),onSubmit:async(r,n)=>{await $be(r)&&t()}}),t=async()=>{const{phone:r,...n}=await Bbe();console.log("temp contact",n._doc),e.setFieldValue("place",n._doc.place),e.setFieldValue("state",n._doc.state),e.setFieldValue("district",n._doc.district),e.setFieldValue("country",n._doc.country),e.setFieldValue("pincode",n._doc.pincode?n._doc.pincode:""),e.setFieldValue("houseName",n._doc.houseName),e.setFieldValue("phone",r)};return T.useEffect(()=>{t()},[]),h.jsx("div",{className:"w-full h-full",children:h.jsxs("div",{className:"w-full h-full flex flex-col gap-4 items-center pt-10",children:[h.jsx("div",{className:"w-[70%] ",children:h.jsx("h1",{className:"text-lg font-medium",children:"Address"})}),h.jsxs("form",{className:"w-[70%]  grid grid-cols-2 gap-4",children:[h.jsx(Je,{variant:"filled",label:"House Name",className:"font-bold",name:"houseName",onChange:e.handleChange,value:e.values.houseName}),h.jsx(Je,{variant:"filled",label:"Place",className:"font-bold",name:"place",onChange:e.handleChange,value:e.values.place}),h.jsx(Je,{variant:"filled",label:"District",className:"font-bold",name:"district",onChange:e.handleChange,value:e.values.district}),h.jsx(Je,{variant:"filled",label:"State",className:"font-bold",name:"state",onChange:e.handleChange,value:e.values.state}),h.jsx(Je,{variant:"filled",label:"Country",className:"font-bold",name:"country",onChange:e.handleChange,value:e.values.country}),h.jsx(Je,{variant:"filled",label:"Pincode",className:"font-bold",name:"pincode",onChange:e.handleChange,value:e.values.pincode})]}),h.jsxs("form",{className:"w-[70%] flex flex-col pt-10",children:[h.jsx("div",{children:h.jsx("h1",{className:"text-lg font-medium",children:"Contact Details"})}),h.jsx("div",{className:"w-[30%] flex flex-col gap-4 mt-5 ",children:h.jsx(Je,{variant:"filled",label:"Phone",className:"font-bold",name:"phone",onChange:e.handleChange,value:e.values.phone})})]}),h.jsxs("button",{type:"button",onClick:e.handleSubmit,className:"w-[70%] text-lg font-sm border rounded-[5%] bg-orange-500 p-2 flex gap-4 items-center justify-center",children:[h.jsx(FP,{}),"Save"]})]})})}function Gbe(){return h.jsx("div",{className:"w-full h-screen flex pt-[15vh] justify-center",children:h.jsxs("div",{className:"resetPassword w-[40%] h-fit flex flex-col gap-6 border shadow-lg p-5 ",children:[h.jsx("h1",{className:"text-lg font-medium",children:"Reset Password"}),h.jsx(Oq,{})]})})}function zbe(){const{username:e}=lo(t=>t.user);return h.jsxs("div",{className:"w-full h-full flex flex-col",children:[h.jsx("div",{className:"w-full h-screen flex bg-[url(/icons/pharmacyHome.jpg)] bg-no-repeat bg-cover bg-center",children:h.jsx("div",{className:"w-full h-screen flex flex-col bg-black bg-opacity-70",children:h.jsxs("div",{className:"welcome w-full flex flex-col items-center mt-10 text-white p-10",children:[h.jsx("span",{className:"text-[20vh] font-bold",children:"Welcome"}),h.jsx("span",{className:"text-[10vh] font-bold",children:e}),h.jsx("p",{className:"text-[3vh]",children:"The HealthCompanion Pharmacy offers you the best Management of the Medicines"})]})})}),h.jsx("div",{className:"stock w-full h-auto mt-5",children:h.jsx("div",{className:"w-full h-[100vh] flex gap-10",children:h.jsx("div",{className:"w-full h-auto flex justify-center",children:h.jsx("img",{src:"/normalUser.png",className:"rounded-full object-fit h-[20vh] w-[10vw]"})})})})]})}const Kbe="http://localhost:5000/api",qbe=sessionStorage.getItem("token"),Ybe=async()=>{try{const e=await Ce.get(`${Kbe}/laboratory/profile/getDetails`,{headers:{Authorization:`bearer ${qbe}`}});return console.log("lab details",e.data),e.data.laboratoryDetails}catch(e){return console.log(e),e.status=="500"&&e.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):e.status=="400"&&e.response.data.invalidToken?oe.fire({icon:"warning",text:"Your session is out.....please Log In"}):e.status=="401"&&oe.fire({icon:"warning",text:"Log In"}),!1}};function Xbe(){const e=zf(),t=Ln(),{username:r,email:n}=lo(o=>o.user),i=async()=>{const o=await Ybe();o&&e(Xs({username:o.userId.username,email:o.userId.email,phone:o.userId.phone,role:o.userId.role,isLoggedIn:!0}))};return T.useEffect(()=>{i()},[]),h.jsx("div",{className:"navbarParent h-full w-full ",children:h.jsxs("div",{className:"navbar w-full h-full flex flex-col rounded-tr-[3%] bg-pink-600 bg-opacity-90 p-4 gap-10 ",children:[h.jsxs("div",{className:"w-full h-[8vh] flex justify-start items-center gap-4 ",children:[h.jsx("img",{src:"/icons/arrowBack.png",alt:"",className:"h-[5vh] w-[] p-2 ml-2 bg-white  rounded-lg"}),h.jsx("h2",{className:"text-white text-sm",children:"Minimize"}),h.jsx("div",{className:"flex-1 h-full flex justify-end items-center",children:h.jsx("img",{src:"/logo.png",alt:"",className:"w-[7vw] h-[7vh] bg-white mr-4"})})]}),h.jsxs("div",{className:"profile h-[12%] flex flex-row justify-start gap-4",children:[h.jsx("div",{className:"profileImage w-auto h-full flex ",children:h.jsx("img",{src:"/normalUser.png",alt:"image",className:"h-full w-[5vw] rounded-full "})}),h.jsxs("div",{className:"details flex-1 flex flex-col justify-center bg-white bg-opacity-30 p-2 rounded-lg gap-2 ",children:[h.jsx("span",{children:h.jsx("h2",{className:"text-white text-lg font-bold",children:r})}),h.jsx("span",{children:h.jsx("h2",{className:"text-white text-sm",children:"Laboratory"})})]})]}),h.jsx("div",{className:"search w-full h-[5%]",children:h.jsx(Je,{variant:"filled",name:"search",placeholder:"search",className:"h-full"})}),h.jsxs("div",{className:"home w-full text-white h-[80%] flex flex-col gap-4 border-slate-50",children:[h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-30 ",children:[h.jsx("img",{src:"/icons/laboratory_homeIcon.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full cursor-pointer",onClick:()=>{t("")},children:"Home"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-30 ",children:[h.jsx("img",{src:"/icons/laboratory_serviceIcon.jpg",alt:"laboratory services",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full cursor-pointer",onClick:()=>{t("/laboratory/testServices")},children:"Laboratory test Services"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-30 ",children:[h.jsx("img",{src:"/icons/laboratory_testOrderIcon.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{t("/laboratory/order")},children:"Test Orders"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-30 ",children:[h.jsx("img",{src:"/icons/profileIcon.jpg",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{t("/pharmacy/profile")},children:"Profile"})]}),h.jsxs("div",{className:"option p-2 w-full h-[10%] flex flex-row gap-4 justify-start bg-white bg-opacity-30 ",children:[h.jsx("img",{src:"/icons/logout.png",alt:"home img",className:"bg-white h-full rounded-sm"}),h.jsx("button",{className:"h-full",onClick:()=>{sessionStorage.removeItem("token"),e(Xs({})),t("/")},children:"sign out"})]})]})]})})}function Jbe(){return h.jsxs("div",{className:"w-screen h-screen flex fex-col",children:[h.jsx("div",{className:"fixed header w-[21%] h-[100vh] ",children:h.jsx(Xbe,{})}),h.jsx("div",{className:"contentPage relative w-[79%] ml-[21vw] right-[0] h-full flex flex-1 flex-col gap-4 overflow-y-auto",children:h.jsx(po,{})})]})}function Qbe(){return h.jsxs("div",{className:"w-full h-auto p-5 flex flex-row gap-5 justify-start ",children:[h.jsxs(Kr,{className:"w-auto h-auto p-3 flex flex-row gap-5 items-center border rounded-lg shadow-lg shadow-emerald-200",to:"/laboratory/testServices/addTest",children:[h.jsx(kbe,{className:"w-[2vw] h-[4vh]"}),h.jsx("span",{className:"font-medium",children:"New Test"})]}),h.jsxs(Kr,{className:"w-auto h-auto p-3 flex flex-row gap-5 items-center border rounded-lg shadow-lg shadow-emerald-200",to:"/laboratory/testServices/viewTests",children:[h.jsx(M_e,{className:"w-[2vw] h-[4vh]"}),h.jsx("span",{className:"font-medium",children:"View Test Service"})]})]})}function Zbe(){return h.jsxs("div",{className:"w-full h-full flex flex-col gap-4",children:[h.jsx("div",{className:"w-full h-[10vh]",children:h.jsx(Qbe,{})}),h.jsx("div",{className:"content w-full h-full flex flex-col overflow-y-auto ",children:h.jsx(po,{})})]})}const ra="http://localhost:5000/api",na=sessionStorage.getItem("token"),ewe=async({testName:e,testId:t,atLab:r,atHome:n,priceHome:i,priceLab:o})=>{try{const s=await Ce.post(`${ra}/laboratory/test/addTest`,{testId:t,priceHome:i,priceLab:o,atHome:n,atLab:r},{headers:{Authorization:`bearer ${na}`}});return!0}catch(s){return console.log(s),s.status=="500"&&s.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):s.status=="400"&&s.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):s.status=="400"&&s.response.data.errorTestPresent?oe.fire({icon:"warning",text:"Test Already Present"}):s.status=="401"&&oe.fire({icon:"warning",text:"Log In"}),!1}},twe=async()=>{try{return(await Ce.get(`${ra}/laboratory/test/getTestsPresent`,{headers:{Authorization:`bearer ${na}`}})).data.tests}catch(e){return console.log(e),e.status=="500"&&e.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):e.status=="400"&&e.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):e.status=="401"&&oe.fire({icon:"warning",text:"Log In"}),!1}},rwe=async()=>{try{return(await Ce.get(`${ra}/laboratory/test/getAddedTests`,{headers:{Authorization:`bearer ${na}`}})).data.tests}catch(e){return console.log(e),e.status=="500"&&e.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):e.status=="400"&&e.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):e.status=="401"&&oe.fire({icon:"warning",text:"Log In"}),!1}},nwe=async({testName:e,testId:t})=>{try{const r=await Ce.post(`${ra}/laboratory/test/getAddedTestDetails`,{testName:e,testId:t},{headers:{Authorization:`bearer ${na}`}});return console.log(r.data),r.data.test}catch(r){return console.log(r),r.status=="500"&&r.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):r.status=="400"&&r.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):r.status=="401"?oe.fire({icon:"warning",text:"Log In"}):r.status=="404"&&r.response.data.errorTestPresent&&oe.fire({icon:"warning",text:"Test can't be found at database"}),!1}},iwe=async({testName:e,testId:t,atHome:r,atLab:n,priceHome:i,priceLab:o})=>{try{const s=await Ce.post(`${ra}/laboratory/test/updateAddedTestDetails`,{testName:e,testId:t,atHome:r,atLab:n,priceHome:i,priceLab:o},{headers:{Authorization:`bearer ${na}`}});return console.log(s.data),!0}catch(s){return console.log(s),s.status=="500"&&s.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):s.status=="400"&&s.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):s.status=="401"?oe.fire({icon:"warning",text:"Log In"}):s.status=="400"&&s.response.data.errorDatabase&&oe.fire({icon:"error",text:"Issue at the Database"}),!1}},owe=async({testName:e,testId:t})=>{try{const r=await Ce.post(`${ra}/laboratory/test/deletedAddedTest`,{testName:e,testId:t},{headers:{Authorization:`bearer ${na}`}});return console.log(r.data),!0}catch(r){return console.log(r),r.status=="500"&&r.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):r.status=="400"&&r.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):r.status=="401"?oe.fire({icon:"warning",text:"Log In"}):r.status=="400"&&r.response.data.errorDatabase&&oe.fire({icon:"error",text:"Issue at the Database"}),!1}},swe=async()=>{try{return(await Ce.get(`${ra}/laboratory/order/test/getOrderedTests`,{headers:{Authorization:`bearer ${na}`}})).data.orders}catch(e){return console.log(e),e.status=="500"&&e.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):e.status=="400"&&e.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):e.status=="401"?oe.fire({icon:"warning",text:"Log In"}):e.status=="400"&&e.response.data.errorDatabase&&oe.fire({icon:"error",text:"Issue at the Database"}),!1}},awe=async({testOrderId:e})=>{try{const t=await Ce.post(`${ra}/laboratory/order/test/completeOrderedTest`,{testOrderId:e},{headers:{Authorization:`bearer ${na}`}});return!0}catch(t){return console.log(t),t.status=="500"&&t.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):t.status=="400"&&t.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):t.status=="401"?oe.fire({icon:"warning",text:"Log In"}):t.status=="400"&&t.response.data.errorDatabase&&oe.fire({icon:"error",text:"Issue at the Database"}),!1}},cwe=async()=>{try{return(await Ce.get(`${ra}/laboratory/order/test/getCompletedOrderedTest`,{headers:{Authorization:`bearer ${na}`}})).data.orders}catch(e){return console.log(e),e.status=="500"&&e.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):e.status=="400"&&e.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):e.status=="401"?oe.fire({icon:"warning",text:"Log In"}):e.status=="400"&&e.response.data.errorDatabase&&oe.fire({icon:"error",text:"Issue at the Database"}),!1}},lwe=async({testOrderId:e})=>{try{return(await Ce.post(`${ra}/laboratory/order/test/completed/testDetails`,{testOrderId:e},{headers:{Authorization:`bearer ${na}`}})).data.order}catch(t){return console.log(t),t.status=="500"&&t.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):t.status=="400"&&t.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):t.status=="401"?oe.fire({icon:"warning",text:"Log In"}):t.status=="400"&&t.response.data.errorDatabase&&oe.fire({icon:"error",text:"Issue at the Database"}),!1}},dwe=async({testOrderId:e,testResultDescription:t,patientId:r,doctorId:n})=>{try{const i=await Ce.post(`${ra}/laboratory/order/test/uploadResult`,{testOrderId:e,testResultDescription:t,patientId:r,doctorId:n},{headers:{Authorization:`bearer ${na}`}});return!0}catch(i){return console.log(i),i.status=="500"&&i.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):i.status=="400"&&i.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):i.status=="401"?oe.fire({icon:"warning",text:"Log In"}):i.status=="400"&&i.response.data.errorDatabase&&oe.fire({icon:"error",text:"Issue at the Database"}),!1}},Vq=async({testOrderId:e})=>{try{return(await Ce.post(`${ra}/laboratory/order/test/result/getDetails`,{testOrderId:e},{headers:{Authorization:`bearer ${na}`}})).data.result}catch(t){return console.log(t),t.status=="500"&&t.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):t.status=="400"&&t.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):t.status=="401"?oe.fire({icon:"warning",text:"Log In"}):t.status=="400"&&t.response.data.errorDatabase&&oe.fire({icon:"error",text:"Issue at the Database"}),!1}},Bq=fo().shape({testId:kt().required("choose right category"),atHome:hx().required(),atLab:hx().required(),priceHome:kt().when("atHome",{is:!0,then:()=>kt().required().matches(/^(0|[1-9]\d*)(\.\d{1,2})?$/,"Not a number"),otherwise:()=>kt()}),priceLab:kt().when("atLab",{is:!0,then:()=>kt().required().matches(/^(0|[1-9]\d*)(\.\d{1,2})?$/,"Not a number"),otherwise:()=>kt()})}).test("atHome-or-atlab","Should choose any of them",e=>(console.log("jjjj",e),e?e.atHome||e.atLab:!1)),uwe=fo().shape({testResultDescription:kt().required("Shouldn't be left empty")});function hwe(){const[e,t]=T.useState({}),[r,n]=T.useState([]),[i,o]=T.useState(void 0),s=Yi({initialValues:{testId:"",priceHome:"",priceLab:"",atHome:!1,atLab:!1},validationSchema:Bq,onSubmit:async(d,u)=>{await ewe(d)&&oe.fire({icon:"success",text:"Test Service has been added"})}}),a=async d=>{const u=r==null?void 0:r.find(p=>p.testName==d.target.value);o(u),u?await s.setFieldValue("testId",u._id):await s.setFieldValue("testId",""),s.setFieldTouched("testId",!0)},c=async d=>{await t({...e,[d.target.name]:!e[d.target.name]}),d.target.name=="home"?(await s.setFieldValue("atHome",!s.values.atHome),s.setFieldTouched("atHome",!0)):d.target.name=="lab"&&(await s.setFieldValue("atLab",!s.values.atLab),s.setFieldTouched("atLab",!0))},l=async()=>{const d=await twe();await n(d)};return T.useEffect(()=>{l()},[]),T.useEffect(()=>{const d=[];Object.keys(e).forEach(u=>{e[u]&&d.push(u)}),s.setFieldValue("testType",d)},[e]),console.log("values",s.values),console.log("errors",s.errors),h.jsx("div",{className:"w-full h-full flex flex-col items-center ",children:h.jsxs("form",{onSubmit:s.handleSubmit,className:"w-[80%] h-full flex flex-col gap-5 pt-20 px-5",children:[h.jsx("h1",{className:"font-bold text-emerald-400 text-2xl",children:"Test"}),h.jsxs("div",{className:"w-full h-auto flex flex-row gap-5 ",children:[h.jsxs("div",{className:"w-[60%] h-full flex flex-col gap-5",children:[h.jsx(Je,{list:"tests",name:"testName",variant:"filled",label:"Test Type",onChange:a,onBlur:d=>s.setFieldTouched("testId",!0),...s.touched.testId&&(s.errors.testId?{color:"error",helperText:`${s.errors.testId}`}:{color:"success"})}),h.jsx("div",{children:h.jsx("datalist",{id:"tests",children:r&&r.map((d,u)=>h.jsx("option",{value:d.testName},u))})}),h.jsx("textarea",{label:" Test Description",rows:"10",value:i&&i.testDescription,placeholder:"Test Description"}),h.jsxs("div",{className:"options w-full h-auto flex flex-col gap-10 ",children:[h.jsx("h1",{className:"text-md font-medium",children:"Test Service Options"}),h.jsxs("div",{className:"flex flex-1 gap-10 w-full",children:[h.jsxs("div",{className:"flex flex-col gap-5 w-[50%]",children:[h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("input",{type:"checkbox",id:"id_chkhome",name:"home",value:"home",onChange:c,checked:s.va}),h.jsx("span",{children:"Home"})]}),e.home&&h.jsx(Je,{variant:"filled",label:"Price at Home",name:"priceHome",onChange:s.handleChange,onBlur:s.handleBlur,...s.touched.priceHome&&(s.errors.priceHome?{color:"error",helperText:`${s.errors.priceHome}`}:{color:"success"})})]}),h.jsxs("div",{className:"flex flex-col gap-5 w-[50%]",children:[h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("input",{type:"checkbox",id:"id_lab",name:"lab",value:"lab",onChange:c}),h.jsx("span",{children:"Lab"})]}),e.lab&&h.jsx(Je,{variant:"filled",label:"Price at Lab",name:"priceLab",onChange:s.handleChange,onBlur:s.handleBlur,...s.touched.priceLab&&(s.errors.priceLab?{color:"error",helperText:`${s.errors.priceLab}`}:{color:"success"})})]})]})]}),h.jsx("button",{type:"submit",className:"w-[full] h-[5vh] border rounded-[5%] bg-orange-500 p-2 mb-5",children:"Add Test"})]}),h.jsx("div",{className:"w-[30%] h-[40vh] flex flex-col",children:h.jsx("img",{src:i&&i.testImage,className:"h-full w-full object-fit",alt:"testImage"})})]})]})})}function pwe(){return h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"w-full h-full",children:h.jsx(fwe,{})})})}function fwe(e){const t=Ln(),[r,n]=T.useState(),i=["Test Name","image","on Home","on Clinic","Edit","Delete"],o=async()=>{const a=await rwe();n(a)};T.useEffect(()=>{o()},[]);const s=async(a,c)=>{oe.fire({showCancelButton:!0,title:"Do you want to delete",text:"please click yes to proceed",confirmButtonText:"Delete"}).then(async l=>{l.isConfirmed&&await owe({testId:c==null?void 0:c.testId})&&(oe.fire("Deleted","","success"),o())})};return h.jsx("div",{className:"w-auto h-auto px-10 py-5",children:h.jsxs(ur,{hoverable:!0,children:[h.jsx(ur.Head,{children:i.map((a,c)=>h.jsx(ur.HeadCell,{children:a},c))}),h.jsx(ur.Body,{className:"font-bold text-black",children:r&&r.map((a,c)=>h.jsxs(ur.Row,{className:"border border-b-black",children:[h.jsx(ur.Cell,{children:a.testId.testName}),h.jsx(ur.Cell,{children:h.jsx("img",{src:a.testId.testImage,className:"w-[3vw] h-[4vh] object-fit"})}),h.jsx(ur.Cell,{children:a.atHome?a.priceHome:"not available"}),h.jsx(ur.Cell,{children:a.atLab?a.priceLab:"not available"}),h.jsx(ur.Cell,{className:"cursor-pointer",children:h.jsx(Rq,{onClick:()=>t(`/laboratory/testServices/editTestDetails/?testName=${a.testId.testName}&testId=${a.testId._id}`)})}),h.jsx(ur.Cell,{className:"cursor-pointer",children:h.jsx(L_e,{onClick:l=>s(l,a)})})]},c))})]})})}function mwe(){var l,d,u;const[e,t]=mH(),[r,n]=T.useState(void 0),[i,o]=T.useState({}),s=Yi({initialValues:{testId:e.get("testId"),priceHome:"",priceLab:"",atHome:!1,atLab:!1},validationSchema:Bq,onSubmit:async(p,f)=>{await iwe({...p,testName:e.get("testId")})&&(oe.fire({icon:"success",text:"Test Service has been updated"}),await c())}}),a=async p=>{await o({...i,[p.target.name]:!i[p.target.name]}),p.target.name=="home"?(await s.setFieldValue("atHome",!s.values.atHome),s.setFieldTouched("atHome",!0)):p.target.name=="lab"&&(await s.setFieldValue("atLab",!s.values.atLab),s.setFieldTouched("atLab",!0))},c=async()=>{const p=await nwe({testName:e.get("testName"),testId:e.get("testId")});n(p),s.setFieldValue("atHome",p.atHome),s.setFieldValue("atLab",p.atLab),s.setFieldValue("priceHome",p.priceHome),s.setFieldValue("priceLab",p.priceLab)};return T.useEffect(()=>{c()},[]),h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsxs("form",{onSubmit:s.handleSubmit,className:"w-full h-full flex  gap-4 px-6 py-20 justify-center",children:[h.jsxs("div",{className:"detail w-[60%] h-auto flex flex-col gap-6 shadow-lg shadow-pink-500 p-4",children:[h.jsx("h1",{className:"w-full font-medium text-2xl text-emerald-400 flex justify-center ",children:"Update Test"}),h.jsx(Je,{variant:"filled",label:"Test Name",value:(l=r==null?void 0:r.testId)==null?void 0:l.testName}),h.jsx("textarea",{variant:"filled",rows:"20",label:"Test Description",value:(d=r==null?void 0:r.testId)==null?void 0:d.testDescription}),h.jsxs("div",{className:"w-full h-auto flex gap-2",children:[h.jsxs("div",{className:"flex flex-col gap-5 w-[50%]",children:[h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("input",{type:"checkbox",id:"id_chkhome",name:"home",value:"home",onChange:a,checked:s.values.atHome}),h.jsx("span",{children:"Home"})]}),s.values.atHome&&h.jsx(Je,{variant:"filled",label:"Price at Home",name:"priceHome",value:s.values.priceHome,onChange:s.handleChange,onBlur:s.handleBlur,...s.touched.priceHome&&(s.errors.priceHome?{color:"error",helperText:s.errors.priceHome}:{color:"success"})})]}),h.jsxs("div",{className:"flex flex-col gap-5 w-[50%]",children:[h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("input",{type:"checkbox",id:"id_lab",name:"lab",value:"lab",onChange:a,checked:s.values.atLab}),h.jsx("span",{children:"Lab"})]}),s.values.atLab&&h.jsx(Je,{variant:"filled",label:"Price at Lab",name:"priceLab",value:s.values.priceLab,onChange:s.handleChange,onBlur:s.handleBlur,...s.touched.priceLab&&(s.errors.priceLab?{color:"error",helperText:s.errors.priceLab}:{color:"success"})})]})]}),h.jsxs("button",{type:"submit",className:"w-[full] h-[5vh] border rounded-[5%] bg-orange-500 p-2 mb-5 flex gap-2 items-center justify-center",children:[h.jsx(Rq,{}),"Update Test"]})]}),h.jsx("div",{className:"testImage flex  w-[20vw] h-full pt-20",children:h.jsx("img",{src:(u=r==null?void 0:r.testId)==null?void 0:u.testImage,alt:"test image",className:"mt-5 object-fit h-[40vh] w-[20vw]"})})]})})}function gwe(e){const{test:t}=e;return h.jsx("div",{className:"flex w-auto h-auto border rounded-lg shadow-lg shadow-emerald-300 hover:bg-black hover:bg-opacity-10 py-5 px-3 cursor-pointer   ",children:h.jsxs("div",{className:"w-[30vw] h-auto flex flex-row gap-5 ",children:[h.jsx("div",{className:"image w-[50%] h-full flex justify-center items-center",children:h.jsx("img",{src:t==null?void 0:t.testImage,alt:"testImage",className:"object-cover w-full h-[70%]"})}),h.jsxs("div",{className:"w-full h-full content flex flex-col gap-5 bg-black bg-opacity-10 p-4",children:[h.jsx("h2",{className:"flex justify-center text-white bg-blue-500 py-3 font-medium",children:t==null?void 0:t.testName}),h.jsx("textarea",{name:"testDescription",id:"id_testDescripion",value:t==null?void 0:t.testDescription,rows:"10",className:"flex text-sm cursor-pointer border-0",disabled:!0})]})]})})}const xS="http://localhost:5000/api",$q=sessionStorage.getItem("token"),ywe=async()=>{try{return(await Ce.get(`${xS}/patient/tests/getAllTestAvailable`)).data.tests}catch(e){return console.log(e),e.status=="500"&&e.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):e.status=="400"&&e.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):e.status=="401"?oe.fire({icon:"warning",text:"Log In"}):e.status=="404"&&e.response.data.errorTestPresent&&oe.fire({icon:"warning",text:"Test can't be found at database"}),!1}},vwe=async({testId:e})=>{try{const t=await Ce.post(`${xS}/patient/tests/testDetails`,{testId:e});return console.log(t.data),t.data.testAndLabs}catch(t){return console.log(t),t.status=="500"&&t.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):t.status=="400"&&t.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):t.status=="401"?oe.fire({icon:"warning",text:"Log In"}):t.status=="404"&&t.response.data.errorTestPresent&&oe.fire({icon:"warning",text:"Test can't be found at database"}),!1}},Ewe=async()=>{try{const e=await Ce.get(`${xS}/patient/doctor/test/requests`,{headers:{Authorization:`bearer ${$q}`}});return console.log(e.data),e.data.tests}catch(e){return console.log(e),e.status=="500"&&e.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):e.status=="400"&&e.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):e.status=="401"?oe.fire({icon:"warning",text:"Log In"}):e.status=="404"&&e.response.data.errorNoPatient&&oe.fire({icon:"warning",text:"Patient Can't be found"}),!1}},_we=async({testOrderId:e})=>{try{const t=await Ce.post(`${xS}/patient/doctor/test/requests/order`,{testOrderId:e},{headers:{Authorization:`bearer ${$q}`}});return!0}catch(t){return console.log(t),t.status=="500"&&t.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):t.status=="400"&&t.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):t.status=="401"?oe.fire({icon:"warning",text:"Log In"}):t.status=="404"&&t.response.data.errorNoPatient&&oe.fire({icon:"warning",text:"Patient Can't be found"}),!1}};function bwe(){const[e,t]=T.useState([]),r=Ln(),n=async()=>{const i=await ywe();t(i)};return T.useEffect(()=>{n()},[]),h.jsx("div",{className:"flex flex-col w-full h-full",children:h.jsx("div",{className:"w-full h-full grid grid-cols-3 gap-4 justify-items-start",children:(e==null?void 0:e.length)>0&&e.map((i,o)=>h.jsx("div",{className:"w-auto h-auto cursor-pointer",onClick:()=>r(`/patient/tests/testDetails/?testId=${i._id}&testName=${i.testName}`),children:h.jsx(gwe,{test:i})},o))})})}function Oy(e){return pn({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"256",cy:"192",r:"32"},child:[]},{tag:"path",attr:{d:"M256 32c-88.22 0-160 68.65-160 153 0 40.17 18.31 93.59 54.42 158.78 29 52.34 62.55 99.67 80 123.22a31.75 31.75 0 0 0 51.22 0c17.42-23.55 51-70.88 80-123.22C397.69 278.61 416 225.19 416 185c0-84.35-71.78-153-160-153zm0 224a64 64 0 1 1 64-64 64.07 64.07 0 0 1-64 64z"},child:[]}]})(e)}function wwe(e){var r;const{test:t}=e;return h.jsx("div",{className:"flex w-full h-full ",children:h.jsxs("div",{className:"flex h-full w-[40vw] gap-6 bg-white  border rounded-lg p-4 shadow-lg",children:[h.jsx("div",{className:"image w-[20%] h-[90%]",children:h.jsx("img",{src:"/normalUser.png",alt:"image",className:"object-fit w-full h-full"})}),h.jsxs("div",{className:"details h-full w-full flex flex-1 flex-col gap-4 ",children:[h.jsx("h1",{children:(r=t==null?void 0:t.labId)==null?void 0:r.userId.username}),h.jsx("div",{className:"location"}),h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx(Oy,{}),h.jsx("span",{children:"Koovappally"})]}),h.jsxs("div",{className:"flex gap-2 w-full h-auto",children:[(t==null?void 0:t.atHome)&&h.jsxs("button",{className:"w-[50%] text-white text-md font-medium bg-orange-400 p-3 rounded-md flex gap-4 items-center",children:[h.jsx("span",{children:" Home Service"}),h.jsxs("span",{className:"flex gap-2 items-center",children:[h.jsx(jb,{}),h.jsx("h6",{children:t==null?void 0:t.priceHome})]})]}),(t==null?void 0:t.atLab)&&h.jsxs("button",{className:"w-[50%] text-white text-md font-medium bg-blue-400 p-3 rounded-md flex gap-4 items-center",children:[h.jsx("span",{children:" Lab Service"}),h.jsxs("span",{className:"flex gap-2 items-center",children:[h.jsx(jb,{}),h.jsx("h6",{children:t==null?void 0:t.priceLab})]})]})]})]})]})})}function Swe(){const[e,t]=T.useState([]),[r,n]=T.useState(void 0),i=new URLSearchParams(window.location.search),o=async()=>{const s=await vwe({testId:i.get("testId")});t(s),n(s[0].testId)};return T.useEffect(()=>{o()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"screen w-full h-full flex  gap-2 justify-between ",children:[h.jsxs("div",{className:"w-[50%] h-[80vh] flex gap-10 border p-4 shadow-lg items-center bg-emerald-400 bg-opacity-10 bg-blur-sm",children:[h.jsx("div",{className:"image h-[40vh] w-[70%]",children:h.jsx("img",{src:r==null?void 0:r.testImage,alt:"testImage",className:"w-full h-full object-fit"})}),h.jsxs("div",{className:"testDetails flex flex-col gap-2 w-full h-full justify-center",children:[h.jsxs("div",{className:"description w-full h-[10vh] border shadow-lg flex flex-col gap-2 px-1",children:[h.jsx("h2",{className:"flex w-full justify-start text-md font-medium opacity-40",children:"Test Name"}),h.jsx("span",{className:"text-lg font-medium",children:r==null?void 0:r.testName.toUpperCase()})]}),h.jsxs("div",{className:"testDescription flex flex-col gap-2 border w-full h-[40vh] shadow-lg px-1",children:[h.jsx("h2",{className:"flex w-full justify-start text-md font-medium opacity-40",children:"Test Description"}),h.jsx("span",{className:"h-[10vh] p-2",children:r==null?void 0:r.testDescription})]})]})]}),h.jsxs("div",{className:"laboratorys bg-black bg-opacity-10 p-3 flex flex-col gap-4 w-auto h-full border  ",children:[h.jsx("h2",{className:"text-lg text-white  font-medium flex justify-center bg-blue-500 py-2",children:"Labs where the service available"}),h.jsx("div",{className:"labs flex flex-col gap-4 h-full w-full overflow-y-auto",children:(e==null?void 0:e.length)>0&&e.map((s,a)=>h.jsx("div",{className:"w-full h-auto",children:h.jsx(wwe,{test:s})},a))})]})]})})}function Twe(){return h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"options w-full flex justify-start gap-10",children:[h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-blue-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"currentBookings",children:"Booked"}),h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-red-500 flex justify-center items-center shadow-lg shadow-emerald-400",children:"Past Bookings"})]})})}function Cwe(){return h.jsxs("div",{className:"w-full h-full flex flex-col gap-5 overflow-y-auto",children:[h.jsx("div",{className:"header w-full h-[5vh]",children:h.jsx(Twe,{})}),h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx(po,{})})]})}const Hq="http://localhost:5000/api",Wq=sessionStorage.getItem("token"),Rwe=async()=>{var e,t,r;try{return(await Ce.get(`${Hq}/patient/bookings/getAllCurrentBookings`,{headers:{Authorization:`bearer ${Wq}`}})).data.bookings}catch(n){return console.log(n),((e=n.response)==null?void 0:e.status)=="500"&&((r=(t=n.response)==null?void 0:t.data)!=null&&r.errorServer)&&oe.fire("Server Error","","error"),!1}},Iwe=async({startTime:e,slotDate:t,doctorId:r})=>{var n,i,o;try{const s=await Ce.post(`${Hq}/patient/bookings/cancelBooking`,{startTime:e,slotDate:t,doctorId:r},{headers:{Authorization:`bearer ${Wq}`}});return console.log(s.data),!0}catch(s){return console.log(s),((n=s.response)==null?void 0:n.status)=="500"&&((o=(i=s.response)==null?void 0:i.data)!=null&&o.errorServer)&&oe.fire("Server Error","","error"),!1}};function Awe(e){var n,i,o,s,a,c,l;const{booking:t}=e;Ln();const r=async(d,u,p,f)=>{d.preventDefault(),await oe.fire({showCancelButton:!0,confirmButtonText:"Proceed Canceling",text:"Do you want to cancel the booking",icon:"question"}).then(async m=>{m.isConfirmed&&await Iwe({startTime:u,slotDate:p,doctorId:f})&&(await oe.fire("Canceled","Booking has been Canceled","success"),window.location.reload())})};return h.jsx("div",{className:"w-full h-full ",children:h.jsxs("div",{className:"w-full h-full flex gap-2 border shadow-lg p-4 bg-white rounded-lg hover:bg-black hover:bg-opacity-10 cursor-pointer",children:[h.jsx("div",{className:"image w-auto h-full flex items-center px-5",children:h.jsx("img",{src:(n=t==null?void 0:t.doctorId)==null?void 0:n.profileImage,className:"h-[15vh] w-[7vw] rounded-full"})}),h.jsxs("div",{className:"details w-auto h-full px-2 py-2 flex flex-col gap-4 flex-1 items-start border bg-black bg-opacity-5 ",children:[h.jsx("h4",{className:"text-sm font-medium opacity-40",children:"Cardiology"}),h.jsx("div",{className:"w-full h-auto",children:h.jsx("h4",{children:(o=(i=t==null?void 0:t.doctorId)==null?void 0:i.userId)==null?void 0:o.username})}),h.jsx("div",{className:"location w-full h-auto",children:h.jsxs("div",{className:"flex gap-4 items-start",children:[h.jsx(Oy,{}),h.jsxs("div",{className:"flex flex-col gap-2 w-auto h-full items-start justify-start",children:[h.jsx("span",{className:"flex items-center",children:(a=(s=t==null?void 0:t.doctorId)==null?void 0:s.addressId)==null?void 0:a.place}),h.jsx("span",{className:"flex items-center",children:(l=(c=t==null?void 0:t.doctorId)==null?void 0:c.addressId)==null?void 0:l.district})]})]})})]}),h.jsxs("div",{className:"w-auto h-full flex flex-1 flex-col justify-end font-bold gap-4 py-2 px-2 bg-emerald-200 bg-opacity-40",children:[h.jsxs("div",{className:"slotDetails w-full h-auto p-4 flex gap-4 items-center",children:[h.jsx(RS,{}),h.jsx("span",{children:`${t==null?void 0:t.slotDate} ${Ct(t==null?void 0:t.startTime,"H:mm A").format("h:mm A").toString()}`})]}),h.jsxs("div",{className:"w-full h-auto flex gap-4",children:[h.jsx("button",{className:"cancel w-full h-auto p-2 bg-red-500 font-medium flex items-center justify-center",onClick:d=>{var u;return r(d,t==null?void 0:t.startTime,t==null?void 0:t.slotDate,(u=t==null?void 0:t.doctorId)==null?void 0:u._id)},children:"Cancel"}),Ct().isAfter(Ct(`${t.slotDate} ${t.startTime}`,"D MMM, dddd YYYY H:mm A"))&&Ct().isBefore(Ct(`${t.slotDate} ${t.startTime}`,"D MMM, dddd YYYY H:mm A").add(2,"hour"))&&h.jsx("button",{className:"cancel w-full h-auto p-2 bg-blue-500 font-medium flex items-center justify-center",onClick:d=>window.open(`/patient/bookings/videoConsult?patientId=${t.patientId._id}&doctorId=${t.doctorId._id}`,"_blank"),children:"Join Meeting"})]})]})]})})}function xwe(){const[e,t]=T.useState([]),r=async()=>{const n=await Rwe();await t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"flex w-full h-full",children:h.jsx("div",{className:"booked flex flex-col gap-4",children:(e==null?void 0:e.length)>0&&e.map((n,i)=>h.jsx("div",{className:"w-[60vw] h-[25vh] ",children:h.jsx(Awe,{booking:n})},i))})})}function Owe(){return h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"options w-full flex justify-start gap-10",children:[h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-blue-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"currentBookings",children:"Booked"}),h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-red-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"pastCompletedBookings",children:"Past Bookings"})]})})}function Nwe(){return h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsxs("div",{className:"screen w-full h-full flex flex-col gap-10 p-2",children:[h.jsx("div",{className:"w-full h-[5vh] flex",children:h.jsx(Owe,{})}),h.jsx("div",{className:"w-full h-full p-2 flex flex-col",children:h.jsx(po,{})})]})})}const Gq="http://localhost:5000/api",zq=sessionStorage.getItem("token"),kwe=async()=>{var e,t,r;try{const n=await Ce.get(`${Gq}/doctor/bookings/getAllCurrentBookings`,{headers:{Authorization:`bearer ${zq}`}});return console.log(n.data),n.data.bookings}catch(n){return console.log(n),((e=n==null?void 0:n.response)==null?void 0:e.status)=="500"&&((r=(t=n==null?void 0:n.response)==null?void 0:t.data)!=null&&r.errorServer)&&oe.fire("Server Error","","error"),!1}},Pwe=async()=>{var e,t,r;try{const n=await Ce.get(`${Gq}/doctor/bookings/getPastCompletedBookings`,{headers:{Authorization:`bearer ${zq}`}});return console.log(n.data),n.data.bookings}catch(n){return console.log(n),((e=n==null?void 0:n.response)==null?void 0:e.status)=="500"&&((r=(t=n==null?void 0:n.response)==null?void 0:t.data)!=null&&r.errorServer)&&oe.fire("Server Error","","error"),!1}};Ct.extend(vl);function Dwe(e){var n,i,o,s,a,c;const{booking:t}=e;Ln(),console.log("test date",Ct().add(2,"hour").isBefore(Ct(`${t.slotDate} ${t.startTime}`,"D MMM, dddd YYYY H:mm A").add(2,"hour")));const r=async(l,d,u,p)=>{l.preventDefault(),await oe.fire({showCancelButton:!0,confirmButtonText:"Proceed Rescheduling",text:"Do you want to Reschedule the booking",icon:"question"}).then(async f=>{f.isConfirmed&&await patient_cancelBookingService({startTime:d,slotDate:u,doctorId:p})&&(await oe.fire("Canceled","Booking has been Canceled","success"),window.location.reload())})};return h.jsx("div",{className:"w-full h-full ",children:h.jsxs("div",{className:"w-full h-full flex gap-2 border shadow-lg p-4 bg-white rounded-lg hover:bg-black hover:bg-opacity-10 cursor-pointer",children:[h.jsx("div",{className:"image w-auto h-full flex items-center px-5",children:h.jsx("img",{src:(n=t==null?void 0:t.patientId)==null?void 0:n.profileImage,className:"h-[15vh] w-[7vw] rounded-full"})}),h.jsxs("div",{className:"details w-auto h-full px-2 py-2 flex flex-col gap-4 flex-1 items-start border bg-black bg-opacity-5 ",children:[h.jsx("h4",{className:"text-sm font-medium opacity-40",children:"Cardiology"}),h.jsx("div",{className:"w-full h-auto",children:h.jsx("h4",{children:(i=t==null?void 0:t.patientId)==null?void 0:i.firstName})}),h.jsx("div",{className:"location w-full h-auto",children:h.jsxs("div",{className:"flex gap-4 items-start",children:[h.jsx(Oy,{}),h.jsxs("div",{className:"flex flex-col gap-2 w-auto h-full items-start justify-start",children:[h.jsx("span",{className:"flex items-center",children:(s=(o=t==null?void 0:t.patientId)==null?void 0:o.addressId)==null?void 0:s.place}),h.jsx("span",{className:"flex items-center",children:(c=(a=t==null?void 0:t.patientId)==null?void 0:a.addressId)==null?void 0:c.district})]})]})})]}),h.jsxs("div",{className:"w-auto h-full flex flex-1 flex-col justify-end font-bold gap-4 py-2 px-2 bg-emerald-200 bg-opacity-40",children:[h.jsxs("div",{className:"slotDetails w-full h-auto p-4 flex gap-4 items-center",children:[h.jsx(RS,{}),h.jsx("span",{children:`${t==null?void 0:t.slotDate} ${Ct(t==null?void 0:t.startTime,"H:mm A").format("h:mm A").toString()}`})]}),h.jsxs("div",{className:"w-full h-auto flex flex-between gap-4",children:[h.jsx("button",{className:"cancel w-full h-auto p-2 bg-red-500 font-medium flex items-center justify-center",onClick:l=>{var d;return r(l,t==null?void 0:t.startTime,t==null?void 0:t.slotDate,(d=t==null?void 0:t.doctorId)==null?void 0:d._id)},children:"Reschedule"}),Ct().isAfter(Ct(`${t.slotDate} ${t.startTime}`,"D MMM, dddd YYYY H:mm A"))&&Ct().isBefore(Ct(`${t.slotDate} ${t.startTime}`,"D MMM, dddd YYYY H:mm A").add(2,"hour"))&&h.jsx("button",{className:"cancel w-full h-auto p-2 bg-blue-500 font-medium flex items-center justify-center",onClick:l=>window.open(`/patient/bookings/videoConsult?patientId=${t.patientId._id}&doctorId=${t.doctorId._id}`,"_blank"),children:"Join Meeting"})]})]})]})})}function Lwe(){const[e,t]=T.useState([]),r=async()=>{const n=await kwe();t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"bookings w-full h-full",children:(e==null?void 0:e.length)>0&&(e==null?void 0:e.map((n,i)=>h.jsx("div",{className:"w-[70%] h-[25vh]",children:h.jsx(Dwe,{booking:n})},i)))})})})}/**
 * @license agora-rtc-react
 * @version 2.3.0
 *
 * Copyright (c) Agora, Inc.
 *
 * This source code is licensed under the MIT license.
 */function Mwe(e,t){return t.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(n){if(n!=="default"&&!(n in e)){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}})}),Object.freeze(e)}var Gp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qr=function(e){try{return!!e()}catch{return!0}},OS=!qr(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Kq=OS,qq=Function.prototype,Wx=qq.call,jwe=Kq&&qq.bind.bind(Wx,Wx),Br=Kq?jwe:function(e){return function(){return Wx.apply(e,arguments)}},Ti=Br({}.isPrototypeOf),Pv=function(e){return e&&e.Math==Math&&e},Mn=Pv(typeof globalThis=="object"&&globalThis)||Pv(typeof window=="object"&&window)||Pv(typeof self=="object"&&self)||Pv(typeof Gp=="object"&&Gp)||function(){return this}()||Gp||Function("return this")(),Uwe=OS,Yq=Function.prototype,dU=Yq.apply,uU=Yq.call,WP=typeof Reflect=="object"&&Reflect.apply||(Uwe?uU.bind(dU):function(){return uU.apply(dU,arguments)}),Xq=Br,Fwe=Xq({}.toString),Vwe=Xq("".slice),Sc=function(e){return Vwe(Fwe(e),8,-1)},Bwe=Sc,$we=Br,x0=function(e){if(Bwe(e)==="Function")return $we(e)},PC=typeof document=="object"&&document.all,NS={all:PC,IS_HTMLDDA:PC===void 0&&PC!==void 0},Hwe=NS.all,jn=NS.IS_HTMLDDA?function(e){return typeof e=="function"||e===Hwe}:function(e){return typeof e=="function"},Ny={},_s=!qr(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Wwe=OS,Dv=Function.prototype.call,Un=Wwe?Dv.bind(Dv):function(){return Dv.apply(Dv,arguments)},kS={},Jq={}.propertyIsEnumerable,Qq=Object.getOwnPropertyDescriptor,Gwe=Qq&&!Jq.call({1:2},1);kS.f=Gwe?function(e){var t=Qq(this,e);return!!t&&t.enumerable}:Jq;var Al,XE,Ud=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},zwe=qr,Kwe=Sc,DC=Object,qwe=Br("".split),PS=zwe(function(){return!DC("z").propertyIsEnumerable(0)})?function(e){return Kwe(e)=="String"?qwe(e,""):DC(e)}:DC,em=function(e){return e==null},Ywe=em,Xwe=TypeError,tm=function(e){if(Ywe(e))throw Xwe("Can't call method on "+e);return e},Jwe=PS,Qwe=tm,Fd=function(e){return Jwe(Qwe(e))},hU=jn,Zwe=NS.all,Bo=NS.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:hU(e)||e===Zwe}:function(e){return typeof e=="object"?e!==null:hU(e)},ja={},LC=ja,MC=Mn,eSe=jn,pU=function(e){return eSe(e)?e:void 0},mo=function(e,t){return arguments.length<2?pU(LC[e])||pU(MC[e]):LC[e]&&LC[e][t]||MC[e]&&MC[e][t]},vh=typeof navigator<"u"&&String(navigator.userAgent)||"",Zq=Mn,jC=vh,fU=Zq.process,mU=Zq.Deno,gU=fU&&fU.versions||mU&&mU.version,yU=gU&&gU.v8;yU&&(XE=(Al=yU.split("."))[0]>0&&Al[0]<4?1:+(Al[0]+Al[1])),!XE&&jC&&(!(Al=jC.match(/Edge\/(\d+)/))||Al[1]>=74)&&(Al=jC.match(/Chrome\/(\d+)/))&&(XE=+Al[1]);var rh=XE,vU=rh,tSe=qr,rSe=Mn.String,rm=!!Object.getOwnPropertySymbols&&!tSe(function(){var e=Symbol();return!rSe(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&vU&&vU<41}),eY=rm&&!Symbol.sham&&typeof Symbol.iterator=="symbol",nSe=mo,iSe=jn,oSe=Ti,sSe=Object,ky=eY?function(e){return typeof e=="symbol"}:function(e){var t=nSe("Symbol");return iSe(t)&&oSe(t.prototype,sSe(e))},aSe=String,nm=function(e){try{return aSe(e)}catch{return"Object"}},cSe=jn,lSe=nm,dSe=TypeError,ia=function(e){if(cSe(e))return e;throw dSe(lSe(e)+" is not a function")},uSe=ia,hSe=em,DS=function(e,t){var r=e[t];return hSe(r)?void 0:uSe(r)},EU=Un,_U=jn,bU=Bo,pSe=TypeError,tY={exports:{}},wU=Mn,fSe=Object.defineProperty,mSe=function(e,t){try{fSe(wU,e,{value:t,configurable:!0,writable:!0})}catch{wU[e]=t}return t},SU="__core-js_shared__",GP=Mn[SU]||mSe(SU,{}),TU=GP;(tY.exports=function(e,t){return TU[e]||(TU[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var im=tY.exports,gSe=tm,ySe=Object,Tc=function(e){return ySe(gSe(e))},vSe=Tc,ESe=Br({}.hasOwnProperty),Kn=Object.hasOwn||function(e,t){return ESe(vSe(e),t)},_Se=Br,bSe=0,wSe=Math.random(),SSe=_Se(1 .toString),zP=function(e){return"Symbol("+(e===void 0?"":e)+")_"+SSe(++bSe+wSe,36)},TSe=im,CU=Kn,CSe=zP,RSe=rm,ISe=eY,Tp=Mn.Symbol,UC=TSe("wks"),ASe=ISe?Tp.for||Tp:Tp&&Tp.withoutSetter||CSe,jr=function(e){return CU(UC,e)||(UC[e]=RSe&&CU(Tp,e)?Tp[e]:ASe("Symbol."+e)),UC[e]},xSe=Un,RU=Bo,IU=ky,OSe=DS,NSe=function(e,t){var r,n;if(_U(r=e.toString)&&!bU(n=EU(r,e))||_U(r=e.valueOf)&&!bU(n=EU(r,e))||t!=="string")return n;throw pSe("Can't convert object to primitive value")},kSe=TypeError,PSe=jr("toPrimitive"),DSe=function(e,t){if(!RU(e)||IU(e))return e;var r,n=OSe(e,PSe);if(n){if(r=xSe(n,e,t),!RU(r)||IU(r))return r;throw kSe("Can't convert object to primitive value")}return NSe(e,t)},LSe=ky,LS=function(e){var t=DSe(e,"string");return LSe(t)?t:t+""},AU=Bo,Gx=Mn.document,MSe=AU(Gx)&&AU(Gx.createElement),KP=function(e){return MSe?Gx.createElement(e):{}},jSe=KP,rY=!_s&&!qr(function(){return Object.defineProperty(jSe("div"),"a",{get:function(){return 7}}).a!=7}),USe=_s,FSe=Un,VSe=kS,BSe=Ud,$Se=Fd,HSe=LS,WSe=Kn,GSe=rY,xU=Object.getOwnPropertyDescriptor;Ny.f=USe?xU:function(e,t){if(e=$Se(e),t=HSe(t),GSe)try{return xU(e,t)}catch{}if(WSe(e,t))return BSe(!FSe(VSe.f,e,t),e[t])};var zSe=qr,KSe=jn,qSe=/#|\.prototype\./,Py=function(e,t){var r=XSe[YSe(e)];return r==QSe||r!=JSe&&(KSe(t)?zSe(t):!!t)},YSe=Py.normalize=function(e){return String(e).replace(qSe,".").toLowerCase()},XSe=Py.data={},JSe=Py.NATIVE="N",QSe=Py.POLYFILL="P",nY=Py,ZSe=ia,eTe=OS,tTe=x0(x0.bind),Vd=function(e,t){return ZSe(e),t===void 0?e:eTe?tTe(e,t):function(){return e.apply(t,arguments)}},oa={},iY=_s&&qr(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),rTe=Bo,nTe=String,iTe=TypeError,Xi=function(e){if(rTe(e))return e;throw iTe(nTe(e)+" is not an object")},oTe=_s,sTe=rY,aTe=iY,Lv=Xi,OU=LS,cTe=TypeError,FC=Object.defineProperty,lTe=Object.getOwnPropertyDescriptor,VC="enumerable",BC="configurable",$C="writable";oa.f=oTe?aTe?function(e,t,r){if(Lv(e),t=OU(t),Lv(r),typeof e=="function"&&t==="prototype"&&"value"in r&&$C in r&&!r[$C]){var n=lTe(e,t);n&&n[$C]&&(e[t]=r.value,r={configurable:BC in r?r[BC]:n[BC],enumerable:VC in r?r[VC]:n[VC],writable:!1})}return FC(e,t,r)}:FC:function(e,t,r){if(Lv(e),t=OU(t),Lv(r),sTe)try{return FC(e,t,r)}catch{}if("get"in r||"set"in r)throw cTe("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var dTe=oa,uTe=Ud,Bd=_s?function(e,t,r){return dTe.f(e,t,uTe(1,r))}:function(e,t,r){return e[t]=r,e},Mv=Mn,hTe=WP,pTe=x0,fTe=jn,mTe=Ny.f,gTe=nY,jh=ja,yTe=Vd,Uh=Bd,NU=Kn,vTe=function(e){var t=function(r,n,i){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,n)}return new e(r,n,i)}return hTe(e,this,arguments)};return t.prototype=e.prototype,t},Yt=function(e,t){var r,n,i,o,s,a,c,l,d,u=e.target,p=e.global,f=e.stat,m=e.proto,g=p?Mv:f?Mv[u]:(Mv[u]||{}).prototype,y=p?jh:jh[u]||Uh(jh,u,{})[u],v=y.prototype;for(o in t)n=!(r=gTe(p?o:u+(f?".":"#")+o,e.forced))&&g&&NU(g,o),a=y[o],n&&(c=e.dontCallGetSet?(d=mTe(g,o))&&d.value:g[o]),s=n&&c?c:t[o],n&&typeof a==typeof s||(l=e.bind&&n?yTe(s,Mv):e.wrap&&n?vTe(s):m&&fTe(s)?pTe(s):s,(e.sham||s&&s.sham||a&&a.sham)&&Uh(l,"sham",!0),Uh(y,o,l),m&&(NU(jh,i=u+"Prototype")||Uh(jh,i,{}),Uh(jh[i],o,s),e.real&&v&&(r||!v[o])&&Uh(v,o,s)))},ETe=Math.ceil,_Te=Math.floor,bTe=Math.trunc||function(e){var t=+e;return(t>0?_Te:ETe)(t)},wTe=bTe,qP=function(e){var t=+e;return t!=t||t===0?0:wTe(t)},STe=qP,TTe=Math.max,CTe=Math.min,YP=function(e,t){var r=STe(e);return r<0?TTe(r+t,0):CTe(r,t)},RTe=qP,ITe=Math.min,oY=function(e){return e>0?ITe(RTe(e),9007199254740991):0},ATe=oY,El=function(e){return ATe(e.length)},xTe=Fd,OTe=YP,NTe=El,kU=function(e){return function(t,r,n){var i,o=xTe(t),s=NTe(o),a=OTe(n,s);if(e&&r!=r){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},XP={includes:kU(!0),indexOf:kU(!1)},kTe=XP.includes;Yt({target:"Array",proto:!0,forced:qr(function(){return!Array(1).includes()})},{includes:function(e){return kTe(this,e,arguments.length>1?arguments[1]:void 0)}});var PTe=ja,sa=function(e){return PTe[e+"Prototype"]},DTe=sa("Array").includes,LTe=Bo,MTe=Sc,jTe=jr("match"),sY=function(e){var t;return LTe(e)&&((t=e[jTe])!==void 0?!!t:MTe(e)=="RegExp")},UTe=sY,FTe=TypeError,aY={};aY[jr("toStringTag")]="z";var JP=String(aY)==="[object z]",VTe=JP,BTe=jn,JE=Sc,$Te=jr("toStringTag"),HTe=Object,WTe=JE(function(){return arguments}())=="Arguments",Cc=VTe?JE:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=function(i,o){try{return i[o]}catch{}}(t=HTe(e),$Te))=="string"?r:WTe?JE(t):(n=JE(t))=="Object"&&BTe(t.callee)?"Arguments":n},GTe=Cc,zTe=String,bs=function(e){if(GTe(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return zTe(e)},KTe=jr("match"),qTe=Yt,YTe=function(e){if(UTe(e))throw FTe("The method doesn't accept regular expressions");return e},XTe=tm,PU=bs,JTe=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[KTe]=!1,"/./"[e](t)}catch{}}return!1},QTe=Br("".indexOf);qTe({target:"String",proto:!0,forced:!JTe("includes")},{includes:function(e){return!!~QTe(PU(XTe(this)),PU(YTe(e)),arguments.length>1?arguments[1]:void 0)}});var ZTe=sa("String").includes,DU=Ti,eCe=DTe,tCe=ZTe,HC=Array.prototype,WC=String.prototype,rCe=function(e){var t=e.includes;return e===HC||DU(HC,e)&&t===HC.includes?eCe:typeof e=="string"||e===WC||DU(WC,e)&&t===WC.includes?tCe:t},pe=xr(rCe),nCe=ia,iCe=Tc,oCe=PS,sCe=El,aCe=TypeError,LU=function(e){return function(t,r,n,i){nCe(r);var o=iCe(t),s=oCe(o),a=sCe(o),c=e?a-1:0,l=e?-1:1;if(n<2)for(;;){if(c in s){i=s[c],c+=l;break}if(c+=l,e?c<0:a<=c)throw aCe("Reduce of empty array with no initial value")}for(;e?c>=0:a>c;c+=l)c in s&&(i=r(i,s[c],c,o));return i}},cCe={left:LU(!1),right:LU(!0)},lCe=qr,MS=function(e,t){var r=[][e];return!!r&&lCe(function(){r.call(null,t||function(){return 1},1)})},Dy=typeof process<"u"&&Sc(process)=="process",dCe=cCe.left;Yt({target:"Array",proto:!0,forced:!Dy&&rh>79&&rh<83||!MS("reduce")},{reduce:function(e){var t=arguments.length;return dCe(this,e,t,t>1?arguments[1]:void 0)}});var uCe=sa("Array").reduce,hCe=Ti,pCe=uCe,GC=Array.prototype,fCe=function(e){var t=e.reduce;return e===GC||hCe(GC,e)&&t===GC.reduce?pCe:t},cY=fCe,ka=xr(cY),lY=!0,dY=!0;function jv(e,t,r){let n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function Eh(e,t,r){if(!e.RTCPeerConnection)return;let n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(s,a){if(s!==t)return i.apply(this,arguments);let c=l=>{let d=r(l);d&&(a.handleEvent?a.handleEvent(d):a(d))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(a,c),i.apply(this,[s,c])};let o=n.removeEventListener;n.removeEventListener=function(s,a){if(s!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(a))return o.apply(this,arguments);let c=this._eventMap[t].get(a);return this._eventMap[t].delete(a),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[s,c])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(s){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),s&&this.addEventListener(t,this["_on"+t]=s)},enumerable:!0,configurable:!0})}function mCe(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(lY=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function gCe(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(dY=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function uY(){if(typeof window=="object"){if(lY)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function QP(e,t){dY&&console.warn(e+" is deprecated, please use "+t+" instead.")}function MU(e){return Object.prototype.toString.call(e)==="[object Object]"}function hY(e){var t;return MU(e)?ka(t=Object.keys(e)).call(t,function(r,n){let i=MU(e[n]),o=i?hY(e[n]):e[n],s=i&&!Object.keys(o).length;return o===void 0||s?r:Object.assign(r,{[n]:o})},{}):e}function zx(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach(n=>{n.endsWith("Id")?zx(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach(i=>{zx(e,e.get(i),r)})}))}function jU(e,t,r){let n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(t===null)return i;let o=[];return e.forEach(s=>{s.type==="track"&&s.trackIdentifier===t.id&&o.push(s)}),o.forEach(s=>{e.forEach(a=>{a.type===n&&a.trackId===s.id&&zx(e,a,i)})}),i}var yCe=zP,UU=im("keys"),jS=function(e){return UU[e]||(UU[e]=yCe(e))},vCe=!qr(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),ECe=Kn,_Ce=jn,bCe=Tc,wCe=vCe,FU=jS("IE_PROTO"),Kx=Object,SCe=Kx.prototype,ZP=wCe?Kx.getPrototypeOf:function(e){var t=bCe(e);if(ECe(t,FU))return t[FU];var r=t.constructor;return _Ce(r)&&t instanceof r?r.prototype:t instanceof Kx?SCe:null},TCe=Br,CCe=ia,RCe=jn,ICe=String,ACe=TypeError,xCe=function(e,t,r){try{return TCe(CCe(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},OCe=Xi,NCe=function(e){if(typeof e=="object"||RCe(e))return e;throw ACe("Can't set "+ICe(e)+" as a prototype")},kCe=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=xCe(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch{}return function(n,i){return OCe(n),NCe(i),t?e(n,i):n.__proto__=i,n}}():void 0),US={},FS={},zC=Kn,PCe=Fd,DCe=XP.indexOf,LCe=FS,VU=Br([].push),pY=function(e,t){var r,n=PCe(e),i=0,o=[];for(r in n)!zC(LCe,r)&&zC(n,r)&&VU(o,r);for(;t.length>i;)zC(n,r=t[i++])&&(~DCe(o,r)||VU(o,r));return o},eD=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],MCe=pY,jCe=eD.concat("length","prototype");US.f=Object.getOwnPropertyNames||function(e){return MCe(e,jCe)};var Ly={};Ly.f=Object.getOwnPropertySymbols;var UCe=mo,FCe=US,VCe=Ly,BCe=Xi,$Ce=Br([].concat),HCe=UCe("Reflect","ownKeys")||function(e){var t=FCe.f(BCe(e)),r=VCe.f;return r?$Ce(t,r(e)):t},BU=Kn,WCe=HCe,GCe=Ny,zCe=oa,tD={},KCe=pY,qCe=eD,VS=Object.keys||function(e){return KCe(e,qCe)},YCe=_s,XCe=iY,JCe=oa,QCe=Xi,ZCe=Fd,eRe=VS;tD.f=YCe&&!XCe?Object.defineProperties:function(e,t){QCe(e);for(var r,n=ZCe(t),i=eRe(t),o=i.length,s=0;o>s;)JCe.f(e,r=i[s++],n[r]);return e};var Uv,fY=mo("document","documentElement"),tRe=Xi,rRe=tD,$U=eD,nRe=FS,iRe=fY,oRe=KP,qx="prototype",Yx="script",mY=jS("IE_PROTO"),KC=function(){},gY=function(e){return"<"+Yx+">"+e+"</"+Yx+">"},HU=function(e){e.write(gY("")),e.close();var t=e.parentWindow.Object;return e=null,t},QE=function(){try{Uv=new ActiveXObject("htmlfile")}catch{}var e,t,r;QE=typeof document<"u"?document.domain&&Uv?HU(Uv):(t=oRe("iframe"),r="java"+Yx+":",t.style.display="none",iRe.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(gY("document.F=Object")),e.close(),e.F):HU(Uv);for(var n=$U.length;n--;)delete QE[qx][$U[n]];return QE()};nRe[mY]=!0;var My=Object.create||function(e,t){var r;return e!==null?(KC[qx]=tRe(e),r=new KC,KC[qx]=null,r[mY]=e):r=QE(),t===void 0?r:rRe.f(r,t)},sRe=Bo,aRe=Bd,yY=Error,cRe=Br("".replace),lRe=String(yY("zxcasd").stack),vY=/\n\s*at [^:]*:[^\n]*/,dRe=vY.test(lRe),uRe=Ud,hRe=!qr(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",uRe(1,7)),e.stack!==7)}),pRe=Bd,fRe=function(e,t){if(dRe&&typeof e=="string"&&!yY.prepareStackTrace)for(;t--;)e=cRe(e,vY,"");return e},mRe=hRe,WU=Error.captureStackTrace,_h={},gRe=_h,yRe=jr("iterator"),vRe=Array.prototype,EY=function(e){return e!==void 0&&(gRe.Array===e||vRe[yRe]===e)},ERe=Cc,GU=DS,_Re=em,bRe=_h,wRe=jr("iterator"),BS=function(e){if(!_Re(e))return GU(e,wRe)||GU(e,"@@iterator")||bRe[ERe(e)]},SRe=Un,TRe=ia,CRe=Xi,RRe=nm,IRe=BS,ARe=TypeError,rD=function(e,t){var r=arguments.length<2?IRe(e):t;if(TRe(r))return CRe(SRe(r,e));throw ARe(RRe(e)+" is not iterable")},xRe=Un,zU=Xi,ORe=DS,_Y=function(e,t,r){var n,i;zU(e);try{if(!(n=ORe(e,"return"))){if(t==="throw")throw r;return r}n=xRe(n,e)}catch(o){i=!0,n=o}if(t==="throw")throw r;if(i)throw n;return zU(n),r},NRe=Vd,kRe=Un,PRe=Xi,DRe=nm,LRe=EY,MRe=El,KU=Ti,jRe=rD,URe=BS,qU=_Y,FRe=TypeError,ZE=function(e,t){this.stopped=e,this.result=t},YU=ZE.prototype,jy=function(e,t,r){var n,i,o,s,a,c,l,d=r&&r.that,u=!(!r||!r.AS_ENTRIES),p=!(!r||!r.IS_RECORD),f=!(!r||!r.IS_ITERATOR),m=!(!r||!r.INTERRUPTED),g=NRe(t,d),y=function(E){return n&&qU(n,"normal",E),new ZE(!0,E)},v=function(E){return u?(PRe(E),m?g(E[0],E[1],y):g(E[0],E[1])):m?g(E,y):g(E)};if(p)n=e.iterator;else if(f)n=e;else{if(!(i=URe(e)))throw FRe(DRe(e)+" is not iterable");if(LRe(i)){for(o=0,s=MRe(e);s>o;o++)if((a=v(e[o]))&&KU(YU,a))return a;return new ZE(!1)}n=jRe(e,i)}for(c=p?e.next:n.next;!(l=kRe(c,n)).done;){try{a=v(l.value)}catch(E){qU(n,"throw",E)}if(typeof a=="object"&&a&&KU(YU,a))return a}return new ZE(!1)},VRe=bs,BRe=Yt,$Re=Ti,HRe=ZP,Ub=kCe,WRe=function(e,t,r){for(var n=WCe(t),i=zCe.f,o=GCe.f,s=0;s<n.length;s++){var a=n[s];BU(e,a)||r&&BU(r,a)||i(e,a,o(t,a))}},bY=My,qC=Bd,YC=Ud,GRe=function(e,t){sRe(t)&&"cause"in t&&aRe(e,"cause",t.cause)},zRe=function(e,t,r,n){mRe&&(WU?WU(e,t):pRe(e,"stack",fRe(r,n)))},KRe=jy,qRe=function(e,t){return e===void 0?arguments.length<2?"":t:VRe(e)},YRe=jr("toStringTag"),Fb=Error,XRe=[].push,wf=function(e,t){var r,n=$Re(XC,this);Ub?r=Ub(Fb(),n?HRe(this):XC):(r=n?this:bY(XC),qC(r,YRe,"Error")),t!==void 0&&qC(r,"message",qRe(t)),zRe(r,wf,r.stack,1),arguments.length>2&&GRe(r,arguments[2]);var i=[];return KRe(e,XRe,{that:i}),qC(r,"errors",i),r};Ub?Ub(wf,Fb):WRe(wf,Fb,{name:!0});var XC=wf.prototype=bY(Fb.prototype,{constructor:YC(1,wf),message:YC(1,""),name:YC(1,"AggregateError")});BRe({global:!0,constructor:!0,arity:2},{AggregateError:wf});var Vb,Lg,Bb,JRe=jn,XU=Mn.WeakMap,QRe=JRe(XU)&&/native code/.test(String(XU)),wY=Mn,ZRe=Bo,eIe=Bd,JC=Kn,QC=GP,tIe=jS,rIe=FS,JU="Object already initialized",Xx=wY.TypeError,nIe=wY.WeakMap;QRe||QC.state?(da=QC.state||(QC.state=new nIe),da.get=da.get,da.has=da.has,da.set=da.set,Vb=function(e,t){if(da.has(e))throw Xx(JU);return t.facade=e,da.set(e,t),t},Lg=function(e){return da.get(e)||{}},Bb=function(e){return da.has(e)}):(Xd=tIe("state"),rIe[Xd]=!0,Vb=function(e,t){if(JC(e,Xd))throw Xx(JU);return t.facade=e,eIe(e,Xd,t),t},Lg=function(e){return JC(e,Xd)?e[Xd]:{}},Bb=function(e){return JC(e,Xd)});var da,Xd,Fu,QU,ZU,bh={set:Vb,get:Lg,has:Bb,enforce:function(e){return Bb(e)?Lg(e):Vb(e,{})},getterFor:function(e){return function(t){var r;if(!ZRe(t)||(r=Lg(t)).type!==e)throw Xx("Incompatible receiver, "+e+" required");return r}}},Jx=_s,iIe=Kn,SY=Function.prototype,oIe=Jx&&Object.getOwnPropertyDescriptor,ZC=iIe(SY,"name"),TY={EXISTS:ZC,PROPER:ZC&&(function(){}).name==="something",CONFIGURABLE:ZC&&(!Jx||Jx&&oIe(SY,"name").configurable)},sIe=Bd,$d=function(e,t,r,n){return n&&n.enumerable?e[t]=r:sIe(e,t,r),e},aIe=qr,cIe=jn,lIe=Bo,dIe=My,e5=ZP,uIe=$d,Qx=jr("iterator"),CY=!1;[].keys&&("next"in(ZU=[].keys())?(QU=e5(e5(ZU)))!==Object.prototype&&(Fu=QU):CY=!0);var hIe=!lIe(Fu)||aIe(function(){var e={};return Fu[Qx].call(e)!==e});cIe((Fu=hIe?{}:dIe(Fu))[Qx])||uIe(Fu,Qx,function(){return this});var RY={IteratorPrototype:Fu,BUGGY_SAFARI_ITERATORS:CY},pIe=Cc,fIe=JP?{}.toString:function(){return"[object "+pIe(this)+"]"},mIe=JP,gIe=oa.f,yIe=Bd,vIe=Kn,EIe=fIe,t5=jr("toStringTag"),Hd=function(e,t,r,n){if(e){var i=r?e:e.prototype;vIe(i,t5)||gIe(i,t5,{configurable:!0,value:t}),n&&!mIe&&yIe(i,"toString",EIe)}},_Ie=RY.IteratorPrototype,bIe=My,wIe=Ud,SIe=Hd,TIe=_h,CIe=function(){return this},nD=function(e,t,r,n){var i=t+" Iterator";return e.prototype=bIe(_Ie,{next:wIe(+!n,r)}),SIe(e,i,!1,!0),TIe[i]=CIe,e},RIe=Yt,IIe=Un,AIe=TY,xIe=nD,OIe=ZP,NIe=Hd,r5=$d,n5=_h,kIe=RY,PIe=AIe.PROPER,Fv=kIe.BUGGY_SAFARI_ITERATORS,eR=jr("iterator"),i5="keys",Vv="values",o5="entries",DIe=function(){return this},IY=function(e,t,r,n,i,o,s){xIe(r,t,n);var a,c,l,d=function(v){if(v===i&&g)return g;if(!Fv&&v in f)return f[v];switch(v){case i5:case Vv:case o5:return function(){return new r(this,v)}}return function(){return new r(this)}},u=t+" Iterator",p=!1,f=e.prototype,m=f[eR]||f["@@iterator"]||i&&f[i],g=!Fv&&m||d(i),y=t=="Array"&&f.entries||m;if(y&&(a=OIe(y.call(new e)))!==Object.prototype&&a.next&&(NIe(a,u,!0,!0),n5[u]=DIe),PIe&&i==Vv&&m&&m.name!==Vv&&(p=!0,g=function(){return IIe(m,this)}),i)if(c={values:d(Vv),keys:o?g:d(i5),entries:d(o5)},s)for(l in c)(Fv||p||!(l in f))&&r5(f,l,c[l]);else RIe({target:t,proto:!0,forced:Fv||p},c);return s&&f[eR]!==g&&r5(f,eR,g,{name:i}),n5[t]=g,c},iD=function(e,t){return{value:e,done:t}},LIe=Fd,s5=_h,AY=bh;oa.f;var MIe=IY,a5=iD,xY="Array Iterator",jIe=AY.set,UIe=AY.getterFor(xY);MIe(Array,"Array",function(e,t){jIe(this,{type:xY,target:LIe(e),index:0,kind:t})},function(){var e=UIe(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,a5(void 0,!0)):a5(r=="keys"?n:r=="values"?t[n]:[n,t[n]],!1)},"values"),s5.Arguments=s5.Array;var FIe=oa,$S=function(e,t,r){return FIe.f(e,t,r)},VIe=mo,BIe=$S,$Ie=_s,c5=jr("species"),HIe=Ti,WIe=TypeError,oD=function(e,t){if(HIe(t,e))return e;throw WIe("Incorrect invocation")},GIe=jn,Zx=GP,zIe=Br(Function.toString);GIe(Zx.inspectSource)||(Zx.inspectSource=function(e){return zIe(e)});var OY=Zx.inspectSource,KIe=Br,qIe=qr,NY=jn,YIe=Cc,XIe=OY,kY=function(){},JIe=[],PY=mo("Reflect","construct"),sD=/^\s*(?:class|function)\b/,QIe=KIe(sD.exec),ZIe=!sD.exec(kY),Lm=function(e){if(!NY(e))return!1;try{return PY(kY,JIe,e),!0}catch{return!1}},DY=function(e){if(!NY(e))return!1;switch(YIe(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ZIe||!!QIe(sD,XIe(e))}catch{return!0}};DY.sham=!0;var O0,Fh,l5,tR,HS=!PY||qIe(function(){var e;return Lm(Lm.call)||!Lm(Object)||!Lm(function(){e=!0})||e})?DY:Lm,eAe=HS,tAe=nm,rAe=TypeError,d5=Xi,nAe=function(e){if(eAe(e))return e;throw rAe(tAe(e)+" is not a constructor")},iAe=em,oAe=jr("species"),aD=function(e,t){var r,n=d5(e).constructor;return n===void 0||iAe(r=d5(n)[oAe])?t:nAe(r)},cD=Br([].slice),sAe=TypeError,WS=function(e,t){if(e<t)throw sAe("Not enough arguments");return e},LY=/(?:ipad|iphone|ipod).*applewebkit/i.test(vh),ns=Mn,aAe=WP,cAe=Vd,u5=jn,lAe=Kn,MY=qr,h5=fY,dAe=cD,p5=KP,uAe=WS,hAe=LY,pAe=Dy,eO=ns.setImmediate,tO=ns.clearImmediate,fAe=ns.process,rR=ns.Dispatch,mAe=ns.Function,f5=ns.MessageChannel,gAe=ns.String,nR=0,Mg={},m5="onreadystatechange";MY(function(){O0=ns.location});var lD=function(e){if(lAe(Mg,e)){var t=Mg[e];delete Mg[e],t()}},iR=function(e){return function(){lD(e)}},g5=function(e){lD(e.data)},y5=function(e){ns.postMessage(gAe(e),O0.protocol+"//"+O0.host)};eO&&tO||(eO=function(e){uAe(arguments.length,1);var t=u5(e)?e:mAe(e),r=dAe(arguments,1);return Mg[++nR]=function(){aAe(t,void 0,r)},Fh(nR),nR},tO=function(e){delete Mg[e]},pAe?Fh=function(e){fAe.nextTick(iR(e))}:rR&&rR.now?Fh=function(e){rR.now(iR(e))}:f5&&!hAe?(tR=(l5=new f5).port2,l5.port1.onmessage=g5,Fh=cAe(tR.postMessage,tR)):ns.addEventListener&&u5(ns.postMessage)&&!ns.importScripts&&O0&&O0.protocol!=="file:"&&!MY(y5)?(Fh=y5,ns.addEventListener("message",g5,!1)):Fh=m5 in p5("script")?function(e){h5.appendChild(p5("script"))[m5]=function(){h5.removeChild(this),lD(e)}}:function(e){setTimeout(iR(e),0)});var jY={set:eO,clear:tO},UY=function(){this.head=null,this.tail=null};UY.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return(this.head=e.next)===null&&(this.tail=null),e.item}};var Vh,oR,sR,aR,v5,FY=UY,yAe=/ipad|iphone|ipod/i.test(vh)&&typeof Pebble<"u",vAe=/web0s(?!.*chrome)/i.test(vh),nh=Mn,E5=Vd,EAe=Ny.f,cR=jY.set,_Ae=FY,bAe=LY,wAe=yAe,SAe=vAe,lR=Dy,_5=nh.MutationObserver||nh.WebKitMutationObserver,b5=nh.document,w5=nh.process,Bv=nh.Promise,S5=EAe(nh,"queueMicrotask"),rO=S5&&S5.value;rO||(Mm=new _Ae,jm=function(){var e,t;for(lR&&(e=w5.domain)&&e.exit();t=Mm.get();)try{t()}catch(r){throw Mm.head&&Vh(),r}e&&e.enter()},bAe||lR||SAe||!_5||!b5?!wAe&&Bv&&Bv.resolve?((aR=Bv.resolve(void 0)).constructor=Bv,v5=E5(aR.then,aR),Vh=function(){v5(jm)}):lR?Vh=function(){w5.nextTick(jm)}:(cR=E5(cR,nh),Vh=function(){cR(jm)}):(oR=!0,sR=b5.createTextNode(""),new _5(jm).observe(sR,{characterData:!0}),Vh=function(){sR.data=oR=!oR}),rO=function(e){Mm.head||Vh(),Mm.add(e)});var Mm,jm,TAe=rO,om=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},ih=Mn.Promise,VY=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",CAe=!VY&&!Dy&&typeof window=="object"&&typeof document=="object",RAe=Mn,jg=ih,IAe=jn,AAe=nY,xAe=OY,OAe=jr,NAe=CAe,kAe=VY,dR=rh,T5=jg&&jg.prototype,PAe=OAe("species"),BY=!1,$Y=IAe(RAe.PromiseRejectionEvent),DAe=AAe("Promise",function(){var e=xAe(jg),t=e!==String(jg);if(!t&&dR===66||!T5.catch||!T5.finally)return!0;if(!dR||dR<51||!/native code/.test(e)){var r=new jg(function(i){i(1)}),n=function(i){i(function(){},function(){})};if((r.constructor={})[PAe]=n,!(BY=r.then(function(){})instanceof n))return!0}return!t&&(NAe||kAe)&&!$Y}),Uy={CONSTRUCTOR:DAe,REJECTION_EVENT:$Y,SUBCLASSING:BY},Rc={},C5=ia,LAe=TypeError,MAe=function(e){var t,r;this.promise=new e(function(n,i){if(t!==void 0||r!==void 0)throw LAe("Bad Promise constructor");t=n,r=i}),this.resolve=C5(t),this.reject=C5(r)};Rc.f=function(e){return new MAe(e)};var uR,R5,jAe=Yt,$b=Dy,xd=Mn,Fy=Un,UAe=$d,FAe=Hd,VAe=function(e){var t=VIe(e);$Ie&&t&&!t[c5]&&BIe(t,c5,{configurable:!0,get:function(){return this}})},BAe=ia,nO=jn,$Ae=Bo,HAe=oD,WAe=aD,HY=jY.set,dD=TAe,GAe=function(e,t){try{arguments.length==1?console.error(e):console.error(e,t)}catch{}},zAe=om,KAe=FY,WY=bh,iO=ih,GY=Uy,zY=Rc,e_="Promise",I5=GY.CONSTRUCTOR,qAe=GY.REJECTION_EVENT,hR=WY.getterFor(e_),YAe=WY.set,XAe=iO&&iO.prototype,Um=iO,pR=XAe,KY=xd.TypeError,oO=xd.document,uD=xd.process,sO=zY.f,JAe=sO,QAe=!!(oO&&oO.createEvent&&xd.dispatchEvent),qY="unhandledrejection",YY=function(e){var t;return!(!$Ae(e)||!nO(t=e.then))&&t},XY=function(e,t){var r,n,i,o=t.value,s=t.state==1,a=s?e.ok:e.fail,c=e.resolve,l=e.reject,d=e.domain;try{a?(s||(t.rejection===2&&exe(t),t.rejection=1),a===!0?r=o:(d&&d.enter(),r=a(o),d&&(d.exit(),i=!0)),r===e.promise?l(KY("Promise-chain cycle")):(n=YY(r))?Fy(n,r,c,l):c(r)):l(o)}catch(u){d&&!i&&d.exit(),l(u)}},JY=function(e,t){e.notified||(e.notified=!0,dD(function(){for(var r,n=e.reactions;r=n.get();)XY(r,e);e.notified=!1,t&&!e.rejection&&ZAe(e)}))},QY=function(e,t,r){var n,i;QAe?((n=oO.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),xd.dispatchEvent(n)):n={promise:t,reason:r},!qAe&&(i=xd["on"+e])?i(n):e===qY&&GAe("Unhandled promise rejection",r)},ZAe=function(e){Fy(HY,xd,function(){var t,r=e.facade,n=e.value;if(A5(e)&&(t=zAe(function(){$b?uD.emit("unhandledRejection",n,r):QY(qY,r,n)}),e.rejection=$b||A5(e)?2:1,t.error))throw t.value})},A5=function(e){return e.rejection!==1&&!e.parent},exe=function(e){Fy(HY,xd,function(){var t=e.facade;$b?uD.emit("rejectionHandled",t):QY("rejectionhandled",t,e.value)})},Cp=function(e,t,r){return function(n){e(t,n,r)}},zp=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,JY(e,!0))},aO=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw KY("Promise can't be resolved itself");var n=YY(t);n?dD(function(){var i={done:!1};try{Fy(n,t,Cp(aO,i,e),Cp(zp,i,e))}catch(o){zp(i,o,e)}}):(e.value=t,e.state=1,JY(e,!1))}catch(i){zp({done:!1},i,e)}}};I5&&(pR=(Um=function(e){HAe(this,pR),BAe(e),Fy(uR,this);var t=hR(this);try{e(Cp(aO,t),Cp(zp,t))}catch(r){zp(t,r)}}).prototype,(uR=function(e){YAe(this,{type:e_,done:!1,notified:!1,parent:!1,reactions:new KAe,rejection:!1,state:0,value:void 0})}).prototype=UAe(pR,"then",function(e,t){var r=hR(this),n=sO(WAe(this,Um));return r.parent=!0,n.ok=!nO(e)||e,n.fail=nO(t)&&t,n.domain=$b?uD.domain:void 0,r.state==0?r.reactions.add(n):dD(function(){XY(n,r)}),n.promise}),R5=function(){var e=new uR,t=hR(e);this.promise=e,this.resolve=Cp(aO,t),this.reject=Cp(zp,t)},zY.f=sO=function(e){return e===Um||e===void 0?new R5(e):JAe(e)}),jAe({global:!0,constructor:!0,wrap:!0,forced:I5},{Promise:Um}),FAe(Um,e_,!1,!0),VAe(e_);var ZY=jr("iterator"),eX=!1;try{x5=0,fR={next:function(){return{done:!!x5++}},return:function(){eX=!0}},fR[ZY]=function(){return this},Array.from(fR,function(){throw 2})}catch{}var x5,fR,txe=ih,rxe=function(e,t){if(!eX)return!1;var r=!1;try{var n={};n[ZY]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},GS=Uy.CONSTRUCTOR||!rxe(function(e){txe.all(e).then(void 0,function(){})}),nxe=Un,ixe=ia,oxe=Rc,sxe=om,axe=jy;Yt({target:"Promise",stat:!0,forced:GS},{all:function(e){var t=this,r=oxe.f(t),n=r.resolve,i=r.reject,o=sxe(function(){var s=ixe(t.resolve),a=[],c=0,l=1;axe(e,function(d){var u=c++,p=!1;l++,nxe(s,t,d).then(function(f){p||(p=!0,a[u]=f,--l||n(a))},i)}),--l||n(a)});return o.error&&i(o.value),r.promise}});var cxe=Yt,lxe=Uy.CONSTRUCTOR;ih&&ih.prototype,cxe({target:"Promise",proto:!0,forced:lxe,real:!0},{catch:function(e){return this.then(void 0,e)}});var dxe=Un,uxe=ia,hxe=Rc,pxe=om,fxe=jy;Yt({target:"Promise",stat:!0,forced:GS},{race:function(e){var t=this,r=hxe.f(t),n=r.reject,i=pxe(function(){var o=uxe(t.resolve);fxe(e,function(s){dxe(o,t,s).then(r.resolve,n)})});return i.error&&n(i.value),r.promise}});var mxe=Un,gxe=Rc;Yt({target:"Promise",stat:!0,forced:Uy.CONSTRUCTOR},{reject:function(e){var t=gxe.f(this);return mxe(t.reject,void 0,e),t.promise}});var yxe=Xi,vxe=Bo,Exe=Rc,tX=function(e,t){if(yxe(e),vxe(t)&&t.constructor===e)return t;var r=Exe.f(e);return(0,r.resolve)(t),r.promise},_xe=Yt,bxe=ih,wxe=Uy.CONSTRUCTOR,Sxe=tX,Txe=mo("Promise"),Cxe=!wxe;_xe({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return Sxe(Cxe&&this===Txe?bxe:this,e)}});var Rxe=Un,Ixe=ia,Axe=Rc,xxe=om,Oxe=jy;Yt({target:"Promise",stat:!0,forced:GS},{allSettled:function(e){var t=this,r=Axe.f(t),n=r.resolve,i=r.reject,o=xxe(function(){var s=Ixe(t.resolve),a=[],c=0,l=1;Oxe(e,function(d){var u=c++,p=!1;l++,Rxe(s,t,d).then(function(f){p||(p=!0,a[u]={status:"fulfilled",value:f},--l||n(a))},function(f){p||(p=!0,a[u]={status:"rejected",reason:f},--l||n(a))})}),--l||n(a)});return o.error&&i(o.value),r.promise}});var Nxe=Un,kxe=ia,Pxe=mo,Dxe=Rc,Lxe=om,Mxe=jy,O5="No one promise resolved";Yt({target:"Promise",stat:!0,forced:GS},{any:function(e){var t=this,r=Pxe("AggregateError"),n=Dxe.f(t),i=n.resolve,o=n.reject,s=Lxe(function(){var a=kxe(t.resolve),c=[],l=0,d=1,u=!1;Mxe(e,function(p){var f=l++,m=!1;d++,Nxe(a,t,p).then(function(g){m||u||(u=!0,i(g))},function(g){m||u||(m=!0,c[f]=g,--d||o(new r(c,O5)))})}),--d||o(new r(c,O5))});return s.error&&o(s.value),n.promise}});var jxe=Yt,cO=ih,Uxe=qr,Fxe=mo,Vxe=jn,Bxe=aD,N5=tX,$xe=cO&&cO.prototype;jxe({target:"Promise",proto:!0,real:!0,forced:!!cO&&Uxe(function(){$xe.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=Bxe(this,Fxe("Promise")),r=Vxe(e);return this.then(r?function(n){return N5(t,e()).then(function(){return n})}:e,r?function(n){return N5(t,e()).then(function(){throw n})}:e)}});var hD=Br,Hxe=qP,Wxe=bs,Gxe=tm,zxe=hD("".charAt),k5=hD("".charCodeAt),Kxe=hD("".slice),P5=function(e){return function(t,r){var n,i,o=Wxe(Gxe(t)),s=Hxe(r),a=o.length;return s<0||s>=a?e?"":void 0:(n=k5(o,s))<55296||n>56319||s+1===a||(i=k5(o,s+1))<56320||i>57343?e?zxe(o,s):n:e?Kxe(o,s,s+2):i-56320+(n-55296<<10)+65536}},pD={codeAt:P5(!1),charAt:P5(!0)},qxe=pD.charAt,Yxe=bs,rX=bh,Xxe=IY,D5=iD,nX="String Iterator",Jxe=rX.set,Qxe=rX.getterFor(nX);Xxe(String,"String",function(e){Jxe(this,{type:nX,string:Yxe(e),index:0})},function(){var e,t=Qxe(this),r=t.string,n=t.index;return n>=r.length?D5(void 0,!0):(e=qxe(r,n),t.index+=e.length,D5(e,!1))});var Zxe=ja.Promise,eOe={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},tOe=Mn,rOe=Cc,nOe=Bd,L5=_h,M5=jr("toStringTag");for(Hv in eOe)mR=tOe[Hv],$v=mR&&mR.prototype,$v&&rOe($v)!==M5&&nOe($v,M5,Hv),L5[Hv]=L5.Array;var mR,$v,Hv,iX=Zxe,de=xr(iX),j5=uY;function oX(e,t){let r=e&&e.navigator;if(!r.mediaDevices)return;let n=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;let a={};return Object.keys(s).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;let l=typeof s[c]=="object"?s[c]:{ideal:s[c]};l.exact!==void 0&&typeof l.exact=="number"&&(l.min=l.max=l.exact);let d=function(u,p){return u?u+p.charAt(0).toUpperCase()+p.slice(1):p==="deviceId"?"sourceId":p};if(l.ideal!==void 0){a.optional=a.optional||[];let u={};typeof l.ideal=="number"?(u[d("min",c)]=l.ideal,a.optional.push(u),u={},u[d("max",c)]=l.ideal,a.optional.push(u)):(u[d("",c)]=l.ideal,a.optional.push(u))}l.exact!==void 0&&typeof l.exact!="number"?(a.mandatory=a.mandatory||{},a.mandatory[d("",c)]=l.exact):["min","max"].forEach(u=>{l[u]!==void 0&&(a.mandatory=a.mandatory||{},a.mandatory[d(u,c)]=l[u])})}),s.advanced&&(a.optional=(a.optional||[]).concat(s.advanced)),a},i=function(s,a){if(t.version>=61)return a(s);if((s=JSON.parse(JSON.stringify(s)))&&typeof s.audio=="object"){let c=function(l,d,u){d in l&&!(u in l)&&(l[u]=l[d],delete l[d])};c((s=JSON.parse(JSON.stringify(s))).audio,"autoGainControl","googAutoGainControl"),c(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=n(s.audio)}if(s&&typeof s.video=="object"){let c=s.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});let l=t.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||l)){let d;if(delete s.video.facingMode,c.exact==="environment"||c.ideal==="environment"?d=["back","rear"]:c.exact!=="user"&&c.ideal!=="user"||(d=["front"]),d)return r.mediaDevices.enumerateDevices().then(u=>{let p=(u=u.filter(f=>f.kind==="videoinput")).find(f=>d.some(m=>{var g;return pe(g=f.label.toLowerCase()).call(g,m)}));return!p&&u.length&&pe(d).call(d,"back")&&(p=u[u.length-1]),p&&(s.video.deviceId=c.exact?{exact:p.deviceId}:{ideal:p.deviceId}),s.video=n(s.video),j5("chrome: "+JSON.stringify(s)),a(s)})}s.video=n(s.video)}return j5("chrome: "+JSON.stringify(s)),a(s)},o=function(s){return t.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=(function(s,a,c){i(s,l=>{r.webkitGetUserMedia(l,a,d=>{c&&c(o(d))})})}).bind(r),r.mediaDevices.getUserMedia){let s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(a){return i(a,c=>s(c).then(l=>{if(c.audio&&!l.getAudioTracks().length||c.video&&!l.getVideoTracks().length)throw l.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return l},l=>de.reject(o(l))))}}}function sX(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function aX(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});let t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(s=>s.track&&s.track.id===n.track.id):{track:n.track};let o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(s=>s.track&&s.track.id===n.id):{track:n};let o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Eh(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function cX(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){let t=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};let i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(s,a){let c=i.apply(this,arguments);return c||(c=t(this,s),this._senders.push(c)),c};let o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(s){o.apply(this,arguments);let a=this._senders.indexOf(s);a!==-1&&this._senders.splice(a,1)}}let r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(i){this._senders=this._senders||[],r.apply(this,[i]),i.getTracks().forEach(o=>{this._senders.push(t(this,o))})};let n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(i){this._senders=this._senders||[],n.apply(this,[i]),i.getTracks().forEach(o=>{let s=this._senders.find(a=>a.track===o);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){let t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){let r=t.apply(this,[]);return r.forEach(n=>n._pc=this),r},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function lX(e){if(!e.RTCPeerConnection)return;let t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){let[r,n,i]=arguments;if(arguments.length>0&&typeof r=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof r!="function"))return t.apply(this,[]);let o=function(a){let c={};return a.result().forEach(l=>{let d={id:l.id,timestamp:l.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[l.type]||l.type};l.names().forEach(u=>{d[u]=l.stat(u)}),c[d.id]=d}),c},s=function(a){return new Map(Object.keys(a).map(c=>[c,a[c]]))};if(arguments.length>=2){let a=function(c){n(s(o(c)))};return t.apply(this,[a,r])}return new de((a,c)=>{t.apply(this,[function(l){a(s(o(l)))},c])}).then(n,i)}}function dX(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){let r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){let i=r.apply(this,[]);return i.forEach(o=>o._pc=this),i});let n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){let i=n.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){let i=this;return this._pc.getStats().then(o=>jU(o,i.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){let r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){let n=r.apply(this,[]);return n.forEach(i=>i._pc=this),n}),Eh(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){let n=this;return this._pc.getStats().then(i=>jU(i,n.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;let t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){let r=arguments[0],n,i,o;return this.getSenders().forEach(s=>{s.track===r&&(n?o=!0:n=s)}),this.getReceivers().forEach(s=>(s.track===r&&(i?o=!0:i=s),s.track===r)),o||n&&i?de.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():de.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function uX(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};let t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(o,s){if(!s)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};let a=t.apply(this,arguments);return this._shimmedLocalStreams[s.id]?this._shimmedLocalStreams[s.id].indexOf(a)===-1&&this._shimmedLocalStreams[s.id].push(a):this._shimmedLocalStreams[s.id]=[s,a],a};let r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(c=>{if(this.getSenders().find(l=>l.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});let s=this.getSenders();r.apply(this,arguments);let a=this.getSenders().filter(c=>s.indexOf(c)===-1);this._shimmedLocalStreams[o.id]=[o].concat(a)};let n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],n.apply(this,arguments)};let i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(s=>{let a=this._shimmedLocalStreams[s].indexOf(o);a!==-1&&this._shimmedLocalStreams[s].splice(a,1),this._shimmedLocalStreams[s].length===1&&delete this._shimmedLocalStreams[s]}),i.apply(this,arguments)}}function hX(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return uX(e);let r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){let c=r.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(l=>this._reverseStreams[l.id])};let n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){let l=new e.MediaStream(c.getTracks());this._streams[c.id]=l,this._reverseStreams[l.id]=c,c=l}n.apply(this,[c])};let i=e.RTCPeerConnection.prototype.removeStream;function o(c,l){let d=l.sdp;return Object.keys(c._reverseStreams||[]).forEach(u=>{let p=c._reverseStreams[u],f=c._streams[p.id];d=d.replace(new RegExp(f.id,"g"),p.id)}),new RTCSessionDescription({type:l.type,sdp:d})}e.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},e.RTCPeerConnection.prototype.addTrack=function(c,l){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");let d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(p=>p===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(p=>p.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};let u=this._streams[l.id];if(u)u.addTrack(c),de.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{let p=new e.MediaStream([c]);this._streams[l.id]=p,this._reverseStreams[p.id]=l,this.addStream(p)}return this.getSenders().find(p=>p.track===c)},["createOffer","createAnswer"].forEach(function(c){let l=e.RTCPeerConnection.prototype[c],d={[c](){let u=arguments;return arguments.length&&typeof arguments[0]=="function"?l.apply(this,[p=>{let f=o(this,p);u[0].apply(null,[f])},p=>{u[1]&&u[1].apply(null,p)},arguments[2]]):l.apply(this,arguments).then(p=>o(this,p))}};e.RTCPeerConnection.prototype[c]=d[c]});let s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(c,l){let d=l.sdp;return Object.keys(c._reverseStreams||[]).forEach(u=>{let p=c._reverseStreams[u],f=c._streams[p.id];d=d.replace(new RegExp(p.id,"g"),f.id)}),new RTCSessionDescription({type:l.type,sdp:d})}(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};let a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){let c=a.get.apply(this);return c.type===""?c:o(this,c)}}),e.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(c._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let l;this._streams=this._streams||{},Object.keys(this._streams).forEach(d=>{this._streams[d].getTracks().find(u=>c.track===u)&&(l=this._streams[d])}),l&&(l.getTracks().length===1?this.removeStream(this._reverseStreams[l.id]):l.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function lO(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){let n=e.RTCPeerConnection.prototype[r],i={[r](){return arguments[0]=new(r==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[r]=i[r]})}function pX(e,t){Eh(e,"negotiationneeded",r=>{let n=r.target;if(!(t.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")||n.signalingState==="stable")return r})}var U5=Object.freeze({__proto__:null,fixNegotiationNeeded:pX,shimAddTrackRemoveTrack:hX,shimAddTrackRemoveTrackWithNative:uX,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(typeof t=="function"?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(n=>{let i=r.video&&r.video.width,o=r.video&&r.video.height,s=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n,maxFrameRate:s||3}},i&&(r.video.mandatory.maxWidth=i),o&&(r.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:cX,shimGetStats:lX,shimGetUserMedia:oX,shimMediaStream:sX,shimOnTrack:aX,shimPeerConnection:lO,shimSenderReceiverGetStats:dX});function fX(e,t){let r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(i,o,s){QP("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(i).then(o,s)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){let i=function(s,a,c){a in s&&!(c in s)&&(s[c]=s[a],delete s[a])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},n&&n.prototype.getSettings){let s=n.prototype.getSettings;n.prototype.getSettings=function(){let a=s.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(n&&n.prototype.applyConstraints){let s=n.prototype.applyConstraints;n.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function mX(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function dO(e,t){if(typeof e!="object"||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){let o=e.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};e.RTCPeerConnection.prototype[i]=s[i]});let r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){let[i,o,s]=arguments;return n.apply(this,[i||null]).then(a=>{if(t.version<53&&!o)try{a.forEach(c=>{c.type=r[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;a.forEach((l,d)=>{a.set(d,Object.assign({},l,{type:r[l.type]||l.type}))})}return a}).then(o,s)}}function gX(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;let t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){let n=t.apply(this,[]);return n.forEach(i=>i._pc=this),n});let r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){let n=r.apply(this,arguments);return n._pc=this,n}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):de.resolve(new Map)}}function yX(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;let t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){let r=t.apply(this,[]);return r.forEach(n=>n._pc=this),r}),Eh(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function vX(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(t){QP("removeStream","removeTrack"),this.getSenders().forEach(r=>{var n;r.track&&pe(n=t.getTracks()).call(n,r.track)&&this.removeTrack(r)})})}function EX(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function _X(e){if(typeof e!="object"||!e.RTCPeerConnection)return;let t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];let n=r.length>0;n&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});let i=t.apply(this,arguments);if(n){let{sender:o}=i,s=o.getParameters();(!("encodings"in s)||s.encodings.length===1&&Object.keys(s.encodings[0]).length===0)&&(s.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(s).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return i})}function bX(e){if(typeof e!="object"||!e.RTCRtpSender)return;let t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){let r=t.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function wX(e){if(typeof e!="object"||!e.RTCPeerConnection)return;let t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?de.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function SX(e){if(typeof e!="object"||!e.RTCPeerConnection)return;let t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?de.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var F5=Object.freeze({__proto__:null,shimAddTransceiver:_X,shimCreateAnswer:SX,shimCreateOffer:wX,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){let n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,de.reject(n)}return r.video===!0?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})},shimGetParameters:bX,shimGetUserMedia:fX,shimOnTrack:mX,shimPeerConnection:dO,shimRTCDataChannel:EX,shimReceiverGetStats:yX,shimRemoveStream:vX,shimSenderGetStats:gX});function TX(e){if(typeof e=="object"&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){let t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(r){var n;this._localStreams||(this._localStreams=[]),pe(n=this._localStreams).call(n,r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>t.call(this,i,r)),r.getVideoTracks().forEach(i=>t.call(this,i,r))},e.RTCPeerConnection.prototype.addTrack=function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i&&i.forEach(s=>{var a;this._localStreams?pe(a=this._localStreams).call(a,s)||this._localStreams.push(s):this._localStreams=[s]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);let r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);let n=t.getTracks();this.getSenders().forEach(i=>{pe(n).call(n,i.track)&&this.removeTrack(i)})})}}function CX(e){if(typeof e=="object"&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(i=>{var o;if(this._remoteStreams||(this._remoteStreams=[]),pe(o=this._remoteStreams).call(o,i))return;this._remoteStreams.push(i);let s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});let t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){let r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach(i=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(i)>=0)return;r._remoteStreams.push(i);let o=new Event("addstream");o.stream=i,r.dispatchEvent(o)})}),t.apply(r,arguments)}}}function RX(e){if(typeof e!="object"||!e.RTCPeerConnection)return;let t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(c,l){let d=arguments.length>=2?arguments[2]:arguments[0],u=r.apply(this,[d]);return l?(u.then(c,l),de.resolve()):u},t.createAnswer=function(c,l){let d=arguments.length>=2?arguments[2]:arguments[0],u=n.apply(this,[d]);return l?(u.then(c,l),de.resolve()):u};let a=function(c,l,d){let u=i.apply(this,[c]);return d?(u.then(l,d),de.resolve()):u};t.setLocalDescription=a,a=function(c,l,d){let u=o.apply(this,[c]);return d?(u.then(l,d),de.resolve()):u},t.setRemoteDescription=a,a=function(c,l,d){let u=s.apply(this,[c]);return d?(u.then(l,d),de.resolve()):u},t.addIceCandidate=a}function IX(e){let t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){let r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=i=>n(AX(i))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(r,n,i){t.mediaDevices.getUserMedia(r).then(n,i)}).bind(t))}function AX(e){return e&&e.video!==void 0?Object.assign({},e,{video:hY(e.video)}):e}function xX(e){if(!e.RTCPeerConnection)return;let t=e.RTCPeerConnection;e.RTCPeerConnection=function(r,n){if(r&&r.iceServers){let i=[];for(let o=0;o<r.iceServers.length;o++){let s=r.iceServers[o];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(QP("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,i.push(s)):i.push(r.iceServers[o])}r.iceServers=i}return new t(r,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function OX(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function NX(e){let t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(r){if(r){r.offerToReceiveAudio!==void 0&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);let n=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&n?n.direction==="sendrecv"?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":n.direction==="recvonly"&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):r.offerToReceiveAudio!==!0||n||this.addTransceiver("audio",{direction:"recvonly"}),r.offerToReceiveVideo!==void 0&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);let i=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveVideo!==!0||i||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function kX(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var V5=Object.freeze({__proto__:null,shimAudioContext:kX,shimCallbacksAPI:RX,shimConstraints:AX,shimCreateOfferLegacy:NX,shimGetUserMedia:IX,shimLocalStreamsAPI:TX,shimRTCIceServerUrls:xX,shimRemoteStreamsAPI:CX,shimTrackEventTransceiver:OX}),PX=`	
\v\f\r                　\u2028\u2029\uFEFF`,iOe=tm,oOe=bs,uO=PX,B5=Br("".replace),sOe=RegExp("^["+uO+"]+"),aOe=RegExp("(^|[^"+uO+"])["+uO+"]+$"),gR=function(e){return function(t){var r=oOe(iOe(t));return 1&e&&(r=B5(r,sOe,"")),2&e&&(r=B5(r,aOe,"$1")),r}},cOe={start:gR(1),end:gR(2),trim:gR(3)},lOe=TY.PROPER,dOe=qr,$5=PX,uOe=cOe.trim;Yt({target:"String",proto:!0,forced:function(e){return dOe(function(){return!!$5[e]()||"​᠎"[e]()!=="​᠎"||lOe&&$5[e].name!==e})}("trim")},{trim:function(){return uOe(this)}});var hOe=sa("String").trim,pOe=Ti,fOe=hOe,yR=String.prototype,mOe=function(e){var t=e.trim;return typeof e=="string"||e===yR||pOe(yR,e)&&t===yR.trim?fOe:t},ci=xr(mOe),DX={exports:{}};(function(e){let t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(r){return r.trim().split(`
`).map(n=>n.trim())},t.splitSections=function(r){return r.split(`
m=`).map((n,i)=>(i>0?"m="+n:n).trim()+`\r
`)},t.getDescription=function(r){let n=t.splitSections(r);return n&&n[0]},t.getMediaSections=function(r){let n=t.splitSections(r);return n.shift(),n},t.matchPrefix=function(r,n){return t.splitLines(r).filter(i=>i.indexOf(n)===0)},t.parseCandidate=function(r){let n;n=r.indexOf("a=candidate:")===0?r.substring(12).split(" "):r.substring(10).split(" ");let i={foundation:n[0],component:{1:"rtp",2:"rtcp"}[n[1]]||n[1],protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]};for(let o=8;o<n.length;o+=2)switch(n[o]){case"raddr":i.relatedAddress=n[o+1];break;case"rport":i.relatedPort=parseInt(n[o+1],10);break;case"tcptype":i.tcpType=n[o+1];break;case"ufrag":i.ufrag=n[o+1],i.usernameFragment=n[o+1];break;default:i[n[o]]===void 0&&(i[n[o]]=n[o+1])}return i},t.writeCandidate=function(r){let n=[];n.push(r.foundation);let i=r.component;i==="rtp"?n.push(1):i==="rtcp"?n.push(2):n.push(i),n.push(r.protocol.toUpperCase()),n.push(r.priority),n.push(r.address||r.ip),n.push(r.port);let o=r.type;return n.push("typ"),n.push(o),o!=="host"&&r.relatedAddress&&r.relatedPort&&(n.push("raddr"),n.push(r.relatedAddress),n.push("rport"),n.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(n.push("ufrag"),n.push(r.usernameFragment||r.ufrag)),"candidate:"+n.join(" ")},t.parseIceOptions=function(r){return r.substring(14).split(" ")},t.parseRtpMap=function(r){let n=r.substring(9).split(" "),i={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),i.name=n[0],i.clockRate=parseInt(n[1],10),i.channels=n.length===3?parseInt(n[2],10):1,i.numChannels=i.channels,i},t.writeRtpMap=function(r){let n=r.payloadType;r.preferredPayloadType!==void 0&&(n=r.preferredPayloadType);let i=r.channels||r.numChannels||1;return"a=rtpmap:"+n+" "+r.name+"/"+r.clockRate+(i!==1?"/"+i:"")+`\r
`},t.parseExtmap=function(r){let n=r.substring(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1],attributes:n.slice(2).join(" ")}},t.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+(r.attributes?" "+r.attributes:"")+`\r
`},t.parseFmtp=function(r){let n={},i,o=r.substring(r.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)i=o[s].trim().split("="),n[i[0].trim()]=i[1];return n},t.writeFmtp=function(r){let n="",i=r.payloadType;if(r.preferredPayloadType!==void 0&&(i=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){let o=[];Object.keys(r.parameters).forEach(s=>{r.parameters[s]!==void 0?o.push(s+"="+r.parameters[s]):o.push(s)}),n+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return n},t.parseRtcpFb=function(r){let n=r.substring(r.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},t.writeRtcpFb=function(r){let n="",i=r.payloadType;return r.preferredPayloadType!==void 0&&(i=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(o=>{n+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),n},t.parseSsrcMedia=function(r){let n=r.indexOf(" "),i={ssrc:parseInt(r.substring(7,n),10)},o=r.indexOf(":",n);return o>-1?(i.attribute=r.substring(n+1,o),i.value=r.substring(o+1)):i.attribute=r.substring(n+1),i},t.parseSsrcGroup=function(r){let n=r.substring(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(i=>parseInt(i,10))}},t.getMid=function(r){let n=t.matchPrefix(r,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(r){let n=r.substring(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1].toUpperCase()}},t.getDtlsParameters=function(r,n){return{role:"auto",fingerprints:t.matchPrefix(r+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(r,n){let i="a=setup:"+n+`\r
`;return r.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},t.parseCryptoLine=function(r){let n=r.substring(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},t.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?t.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;let n=r.substring(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},t.getCryptoParameters=function(r,n){return t.matchPrefix(r+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(r,n){let i=t.matchPrefix(r+n,"a=ice-ufrag:")[0],o=t.matchPrefix(r+n,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},t.writeIceParameters=function(r){let n="a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`;return r.iceLite&&(n+=`a=ice-lite\r
`),n},t.parseRtpParameters=function(r){let n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(r)[0].split(" ");n.profile=i[2];for(let s=3;s<i.length;s++){let a=i[s],c=t.matchPrefix(r,"a=rtpmap:"+a+" ")[0];if(c){let l=t.parseRtpMap(c),d=t.matchPrefix(r,"a=fmtp:"+a+" ");switch(l.parameters=d.length?t.parseFmtp(d[0]):{},l.rtcpFeedback=t.matchPrefix(r,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),n.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(l.name.toUpperCase())}}}t.matchPrefix(r,"a=extmap:").forEach(s=>{n.headerExtensions.push(t.parseExtmap(s))});let o=t.matchPrefix(r,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach(s=>{o.forEach(a=>{s.rtcpFeedback.find(c=>c.type===a.type&&c.parameter===a.parameter)||s.rtcpFeedback.push(a)})}),n},t.writeRtpDescription=function(r,n){let i="";i+="m="+r+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(s=>{i+=t.writeRtpMap(s),i+=t.writeFmtp(s),i+=t.writeRtcpFb(s)});let o=0;return n.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),n.headerExtensions&&n.headerExtensions.forEach(s=>{i+=t.writeExtmap(s)}),i},t.parseRtpEncodingParameters=function(r){let n=[],i=t.parseRtpParameters(r),o=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=t.matchPrefix(r,"a=ssrc:").map(p=>t.parseSsrcMedia(p)).filter(p=>p.attribute==="cname"),c=a.length>0&&a[0].ssrc,l,d=t.matchPrefix(r,"a=ssrc-group:FID").map(p=>p.substring(17).split(" ").map(f=>parseInt(f,10)));d.length>0&&d[0].length>1&&d[0][0]===c&&(l=d[0][1]),i.codecs.forEach(p=>{if(p.name.toUpperCase()==="RTX"&&p.parameters.apt){let f={ssrc:c,codecPayloadType:parseInt(p.parameters.apt,10)};c&&l&&(f.rtx={ssrc:l}),n.push(f),o&&(f=JSON.parse(JSON.stringify(f)),f.fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},n.push(f))}}),n.length===0&&c&&n.push({ssrc:c});let u=t.matchPrefix(r,"b=");return u.length&&(u=u[0].indexOf("b=TIAS:")===0?parseInt(u[0].substring(7),10):u[0].indexOf("b=AS:")===0?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach(p=>{p.maxBitrate=u})),n},t.parseRtcpParameters=function(r){let n={},i=t.matchPrefix(r,"a=ssrc:").map(a=>t.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);let o=t.matchPrefix(r,"a=rtcp-rsize");n.reducedSize=o.length>0,n.compound=o.length===0;let s=t.matchPrefix(r,"a=rtcp-mux");return n.mux=s.length>0,n},t.writeRtcpParameters=function(r){let n="";return r.reducedSize&&(n+=`a=rtcp-rsize\r
`),r.mux&&(n+=`a=rtcp-mux\r
`),r.ssrc!==void 0&&r.cname&&(n+="a=ssrc:"+r.ssrc+" cname:"+r.cname+`\r
`),n},t.parseMsid=function(r){let n,i=t.matchPrefix(r,"a=msid:");if(i.length===1)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};let o=t.matchPrefix(r,"a=ssrc:").map(s=>t.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");return o.length>0?(n=o[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(r){let n=t.parseMLine(r),i=t.matchPrefix(r,"a=max-message-size:"),o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);let s=t.matchPrefix(r,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:n.fmt,maxMessageSize:o};let a=t.matchPrefix(r,"a=sctpmap:");if(a.length>0){let c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:o}}},t.writeSctpDescription=function(r,n){let i=[];return i=r.protocol!=="DTLS/SCTP"?["m="+r.kind+" 9 "+r.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:["m="+r.kind+" 9 "+r.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&i.push("a=max-message-size:"+n.maxMessageSize+`\r
`),i.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(r,n,i){let o,s=n!==void 0?n:2;return o=r||t.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(r,n){let i=t.splitLines(r);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(r){return t.splitLines(r)[0].split(" ")[0].substring(2)},t.isRejected=function(r){return r.split(" ",2)[1]==="0"},t.parseMLine=function(r){let n=t.splitLines(r)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(r){let n=t.matchPrefix(r,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;let n=t.splitLines(r);for(let i=0;i<n.length;i++)if(n[i].length<2||n[i].charAt(1)!=="=")return!1;return!0},e.exports=t})(DX);var LX=DX.exports,Kp=xr(LX),gOe=Mwe({__proto__:null,default:Kp},[LX]);function t_(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;let t=e.RTCIceCandidate;e.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&((r=JSON.parse(JSON.stringify(r))).candidate=r.candidate.substr(2)),r.candidate&&r.candidate.length){let n=new t(r),i=Kp.parseCandidate(r.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(r)},e.RTCIceCandidate.prototype=t.prototype,Eh(e,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new e.RTCIceCandidate(r.candidate),writable:"false"}),r))}function hO(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Eh(e,"icecandidate",t=>{if(t.candidate){let r=Kp.parseCandidate(t.candidate.candidate);r.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return t})}function r_(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});let r=function(a){if(!a||!a.sdp)return!1;let c=Kp.splitSections(a.sdp);return c.shift(),c.some(l=>{let d=Kp.parseMLine(l);return d&&d.kind==="application"&&d.protocol.indexOf("SCTP")!==-1})},n=function(a){let c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;let l=parseInt(c[1],10);return l!=l?-1:l},i=function(a){let c=65536;return t.browser==="firefox"&&(c=t.version<57?a===-1?16384:2147483637:t.version<60?t.version===57?65535:65536:2147483637),c},o=function(a,c){let l=65536;t.browser==="firefox"&&t.version===57&&(l=65535);let d=Kp.matchPrefix(a.sdp,"a=max-message-size:");return d.length>0?l=parseInt(d[0].substr(19),10):t.browser==="firefox"&&c!==-1&&(l=2147483637),l},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){let{sdpSemantics:a}=this.getConfiguration();a==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){let a=n(arguments[0]),c=i(a),l=o(arguments[0],a),d;d=c===0&&l===0?Number.POSITIVE_INFINITY:c===0||l===0?Math.max(c,l):Math.min(c,l);let u={};Object.defineProperty(u,"maxMessageSize",{get:()=>d}),this._sctp=u}return s.apply(this,arguments)}}function n_(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(n,i){let o=n.send;n.send=function(){let s=arguments[0],a=s.length||s.size||s.byteLength;if(n.readyState==="open"&&i.sctp&&a>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(n,arguments)}}let r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){let n=r.apply(this,arguments);return t(n,this),n},Eh(e,"datachannel",n=>(t(n.channel,n.target),n))}function pO(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;let t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{let n=t[r];t[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{let o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;let s=new Event("connectionstatechange",i);o.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function fO(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;let r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(n){if(n&&n.sdp&&n.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){let i=n.sdp.split(`
`).filter(o=>ci(o).call(o)!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&n instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:n.type,sdp:i}):n.sdp=i}return r.apply(this,arguments)}}function i_(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;let r=e.RTCPeerConnection.prototype.addIceCandidate;r&&r.length!==0&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?de.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),de.resolve())})}function o_(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;let r=e.RTCPeerConnection.prototype.setLocalDescription;r&&r.length!==0&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let n=arguments[0]||{};if(typeof n!="object"||n.type&&n.sdp)return r.apply(this,arguments);if(n={type:n.type,sdp:n.sdp},!n.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":n.type="offer";break;default:n.type="answer"}return n.sdp||n.type!=="offer"&&n.type!=="answer"?r.apply(this,[n]):(n.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(i=>r.apply(this,[i]))})}var yOe=Object.freeze({__proto__:null,removeExtmapAllowMixed:fO,shimAddIceCandidateNullOrEmpty:i_,shimConnectionState:pO,shimMaxMessageSize:r_,shimParameterlessSetLocalDescription:o_,shimRTCIceCandidate:t_,shimRTCIceCandidateRelayProtocol:hO,shimSendThrowTypeError:n_});(function(){let{window:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},r=uY,n=function(o){let s={browser:null,version:null};if(o===void 0||!o.navigator)return s.browser="Not a browser.",s;let{navigator:a}=o;if(a.mozGetUserMedia)s.browser="firefox",s.version=jv(a.userAgent,/Firefox\/(\d+)\./,1);else if(a.webkitGetUserMedia||o.isSecureContext===!1&&o.webkitRTCPeerConnection)s.browser="chrome",s.version=jv(a.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!o.RTCPeerConnection||!a.userAgent.match(/AppleWebKit\/(\d+)\./))return s.browser="Not a supported browser.",s;s.browser="safari",s.version=jv(a.userAgent,/AppleWebKit\/(\d+)\./,1),s.supportsUnifiedPlan=o.RTCRtpTransceiver&&"currentDirection"in o.RTCRtpTransceiver.prototype}return s}(e),i={browserDetails:n,commonShim:yOe,extractVersion:jv,disableLog:mCe,disableWarnings:gCe,sdp:gOe};switch(n.browser){case"chrome":if(!U5||!lO||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;if(n.version===null)return r("Chrome shim can not determine version, not shimming."),i;r("adapter.js shimming chrome."),i.browserShim=U5,i_(e,n),o_(e),oX(e,n),sX(e),lO(e,n),aX(e),hX(e,n),cX(e),lX(e),dX(e),pX(e,n),t_(e),hO(e),pO(e),r_(e,n),n_(e),fO(e,n);break;case"firefox":if(!F5||!dO||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),i.browserShim=F5,i_(e,n),o_(e),fX(e,n),dO(e,n),mX(e),vX(e),gX(e),yX(e),EX(e),_X(e),bX(e),wX(e),SX(e),t_(e),pO(e),r_(e,n),n_(e);break;case"safari":if(!V5||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),i.browserShim=V5,i_(e,n),o_(e),xX(e),NX(e),RX(e),TX(e),CX(e),OX(e),IX(e),kX(e),t_(e),hO(e),r_(e,n),n_(e),fO(e,n);break;default:r("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var vOe=sa("Array").keys,EOe=Cc,_Oe=Kn,bOe=Ti,wOe=vOe,vR=Array.prototype,SOe={DOMTokenList:!0,NodeList:!0},TOe=function(e){var t=e.keys;return e===vR||bOe(vR,e)&&t===vR.keys||_Oe(SOe,EOe(e))?wOe:t},wo=xr(TOe),H5=nm,COe=TypeError,ROe=LS,IOe=oa,AOe=Ud,zS=function(e,t,r){var n=ROe(t);n in e?IOe.f(e,n,AOe(0,r)):e[n]=r},W5=YP,xOe=El,OOe=zS,NOe=Array,kOe=Math.max,fD=function(e,t,r){for(var n=xOe(e),i=W5(t,n),o=W5(r===void 0?n:r,n),s=NOe(kOe(o-i,0)),a=0;i<o;i++,a++)OOe(s,a,e[i]);return s.length=a,s},G5=fD,POe=Math.floor,mO=function(e,t){var r=e.length,n=POe(r/2);return r<8?DOe(e,t):LOe(e,mO(G5(e,0,n),t),mO(G5(e,n),t),t)},DOe=function(e,t){for(var r,n,i=e.length,o=1;o<i;){for(n=o,r=e[o];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==o++&&(e[n]=r)}return e},LOe=function(e,t,r,n){for(var i=t.length,o=r.length,s=0,a=0;s<i||a<o;)e[s+a]=s<i&&a<o?n(t[s],r[a])<=0?t[s++]:r[a++]:s<i?t[s++]:r[a++];return e},MX=mO,z5=vh.match(/firefox\/(\d+)/i),MOe=!!z5&&+z5[1],jOe=/MSIE|Trident/.test(vh),K5=vh.match(/AppleWebKit\/(\d+)\./),UOe=!!K5&&+K5[1],FOe=Yt,jX=Br,VOe=ia,BOe=Tc,q5=El,$Oe=function(e,t){if(!delete e[t])throw COe("Cannot delete property "+H5(t)+" of "+H5(e))},Y5=bs,mD=qr,HOe=MX,WOe=MS,X5=MOe,GOe=jOe,J5=rh,Q5=UOe,rd=[],Z5=jX(rd.sort),zOe=jX(rd.push),KOe=mD(function(){rd.sort(void 0)}),qOe=mD(function(){rd.sort(null)}),YOe=WOe("sort"),e4=!mD(function(){if(J5)return J5<70;if(!(X5&&X5>3)){if(GOe)return!0;if(Q5)return Q5<603;var e,t,r,n,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)rd.push({k:t+n,v:r})}for(rd.sort(function(o,s){return s.v-o.v}),n=0;n<rd.length;n++)t=rd[n].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return i!=="DGBEFHACIJK"}});FOe({target:"Array",proto:!0,forced:KOe||!qOe||!YOe||!e4},{sort:function(e){e!==void 0&&VOe(e);var t=BOe(this);if(e4)return e===void 0?Z5(t):Z5(t,e);var r,n,i=[],o=q5(t);for(n=0;n<o;n++)n in t&&zOe(i,t[n]);for(HOe(i,function(s){return function(a,c){return c===void 0?-1:a===void 0?1:s!==void 0?+s(a,c)||0:Y5(a)>Y5(c)?1:-1}}(e)),r=q5(i),n=0;n<r;)t[n]=i[n++];for(;n<o;)$Oe(t,n++);return t}});var ER,_R,XOe=sa("Array").sort,JOe=Ti,QOe=XOe,bR=Array.prototype,ZOe=function(e){var t=e.sort;return e===bR||JOe(bR,e)&&t===bR.sort?QOe:t},Vy=xr(ZOe),gO={exports:{}};ER=gO,_R=gO.exports,function(e,t){var r="function",n="undefined",i="object",o="string",s="major",a="model",c="name",l="type",d="vendor",u="version",p="architecture",f="console",m="mobile",g="tablet",y="smarttv",v="wearable",E="embedded",w="Amazon",S="Apple",A="ASUS",N="BlackBerry",L="Browser",j="Chrome",W="Firefox",V="Google",Y="Huawei",Z="LG",te="Microsoft",H="Motorola",$="Opera",K="Samsung",x="Sharp",O="Sony",F="Xiaomi",P="Zebra",_="Facebook",R="Chromium OS",k="Mac OS",z=function(Ye){for(var _t={},Te=0;Te<Ye.length;Te++)_t[Ye[Te].toUpperCase()]=Ye[Te];return _t},U=function(Ye,_t){return typeof Ye===o&&q(_t).indexOf(q(Ye))!==-1},q=function(Ye){return Ye.toLowerCase()},ie=function(Ye,_t){if(typeof Ye===o)return Ye=Ye.replace(/^\s\s*/,""),typeof _t===n?Ye:Ye.substring(0,350)},ue=function(Ye,_t){for(var Te,Ze,Ve,Ke,Ge,ee,Ae=0;Ae<_t.length&&!Ge;){var Le=_t[Ae],We=_t[Ae+1];for(Te=Ze=0;Te<Le.length&&!Ge&&Le[Te];)if(Ge=Le[Te++].exec(Ye))for(Ve=0;Ve<We.length;Ve++)ee=Ge[++Ze],typeof(Ke=We[Ve])===i&&Ke.length>0?Ke.length===2?typeof Ke[1]==r?this[Ke[0]]=Ke[1].call(this,ee):this[Ke[0]]=Ke[1]:Ke.length===3?typeof Ke[1]!==r||Ke[1].exec&&Ke[1].test?this[Ke[0]]=ee?ee.replace(Ke[1],Ke[2]):t:this[Ke[0]]=ee?Ke[1].call(this,ee,Ke[2]):t:Ke.length===4&&(this[Ke[0]]=ee?Ke[3].call(this,ee.replace(Ke[1],Ke[2])):t):this[Ke]=ee||t;Ae+=2}},me=function(Ye,_t){for(var Te in _t)if(typeof _t[Te]===i&&_t[Te].length>0){for(var Ze=0;Ze<_t[Te].length;Ze++)if(U(_t[Te][Ze],Ye))return Te==="?"?t:Te}else if(U(_t[Te],Ye))return Te==="?"?t:Te;return Ye},De={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},He={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[u,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[u,[c,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[c,u],[/opios[\/ ]+([\w\.]+)/i],[u,[c,$+" Mini"]],[/\bopr\/([\w\.]+)/i],[u,[c,$]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,u],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[u,[c,"UC"+L]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[u,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[u,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[u,[c,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[u,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[u,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure "+L],u],[/\bfocus\/([\w\.]+)/i],[u,[c,W+" Focus"]],[/\bopt\/([\w\.]+)/i],[u,[c,$+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[u,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[u,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[u,[c,$+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[u,[c,"MIUI "+L]],[/fxios\/([-\w\.]+)/i],[u,[c,W]],[/\bqihu|(qi?ho?o?|360)browser/i],[[c,"360 "+L]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 "+L],u],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],u],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[c,u],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[c],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[c,_],u],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[c,u],[/\bgsa\/([\w\.]+) .*safari\//i],[u,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[u,[c,j+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[c,j+" WebView"],u],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[u,[c,"Android "+L]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[c,u],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[u,[c,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[u,c],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[c,[u,me,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[c,u],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[c,"Netscape"],u],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[u,[c,W+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[c,u],[/(cobalt)\/([\w\.]+)/i],[c,[u,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,q]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",q]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,q]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[a,[d,K],[l,g]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[a,[d,K],[l,m]],[/\((ip(?:hone|od)[\w ]*);/i],[a,[d,S],[l,m]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[d,S],[l,g]],[/(macintosh);/i],[a,[d,S]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[a,[d,x],[l,m]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[a,[d,Y],[l,g]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[a,[d,Y],[l,m]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[a,/_/g," "],[d,F],[l,m]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[a,/_/g," "],[d,F],[l,g]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[a,[d,"OPPO"],[l,m]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[a,[d,"Vivo"],[l,m]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[a,[d,"Realme"],[l,m]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[a,[d,H],[l,m]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[a,[d,H],[l,g]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[a,[d,Z],[l,g]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[a,[d,Z],[l,m]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[a,[d,"Lenovo"],[l,g]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[a,/_/g," "],[d,"Nokia"],[l,m]],[/(pixel c)\b/i],[a,[d,V],[l,g]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[a,[d,V],[l,m]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[d,O],[l,m]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[a,"Xperia Tablet"],[d,O],[l,g]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[a,[d,"OnePlus"],[l,m]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[a,[d,w],[l,g]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[a,/(.+)/g,"Fire Phone $1"],[d,w],[l,m]],[/(playbook);[-\w\),; ]+(rim)/i],[a,d,[l,g]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[a,[d,N],[l,m]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[a,[d,A],[l,g]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[a,[d,A],[l,m]],[/(nexus 9)/i],[a,[d,"HTC"],[l,g]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[a,/_/g," "],[l,m]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[a,[d,"Acer"],[l,g]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[a,[d,"Meizu"],[l,m]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,a,[l,m]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,a,[l,g]],[/(surface duo)/i],[a,[d,te],[l,g]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[a,[d,"Fairphone"],[l,m]],[/(u304aa)/i],[a,[d,"AT&T"],[l,m]],[/\bsie-(\w*)/i],[a,[d,"Siemens"],[l,m]],[/\b(rct\w+) b/i],[a,[d,"RCA"],[l,g]],[/\b(venue[\d ]{2,7}) b/i],[a,[d,"Dell"],[l,g]],[/\b(q(?:mv|ta)\w+) b/i],[a,[d,"Verizon"],[l,g]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[a,[d,"Barnes & Noble"],[l,g]],[/\b(tm\d{3}\w+) b/i],[a,[d,"NuVision"],[l,g]],[/\b(k88) b/i],[a,[d,"ZTE"],[l,g]],[/\b(nx\d{3}j) b/i],[a,[d,"ZTE"],[l,m]],[/\b(gen\d{3}) b.+49h/i],[a,[d,"Swiss"],[l,m]],[/\b(zur\d{3}) b/i],[a,[d,"Swiss"],[l,g]],[/\b((zeki)?tb.*\b) b/i],[a,[d,"Zeki"],[l,g]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],a,[l,g]],[/\b(ns-?\w{0,9}) b/i],[a,[d,"Insignia"],[l,g]],[/\b((nxa|next)-?\w{0,9}) b/i],[a,[d,"NextBook"],[l,g]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],a,[l,m]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],a,[l,m]],[/\b(ph-1) /i],[a,[d,"Essential"],[l,m]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[a,[d,"Envizen"],[l,g]],[/\b(trio[-\w\. ]+) b/i],[a,[d,"MachSpeed"],[l,g]],[/\btu_(1491) b/i],[a,[d,"Rotor"],[l,g]],[/(shield[\w ]+) b/i],[a,[d,"Nvidia"],[l,g]],[/(sprint) (\w+)/i],[d,a,[l,m]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[d,te],[l,m]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[d,P],[l,g]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[d,P],[l,m]],[/smart-tv.+(samsung)/i],[d,[l,y]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[d,K],[l,y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,Z],[l,y]],[/(apple) ?tv/i],[d,[a,S+" TV"],[l,y]],[/crkey/i],[[a,j+"cast"],[d,V],[l,y]],[/droid.+aft(\w)( bui|\))/i],[a,[d,w],[l,y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[a,[d,x],[l,y]],[/(bravia[\w ]+)( bui|\))/i],[a,[d,O],[l,y]],[/(mitv-\w{5}) bui/i],[a,[d,F],[l,y]],[/Hbbtv.*(technisat) (.*);/i],[d,a,[l,y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[d,ie],[a,ie],[l,y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,a,[l,f]],[/droid.+; (shield) bui/i],[a,[d,"Nvidia"],[l,f]],[/(playstation [345portablevi]+)/i],[a,[d,O],[l,f]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[a,[d,te],[l,f]],[/((pebble))app/i],[d,a,[l,v]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[a,[d,S],[l,v]],[/droid.+; (glass) \d/i],[a,[d,V],[l,v]],[/droid.+; (wt63?0{2,3})\)/i],[a,[d,P],[l,v]],[/(quest( 2| pro)?)/i],[a,[d,_],[l,v]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[l,E]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[a,[l,m]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[a,[l,g]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,g]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[l,m]],[/(android[-\w\. ]{0,9});.+buil/i],[a,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[u,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[u,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[c,u],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[u,c]],os:[[/microsoft (windows) (vista|xp)/i],[c,u],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[c,[u,me,De]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[c,"Windows"],[u,me,De]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[u,/_/g,"."],[c,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[c,k],[u,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[u,c],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[c,u],[/\(bb(10);/i],[u,[c,N]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[u,[c,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[u,[c,W+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[u,[c,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[u,[c,"watchOS"]],[/crkey\/([\d\.]+)/i],[u,[c,j+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[c,R],u],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[c,u],[/(sunos) ?([\w\.\d]*)/i],[[c,"Solaris"],u],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[c,u]]},Pe=function(Ye,_t){if(typeof Ye===i&&(_t=Ye,Ye=t),!(this instanceof Pe))return new Pe(Ye,_t).getResult();var Te=typeof e!==n&&e.navigator?e.navigator:t,Ze=Ye||(Te&&Te.userAgent?Te.userAgent:""),Ve=Te&&Te.userAgentData?Te.userAgentData:t,Ke=_t?function(Ge,ee){var Ae={};for(var Le in Ge)ee[Le]&&ee[Le].length%2==0?Ae[Le]=ee[Le].concat(Ge[Le]):Ae[Le]=Ge[Le];return Ae}(He,_t):He;return this.getBrowser=function(){var Ge={};return Ge[c]=t,Ge[u]=t,ue.call(Ge,Ze,Ke.browser),Ge[s]=function(ee){return typeof ee===o?ee.replace(/[^\d\.]/g,"").split(".")[0]:t}(Ge[u]),Te&&Te.brave&&typeof Te.brave.isBrave==r&&(Ge[c]="Brave"),Ge},this.getCPU=function(){var Ge={};return Ge[p]=t,ue.call(Ge,Ze,Ke.cpu),Ge},this.getDevice=function(){var Ge={};return Ge[d]=t,Ge[a]=t,Ge[l]=t,ue.call(Ge,Ze,Ke.device),!Ge[l]&&Ve&&Ve.mobile&&(Ge[l]=m),Ge[a]=="Macintosh"&&Te&&typeof Te.standalone!==n&&Te.maxTouchPoints&&Te.maxTouchPoints>2&&(Ge[a]="iPad",Ge[l]=g),Ge},this.getEngine=function(){var Ge={};return Ge[c]=t,Ge[u]=t,ue.call(Ge,Ze,Ke.engine),Ge},this.getOS=function(){var Ge={};return Ge[c]=t,Ge[u]=t,ue.call(Ge,Ze,Ke.os),!Ge[c]&&Ve&&Ve.platform!="Unknown"&&(Ge[c]=Ve.platform.replace(/chrome os/i,R).replace(/macos/i,k)),Ge},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Ze},this.setUA=function(Ge){return Ze=typeof Ge===o&&Ge.length>350?ie(Ge,350):Ge,this},this.setUA(Ze),this};Pe.VERSION="0.7.34",Pe.BROWSER=z([c,u,s]),Pe.CPU=z([p]),Pe.DEVICE=z([a,d,l,f,m,y,g,v,E]),Pe.ENGINE=Pe.OS=z([c,u]),ER.exports&&(_R=ER.exports=Pe),_R.UAParser=Pe;var nt=typeof e!==n&&(e.jQuery||e.Zepto);if(nt&&!nt.ua){var Rt=new Pe;nt.ua=Rt.getResult(),nt.ua.get=function(){return Rt.getUA()},nt.ua.set=function(Ye){Rt.setUA(Ye);var _t=Rt.getResult();for(var Te in _t)nt.ua[Te]=_t[Te]}}}(typeof window=="object"?window:Gp);var eNe=xr(gO.exports),tNe=Cc,rNe=Kn,nNe=em,iNe=_h,oNe=jr("iterator"),sNe=Object,aNe=function(e){if(nNe(e))return!1;var t=sNe(e);return t[oNe]!==void 0||"@@iterator"in t||rNe(iNe,tNe(t))},cNe=xr(aNe),wR=Mn;Yt({global:!0,forced:wR.globalThis!==wR},{globalThis:wR});var t4=xr(Mn);function UX(e,t){return function(){return e.apply(t,arguments)}}var{toString:lNe}=Object.prototype,{getPrototypeOf:gD}=Object,Hb=(SR=Object.create(null),e=>{let t=lNe.call(e);return SR[t]||(SR[t]=t.slice(8,-1).toLowerCase())}),SR,Ic=e=>(e=e.toLowerCase(),t=>Hb(t)===e),KS=e=>t=>typeof t===e,{isArray:tp}=Array,sg=KS("undefined"),r4=Ic("ArrayBuffer"),dNe=KS("string"),As=KS("function"),n4=KS("number"),Wv=e=>e!==null&&typeof e=="object",Gv=e=>{if(Hb(e)!=="object")return!1;let t=gD(e);return!(t!==null&&t!==Object.prototype&&Object.getPrototypeOf(t)!==null||Symbol.toStringTag in e||cNe(e))},uNe=Ic("Date"),hNe=Ic("File"),pNe=Ic("Blob"),fNe=Ic("FileList"),mNe=Ic("URLSearchParams");function ag(e,t){let r,n,{allOwnKeys:i=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e!=null)if(typeof e!="object"&&(e=[e]),tp(e))for(r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else{let o=i?Object.getOwnPropertyNames(e):Object.keys(e),s=o.length,a;for(r=0;r<s;r++)a=o[r],t.call(null,e[a],a,e)}}function i4(e,t){t=t.toLowerCase();let r=Object.keys(e),n,i=r.length;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}var FX=t4!==void 0?t4:typeof self<"u"?self:typeof window<"u"?window:global,o4=e=>!sg(e)&&e!==FX,gNe=(TR=typeof Uint8Array<"u"&&gD(Uint8Array),e=>TR&&e instanceof TR),TR,yNe=Ic("HTMLFormElement"),s4=(e=>{let{hasOwnProperty:t}=e;return(r,n)=>t.call(r,n)})(Object.prototype),vNe=Ic("RegExp"),a4=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),n={};ag(r,(i,o)=>{let s;(s=t(i,o,e))!==!1&&(n[o]=s||i)}),Object.defineProperties(e,n)},CR="abcdefghijklmnopqrstuvwxyz",c4="0123456789",l4={DIGIT:c4,ALPHA:CR,ALPHA_DIGIT:CR+CR.toUpperCase()+c4},ENe=Ic("AsyncFunction"),ge={isArray:tp,isArrayBuffer:r4,isBuffer:function(e){return e!==null&&!sg(e)&&e.constructor!==null&&!sg(e.constructor)&&As(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||As(e.append)&&((t=Hb(e))==="formdata"||t==="object"&&As(e.toString)&&e.toString()==="[object FormData]"))},isArrayBufferView:function(e){let t;return t=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&r4(e.buffer),t},isString:dNe,isNumber:n4,isBoolean:e=>e===!0||e===!1,isObject:Wv,isPlainObject:Gv,isUndefined:sg,isDate:uNe,isFile:hNe,isBlob:pNe,isRegExp:vNe,isFunction:As,isStream:e=>Wv(e)&&As(e.pipe),isURLSearchParams:mNe,isTypedArray:gNe,isFileList:fNe,forEach:ag,merge:function e(){let{caseless:t}=o4(this)&&this||{},r={},n=(i,o)=>{let s=t&&i4(r,o)||o;Gv(r[s])&&Gv(i)?r[s]=e(r[s],i):Gv(i)?r[s]=e({},i):tp(i)?r[s]=i.slice():r[s]=i};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&ag(arguments[i],n);return r},extend:function(e,t,r){let{allOwnKeys:n}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return ag(t,(i,o)=>{r&&As(i)?e[o]=UX(i,r):e[o]=i},{allOwnKeys:n}),e},trim:e=>ci(e)?ci(e).call(e):e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits:(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,n)=>{let i,o,s,a={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)s=i[o],n&&!n(s,e,t)||a[s]||(t[s]=e[s],a[s]=!0);e=r!==!1&&gD(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:Hb,kindOfTest:Ic,endsWith:(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;let n=e.indexOf(t,r);return n!==-1&&n===r},toArray:e=>{if(!e)return null;if(tp(e))return e;let t=e.length;if(!n4(t))return null;let r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{let r=(e&&e[Symbol.iterator]).call(e),n;for(;(n=r.next())&&!n.done;){let i=n.value;t.call(e,i[0],i[1])}},matchAll:(e,t)=>{let r,n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},isHTMLForm:yNe,hasOwnProperty:s4,hasOwnProp:s4,reduceDescriptors:a4,freezeMethods:e=>{a4(e,(t,r)=>{if(As(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;let n=e[r];As(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,t)=>{let r={},n=i=>{i.forEach(o=>{r[o]=!0})};return tp(e)?n(e):n(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,n){return r.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:i4,global:FX,isContextDefined:o4,ALPHABET:l4,generateString:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l4.ALPHA_DIGIT,r="",{length:n}=t;for(;e--;)r+=t[Math.random()*n|0];return r},isSpecCompliantForm:function(e){return!!(e&&As(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])},toJSONObject:e=>{let t=new Array(10),r=(n,i)=>{if(Wv(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[i]=n;let o=tp(n)?[]:{};return ag(n,(s,a)=>{let c=r(s,i+1);!sg(c)&&(o[a]=c)}),t[i]=void 0,o}}return n};return r(e,0)},isAsyncFn:ENe,isThenable:e=>e&&(Wv(e)||As(e))&&As(e.then)&&As(e.catch)};function cr(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i)}ge.inherits(cr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ge.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var d4=cr.prototype,u4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{u4[e]={value:e}}),Object.defineProperties(cr,u4),Object.defineProperty(d4,"isAxiosError",{value:!0}),cr.from=(e,t,r,n,i,o)=>{let s=Object.create(d4);return ge.toFlatObject(e,s,function(a){return a!==Error.prototype},a=>a!=="isAxiosError"),cr.call(s,e.message,t,r,n,i),s.cause=e,s.name=e.name,o&&Object.assign(s,o),s};function RR(e){return ge.isPlainObject(e)||ge.isArray(e)}function VX(e){return ge.endsWith(e,"[]")?e.slice(0,-2):e}function h4(e,t,r){return e?e.concat(t).map(function(n,i){return n=VX(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}var _Ne=ge.toFlatObject(ge,{},null,function(e){return/^is[A-Z]/.test(e)});function Wb(e,t,r){if(!ge.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;let n=(r=ge.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,f){return!ge.isUndefined(f[p])})).metaTokens,i=r.visitor||l,o=r.dots,s=r.indexes,a=(r.Blob||typeof Blob<"u"&&Blob)&&ge.isSpecCompliantForm(t);if(!ge.isFunction(i))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(ge.isDate(p))return p.toISOString();if(!a&&ge.isBlob(p))throw new cr("Blob is not supported. Use a Buffer instead.");return ge.isArrayBuffer(p)||ge.isTypedArray(p)?a&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function l(p,f,m){let g=p;if(p&&!m&&typeof p=="object"){if(ge.endsWith(f,"{}"))f=n?f:f.slice(0,-2),p=JSON.stringify(p);else if(ge.isArray(p)&&function(y){return ge.isArray(y)&&!y.some(RR)}(p)||(ge.isFileList(p)||ge.endsWith(f,"[]"))&&(g=ge.toArray(p)))return f=VX(f),g.forEach(function(y,v){!ge.isUndefined(y)&&y!==null&&t.append(s===!0?h4([f],v,o):s===null?f:f+"[]",c(y))}),!1}return!!RR(p)||(t.append(h4(m,f,o),c(p)),!1)}let d=[],u=Object.assign(_Ne,{defaultVisitor:l,convertValue:c,isVisitable:RR});if(!ge.isObject(e))throw new TypeError("data must be an object");return function p(f,m){if(!ge.isUndefined(f)){if(d.indexOf(f)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(f),ge.forEach(f,function(g,y){(!(ge.isUndefined(g)||g===null)&&i.call(t,g,ge.isString(y)?ci(y).call(y):y,m,u))===!0&&p(g,m?m.concat(y):[y])}),d.pop()}}(e),t}function p4(e){let t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function yD(e,t){this._pairs=[],e&&Wb(e,this,t)}var f4=yD.prototype;function bNe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function BX(e,t,r){if(!t)return e;let n=r&&r.encode||bNe,i=r&&r.serialize,o;if(o=i?i(t,r):ge.isURLSearchParams(t)?t.toString():new yD(t,r).toString(n),o){let s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}f4.append=function(e,t){this._pairs.push([e,t])},f4.toString=function(e){let t=e?function(r){return e.call(this,r,p4)}:p4;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};var m4=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ge.forEach(this.handlers,function(t){t!==null&&e(t)})}},$X={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},HX={exports:{}},wNe=Yt,SNe=_s,g4=oa.f;wNe({target:"Object",stat:!0,forced:Object.defineProperty!==g4,sham:!SNe},{defineProperty:g4});var WX=ja.Object,TNe=HX.exports=function(e,t,r){return WX.defineProperty(e,t,r)};WX.defineProperty.sham&&(TNe.sham=!0);var GX=xr(HX.exports),CNe=Sc,By=Array.isArray||function(e){return CNe(e)=="Array"},RNe=TypeError,y4=By,INe=HS,ANe=Bo,xNe=jr("species"),v4=Array,ONe=function(e){var t;return y4(e)&&(t=e.constructor,(INe(t)&&(t===v4||y4(t.prototype))||ANe(t)&&(t=t[xNe])===null)&&(t=void 0)),t===void 0?v4:t},zX=function(e,t){return new(ONe(e))(t===0?0:t)},NNe=qr,kNe=rh,PNe=jr("species"),KX=function(e){return kNe>=51||!NNe(function(){var t=[];return(t.constructor={})[PNe]=function(){return{foo:1}},t[e](Boolean).foo!==1})},DNe=Yt,LNe=qr,MNe=By,jNe=Bo,UNe=Tc,FNe=El,E4=function(e){if(e>9007199254740991)throw RNe("Maximum allowed index exceeded");return e},_4=zS,VNe=zX,BNe=KX,$Ne=rh,qX=jr("isConcatSpreadable"),HNe=$Ne>=51||!LNe(function(){var e=[];return e[qX]=!1,e.concat()[0]!==e}),WNe=function(e){if(!jNe(e))return!1;var t=e[qX];return t!==void 0?!!t:MNe(e)};DNe({target:"Array",proto:!0,arity:1,forced:!HNe||!BNe("concat")},{concat:function(e){var t,r,n,i,o,s=UNe(this),a=VNe(s,0),c=0;for(t=-1,n=arguments.length;t<n;t++)if(WNe(o=t===-1?s:arguments[t]))for(i=FNe(o),E4(c+i),r=0;r<i;r++,c++)r in o&&_4(a,c,o[r]);else E4(c+1),_4(a,c++,o);return a.length=c,a}});var YX={},GNe=Sc,zNe=Fd,b4=US.f,KNe=fD,w4=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];YX.f=function(e){return w4&&GNe(e)=="Window"?function(t){try{return b4(t)}catch{return KNe(w4)}}(e):b4(zNe(e))};var sm={},qNe=jr;sm.f=qNe;var S4=ja,YNe=Kn,XNe=sm,JNe=oa.f,On=function(e){var t=S4.Symbol||(S4.Symbol={});YNe(t,e)||JNe(t,e,{value:XNe.f(e)})},QNe=Un,ZNe=mo,eke=jr,tke=$d,XX=function(){var e=ZNe("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=eke("toPrimitive");t&&!t[n]&&tke(t,n,function(i){return QNe(r,this)},{arity:1})},rke=Vd,nke=PS,ike=Tc,oke=El,ske=zX,T4=Br([].push),xl=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,o=e==6,s=e==7,a=e==5||o;return function(c,l,d,u){for(var p,f,m=ike(c),g=nke(m),y=rke(l,d),v=oke(g),E=0,w=u||ske,S=t?w(c,v):r||s?w(c,0):void 0;v>E;E++)if((a||E in g)&&(f=y(p=g[E],E,m),e))if(t)S[E]=f;else if(f)switch(e){case 3:return!0;case 5:return p;case 6:return E;case 2:T4(S,p)}else switch(e){case 4:return!1;case 7:T4(S,p)}return o?-1:n||i?i:S}},JX={forEach:xl(0),map:xl(1),filter:xl(2),some:xl(3),every:xl(4),find:xl(5),findIndex:xl(6),filterReject:xl(7)},zv=Yt,vD=Mn,ED=Un,ake=Br,qp=_s,Bh=rm,cke=qr,vi=Kn,lke=Ti,yO=Xi,qS=Fd,_D=LS,dke=bs,vO=Ud,N0=My,QX=VS,uke=US,ZX=YX,hke=Ly,eJ=Ny,tJ=oa,pke=tD,rJ=kS,C4=$d,fke=$S,bD=im,nJ=FS,R4=zP,mke=jr,gke=sm,yke=On,vke=XX,Eke=Hd,iJ=bh,YS=JX.forEach,Co=jS("hidden"),Gb="Symbol",k0="prototype",_ke=iJ.set,I4=iJ.getterFor(Gb),Ra=Object[k0],Rp=vD.Symbol,s_=Rp&&Rp[k0],bke=vD.TypeError,IR=vD.QObject,oJ=eJ.f,pu=tJ.f,sJ=ZX.f,wke=rJ.f,aJ=ake([].push),fl=bD("symbols"),$y=bD("op-symbols"),Ske=bD("wks"),AR=!IR||!IR[k0]||!IR[k0].findChild,EO=qp&&cke(function(){return N0(pu({},"a",{get:function(){return pu(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=oJ(Ra,t);n&&delete Ra[t],pu(e,t,r),n&&e!==Ra&&pu(Ra,t,n)}:pu,xR=function(e,t){var r=fl[e]=N0(s_);return _ke(r,{type:Gb,tag:e,description:t}),qp||(r.description=t),r},zb=function(e,t,r){e===Ra&&zb($y,t,r),yO(e);var n=_D(t);return yO(r),vi(fl,n)?(r.enumerable?(vi(e,Co)&&e[Co][n]&&(e[Co][n]=!1),r=N0(r,{enumerable:vO(0,!1)})):(vi(e,Co)||pu(e,Co,vO(1,{})),e[Co][n]=!0),EO(e,n,r)):pu(e,n,r)},OR=function(e,t){yO(e);var r=qS(t),n=QX(r).concat(lJ(r));return YS(n,function(i){qp&&!ED(cJ,r,i)||zb(e,i,r[i])}),e},cJ=function(e){var t=_D(e),r=ED(wke,this,t);return!(this===Ra&&vi(fl,t)&&!vi($y,t))&&(!(r||!vi(this,t)||!vi(fl,t)||vi(this,Co)&&this[Co][t])||r)},A4=function(e,t){var r=qS(e),n=_D(t);if(r!==Ra||!vi(fl,n)||vi($y,n)){var i=oJ(r,n);return!i||!vi(fl,n)||vi(r,Co)&&r[Co][n]||(i.enumerable=!0),i}},x4=function(e){var t=sJ(qS(e)),r=[];return YS(t,function(n){vi(fl,n)||vi(nJ,n)||aJ(r,n)}),r},lJ=function(e){var t=e===Ra,r=sJ(t?$y:qS(e)),n=[];return YS(r,function(i){!vi(fl,i)||t&&!vi(Ra,i)||aJ(n,fl[i])}),n};Bh||(C4(s_=(Rp=function(){if(lke(s_,this))throw bke("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==void 0?dke(arguments[0]):void 0,t=R4(e),r=function(n){this===Ra&&ED(r,$y,n),vi(this,Co)&&vi(this[Co],t)&&(this[Co][t]=!1),EO(this,t,vO(1,n))};return qp&&AR&&EO(Ra,t,{configurable:!0,set:r}),xR(t,e)})[k0],"toString",function(){return I4(this).tag}),C4(Rp,"withoutSetter",function(e){return xR(R4(e),e)}),rJ.f=cJ,tJ.f=zb,pke.f=OR,eJ.f=A4,uke.f=ZX.f=x4,hke.f=lJ,gke.f=function(e){return xR(mke(e),e)},qp&&fke(s_,"description",{configurable:!0,get:function(){return I4(this).description}})),zv({global:!0,constructor:!0,wrap:!0,forced:!Bh,sham:!Bh},{Symbol:Rp}),YS(QX(Ske),function(e){yke(e)}),zv({target:Gb,stat:!0,forced:!Bh},{useSetter:function(){AR=!0},useSimple:function(){AR=!1}}),zv({target:"Object",stat:!0,forced:!Bh,sham:!qp},{create:function(e,t){return t===void 0?N0(e):OR(N0(e),t)},defineProperty:zb,defineProperties:OR,getOwnPropertyDescriptor:A4}),zv({target:"Object",stat:!0,forced:!Bh},{getOwnPropertyNames:x4}),vke(),Eke(Rp,Gb),nJ[Co]=!0;var dJ=rm&&!!Symbol.for&&!!Symbol.keyFor,Tke=Yt,Cke=mo,Rke=Kn,Ike=bs,uJ=im,Ake=dJ,NR=uJ("string-to-symbol-registry"),xke=uJ("symbol-to-string-registry");Tke({target:"Symbol",stat:!0,forced:!Ake},{for:function(e){var t=Ike(e);if(Rke(NR,t))return NR[t];var r=Cke("Symbol")(t);return NR[t]=r,xke[r]=t,r}});var Oke=Yt,Nke=Kn,kke=ky,Pke=nm,Dke=dJ,O4=im("symbol-to-string-registry");Oke({target:"Symbol",stat:!0,forced:!Dke},{keyFor:function(e){if(!kke(e))throw TypeError(Pke(e)+" is not a symbol");if(Nke(O4,e))return O4[e]}});var N4=By,Lke=jn,k4=Sc,Mke=bs,P4=Br([].push),jke=Yt,hJ=mo,pJ=WP,Uke=Un,Hy=Br,fJ=qr,D4=jn,L4=ky,mJ=cD,Fke=function(e){if(Lke(e))return e;if(N4(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?P4(r,i):typeof i!="number"&&k4(i)!="Number"&&k4(i)!="String"||P4(r,Mke(i))}var o=r.length,s=!0;return function(a,c){if(s)return s=!1,c;if(N4(this))return c;for(var l=0;l<o;l++)if(r[l]===a)return c}}},Vke=rm,Bke=String,yd=hJ("JSON","stringify"),Kv=Hy(/./.exec),M4=Hy("".charAt),$ke=Hy("".charCodeAt),Hke=Hy("".replace),Wke=Hy(1 .toString),Gke=/[\uD800-\uDFFF]/g,j4=/^[\uD800-\uDBFF]$/,U4=/^[\uDC00-\uDFFF]$/,F4=!Vke||fJ(function(){var e=hJ("Symbol")();return yd([e])!="[null]"||yd({a:e})!="{}"||yd(Object(e))!="{}"}),V4=fJ(function(){return yd("\uDF06\uD834")!=='"\\udf06\\ud834"'||yd("\uDEAD")!=='"\\udead"'}),zke=function(e,t){var r=mJ(arguments),n=Fke(t);if(D4(n)||e!==void 0&&!L4(e))return r[1]=function(i,o){if(D4(n)&&(o=Uke(n,this,Bke(i),o)),!L4(o))return o},pJ(yd,null,r)},Kke=function(e,t,r){var n=M4(r,t-1),i=M4(r,t+1);return Kv(j4,e)&&!Kv(U4,i)||Kv(U4,e)&&!Kv(j4,n)?"\\u"+Wke($ke(e,0),16):e};yd&&jke({target:"JSON",stat:!0,arity:3,forced:F4||V4},{stringify:function(e,t,r){var n=mJ(arguments),i=pJ(F4?zke:yd,null,n);return V4&&typeof i=="string"?Hke(i,Gke,Kke):i}});var B4=Ly,qke=Tc;Yt({target:"Object",stat:!0,forced:!rm||qr(function(){B4.f(1)})},{getOwnPropertySymbols:function(e){var t=B4.f;return t?t(qke(e)):[]}}),On("asyncIterator"),On("hasInstance"),On("isConcatSpreadable"),On("iterator"),On("match"),On("matchAll"),On("replace"),On("search"),On("species"),On("split");var Yke=XX;On("toPrimitive"),Yke();var Xke=mo,Jke=Hd;On("toStringTag"),Jke(Xke("Symbol"),"Symbol"),On("unscopables"),Hd(Mn.JSON,"JSON",!0);var Qke=ja.Symbol,Zke=jr,ePe=oa.f,$4=Zke("metadata"),H4=Function.prototype;H4[$4]===void 0&&ePe(H4,$4,{value:null}),On("dispose"),On("metadata");var tPe=Qke;On("asyncDispose");var rPe=Br,wD=mo("Symbol"),nPe=wD.keyFor,iPe=rPe(wD.prototype.valueOf),gJ=wD.isRegisteredSymbol||function(e){try{return nPe(iPe(e))!==void 0}catch{return!1}};Yt({target:"Symbol",stat:!0},{isRegisteredSymbol:gJ});for(W4=im,PR=mo,G4=Br,z4=ky,K4=jr,Fm=PR("Symbol"),_O=Fm.isWellKnownSymbol,bO=PR("Object","getOwnPropertyNames"),yJ=G4(Fm.prototype.valueOf),wO=W4("wks"),qv=0,DR=bO(Fm),q4=DR.length;qv<q4;qv++)try{kR=DR[qv],z4(Fm[kR])&&K4(kR)}catch{}var kR,W4,PR,G4,z4,K4,Fm,_O,bO,yJ,wO,qv,DR,q4,Y4=function(e){if(_O&&_O(e))return!0;try{for(var t=yJ(e),r=0,n=bO(wO),i=n.length;r<i;r++)if(wO[n[r]]==t)return!0}catch{}return!1};Yt({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:Y4}),On("matcher"),On("observable"),Yt({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:gJ}),Yt({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:Y4}),On("metadataKey"),On("patternMatch"),On("replaceAll");var Ip=xr(tPe),vJ=xr(sm.f("iterator"));function Ug(e){return Ug=typeof Ip=="function"&&typeof vJ=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Ip=="function"&&t.constructor===Ip&&t!==Ip.prototype?"symbol":typeof t},Ug(e)}var oPe=xr(sm.f("toPrimitive"));function sPe(e){var t=function(r,n){if(Ug(r)!=="object"||r===null)return r;var i=r[oPe];if(i!==void 0){var o=i.call(r,n||"default");if(Ug(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}(e,"string");return Ug(t)==="symbol"?t:String(t)}function C(e,t,r){return(t=sPe(t))in e?GX(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var aPe=qr,cPe=jr("iterator"),SD=!aPe(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2"),n="";return e.pathname="c%20d",t.forEach(function(i,o){t.delete("b"),n+=o+i}),r.delete("a",2),!e.toJSON||!r.has("a",1)||r.has("a",2)||!t.size&&!0||!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[cPe]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||n!=="a1c3"||new URL("http://x",void 0).host!=="x"}),lPe=$d,LR=Yt,Sf=Mn,Yv=Un,vc=Br,Ap=_s,X4=SD,J4=$d,dPe=$S,uPe=function(e,t,r){for(var n in t)r&&r.unsafe&&e[n]?e[n]=t[n]:lPe(e,n,t[n],r);return e},hPe=Hd,pPe=nD,TD=bh,EJ=oD,MR=jn,fPe=Kn,mPe=Vd,gPe=Cc,yPe=Xi,_J=Bo,no=bs,vPe=My,Q4=Ud,SO=rD,EPe=BS,$h=WS,_Pe=MX,bPe=jr("iterator"),P0="URLSearchParams",bJ=P0+"Iterator",wJ=TD.set,Us=TD.getterFor(P0),wPe=TD.getterFor(bJ),SPe=Object.getOwnPropertyDescriptor,CD=function(e){if(!Ap)return Sf[e];var t=SPe(Sf,e);return t&&t.value},Z4=CD("fetch"),Kb=CD("Request"),Fg=CD("Headers"),jR=Kb&&Kb.prototype,e3=Fg&&Fg.prototype,TPe=Sf.RegExp,CPe=Sf.TypeError,SJ=Sf.decodeURIComponent,RPe=Sf.encodeURIComponent,IPe=vc("".charAt),t3=vc([].join),wu=vc([].push),TO=vc("".replace),APe=vc([].shift),r3=vc([].splice),n3=vc("".split),xPe=vc("".slice),OPe=/\+/g,i3=Array(4),NPe=function(e){return i3[e-1]||(i3[e-1]=TPe("((?:%[\\da-f]{2}){"+e+"})","gi"))},kPe=function(e){try{return SJ(e)}catch{return e}},o3=function(e){var t=TO(e,OPe," "),r=4;try{return SJ(t)}catch{for(;r;)t=TO(t,NPe(r--),kPe);return t}},PPe=/[!'()~]|%20/g,DPe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},LPe=function(e){return DPe[e]},s3=function(e){return TO(RPe(e),PPe,LPe)},UR=pPe(function(e,t){wJ(this,{type:bJ,iterator:SO(Us(e).entries),kind:t})},"Iterator",function(){var e=wPe(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value=t==="keys"?n.key:t==="values"?n.value:[n.key,n.value]),r},!0),TJ=function(e){this.entries=[],this.url=null,e!==void 0&&(_J(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?IPe(e,0)==="?"?xPe(e,1):e:no(e)))};TJ.prototype={type:P0,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,i,o,s,a,c=EPe(e);if(c)for(r=(t=SO(e,c)).next;!(n=Yv(r,t)).done;){if(o=(i=SO(yPe(n.value))).next,(s=Yv(o,i)).done||(a=Yv(o,i)).done||!Yv(o,i).done)throw CPe("Expected sequence with length 2");wu(this.entries,{key:no(s.value),value:no(a.value)})}else for(var l in e)fPe(e,l)&&wu(this.entries,{key:l,value:no(e[l])})},parseQuery:function(e){if(e)for(var t,r,n=n3(e,"&"),i=0;i<n.length;)(t=n[i++]).length&&(r=n3(t,"="),wu(this.entries,{key:o3(APe(r)),value:o3(t3(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],wu(r,s3(e.key)+"="+s3(e.value));return t3(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var qb=function(){EJ(this,rp);var e=wJ(this,new TJ(arguments.length>0?arguments[0]:void 0));Ap||(this.size=e.entries.length)},rp=qb.prototype;uPe(rp,{append:function(e,t){var r=Us(this);$h(arguments.length,2),wu(r.entries,{key:no(e),value:no(t)}),Ap||this.length++,r.updateURL()},delete:function(e){for(var t=Us(this),r=$h(arguments.length,1),n=t.entries,i=no(e),o=r<2?void 0:arguments[1],s=o===void 0?o:no(o),a=0;a<n.length;){var c=n[a];if(c.key!==i||s!==void 0&&c.value!==s)a++;else if(r3(n,a,1),s!==void 0)break}Ap||(this.size=n.length),t.updateURL()},get:function(e){var t=Us(this).entries;$h(arguments.length,1);for(var r=no(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){var t=Us(this).entries;$h(arguments.length,1);for(var r=no(e),n=[],i=0;i<t.length;i++)t[i].key===r&&wu(n,t[i].value);return n},has:function(e){for(var t=Us(this).entries,r=$h(arguments.length,1),n=no(e),i=r<2?void 0:arguments[1],o=i===void 0?i:no(i),s=0;s<t.length;){var a=t[s++];if(a.key===n&&(o===void 0||a.value===o))return!0}return!1},set:function(e,t){var r=Us(this);$h(arguments.length,1);for(var n,i=r.entries,o=!1,s=no(e),a=no(t),c=0;c<i.length;c++)(n=i[c]).key===s&&(o?r3(i,c--,1):(o=!0,n.value=a));o||wu(i,{key:s,value:a}),Ap||(this.size=i.length),r.updateURL()},sort:function(){var e=Us(this);_Pe(e.entries,function(t,r){return t.key>r.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,r=Us(this).entries,n=mPe(e,arguments.length>1?arguments[1]:void 0),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new UR(this,"keys")},values:function(){return new UR(this,"values")},entries:function(){return new UR(this,"entries")}},{enumerable:!0}),J4(rp,bPe,rp.entries,{name:"entries"}),J4(rp,"toString",function(){return Us(this).serialize()},{enumerable:!0}),Ap&&dPe(rp,"size",{get:function(){return Us(this).entries.length},configurable:!0,enumerable:!0}),hPe(qb,P0),LR({global:!0,constructor:!0,forced:!X4},{URLSearchParams:qb}),!X4&&MR(Fg)&&(a3=vc(e3.has),c3=vc(e3.set),FR=function(e){if(_J(e)){var t,r=e.body;if(gPe(r)===P0)return t=e.headers?new Fg(e.headers):new Fg,a3(t,"content-type")||c3(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),vPe(e,{body:Q4(0,no(r)),headers:Q4(0,t)})}return e},MR(Z4)&&LR({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return Z4(e,arguments.length>1?FR(arguments[1]):{})}}),MR(Kb)&&(Xv=function(e){return EJ(this,jR),new Kb(e,arguments.length>1?FR(arguments[1]):{})},jR.constructor=Xv,Xv.prototype=jR,LR({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Xv})));var a3,c3,FR,Xv,MPe={URLSearchParams:qb,getState:Us},l3=xr(ja.URLSearchParams),jPe={isBrowser:!0,classes:{URLSearchParams:l3!==void 0?l3:yD,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},CJ=typeof window<"u"&&typeof document<"u",UPe=(d3=typeof navigator<"u"&&navigator.product,CJ&&["ReactNative","NativeScript","NS"].indexOf(d3)<0),d3,FPe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";function u3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function h3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u3(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ac=h3(h3({},Object.freeze({__proto__:null,hasBrowserEnv:CJ,hasStandardBrowserEnv:UPe,hasStandardBrowserWebWorkerEnv:FPe})),jPe),VPe=Xi,BPe=Un,$Pe=Kn,HPe=Ti,WPe=function(){var e=VPe(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},p3=RegExp.prototype,RJ=function(e){var t=e.flags;return t!==void 0||"flags"in p3||$Pe(e,"flags")||!HPe(p3,e)?t:BPe(WPe,e)},GPe=pD.charAt,f3=Un,zPe=Xi,KPe=jn,qPe=Sc,YPe=/./.exec,XPe=TypeError,JPe=Yt,m3=Un,IJ=x0,QPe=nD,Jv=iD,g3=tm,AJ=oY,D0=bs,ZPe=Xi,eDe=em,tDe=Sc,rDe=sY,xJ=RJ,nDe=DS,iDe=qr,oDe=aD,sDe=function(e,t,r){return t+(r?GPe(e,t).length:1)},aDe=function(e,t){var r=e.exec;if(KPe(r)){var n=f3(r,e,t);return n!==null&&zPe(n),n}if(qPe(e)==="RegExp")return f3(YPe,e,t);throw XPe("RegExp#exec called on incompatible receiver")},OJ=bh,cDe=jr("matchAll"),NJ="RegExp String",kJ=NJ+" Iterator",lDe=OJ.set,dDe=OJ.getterFor(kJ),uDe=TypeError,CO=IJ("".indexOf),Yb=IJ("".matchAll),VR=!!Yb&&!iDe(function(){Yb("a",/./)}),hDe=QPe(function(e,t,r,n){lDe(this,{type:kJ,regexp:e,string:t,global:r,unicode:n,done:!1})},NJ,function(){var e=dDe(this);if(e.done)return Jv(void 0,!0);var t=e.regexp,r=e.string,n=aDe(t,r);return n===null?(e.done=!0,Jv(void 0,!0)):e.global?(D0(n[0])===""&&(t.lastIndex=sDe(r,AJ(t.lastIndex),e.unicode)),Jv(n,!1)):(e.done=!0,Jv(n,!1))}),y3=function(e){var t,r,n,i=ZPe(this),o=D0(e),s=oDe(i,RegExp),a=D0(xJ(i));return t=new s(s===RegExp?i.source:i,a),r=!!~CO(a,"g"),n=!!~CO(a,"u"),t.lastIndex=AJ(i.lastIndex),new hDe(t,o,r,n)};JPe({target:"String",proto:!0,forced:VR},{matchAll:function(e){var t,r,n,i,o=g3(this);if(eDe(e)){if(VR)return Yb(o,e)}else{if(rDe(e)&&(t=D0(g3(xJ(e))),!~CO(t,"g")))throw uDe("`.matchAll` does not allow non-global regexes");if(VR)return Yb(o,e);if((n=nDe(e,cDe))===void 0&&tDe(e)=="RegExp"&&(n=y3),n)return m3(n,e,o)}return r=D0(o),i=new RegExp(e,"g"),m3(y3,i,r)}});var pDe=sa("String").matchAll,fDe=Ti,mDe=pDe,BR=String.prototype,gDe=function(e){var t=e.matchAll;return typeof e=="string"||e===BR||fDe(BR,e)&&t===BR.matchAll?mDe:t},yDe=xr(gDe);function PJ(e){function t(r,n,i,o){let s=r[o++];if(s==="__proto__")return!0;let a=Number.isFinite(+s),c=o>=r.length;return s=!s&&ge.isArray(i)?i.length:s,c?(ge.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!a):(i[s]&&ge.isObject(i[s])||(i[s]=[]),t(r,n,i[s],o)&&ge.isArray(i[s])&&(i[s]=function(l){let d={},u=Object.keys(l),p,f=u.length,m;for(p=0;p<f;p++)m=u[p],d[m]=l[m];return d}(i[s])),!a)}if(ge.isFormData(e)&&ge.isFunction(e.entries)){let r={};return ge.forEachEntry(e,(n,i)=>{t(function(o){return yDe(ge).call(ge,/\w+|\[(\w*)]/g,o).map(s=>s[0]==="[]"?"":s[1]||s[0])}(n),i,r,0)}),r}return null}var RD={transitional:$X,adapter:["xhr","http"],transformRequest:[function(e,t){let r=t.getContentType()||"",n=r.indexOf("application/json")>-1,i=ge.isObject(e);if(i&&ge.isHTMLForm(e)&&(e=new FormData(e)),ge.isFormData(e))return n?JSON.stringify(PJ(e)):e;if(ge.isArrayBuffer(e)||ge.isBuffer(e)||ge.isStream(e)||ge.isFile(e)||ge.isBlob(e))return e;if(ge.isArrayBufferView(e))return e.buffer;if(ge.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(s,a){return Wb(s,new ac.classes.URLSearchParams,Object.assign({visitor:function(c,l,d,u){return ac.isNode&&ge.isBuffer(c)?(this.append(l,c.toString("base64")),!1):u.defaultVisitor.apply(this,arguments)}},a))}(e,this.formSerializer).toString();if((o=ge.isFileList(e))||r.indexOf("multipart/form-data")>-1){let s=this.env&&this.env.FormData;return Wb(o?{"files[]":e}:e,s&&new s,this.formSerializer)}}return i||n?(t.setContentType("application/json",!1),function(s,a,c){if(ge.isString(s))try{return(a||JSON.parse)(s),ci(ge).call(ge,s)}catch(l){if(l.name!=="SyntaxError")throw l}return(0,JSON.stringify)(s)}(e)):e}],transformResponse:[function(e){let t=this.transitional||RD.transitional,r=t&&t.forcedJSONParsing,n=this.responseType==="json";if(e&&ge.isString(e)&&(r&&!this.responseType||n)){let i=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(o){if(i)throw o.name==="SyntaxError"?cr.from(o,cr.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ac.classes.FormData,Blob:ac.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ge.forEach(["delete","get","head","post","put","patch"],e=>{RD.headers[e]={}});var ID=RD,vDe=ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),v3=Symbol("internals");function Vm(e){var t;return e&&ci(t=String(e)).call(t).toLowerCase()}function a_(e){return e===!1||e==null?e:ge.isArray(e)?e.map(a_):String(e)}function $R(e,t,r,n,i){return ge.isFunction(n)?n.call(this,t,r):(i&&(t=r),ge.isString(t)?ge.isString(n)?t.indexOf(n)!==-1:ge.isRegExp(n)?n.test(t):void 0:void 0)}var c_=class{constructor(e){e&&this.set(e)}set(e,t,r){let n=this;function i(a,c,l){let d=Vm(c);if(!d)throw new Error("header name must be a non-empty string");let u=ge.findKey(n,d);(!u||n[u]===void 0||l===!0||l===void 0&&n[u]!==!1)&&(n[u||c]=a_(a))}let o=(a,c)=>ge.forEach(a,(l,d)=>i(l,d,c));var s;return ge.isPlainObject(e)||e instanceof this.constructor?o(e,t):ge.isString(e)&&(e=ci(e).call(e))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(ci(s=e).call(s))?o((a=>{let c={},l,d,u;return a&&a.split(`
`).forEach(function(p){var f,m;u=p.indexOf(":"),l=ci(f=p.substring(0,u)).call(f).toLowerCase(),d=ci(m=p.substring(u+1)).call(m),!l||c[l]&&vDe[l]||(l==="set-cookie"?c[l]?c[l].push(d):c[l]=[d]:c[l]=c[l]?c[l]+", "+d:d)}),c})(e),t):e!=null&&i(t,e,r),this}get(e,t){if(e=Vm(e)){let r=ge.findKey(this,e);if(r){let n=this[r];if(!t)return n;if(t===!0)return function(i){let o=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,a;for(;a=s.exec(i);)o[a[1]]=a[2];return o}(n);if(ge.isFunction(t))return t.call(this,n,r);if(ge.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Vm(e)){let r=ge.findKey(this,e);return!(!r||this[r]===void 0||t&&!$R(0,this[r],r,t))}return!1}delete(e,t){let r=this,n=!1;function i(o){if(o=Vm(o)){let s=ge.findKey(r,o);!s||t&&!$R(0,r[s],s,t)||(delete r[s],n=!0)}}return ge.isArray(e)?e.forEach(i):i(e),n}clear(e){let t=Object.keys(this),r=t.length,n=!1;for(;r--;){let i=t[r];e&&!$R(0,this[i],i,e,!0)||(delete this[i],n=!0)}return n}normalize(e){let t=this,r={};return ge.forEach(this,(n,i)=>{var o;let s=ge.findKey(r,i);if(s)return t[s]=a_(n),void delete t[i];let a=e?function(c){return ci(c).call(c).toLowerCase().replace(/([a-z\d])(\w*)/g,(l,d,u)=>d.toUpperCase()+u)}(i):ci(o=String(i)).call(o);a!==i&&delete t[i],t[a]=a_(n),r[a]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.constructor.concat(this,...t)}toJSON(e){let t=Object.create(null);return ge.forEach(this,(r,n)=>{r!=null&&r!==!1&&(t[n]=e&&ge.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,r]=e;return t+": "+r}).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){let t=new this(e);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.forEach(o=>t.set(o)),t}static accessor(e){let t=(this[v3]=this[v3]={accessors:{}}).accessors,r=this.prototype;function n(i){let o=Vm(i);t[o]||(function(s,a){let c=ge.toCamelCase(" "+a);["get","set","has"].forEach(l=>{Object.defineProperty(s,l+c,{value:function(d,u,p){return this[l].call(this,a,d,u,p)},configurable:!0})})}(r,i),t[o]=!0)}return ge.isArray(e)?e.forEach(n):n(e),this}};c_.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ge.reduceDescriptors(c_.prototype,(e,t)=>{let{value:r}=e,n=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(i){this[n]=i}}}),ge.freezeMethods(c_);var nl=c_;function HR(e,t){let r=this||ID,n=t||r,i=nl.from(n.headers),o=n.data;return ge.forEach(e,function(s){o=s.call(r,o,i.normalize(),t?t.status:void 0)}),i.normalize(),o}function DJ(e){return!(!e||!e.__CANCEL__)}function Wy(e,t,r){cr.call(this,e??"canceled",cr.ERR_CANCELED,t,r),this.name="CanceledError"}ge.inherits(Wy,cr,{__CANCEL__:!0});var EDe=ac.hasStandardBrowserEnv?{write(e,t,r,n,i,o){let s=[e+"="+encodeURIComponent(t)];ge.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),ge.isString(n)&&s.push("path="+n),ge.isString(i)&&s.push("domain="+i),o===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){let t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function LJ(e,t){return e&&!function(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}(t)?function(r,n){return n?r.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):r}(e,t):t}var _De=ac.hasStandardBrowserEnv?function(){let e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),r;function n(i){let o=i;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return r=n(window.location.href),function(i){let o=ge.isString(i)?n(i):i;return o.protocol===r.protocol&&o.host===r.host}}():function(){return!0};function E3(e,t){let r=0,n=function(i,o){i=i||10;let s=new Array(i),a=new Array(i),c,l=0,d=0;return o=o!==void 0?o:1e3,function(u){let p=Date.now(),f=a[d];c||(c=p),s[l]=u,a[l]=p;let m=d,g=0;for(;m!==l;)g+=s[m++],m%=i;if(l=(l+1)%i,l===d&&(d=(d+1)%i),p-c<o)return;let y=f&&p-f;return y?Math.round(1e3*g/y):void 0}}(50,250);return i=>{let o=i.loaded,s=i.lengthComputable?i.total:void 0,a=o-r,c=n(a);r=o;let l={loaded:o,total:s,progress:s?o/s:void 0,bytes:a,rate:c||void 0,estimated:c&&s&&o<=s?(s-o)/c:void 0,event:i};l[t?"download":"upload"]=!0,e(l)}}var bDe=typeof XMLHttpRequest<"u"&&function(e){return new de(function(t,r){let n=e.data,i=nl.from(e.headers).normalize(),o,s,{responseType:a,withXSRFToken:c}=e;function l(){e.cancelToken&&e.cancelToken.unsubscribe(o),e.signal&&e.signal.removeEventListener("abort",o)}if(ge.isFormData(n)){if(ac.hasStandardBrowserEnv||ac.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if((s=i.getContentType())!==!1){let[m,...g]=s?s.split(";").map(y=>ci(y).call(y)).filter(Boolean):[];i.setContentType([m||"multipart/form-data",...g].join("; "))}}let d=new XMLHttpRequest;if(e.auth){let m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(m+":"+g))}let u=LJ(e.baseURL,e.url);function p(){if(!d)return;let m=nl.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders());(function(g,y,v){let E=v.config.validateStatus;v.status&&E&&!E(v.status)?y(new cr("Request failed with status code "+v.status,[cr.ERR_BAD_REQUEST,cr.ERR_BAD_RESPONSE][Math.floor(v.status/100)-4],v.config,v.request,v)):g(v)})(function(g){t(g),l()},function(g){r(g),l()},{data:a&&a!=="text"&&a!=="json"?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:m,config:e,request:d}),d=null}if(d.open(e.method.toUpperCase(),BX(u,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,"onloadend"in d?d.onloadend=p:d.onreadystatechange=function(){d&&d.readyState===4&&(d.status!==0||d.responseURL&&d.responseURL.indexOf("file:")===0)&&setTimeout(p)},d.onabort=function(){d&&(r(new cr("Request aborted",cr.ECONNABORTED,e,d)),d=null)},d.onerror=function(){r(new cr("Network Error",cr.ERR_NETWORK,e,d)),d=null},d.ontimeout=function(){let m=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",g=e.transitional||$X;e.timeoutErrorMessage&&(m=e.timeoutErrorMessage),r(new cr(m,g.clarifyTimeoutError?cr.ETIMEDOUT:cr.ECONNABORTED,e,d)),d=null},ac.hasStandardBrowserEnv&&(c&&ge.isFunction(c)&&(c=c(e)),c||c!==!1&&_De(u))){let m=e.xsrfHeaderName&&e.xsrfCookieName&&EDe.read(e.xsrfCookieName);m&&i.set(e.xsrfHeaderName,m)}n===void 0&&i.setContentType(null),"setRequestHeader"in d&&ge.forEach(i.toJSON(),function(m,g){d.setRequestHeader(g,m)}),ge.isUndefined(e.withCredentials)||(d.withCredentials=!!e.withCredentials),a&&a!=="json"&&(d.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&d.addEventListener("progress",E3(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",E3(e.onUploadProgress)),(e.cancelToken||e.signal)&&(o=m=>{d&&(r(!m||m.type?new Wy(null,e,d):m),d.abort(),d=null)},e.cancelToken&&e.cancelToken.subscribe(o),e.signal&&(e.signal.aborted?o():e.signal.addEventListener("abort",o)));let f=function(m){let g=/^([-+\w]{1,25})(:?\/\/|:)/.exec(m);return g&&g[1]||""}(u);f&&ac.protocols.indexOf(f)===-1?r(new cr("Unsupported protocol "+f+":",cr.ERR_BAD_REQUEST,e)):d.send(n||null)})},RO={http:null,xhr:bDe};ge.forEach(RO,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});var _3=e=>"- ".concat(e),wDe=e=>ge.isFunction(e)||e===null||e===!1,MJ={getAdapter:e=>{e=ge.isArray(e)?e:[e];let{length:t}=e,r,n,i={};for(let o=0;o<t;o++){let s;if(r=e[o],n=r,!wDe(r)&&(n=RO[(s=String(r)).toLowerCase()],n===void 0))throw new cr("Unknown adapter '".concat(s,"'"));if(n)break;i[s||"#"+o]=n}if(!n){let o=Object.entries(i).map(s=>{let[a,c]=s;return"adapter ".concat(a," ")+(c===!1?"is not supported by the environment":"is not available in the build")});throw new cr("There is no suitable adapter to dispatch the request "+(t?o.length>1?`since :
`+o.map(_3).join(`
`):" "+_3(o[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return n},adapters:RO};function WR(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Wy(null,e)}function b3(e){return WR(e),e.headers=nl.from(e.headers),e.data=HR.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),MJ.getAdapter(e.adapter||ID.adapter)(e).then(function(t){return WR(e),t.data=HR.call(e,e.transformResponse,t),t.headers=nl.from(t.headers),t},function(t){return DJ(t)||(WR(e),t&&t.response&&(t.response.data=HR.call(e,e.transformResponse,t.response),t.response.headers=nl.from(t.response.headers))),de.reject(t)})}function w3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}var S3=e=>e instanceof nl?function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?w3(Object(n),!0).forEach(function(i){C(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w3(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}({},e):e;function Tf(e,t){t=t||{};let r={};function n(l,d,u){return ge.isPlainObject(l)&&ge.isPlainObject(d)?ge.merge.call({caseless:u},l,d):ge.isPlainObject(d)?ge.merge({},d):ge.isArray(d)?d.slice():d}function i(l,d,u){return ge.isUndefined(d)?ge.isUndefined(l)?void 0:n(void 0,l,u):n(l,d,u)}function o(l,d){if(!ge.isUndefined(d))return n(void 0,d)}function s(l,d){return ge.isUndefined(d)?ge.isUndefined(l)?void 0:n(void 0,l):n(void 0,d)}function a(l,d,u){return u in t?n(l,d):u in e?n(void 0,l):void 0}let c={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(l,d)=>i(S3(l),S3(d),!0)};return ge.forEach(Object.keys(Object.assign({},e,t)),function(l){let d=c[l]||i,u=d(e[l],t[l],l);ge.isUndefined(u)&&d!==a||(r[l]=u)}),r}var jJ="1.6.8",AD={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{AD[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});var T3={};AD.transitional=function(e,t,r){function n(i,o){return"[Axios v"+jJ+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,s)=>{if(e===!1)throw new cr(n(o," has been removed"+(t?" in "+t:"")),cr.ERR_DEPRECATED);return t&&!T3[o]&&(T3[o]=!0,console.warn(n(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(i,o,s)}};var IO={assertOptions:function(e,t,r){if(typeof e!="object")throw new cr("options must be an object",cr.ERR_BAD_OPTION_VALUE);let n=Object.keys(e),i=n.length;for(;i-- >0;){let o=n[i],s=t[o];if(s){let a=e[o],c=a===void 0||s(a,o,e);if(c!==!0)throw new cr("option "+o+" must be "+c,cr.ERR_BAD_OPTION_VALUE)}else if(r!==!0)throw new cr("Unknown option "+o,cr.ERR_BAD_OPTION)}},validators:AD},Ol=IO.validators,l_=class{constructor(e){this.defaults=e,this.interceptors={request:new m4,response:new m4}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let n;Error.captureStackTrace?Error.captureStackTrace(n={}):n=new Error;let i=n.stack?n.stack.replace(/^.+\n/,""):"";r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}throw r}}_request(e,t){typeof e=="string"?(t=t||{}).url=e:t=e||{},t=Tf(this.defaults,t);let{transitional:r,paramsSerializer:n,headers:i}=t;r!==void 0&&IO.assertOptions(r,{silentJSONParsing:Ol.transitional(Ol.boolean),forcedJSONParsing:Ol.transitional(Ol.boolean),clarifyTimeoutError:Ol.transitional(Ol.boolean)},!1),n!=null&&(ge.isFunction(n)?t.paramsSerializer={serialize:n}:IO.assertOptions(n,{encode:Ol.function,serialize:Ol.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&ge.merge(i.common,i[t.method]);i&&ge.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),t.headers=nl.concat(o,i);let s=[],a=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(t)===!1||(a=a&&f.synchronous,s.unshift(f.fulfilled,f.rejected))});let c=[],l;this.interceptors.response.forEach(function(f){c.push(f.fulfilled,f.rejected)});let d,u=0;if(!a){let f=[b3.bind(this),void 0];for(f.unshift.apply(f,s),f.push.apply(f,c),d=f.length,l=de.resolve(t);u<d;)l=l.then(f[u++],f[u++]);return l}d=s.length;let p=t;for(u=0;u<d;){let f=s[u++],m=s[u++];try{p=f(p)}catch(g){m.call(this,g);break}}try{l=b3.call(this,p)}catch(f){return de.reject(f)}for(u=0,d=c.length;u<d;)l=l.then(c[u++],c[u++]);return l}getUri(e){return BX(LJ((e=Tf(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}};ge.forEach(["delete","get","head","options"],function(e){l_.prototype[e]=function(t,r){return this.request(Tf(r||{},{method:e,url:t,data:(r||{}).data}))}}),ge.forEach(["post","put","patch"],function(e){function t(r){return function(n,i,o){return this.request(Tf(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}l_.prototype[e]=t(),l_.prototype[e+"Form"]=t(!0)});var d_=l_,SDe=class UJ{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new de(function(i){r=i});let n=this;this.promise.then(i=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](i);n._listeners=null}),this.promise.then=i=>{let o,s=new de(a=>{n.subscribe(a),o=a}).then(i);return s.cancel=function(){n.unsubscribe(o)},s},t(function(i,o,s){n.reason||(n.reason=new Wy(i,o,s),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;let r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}static source(){let t;return{token:new UJ(function(r){t=r}),cancel:t}}},TDe=SDe,AO={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(AO).forEach(e=>{let[t,r]=e;AO[r]=t});var CDe=AO,Xn=function e(t){let r=new d_(t),n=UX(d_.prototype.request,r);return ge.extend(n,d_.prototype,r,{allOwnKeys:!0}),ge.extend(n,r,null,{allOwnKeys:!0}),n.create=function(i){return e(Tf(t,i))},n}(ID);Xn.Axios=d_,Xn.CanceledError=Wy,Xn.CancelToken=TDe,Xn.isCancel=DJ,Xn.VERSION=jJ,Xn.toFormData=Wb,Xn.AxiosError=cr,Xn.Cancel=Xn.CanceledError,Xn.all=function(e){return de.all(e)},Xn.spread=function(e){return function(t){return e.apply(null,t)}},Xn.isAxiosError=function(e){return ge.isObject(e)&&e.isAxiosError===!0},Xn.mergeConfig=Tf,Xn.AxiosHeaders=nl,Xn.formToJSON=e=>PJ(ge.isHTMLForm(e)?new FormData(e):e),Xn.getAdapter=MJ.getAdapter,Xn.HttpStatusCode=CDe,Xn.default=Xn;var Li=Xn,RDe=()=>{};function L0(){let e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:RDe};return e.promise=new de((t,r)=>{e.resolve=n=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,t(n),e.value=n)},e.reject=n=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,r(n))}}),e}var Qv=new Map,Zv=new Map,Ga=new Map,sn=function(e){return e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot",e}({}),Nt=function(e){return e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger",e}({}),FJ=new eNe,wa=FJ.getResult(),GR=null;function yt(e){if(!GR){wa=FJ.getResult();let t=function(a){if(a.engine.name==="Blink"&&a.browser.name!=="WeChat")return Nt.CHROME;switch(a.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Nt.CHROME;case"Safari":case"Mobile Safari":return Nt.SAFARI;case"Edge":return Nt.EDGE;case"Firefox":return Nt.FIREFOX;case"QQ":case"QQBrowser":return Nt.QQ;case"Opera":return Nt.OPERA;case"WeChat":return Nt.WECHAT;default:return a.browser.name||""}}(wa),r=C3(wa),n=function(a){return a.os.name==="Windows"?a.os.version?a.os.name+" "+a.os.version:a.os.name:a.os.name||""}(wa),i=wa.os.version,o=C3(wa,!1),s=wa.device.type;if(!(t&&r&&n&&i))return{name:t,version:r,os:n,osVersion:i,browserVersion:o,deviceType:s};GR={name:t,version:r,os:n,osVersion:i,browserVersion:o,deviceType:s}}return GR}function C3(e){let t,r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return t=e.engine.name==="Blink"?e.engine.version||"":e.browser.version||"",r?t.split(".")[0]:t}function XS(){return yt().os}function R3(){let e=yt();return"".concat(e.os," ").concat(e.osVersion)}function Xb(){let e=yt();return!!(wa.engine.name==="WebKit"&&e.os===sn.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==Nt.SAFARI||Ei()&&e.name!==Nt.SAFARI)}function vd(){return yt().name===Nt.CHROME}function Pn(){return yt().name===Nt.SAFARI}function VJ(){return yt().name===Nt.EDGE}function _r(){return yt().name===Nt.FIREFOX}function Ei(){return yt().os===sn.IOS}function xO(e){let t=yt();return!(t.name!==Nt.CHROME||!t.osVersion)&&Number(t.version)>=e}function BJ(e){let t=yt();return!(t.name!==Nt.CHROME||!t.osVersion)&&Number(t.version)<e}function I3(e){let t=yt();return!(t.name!==Nt.EDGE||!t.osVersion)&&Number(t.version)>=e}function $J(e){let t=yt();return!(t.name!==Nt.SAFARI||!t.osVersion)&&Number(t.version)>=e}function HJ(e,t,r){let n=yt();if(n.os!==sn.IOS||!n.osVersion)return!1;let i=n.osVersion.split(".");return t&&Number(i[0])===e&&Number(i[1])<t||Number(i[0])<e}function WJ(e,t,r){let n=yt();if(n.name!==Nt.SAFARI||!n.osVersion||!n.browserVersion)return!1;let i=n.browserVersion.split(".");return t&&Number(i[0])===e&&Number(i[1])<t||Number(i[0])<e}function A3(e){let t=yt();return!(t.name!==Nt.OPERA||!t.osVersion)&&Number(t.version)>=e}function x3(){let e=yt();if(e.os!==sn.IOS||!e.osVersion)return!1;let t=e.osVersion.split(".");return Number(t[0])<14||Number(t[0])===14&&Number(t[1])<=6}function Cf(){let e=yt();if(e.os!==sn.IOS||!e.osVersion)return!1;let t=e.osVersion.split(".");return Number(t[0])===15}function OO(){let e=yt();if(e.os!==sn.IOS||!e.osVersion)return!1;let t=e.osVersion.split(".");return Number(t[0])===16}function O3(){let e=yt();if(e.os!==sn.IOS||!e.osVersion)return!1;let t=e.osVersion.split(".");return Number(t[0])===15&&Number(t[1])>=1}function Js(){return Pn()&&navigator.maxTouchPoints>0}function GJ(){return yt().name===Nt.WECHAT}function zJ(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function xD(){let e=XS();return function(){let{deviceType:t}=yt();return t==="mobile"||t==="tablet"}()||e===sn.ANDROID||e===sn.IOS||e===sn.HARMONY_OS}function Od(){let e=yt();return e.name!==Nt.EDGE&&e.name!==Nt.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function JS(){return XS()===sn.ANDROID}function M0(){let e=yt();return JS()&&(e.name===Nt.CHROME||e.name===Nt.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function rr(e,t,r){return(t=function(n){var i=function(o,s){if(typeof o!="object"||!o)return o;var a=o[Symbol.toPrimitive];if(a!==void 0){var c=a.call(o,"string");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n);return typeof i=="symbol"?i:i+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N3(Object(r),!0).forEach(function(n){rr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var I=function(e){return e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",e}({}),X=class extends Error{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;super(t),rr(this,"code",void 0),rr(this,"message",void 0),rr(this,"data",void 0),rr(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=r}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return e==="error"&&(t||console).error(this.toString()),e==="warning"&&(t||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}};function qc(e,t){if(typeof e!="boolean")throw new X(I.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function Xr(e,t,r){if(!pe(r).call(r,e))throw new X(I.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(r)))}function Vt(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(e<r||e>n||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(i){return typeof i=="number"&&i%1==0}(e))throw new X(I.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(r,", ").concat(n,"]. integer only"))}function zR(e,t){if(typeof e!="number"){if(!(e.min||e.max||e.ideal||e.exact))throw new X(I.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));e.min!==void 0&&Vt(e.min,"".concat(t,".min"),0,1/0),e.max!==void 0&&Vt(e.max,"".concat(t,".max"),1,1/0),e.exact!==void 0&&Vt(e.exact,"".concat(t,".exact"),1,1/0),e.ideal!==void 0&&Vt(e.ideal,"".concat(t,".ideal"),1,1/0)}else Vt(e,t,1,1/0)}function En(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(e==null)throw new X(I.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!KJ(e,r,n,i))throw new X(I.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(r,",").concat(n,"].").concat(i?" ASCII characters only.":""))}function $c(e,t){if(!Array.isArray(e))throw new X(I.INVALID_PARAMS,"".concat(t," should be an array"))}function dr(e){return e==null}function KJ(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,n=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof e=="string"&&e.length<=r&&e.length>=t&&(!n||function(i){if(typeof i!="string")return!1;for(let o=0;o<i.length;o+=1){let s=i.charCodeAt(o);if(s<0||s>255)return!1}return!0}(e))}var cg=function(e){return e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE",e}(cg||{}),NO=function(e){return e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",e}(NO||{}),qJ=new class{constructor(){rr(this,"_clientSize",null),rr(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),rr(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),rr(this,"getStyle",e=>window.getComputedStyle(e,null)),rr(this,"checkCssVisibleProperty",e=>{var t;let r=!0,n=this.getStyle(e),{display:i,visibility:o,opacity:s,filter:a}=n;return(i==="none"||pe(t=["hidden","collapse"]).call(t,o)||Number(s)<.1)&&(r=!1),!!r&&(a&&a.split(" ").filter(c=>{var l;let d=c.split("(")[0];return pe(l=["brightness","blur","opacity"]).call(l,d)}).map(c=>{let[l,d]=c.split(/\(|\)/);return[l,Number(d.match(/^[0-9\.]+/))]}).forEach(c=>{let[l,d]=c;switch(l){case"brightness":(d<.1||d>3)&&(r=!1);break;case"blur":d>3&&(r=!1);break;case"opacity":d<.1&&(r=!1)}}),r)}),rr(this,"checkPropertyUpToAllParentNodes",(e,t)=>{let r=!0,n=!0,i=s=>t(s),o=e;for(;o&&n;)i(o)||(r=!1,n=!1),o=o.parentElement,o||(n=!1);return r}),rr(this,"checkActualCssVisibleIncludeInherit",e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty)),rr(this,"getSizeAboutClient",e=>{let{width:t,height:r,left:n,right:i,top:o,bottom:s}=e.getBoundingClientRect(),a=this.getClientWidth(),c=this.getClientHeight();return{width:t,height:r,left:n,right:i,top:o,bottom:s,clientWidth:a,clientHeight:c,clientMin:Math.min(a,c)}}),rr(this,"checkActualSize",()=>{let{width:e,height:t,clientMin:r}=this._clientSize;return this.checkSizeIsVisible(e,t,r)}),rr(this,"elementFromPoint",(e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null),rr(this,"checkCoverForAPoint",(e,t,r)=>{let n=this.elementFromPoint(e,t);return n!==null&&n!==r}),rr(this,"getPointPositionList",()=>{let{width:e,height:t,left:r,top:n}=this._clientSize,i=e/6,o=t/6,s=[],a=10**6;for(let c=0;c<5;c++)for(let l=0;l<5;l++){let d=(r*a+(c===0?.1:c===4?(i*c*a-1e5)/a:i*c)*a)/a,u=(n*a+(l===0?.1:l===4?(o*l*a-1e5)/a:o*l)*a)/a;s.push({x:d,y:u})}return[...s]}),rr(this,"checkElementCover",e=>this.getPointPositionList().map(t=>this.checkCoverForAPoint(t.x,t.y,e)).filter(t=>!!t).length>6),rr(this,"checkSizeIsVisible",(e,t,r)=>(e>50||r/e<=10)&&(t>50||r/t<=10)),rr(this,"checkSizeOfPartInClient",()=>{let{left:e,right:t,top:r,bottom:n,clientHeight:i,clientWidth:o,clientMin:s}=this._clientSize,a,c,l,d;if(e<0)a=0;else{if(!(e<o))return!1;a=e}if(t<0)return!1;if(c=t<o?t:o,r<0)l=0;else{if(!(r<i))return!1;l=r}if(n<0)return!1;d=n<i?n:i;let u=c-a,p=d-l;return this.checkSizeIsVisible(u,p,s)}),rr(this,"returnHiddenResult",e=>(this._clientSize=null,{visible:!1,reason:e})),rr(this,"checkOneElementVisible",e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(cg.COVERED);{let t=this.checkActualSize(),r=this.checkSizeOfPartInClient();return t&&!r?this.returnHiddenResult(cg.POSITION):t?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(cg.SIZE)}}return this.returnHiddenResult(cg.STYLE)}return this.returnHiddenResult(NO.UNMOUNTED)}return this.returnHiddenResult(NO.INVALID_HTML_ELEMENT)}),rr(this,"checkElementIsMountedOnDom",e=>this.checkPropertyUpToAllParentNodes(e,t=>t.nodeName.toUpperCase()!=="HTML"?t.parentElement!==null:!!document.documentElement))}};function OD(e){return new TextEncoder().encode(e)}var k3=function(e,t){let r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r},kO=async e=>function(t,r){let n="";return new Uint8Array(t).forEach(i=>{n+=i.toString(r).padStart(2,"0")}),n}(await crypto.subtle.digest("SHA-256",OD(e)),16),fr=class{constructor(){rr(this,"_events",{}),rr(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map(t=>t.listener):[]}on(e,t){this._events[e]||(this._events[e]=[]);let r=this._events[e];this._indexOfListener(r,t)===-1&&r.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);let r=this._events[e];this._indexOfListener(r,t)===-1&&r.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;let r=this._events[e],n=this._indexOfListener(r,t);n!==-1&&r.splice(n,1),this._events[e].length===0&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);let t=this._events[e].map(o=>o);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(let o=0;o<t.length;o+=1){let s=t[o];s.once&&this.off(e,s.listener),s.listener.apply(this,n||[])}}safeEmit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];[...this._events[e]||[]].forEach(i=>{i.once&&this.off(e,i.listener);try{i.listener.apply(this,r)}catch(o){console.error("safeEmit event:".concat(e," error ").concat(o==null?void 0:o.toString()))}})}_indexOfListener(e,t){let r=e.length;for(;r--;)if(e[r].listener===t)return r;return-1}},Bm=null;function YJ(){if(Bm)return Bm;if(window.electron)return Bm=window.electron;if(!window.require)return null;try{return Bm=window.require("electron"),Bm}catch{return null}}var Gr=function(e){return e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.PRELOAD="PRELOAD",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload",e}({}),Er=function(e){return e.TRACER="tracer",e}({});function P3(e){return Vt(e.timeout,"config.timeout",0,1e5),Vt(e.timeoutFactor,"config.timeoutFactor",0,100,!1),Vt(e.maxRetryCount,"config.maxRetryConfig",0,1/0),Vt(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}var IDe=function(e){return e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",e}({}),Mt=function(e){return e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.FALLBACK="FALLBACK",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e}({});function QS(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach(t=>{if(!t.urls)throw Error()})}catch{return!1}return!0}function XJ(e){return En(e.turnServerURL,"turnServerURL"),En(e.username,"username"),En(e.password,"password"),e.udpport&&Vt(e.udpport,"udpport",1,99999,!0),e.forceturn&&qc(e.forceturn,"forceturn"),e.security&&qc(e.security,"security"),e.tcpport&&Vt(e.tcpport,"tcpport",1,99999,!0),!0}function D3(e){return e.level!==void 0&&Xr(e.level,"level",[1,2,3]),e.delay!==void 0&&Vt(e.delay,"delay",0,3e3,!0),!0}var ut=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",e}({}),kn=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e}({}),oo=function(e){return e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({}),xp=function(e){return e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({});function Dn(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return e.getListeners(t).length===0?de.reject(new X(I.UNEXPECTED_ERROR,"can not emit promise")):new de((o,s)=>{e.emit(t,...n,o,s)})}function Wt(e,t){if(e.getListeners(t).length===0)return de.resolve();for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return Dn(e,t,...n)}function is(e,t){if(e.getListeners(t).length===0)return null;for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return j0(e,t,...n)}function j0(e,t){let r=null,n=null;for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];if(e.emit(t,...o,a=>{r=a},a=>{n=a}),n!==null)throw n;if(r===null)throw new X(I.UNEXPECTED_ERROR,"handler is not sync");return r}var Dr=new class extends fr{set networkState(e){this.emit(xp.NETWORK_STATE_CHANGE,e,this._networkState),e===oo.ONLINE?this.emit(xp.ONLINE):e===oo.OFFLINE&&(this.onlineWaiter=new de(t=>{this.once(xp.ONLINE,()=>{this.onlineWaiter=void 0,t(oo.ONLINE)})}),this.emit(xp.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===oo.ONLINE}constructor(){super(),rr(this,"_moduleName","network-indicator"),rr(this,"_networkState",oo.ONLINE),rr(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=oo.ONLINE}),window.addEventListener("offline",()=>{this.networkState=oo.OFFLINE})}};function Jb(e,t){let r=e.indexOf(t);r!==-1&&e.splice(r,1)}function Op(e){let t=[];return e.forEach(r=>{t.indexOf(r)===-1&&t.push(r)}),t}function ZS(e){de!==void 0?de.resolve().then(e):setTimeout(e,0)}function kr(e){return JSON.parse(JSON.stringify(e))}function Su(e){try{return kr(e)}catch{return e}}var L3={};function Nd(e,t){L3[t]||(L3[t]=!0,e())}function Tu(e){let t=window.atob(e),r=new Uint8Array(new ArrayBuffer(t.length));for(let n=0;n<t.length;n+=1)r[n]=t.charCodeAt(n);return r}function Ed(e){let t="";for(let r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return window.btoa(t)}function JJ(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,r=new TextEncoder().encode(e);if(r.length>t)r=r.slice(0,t);else if(r.length<t){let n=new Uint8Array(t);n.set(r),r=n}return r}function M3(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=ka(t).call(t,(s,a)=>s+a.length,0),i=new Uint8Array(new ArrayBuffer(n)),o=0;return t.forEach(s=>{i.set(s,o),o+=s.length}),i}function cc(e){return window.TextEncoder?new TextEncoder().encode(e).length:e.length}function QJ(e){let t=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&e.realFormData&&(e=e.realFormData),e.forEach(r=>{t+=typeof r=="string"?cc(r):r.size}),t+138}function ADe(e){let t=new X(I.TIMEOUT,"timeout");return new de((r,n)=>{window.setTimeout(()=>n(t),e)})}function Tn(e){return new de(t=>{window.setTimeout(t,e)})}function qt(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0,r=Math.random().toString(16).substr(2,e).toLowerCase();return r.length===e?"".concat(t).concat(r):"".concat(t).concat(r)+qt(e-r.length,"")}function Np(){return qt(32,"").toUpperCase()}var eT=()=>{},j3=new class{constructor(){rr(this,"fnMap",new Map)}throttleByKey(e,t,r,n){for(var i=arguments.length,o=new Array(i>4?i-4:0),s=4;s<i;s++)o[s-4]=arguments[s];if(this.fnMap.has(t)){let a=this.fnMap.get(t);if(a.threshold!==r){a.fn(...a.args),clearTimeout(a.timer);let c=window.setTimeout(()=>{let l=this.fnMap.get(t);l&&l.fn(...l.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:e,threshold:r,timer:c,args:o,skipFn:n})}else a.skipFn&&a.skipFn(...a.args),this.fnMap.set(t,Ee(Ee({},a),{},{fn:e,args:o,skipFn:n}))}else{let a=window.setTimeout(()=>{let c=this.fnMap.get(t);c&&c.fn(...c.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:e,threshold:r,timer:a,args:o,skipFn:n})}}},U3=j3.throttleByKey.bind(j3);function F3(e){return typeof e=="object"&&e!==null&&!(e instanceof RegExp)}function PO(e,t){if(!F3(e)||!F3(t)||Array.isArray(e)&&!Array.isArray(t)||!Array.isArray(e)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(e)){let r=[...e];for(let n=0;n<t.length;n++)r[n]=PO(e[n],t[n]);return r}{let r=Ee({},e);for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(e,n)?r[n]=PO(e[n],t[n]):r[n]=t[n]);return r}}function V3(e,t){let r=[0];if(r=new Array(t).fill(0),e===0)return r;let n=0;for(;e>0&&(r[n]=255&e,e>>=8,n++,n!==t););return r}function KR(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function ZJ(e){let t="0123456789abcdef";function r(w){let S,A="";for(S=0;S<=3;S++)A+=t.charAt(w>>8*S+4&15)+t.charAt(w>>8*S&15);return A}function n(w,S){let A=(65535&w)+(65535&S);return(w>>16)+(S>>16)+(A>>16)<<16|65535&A}function i(w,S,A,N,L,j){return n(function(W,V){return W<<V|W>>>32-V}(n(n(S,w),n(N,j)),L),A)}function o(w,S,A,N,L,j,W){return i(S&A|~S&N,w,S,L,j,W)}function s(w,S,A,N,L,j,W){return i(S&N|A&~N,w,S,L,j,W)}function a(w,S,A,N,L,j,W){return i(S^A^N,w,S,L,j,W)}function c(w,S,A,N,L,j,W){return i(A^(S|~N),w,S,L,j,W)}let l=function(w){let S,A=1+(w.length+8>>6),N=new Array(16*A);for(S=0;S<16*A;S++)N[S]=0;for(S=0;S<w.length;S++)N[S>>2]|=w.charCodeAt(S)<<S%4*8;return N[S>>2]|=128<<S%4*8,N[16*A-2]=8*w.length,N}(e),d,u,p,f,m,g=1732584193,y=-271733879,v=-1732584194,E=271733878;for(d=0;d<l.length;d+=16)u=g,p=y,f=v,m=E,g=o(g,y,v,E,l[d+0],7,-680876936),E=o(E,g,y,v,l[d+1],12,-389564586),v=o(v,E,g,y,l[d+2],17,606105819),y=o(y,v,E,g,l[d+3],22,-1044525330),g=o(g,y,v,E,l[d+4],7,-176418897),E=o(E,g,y,v,l[d+5],12,1200080426),v=o(v,E,g,y,l[d+6],17,-1473231341),y=o(y,v,E,g,l[d+7],22,-45705983),g=o(g,y,v,E,l[d+8],7,1770035416),E=o(E,g,y,v,l[d+9],12,-1958414417),v=o(v,E,g,y,l[d+10],17,-42063),y=o(y,v,E,g,l[d+11],22,-1990404162),g=o(g,y,v,E,l[d+12],7,1804603682),E=o(E,g,y,v,l[d+13],12,-40341101),v=o(v,E,g,y,l[d+14],17,-1502002290),y=o(y,v,E,g,l[d+15],22,1236535329),g=s(g,y,v,E,l[d+1],5,-165796510),E=s(E,g,y,v,l[d+6],9,-1069501632),v=s(v,E,g,y,l[d+11],14,643717713),y=s(y,v,E,g,l[d+0],20,-373897302),g=s(g,y,v,E,l[d+5],5,-701558691),E=s(E,g,y,v,l[d+10],9,38016083),v=s(v,E,g,y,l[d+15],14,-660478335),y=s(y,v,E,g,l[d+4],20,-405537848),g=s(g,y,v,E,l[d+9],5,568446438),E=s(E,g,y,v,l[d+14],9,-1019803690),v=s(v,E,g,y,l[d+3],14,-187363961),y=s(y,v,E,g,l[d+8],20,1163531501),g=s(g,y,v,E,l[d+13],5,-1444681467),E=s(E,g,y,v,l[d+2],9,-51403784),v=s(v,E,g,y,l[d+7],14,1735328473),y=s(y,v,E,g,l[d+12],20,-1926607734),g=a(g,y,v,E,l[d+5],4,-378558),E=a(E,g,y,v,l[d+8],11,-2022574463),v=a(v,E,g,y,l[d+11],16,1839030562),y=a(y,v,E,g,l[d+14],23,-35309556),g=a(g,y,v,E,l[d+1],4,-1530992060),E=a(E,g,y,v,l[d+4],11,1272893353),v=a(v,E,g,y,l[d+7],16,-155497632),y=a(y,v,E,g,l[d+10],23,-1094730640),g=a(g,y,v,E,l[d+13],4,681279174),E=a(E,g,y,v,l[d+0],11,-358537222),v=a(v,E,g,y,l[d+3],16,-722521979),y=a(y,v,E,g,l[d+6],23,76029189),g=a(g,y,v,E,l[d+9],4,-640364487),E=a(E,g,y,v,l[d+12],11,-421815835),v=a(v,E,g,y,l[d+15],16,530742520),y=a(y,v,E,g,l[d+2],23,-995338651),g=c(g,y,v,E,l[d+0],6,-198630844),E=c(E,g,y,v,l[d+7],10,1126891415),v=c(v,E,g,y,l[d+14],15,-1416354905),y=c(y,v,E,g,l[d+5],21,-57434055),g=c(g,y,v,E,l[d+12],6,1700485571),E=c(E,g,y,v,l[d+3],10,-1894986606),v=c(v,E,g,y,l[d+10],15,-1051523),y=c(y,v,E,g,l[d+1],21,-2054922799),g=c(g,y,v,E,l[d+8],6,1873313359),E=c(E,g,y,v,l[d+15],10,-30611744),v=c(v,E,g,y,l[d+6],15,-1560198380),y=c(y,v,E,g,l[d+13],21,1309151649),g=c(g,y,v,E,l[d+4],6,-145523070),E=c(E,g,y,v,l[d+11],10,-1120210379),v=c(v,E,g,y,l[d+2],15,718787259),y=c(y,v,E,g,l[d+9],21,-343485551),g=n(g,u),y=n(y,p),v=n(v,f),E=n(E,m);return r(g)+r(y)+r(v)+r(E)}var xDe=1,eE=console,Gn=class{static setLogger(e){eE=e}constructor(e){rr(this,"lockingPromise",de.resolve()),rr(this,"locks",0),rr(this,"name",""),rr(this,"lockId",void 0),this.lockId=xDe++,e&&(this.name=e),eE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,eE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof e=="string"?e:""));let r=new de(i=>{t=()=>{this.locks-=1,eE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof e=="string"?e:"")),i()}}),n=this.lockingPromise.then(()=>t);return this.lockingPromise=this.lockingPromise.then(()=>r),n}};function Rf(e,t){return function(r,n,i){let o=i.value;if(typeof o!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){let s=this[t];if(!s)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));let a=await s.lock("From ".concat(e,".").concat(n));try{for(var c=arguments.length,l=new Array(c),d=0;d<c;d++)l[d]=arguments[d];return await o.apply(this,l)}finally{a()}},i}}var Fr={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function ND(e,t){let r=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,r)}function Ua(e,t,r,n){let i=Object.assign({},Fr,n),o=i.timeout,s=async()=>{await function(l){return new de(d=>{window.setTimeout(d,l)})}(o),o*=i.timeoutFactor,o=Math.min(i.maxRetryTimeout,o)},a=!1,c=new de(async(l,d)=>{t=t||(()=>!1),r=r||(()=>!0);for(let u=0;u<i.maxRetryCount;u+=1){if(a)return d(new X(I.OPERATION_ABORTED));try{let p=await e();if(!t(p,u)||u+1===i.maxRetryCount)return l(p);await s()}catch(p){if(!r(p,u)||u+1===i.maxRetryCount)return d(p);await s()}}});return c.cancel=()=>a=!0,c}var eQ=class{constructor(e){rr(this,"input",[]),rr(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return this.input.length===0?0:ka(e=this.input).call(e,(t,r)=>t+r)/this.input.length}},tE,rE=0,qR=0;function DO(e,t,r,n){return new de((i,o)=>{t.responseType=t.responseType||"json",t.data&&!r?(t.data=JSON.stringify(t.data),rE+=cc(t.data)):r&&(t.data.size?rE+=t.data.size:t.data instanceof FormData?rE+=QJ(t.data):rE+=cc(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,Li.request(t).then(s=>{typeof s.data=="string"?qR+=cc(s.data):s.data instanceof ArrayBuffer||s.data instanceof Uint8Array?qR+=s.data.byteLength:qR+=cc(JSON.stringify(s.data)),i(s.data)}).catch(s=>{Li.isCancel(s)?o(new X(I.OPERATION_ABORTED,"cancel token canceled")):s.code==="ECONNABORTED"?o(new X(I.NETWORK_TIMEOUT,s.message)):s.response?o(new X(I.NETWORK_RESPONSE_ERROR,s.response.status)):o(new X(I.NETWORK_ERROR,s.message))})})}async function ODe(e,t){let r=new Blob([t.data],{type:"buffer"});return await DO(e,Ee(Ee({},t),{},{data:r,headers:{"Content-Type":"application/octet-stream"}}),!0)}var B3=()=>window.isSecureContext!==void 0,os=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;let t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(t&&t[1]&&t[2]){let n=t[1],i=t[2];return"".concat(n,".").concat(i)}let r=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(r&&r[1]&&r[2]){let n=r[1],i=r[2];return"".concat(n,".").concat(100*(Number(i)+1))}return"4.0.0.999"}("4.22.0"),kD=function(){try{return JSON.parse("true")===!0}catch{return!0}}(),lu=function(e){return e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn",e}({}),PD={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},DD="v4.22.0-0-g8569241d-dirty(8/15/2024, 7:04:06 PM)",Ir=Ee(Ee({PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:PD,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,CUSTOM_ADAPTATION_DEFAULT_MODE:"",ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,ENABLE_PRELOAD:!0},{ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,USE_PUB_RTX:!0,USE_SUB_RTX:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_DATASTREAM_2:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,USE_XR:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,ENABLE_PREALLOC_PC:!1,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_PRE_SUB:!1,ENABLE_AUT_FEEDBACK:!1}),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1});function Ft(e,t,r){var n,i,o;pe(n=Object.keys(Ir)).call(n,e)&&(!r&&pe(i=Object.keys(nd)).call(i,e)||(Ir[e]=t,e==="ENABLE_VIDEO_SEI"&&t===!0&&(Ir.ENABLE_ENCODED_TRANSFORM=!0),e==="USE_NEW_NETWORK_CONFIG"&&t&&(o=!!t,Ir.USE_NEW_NETWORK_CONFIG=o,o&&(Ir.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],Ir.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],Ir.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],Ir.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],Ir.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",Ir.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",Ir.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),e==="ENABLE_PRE_SUB"&&t&&(Ir.ENABLE_INSTANT_VIDEO=!0,Ir.ENABLE_PREALLOC_PC=!0),e==="ENABLE_SVC"&&t&&(Ir.ENABLE_AUT_CC=!0)))}function D(e){return Ir[e]}var nd={},at=function(e){return e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",e}(at||{}),NDe=class{constructor(e,t,r,n){rr(this,"state",void 0),this.state={codec:e,audioCodec:t,mode:r,clientId:n,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:lu.Default}}dispatch(e){this.state=function(t,r){switch(r.type){case at.SET_SESSION_ID:return Ee(Ee({},t),{},{sessionId:r.sessionId});case at.SET_P2P_ID:return Ee(Ee({},t),{},{p2pId:r.p2pId});case at.SET_UID:return Ee(Ee({},t),{},{uid:r.uid});case at.SET_INT_UID:return Ee(Ee({},t),{},{intUid:r.intUid});case at.SET_PUB_ID:return Ee(Ee({},t),{},{pubId:r.pubId});case at.KEY_METRIC_CLIENT_CREATED:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{clientCreated:r.metric})});case at.KEY_METRIC_JOIN_START:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{joinStart:r.metric})});case at.AVOID_JOIN_START:return Ee(Ee({},t),{},{avoidJoinStart:r.avoidJoinStart});case at.KEY_METRIC_JOIN_END:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{joinEnd:r.metric})});case at.KEY_METRIC_REQUEST_AP_START:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{requestAPStart:r.metric})});case at.KEY_METRIC_REQUEST_AP_END:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{requestAPEnd:r.metric})});case at.KEY_METRIC_JOIN_GATEWAY_START:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{joinGatewayStart:r.metric})});case at.KEY_METRIC_JOIN_GATEWAY_END:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{joinGatewayEnd:r.metric})});case at.KEY_METRIC_PEER_CONNECTION_START:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{peerConnectionStart:r.metric})});case at.KEY_METRIC_PEER_CONNECTION_END:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{peerConnectionEnd:r.metric})});case at.KEY_METRIC_DESCRIPTION_START:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{descriptionStart:r.metric})});case at.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{signalChannelOpen:r.metric})});case at.KEY_METRIC_ICE_CONNECTION_END:return Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{iceConnectionEnd:r.metric})});case at.KEY_METRIC_PUBLISH:{let n=t.keyMetrics.publish,i=n.findIndex(o=>o.trackId===r.metric.trackId);return i!==-1?(n[i]=Ee(Ee({},n[i]),r.metric),Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{publish:[...n]})})):Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{publish:[...t.keyMetrics.publish,r.metric]})})}case at.KEY_METRIC_SUBSCRIBE:{let n=t.keyMetrics.subscribe,i=n.findIndex(o=>o.userId===r.metric.userId&&o.type===r.metric.type);return i!==-1?(n[i]=Ee(Ee({},n[i]),r.metric),Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{subscribe:[...n]})})):Ee(Ee({},t),{},{keyMetrics:Ee(Ee({},t.keyMetrics),{},{subscribe:[...t.keyMetrics.subscribe,r.metric]})})}case at.SET_CLOUD_PROXY_SERVER_MODE:return t.cloudProxyServerMode=r.mode,t;case at.RECORD_JOIN_CHANNEL_SERVICE:return typeof r.index!="number"?t.joinChannelServiceRecords=[...t.joinChannelServiceRecords,r.record]:(t.joinChannelServiceRecords[r.index]=Ee(Ee({},t.joinChannelServiceRecords[r.index]),r.record),t.joinChannelServiceRecords=[...t.joinChannelServiceRecords]),t;case at.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return t.joinChannelServiceRecords=[],t;case at.RESET_KEY_METRICS:return t.keyMetrics={publish:[],subscribe:[]},t;case at.SET_USE_P2P:return Ee(Ee({},t),{},{useP2P:r.val});case at.SET_TRANSPORT_TYPE:return Ee(Ee({},t),{},{p2pTransport:r.val});default:return t}}(this.state,e)}set sessionId(e){this.dispatch({type:at.SET_SESSION_ID,sessionId:e})}get sessionId(){return this.state.sessionId}set codec(e){this.state.codec=e}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(e){this.dispatch({type:at.SET_P2P_ID,p2pId:e})}get p2pId(){return this.state.p2pId}set dcId(e){this.dispatch({type:at.SET_DC_ID,dcId:e})}get dcId(){return this.state.dcId}set uid(e){this.dispatch({type:at.SET_UID,uid:e})}get uid(){return this.state.uid}set intUid(e){this.dispatch({type:at.SET_INT_UID,intUid:e})}get intUid(){return this.state.intUid}set pubId(e){this.dispatch({type:at.SET_PUB_ID,pubId:e})}get pubId(){return this.state.pubId}set cloudProxyServerMode(e){this.dispatch({type:at.SET_CLOUD_PROXY_SERVER_MODE,mode:e})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(e){this.dispatch({type:at.SET_USE_P2P,val:e})}get useP2P(){return this.state.useP2P}set p2pTransport(e){this.dispatch({type:at.SET_TRANSPORT_TYPE,val:e})}get p2pTransport(){return this.state.p2pTransport}clientCreated(){this.dispatch({type:at.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:at.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:at.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:at.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:at.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:at.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:at.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:at.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:at.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:at.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:at.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:at.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(e,t,r,n){this.dispatch({type:at.KEY_METRIC_PUBLISH,metric:Ee(Ee({trackId:e,type:t},r&&{publishStart:r}),n&&{publishEnd:n})})}subscribe(e,t,r,n,i,o,s){this.dispatch({type:at.KEY_METRIC_SUBSCRIBE,metric:Ee(Ee(Ee(Ee(Ee({userId:e,type:t},r&&{subscribeStart:r}),n&&{subscribeEnd:n}),i&&{firstFrame:i}),o&&{streamAdded:o}),s&&{firstDecoded:s})})}massSubscribe(e,t,r,n){e.forEach(i=>{this.dispatch({type:at.KEY_METRIC_SUBSCRIBE,metric:Ee(Ee(Ee({userId:i.userId,type:i.type},t&&{subscribeStart:t}),r&&{subscribeEnd:r}),n&&{firstFrame:n})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(e,t){e.service==="gateway"&&Array.isArray(e.urls)&&(e.urls=e.urls.map(r=>r.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof t!="number"?(this.dispatch({type:at.RECORD_JOIN_CHANNEL_SERVICE,record:Ee(Ee({},e),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(t<0||t>=this.state.joinChannelServiceRecords.length||this.dispatch({type:at.RECORD_JOIN_CHANNEL_SERVICE,record:e,index:t}),t)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:at.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:at.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(e){this.dispatch({type:at.AVOID_JOIN_START,avoidJoinStart:e})}},tT=function(e){return e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1",e}({});(function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"})({});var $3=128,kDe=96,H3=1e3,Hh=10,PDe=0;function Rr(e,t,r){return(t=function(n){var i=function(o,s){if(typeof o!="object"||!o)return o;var a=o[Symbol.toPrimitive];if(a!==void 0){var c=a.call(o,"string");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n);return typeof i=="symbol"?i:i+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Qe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W3(Object(r),!0).forEach(function(n){Rr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var tQ=new class extends fr{constructor(){super(...arguments),Rr(this,"currentUploadLogID",0)}reportLogUploadError(e){let{errorRange:t}=e;t[t.length-1]&&t[t.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=t[t.length-1],this.emit("REPORT_LOG_UPLOAD",e))}},DDe=class{constructor(e){Rr(this,"logger",void 0),Rr(this,"prefixLists",[]),this.logger=e}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger.debug(...this.prefixLists,...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger.info(...this.prefixLists,...t)}warning(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger.warning(...this.prefixLists,...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger.error(...this.prefixLists,...t)}prefix(e){return this.prefixLists.push(e),this}popPrefix(){return this.prefixLists.pop(),this}};function YR(){let e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function G3(){let e=new Date,t=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return t?(t==null?void 0:t[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}var Xo={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},nE=Date.now(),$m=e=>{for(let t in Xo)if(Object.prototype.hasOwnProperty.call(Xo,t)&&Xo[t]===e)return t;return"DEFAULT"},b=new class{constructor(){Rr(this,"proxyServerURL",void 0),Rr(this,"logLevel",Xo.DEBUG),Rr(this,"uploadState","collecting"),Rr(this,"uploadLogWaitingList",[]),Rr(this,"uploadLogUploadingList",[]),Rr(this,"uploadErrorCount",0),Rr(this,"currentLogID",0),Rr(this,"url",void 0),Rr(this,"extLog",(e,t)=>{this.appendLogToWaitingList(e,...t)})}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=[Xo.DEBUG].concat(t);this.log.apply(this,n)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=[Xo.INFO].concat(t);this.log.apply(this,n)}warning(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=[Xo.WARNING].concat(t);this.log.apply(this,n)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=[Xo.ERROR].concat(t);this.log.apply(this,n)}upload(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=[Xo.DEBUG].concat(t);this.uploadLog.apply(this,n)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){Ft("UPLOAD_LOG",!0)}disableLogUpload(){Ft("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new DDe(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(Date.now()-nE<100)return void setTimeout(()=>{this.log(...t)},Date.now()-nE);let n=Math.max(0,Math.min(4,t[0]));if(t[0]=YR()+" Agora-SDK [".concat($m(n),"]:"),this.appendLogToWaitingList(n,...t),n<this.logLevel)return;let i=YR()+" %cAgora-SDK [".concat($m(n),"]:"),o=[];if(!D("USE_NEW_LOG"))switch(n){case Xo.DEBUG:o=[i,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,o);break;case Xo.INFO:o=[i,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,o);break;case Xo.WARNING:o=[i,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,o);break;case Xo.ERROR:o=[i,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,o)}}uploadLog(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(Date.now()-nE<100)return void setTimeout(()=>{this.uploadLog(...t)},Date.now()-nE);let n=Math.max(0,Math.min(4,t[0]));t[0]=YR()+" Agora-SDK [".concat($m(n),"]:"),this.appendLogToWaitingList(n,...t)}appendLogToWaitingList(e){if(!D("UPLOAD_LOG"))return;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];Array.isArray(r[0])?r[0][0]=G3()+" Agora-SDK [".concat($m(e),"]:"):r[0]=G3()+" Agora-SDK [".concat($m(e),"]:");let i="";r.forEach(o=>{typeof o=="object"&&(o=JSON.stringify(o)),i+="".concat(o," ")}),this.uploadLogWaitingList.push({payload_str:i,log_level:e,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){let e=this.uploadLogUploadingList,t={sdk_version:os,process_id:D("PROCESS_ID"),payload:JSON.stringify(e)};return Ua(async()=>{let r=await Li.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(D("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(D("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if(r.data!=="OK"){let n=new Error("unexpected upload log response");throw n.response=r,n}},()=>(this.uploadLogUploadingList=[],!1),r=>{let n={status:-1,message:r.message,errorRange:e.map(i=>i.log_item_id)};return r.response?(n.status=r.response.status,n.data=r.response.data,n.headers=r.response.headers):r.request&&(n.status=r.request.status),tQ.reportLogUploadError(n),!0},{timeout:D("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:D("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,D("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),D("UPLOAD_LOG_INTERVAL"))}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),D("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),D("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}},z3;function LDe(e){return En(e.reportId,"params.reportId",0,100,!1),En(e.category,"params.category",0,100,!1),En(e.event,"params.event",0,100,!1),En(e.label,"params.label",0,100,!1),Vt(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(z3={}).FREE="free",z3.UPLOADING="uploading",function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}({});var MDe={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0},vn=function(e){return e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",e}({}),hr=function(e){return e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",e}({});(function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});var jDe=function(e){return e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",e}({}),LD=class rQ{constructor(){Rr(this,"baseInfoMap",new Map),Rr(this,"proxyServer",void 0),Rr(this,"eventUploadTimer",void 0),Rr(this,"setSessionIdTimer",void 0),Rr(this,"url",void 0),Rr(this,"backupUrl",void 0),Rr(this,"_appId",void 0),Rr(this,"keyEventUploadPendingItems",[]),Rr(this,"normalEventUploadPendingItems",[]),Rr(this,"apiInvokeUploadPendingItems",[]),Rr(this,"apiInvokeCount",0),Rr(this,"ltsList",[]),Rr(this,"lastSendNormalEventTime",Date.now()),Rr(this,"customReportCounterTimer",void 0),Rr(this,"customReportCount",0),Rr(this,"extApiInvoke",async t=>{for(let r of t){let n=Qe(Qe({},r),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Er.TRACER});this.sendApiInvoke(n)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),D("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),D("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(t){return this.baseInfoMap.get(t)}adjustSessionStartTime(t){if(!this.baseInfoMap.has(t)&&!this.baseInfoMap.get(t))return void b.error("adjust session ".concat(t," start time, sid is not exist or info is undefined"));let r=this.baseInfoMap.get(t),n=Date.now(),i=r.startTime;r.startTime=n,b.debug("rewrite session ".concat(t," startTime: ").concat(n," , ").concat(n-i,"ms")),this.baseInfoMap.set(t,r)}setAppId(t){this._appId=t}reportApiInvoke(t,r,n){r.timeout=r.timeout||6e4,r.reportResult=r.reportResult===void 0||r.reportResult;let i=Date.now();this.apiInvokeCount+=1;let o=this.apiInvokeCount,s=()=>({tag:r.tag,invokeId:o,sid:t,name:r.name,apiInvokeTime:i,options:r.options,states:r.states||null}),a=!!D("SHOW_REPORT_INVOKER_LOG");a&&b.info("".concat(r.name," start"),r.options);let c=!1;Tn(r.timeout).then(()=>{c||(this.sendApiInvoke(Qe(Qe({},s()),{},{error:I.API_INVOKE_TIMEOUT,success:!1})),b.debug("".concat(r.name," timeout")))});let l=new X(I.UNEXPECTED_ERROR,"".concat(r.name,": this api invoke is end"));return{onSuccess:d=>{let u=()=>{if(c)throw l;return c=!0,this.sendApiInvoke(Qe(Qe({},s()),{},{success:!0},r.reportResult&&{result:d})),a&&b.info("".concat(r.name," onSuccess")),d};return n?U3(u,r.name+"Success",n,()=>c=!0):u()},onError:d=>{let u=()=>{if(c)throw d;c=!0,this.sendApiInvoke(Qe(Qe({},s()),{},{success:!1,error:d})),a&&b.info("".concat(r.name," onFailure"),d.toString())};return n?U3(u,r.name+"Error",n,()=>c=!0):u()}}}sessionInit(t,r){if(this.baseInfoMap.has(t))return;let n=Date.now(),i=this.createBaseInfo(t,n);i.cname=r.cname;let o=Object.assign({},{willUploadConsoleLog:D("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:kD?"global":"oversea",areas:D("AREAS")&&D("AREAS").join(",")},r.extend),{stringUid:s,channelProfile:a,channelMode:c,isABTestSuccess:l,lsid:d,clientRole:u}=r,p=Date.now(),f=Qe(Qe({},i),{},{eventType:vn.SESSION_INIT,appid:r.appid,browser:navigator.userAgent,buildFormat:r.buildFormat,build:DD,lts:p,elapse:p-n,extend:JSON.stringify(o),mode:r.mode,process:D("PROCESS_ID"),appType:D("APP_TYPE"),success:!0,version:os,stringUid:s,channelProfile:a,channelMode:c,isABTestSuccess:l,lsid:d,clientType:pe(m=window.navigator.userAgent).call(m,"AgoraWebView")?42:20,clientRole:u,serviceId:D("PROCESS_ID"),extensionID:D("PLUGIN_INFO").join(",")||""});var m;this.send({type:hr.SESSION,data:f},!0)}joinChooseServer(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe({},i),{},{eventType:vn.JOIN_CHOOSE_SERVER,lts:o,eventElapse:r.elapse||o-r.lts,chooseServerAddr:r.csAddr,errorCode:r.ec,elapse:o-n.startTime,success:r.succ,chooseServerAddrList:JSON.stringify(r.serverList),uid:r.uid?parseInt(r.uid):null,cid:r.cid?parseInt(r.cid):null,chooseServerIp:r.csIp||"",opid:r.opid,unilbsServerIds:r.unilbsServerIds,extend:r.extend||void 0,isHttp3:r.isHttp3});this.send({type:hr.JOIN_CHOOSE_SERVER,data:s},!0)}reqUserAccount(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe({},i),{},{eventType:vn.REQ_USER_ACCOUNT,lts:o,success:r.success,serverAddress:r.serverAddr,stringUid:r.stringUid,uid:r.uid,errorCode:r.errorCode,elapse:r.elapse||o-n.startTime,eventElapse:o-r.lts,extend:JSON.stringify(r.extend)});this.send({type:hr.REQ_USER_ACCOUNT,data:s},!0)}joinGateway(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info;r.vid&&(i.vid=r.vid),i.uid=r.uid,i.cid=r.cid;let o=Date.now(),{firstSuccess:s,avoidJoinStartTime:a}=r,c=o-(s&&a?a:n.startTime),l=Qe(Qe({},i),{},{eventType:vn.JOIN_GATEWAY,lts:o,gatewayAddr:r.addr,success:r.succ,errorCode:r.ec,errorMsg:r.errorMsg||"",elapse:c,eventElapse:o-r.lts,firstSuccess:s,signalChannel:r.signalChannel,preload:r.preload?1:0});r.succ&&(n.lastJoinSuccessTime=o),this.send({type:hr.JOIN_GATEWAY,data:l},!0)}joinChannelTimeout(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=Date.now(),o=Qe(Qe({},n.info),{},{lts:i,timeout:r,elapse:i-n.startTime});this.send({type:hr.JOIN_CHANNEL_TIMEOUT,data:o},!0)}publish(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe({},i),{},{eventType:vn.PUBLISH,lts:o,eventElapse:r.eventElapse,elapse:o-n.startTime,success:r.succ,errorCode:r.ec,videoName:r.videoName,audioName:r.audioName,screenName:r.screenName,screenshare:r.screenshare,audio:r.audio,video:r.video,p2pid:r.p2pid,publishRequestid:r.publishRequestid});this.send({type:hr.PUBLISH,data:s},!0)}subscribe(t,r,n){let i=this.baseInfoMap.get(t);if(!i)return;let o=i.info,s=Date.now(),a=Qe(Qe({},o),{},{eventType:vn.SUBSCRIBE,lts:s,eventElapse:r.eventElapse,elapse:s-i.startTime,success:r.succ,errorCode:r.ec,video:r.video,audio:r.audio,subscribeRequestid:r.subscribeRequestid,p2pid:r.p2pid,preSsrc:r.preSsrc?1:0},n&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof r.peerid=="string"?a.peerSuid=r.peerid:a.peer=r.peerid,this.send({type:hr.SUBSCRIBE,data:a},!0)}wsCompressorInit(t){var r;let n=[...wo(r=this.baseInfoMap).call(r)],i=n.length?n[0]:"UnableToGetSid",o=this.baseInfoMap.get(i);if(!o)return;let s=o.info,a=Date.now(),c=Qe(Qe({},s),{},{eventType:vn.WS_COMPRESSOR_INIT,lts:a,eventElapse:t.eventElapse,elapse:a-o.startTime,status:t.status?1:2});this.send({type:hr.WS_COMPRESSOR_INIT,data:c},!0)}firstRemoteVideoDecode(t,r,n,i){let o=this.baseInfoMap.get(t);if(!o)return;let s=o.info,a=Date.now(),c=Qe(Qe(Qe({},s),i),{},{elapse:a-o.startTime,eventType:r,lts:a,firstDecodeFrame:Math.max((i.firstFrame||a)-o.startTime,0),apEnd:Math.max(i.apEnd-o.startTime,0),apStart:Math.max(i.apStart-o.startTime,0),joinGwEnd:Math.max(i.joinGwEnd-o.startTime,0),joinGwStart:Math.max(i.joinGwStart-o.startTime,0),pcEnd:Math.max(i.pcEnd-o.startTime,0),pcStart:Math.max(i.pcStart-o.startTime,0),subscriberEnd:Math.max(i.subscriberEnd-o.startTime,0),subscriberStart:Math.max(i.subscriberStart-o.startTime,0),videoAddNotify:Math.max(i.videoAddNotify-o.startTime,0)});this.send({type:n,data:c},!0)}firstRemoteFrame(t,r,n,i){let o=this.baseInfoMap.get(t);if(!o)return;let s=o.info,a=Date.now(),c=Qe(Qe(Qe({},s),i),{},{elapse:a-o.startTime,eventType:r,lts:a});this.send({type:n,data:c},!0)}pcStats(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe(Qe({},i),r),{},{vid:i.vid===void 0?0:Number(i.vid),elapse:o-n.startTime,eventType:vn.PC_STATS,lts:o,preallocation:r.preallocation?1:0});this.send({type:hr.PC_STATS,data:s},!0)}updateRemoteRTPCapabilities(t,r){if(t){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe(Qe({},i),r),{},{vid:i.vid===void 0?0:Number(i.vid),eventType:vn.UPDATE_REMOTE_RTPCAPABILITIES,lts:o});this.send({type:hr.UPDATE_REMOTE_RTPCAPABILITIES,data:s},!0)}}onGatewayStream(t,r,n,i){let o=this.baseInfoMap.get(t);if(!o)return;let s=o.info,a=Date.now(),c=Qe(Qe(Qe({},s),i),{},{eventType:r,lts:a});this.send({type:n,data:c},!0)}streamSwitch(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe({},i),{},{eventType:vn.STREAM_SWITCH,lts:o,isDual:r.isdual,elapse:o-n.startTime,success:r.succ});this.send({type:hr.STREAM_SWITCH,data:s},!0)}requestProxyAppCenter(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe({},i),{},{eventType:vn.REQUEST_PROXY_APPCENTER,lts:o,eventElapse:o-r.lts,elapse:o-n.startTime,APAddr:r.APAddr,workerManagerList:r.workerManagerList,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:hr.REQUEST_PROXY_APPCENTER,data:s},!0)}requestProxyWorkerManager(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe({},i),{},{eventType:vn.REQUEST_PROXY_WORKER_MANAGER,lts:o,eventElapse:o-r.lts,elapse:o-n.startTime,workerManagerAddr:r.workerManagerAddr,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:hr.REQUEST_PROXY_WORKER_MANAGER,data:s},!0)}setProxyServer(t){this.proxyServer=t,t?b.debug("reportProxyServerurl: ".concat(t)):b.debug("disable reportProxyServerurl: ".concat(t))}peerPublishStatus(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe({},i),{},{subscribeElapse:r.subscribeElapse,peer:r.peer,peerPublishDuration:Math.max(r.audioPublishDuration,r.videoPublishDuration),audiotag:r.audioPublishDuration>0?1:-1,videotag:r.videoPublishDuration>0?1:-1,lts:o,elapse:o-n.startTime,joinChannelSuccessElapse:o-(n.lastJoinSuccessTime||o),peerPublishDurationVideo:r.videoPublishDuration,peerPublishDurationAudio:r.audioPublishDuration});this.send({type:hr.PEER_PUBLISH_STATUS,data:s},!0)}workerEvent(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now();(function(s,a,c){let l=s[a];if(!l||typeof l!="string")return[s];s[a]="";let d=cc(JSON.stringify(s)),u=0,p=[],f=0;for(let m=0;m<l.length;m++)f+=l.charCodeAt(m)<=127?1:3,f<=c-d||(p[p.length]=Ee(Ee({},s),{},{[a]:l.substring(u,m)}),u=m,f=l.charCodeAt(m)<=127?1:3);return u!==l.length-1&&(p[p.length]=Ee(Ee({},s),{},{[a]:l.substring(u)})),p})(Qe(Qe(Qe({},i),r),{},{elapse:o-n.startTime,lts:o,productType:"WebRTC"}),"payload",1300).forEach(s=>this.send({type:hr.WORKER_EVENT,data:s},!0))}apworkerEvent(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe(Qe({},i),r),{},{elapse:o-n.startTime,lts:o});this.send({type:hr.AP_WORKER_EVENT,data:s},!0)}joinWebProxyAP(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe(Qe({},i),r),{},{elapse:o-n.startTime,lts:o,extend:r.extend||void 0});this.send({type:hr.JOIN_WEB_PROXY_AP,data:s},!0)}WebSocketQuit(t,r){let n=this.baseInfoMap.get(t);if(!n)return;let i=n.info,o=Date.now(),s=Qe(Qe(Qe({},i),r),{},{elapse:o-n.startTime,lts:o});this.send({type:hr.WEBSOCKET_QUIT,data:s},!0)}async sendCustomReportMessage(t,r){if(this.customReportCount+=r.length,this.customReportCount>D("CUSTOM_REPORT_LIMIT"))throw new X(I.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));let n=Date.now(),i=r.map(o=>({type:hr.USER_ANALYTICS,data:Qe(Qe({sid:t},o),{},{lts:n})}));try{D("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(i):await this.postDataToStatsCollector(i)}catch(o){throw b.error("send custom report message failed",o.toString()),new X(I.CUSTOM_REPORT_SEND_FAILED,o.message)}}sendApiInvoke(t){let r=D("NOT_REPORT_EVENT");if(t.tag&&pe(r)&&pe(r).call(r,t.tag))return!1;if(t.sid===null)return this.apiInvokeUploadPendingItems.push(t),!1;let n=this.baseInfoMap.get(t.sid);if(!n)return this.apiInvokeUploadPendingItems.push(t),!1;let{cname:i,uid:o,cid:s}=n.info,a;if(t.lts=t.lts||Date.now(),t.error)if(t.error instanceof X){let{code:l,message:d}=t.error;a=l||d||t.error.toString()}else a=t.error.toString();let c={invokeId:t.invokeId,sid:t.sid,cname:i,cid:s,uid:o,lts:t.lts,success:t.success,elapse:t.lts-n.startTime,execElapse:t.lts-t.apiInvokeTime,apiName:t.name,options:t.options?JSON.stringify(t.options):void 0,execStates:t.states?JSON.stringify(t.states):void 0,execResult:t.result?JSON.stringify(t.result):void 0,errorCode:t.error?a:void 0,errorMsg:t.error?JSON.stringify(t.error):void 0};return this.send({type:hr.API_INVOKE,data:c},!1),!0}appendSessionId(){rQ.__CLIENT_LIST__.forEach(t=>{if(t._sessionId){let r=this.apiInvokeUploadPendingItems.length;for(let n=0;n<r;n++){let i=this.apiInvokeUploadPendingItems.shift();i&&(i.sid=t._sessionId,this.sendApiInvoke(Object.assign({},i)))}}})}send(t,r){if(r)return this.keyEventUploadPendingItems.push(t),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(t),this.normalEventUploadPendingItems.length>D("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(t,r){let n=[],i=[];for(;t.length;){let s=t.shift();n.length<20?n.push(s):i.push(s)}t.push(...i);for(let s of[...n]){var o;this.ltsList.indexOf(s.data.lts)!==-1?(s.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(s.data.lts)):(this.ltsList.push(s.data.lts),Vy(o=this.ltsList).call(o,(a,c)=>a-c))}return r||(this.lastSendNormalEventTime=Date.now()),D("ENABLE_EVENT_REPORT")&&n.length&&(D("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(n):this.postDataToStatsCollector(n)).catch((s=>a=>{D("EVENT_REPORT_RETRY")&&(r?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(s):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(s),this.normalEventUploadPendingItems.length>D("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-D("NORMAL_EVENT_QUEUE_CAPACITY")),b.warning("report: drop normal events"))))})(n)),t}async postDataToStatsCollector2(t){Dr.networkState===oo.OFFLINE&&await de.race([Dr.onlineWaiter,Tn(2*Fr.maxRetryTimeout)]);let r=o=>{let s=new Uint8Array;return o.forEach(a=>{let c=OD(JSON.stringify(a.data)),l=new ArrayBuffer(5),d=(p=>{let f=0;return Object.entries(hr).forEach(m=>{let[g,y]=m;y===p.type&&(f=jDe[g])}),f})(a),u=new DataView(l);u.setUint16(0,c.byteLength,!0),u.setUint8(2,255&d),u.setUint8(3,d>>>8&255),u.setUint8(4,d>>>16&255),s=k3(s,new Uint8Array(l)),s=k3(s,c)}),s},n="event",i=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(D("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(n):"https://".concat(D("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(n);for(let o=0;o<2;o+=1){o===1&&(i=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(D("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(n):"https://".concat(D("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(n));try{await DO(i,{timeout:1e4,data:r(t),headers:Qe(Qe({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(s){if(o===1)throw s;continue}return}}async postDataToStatsCollector(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1],n={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:t.map(s=>JSON.stringify(s)),vid:(s=>{let a=s&&s.data.sid&&this.baseInfoMap.get(s.data.sid);return a&&a.info.vid&&+a.info.vid||0})(t[0])};Dr.networkState===oo.OFFLINE&&await de.race([Dr.onlineWaiter,Tn(2*Fr.maxRetryTimeout)]);let i=r?"/events/proto-raws":"/events/messages",o=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(D("EVENT_REPORT_DOMAIN"),"&p=").concat(D("STATS_COLLECTOR_PORT"),"&d=").concat(i):"https://".concat(D("EVENT_REPORT_DOMAIN"),":").concat(D("STATS_COLLECTOR_PORT")).concat(i));for(let s=0;s<2;s+=1){s===1&&(o=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(D("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(D("STATS_COLLECTOR_PORT"),"&d=").concat(i):"https://".concat(D("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(D("STATS_COLLECTOR_PORT")).concat(i)));try{r?await ODe(o,{timeout:1e4,data:n}):await DO(o,{timeout:1e4,data:n})}catch(a){if(s===1)throw a;continue}return}}createBaseInfo(t,r){let n=Object.assign({},MDe);return n.sid=t,this.baseInfoMap.set(t,{info:n,startTime:r}),n}reportResourceTiming(t,r){let n=performance.getEntriesByName(t),i=n[n.length-1];i&&this.reportApiInvoke(r,{name:"Client.resourceTiming",options:i,tag:Er.TRACER}).onSuccess()}};function Oe(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(t,r,n){let i=n.value;if(typeof i=="function"){let o=e.className||t.__className__||(t.constructor.name==="AgoraRTCClient"?"Client":t.constructor.name);n.value=function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];let l=a;if(e.argsMap)try{l=e.argsMap(this,...a)}catch(u){b.warning(u),l=[]}try{JSON.stringify(l)}catch{b.warning("arguments for method ".concat(o,".").concat(String(r)," not serializable for apiInvoke.")),l=[]}let d=(e.report||_e).reportApiInvoke(this._sessionId||null,{name:"".concat(o,".").concat(String(r)),options:l,tag:Er.TRACER,reportResult:e.reportResult},e.throttleTime);try{let u=i.apply(this,a);return u instanceof de?u.then(p=>(d.onSuccess(e.reportResult&&p),p)).catch(p=>{throw d.onError(p),p}):(d.onSuccess(e.reportResult&&u),u)}catch(u){throw d.onError(u),u}}}return n}}Rr(LD,"__CLIENT_LIST__",[]);var _e=new LD;tQ.on("REPORT_LOG_UPLOAD",e=>{e.networkState=Dr.networkState,_e.reportApiInvoke(null,{name:"logUploadError",options:e,tag:Er.TRACER}).onSuccess("logUploadError")});var UDe=["CHINA","GLOBAL"],xn=function(){let e="us".concat("erna","me"),t="pa".concat("sswo","rd"),r=["t","s","t"];r.splice(1,0,"e");let n=r.join(""),i=[];for(let a=0;a<6;a++)i.push("1");let o=i.join(""),s={};return s[e]=n,s[t]=o,Object.assign(s,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=xn,kD||(Ir.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Ir.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Ir.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Ir.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Ir.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Ir.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Ir.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Ir.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Ir.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Ir.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Ir.AREAS=["NORTH_AMERICA","OVERSEA"]);var nQ=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],zl=[];function Jd(e,t){return!!t&&zl.some(r=>r.uid===e&&r.channelName===t)}LD.__CLIENT_LIST__=zl;var FDe=JX.forEach,K3=MS("forEach")?[].forEach:function(e){return FDe(this,e,arguments.length>1?arguments[1]:void 0)};Yt({target:"Array",proto:!0,forced:[].forEach!=K3},{forEach:K3});var VDe=sa("Array").forEach,BDe=Cc,$De=Kn,HDe=Ti,WDe=VDe,XR=Array.prototype,GDe={DOMTokenList:!0,NodeList:!0},zDe=function(e){var t=e.forEach;return e===XR||HDe(XR,e)&&t===XR.forEach||$De(GDe,BDe(e))?WDe:t},KDe=xr(zDe),qDe=Tc,q3=VS;Yt({target:"Object",stat:!0,forced:qr(function(){q3(1)})},{keys:function(e){return q3(qDe(e))}});var iQ=xr(ja.Object.keys),YDe=xr(cY),XDe=Yt,JDe=By,QDe=Br([].reverse),Y3=[1,2];XDe({target:"Array",proto:!0,forced:String(Y3)===String(Y3.reverse())},{reverse:function(){return JDe(this)&&(this.length=this.length),QDe(this)}});var ZDe=sa("Array").reverse,e2e=Ti,t2e=ZDe,JR=Array.prototype,r2e=function(e){var t=e.reverse;return e===JR||e2e(JR,e)&&t===JR.reverse?t2e:t},oQ=r2e,n2e=xr(oQ),i2e=Yt,X3=By,o2e=HS,s2e=Bo,J3=YP,a2e=El,c2e=Fd,l2e=zS,d2e=jr,u2e=cD,h2e=KX("slice"),p2e=d2e("species"),QR=Array,f2e=Math.max;i2e({target:"Array",proto:!0,forced:!h2e},{slice:function(e,t){var r,n,i,o=c2e(this),s=a2e(o),a=J3(e,s),c=J3(t===void 0?s:t,s);if(X3(o)&&(r=o.constructor,(o2e(r)&&(r===QR||X3(r.prototype))||s2e(r)&&(r=r[p2e])===null)&&(r=void 0),r===QR||r===void 0))return u2e(o,a,c);for(n=new(r===void 0?QR:r)(f2e(c-a,0)),i=0;a<c;a++,i++)a in o&&l2e(n,i,o[a]);return n.length=i,n}});var m2e=sa("Array").slice,g2e=Ti,y2e=m2e,ZR=Array.prototype,v2e=function(e){var t=e.slice;return e===ZR||g2e(ZR,e)&&t===ZR.slice?y2e:t},E2e=xr(v2e);function ve(e,t,r,n,i){var o,s,a,c={};return KDe(o=iQ(n)).call(o,function(l){c[l]=n[l]}),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=YDe(s=n2e(a=E2e(r).call(r)).call(a)).call(s,function(l,d){return d(e,t,l)||l},c),i&&c.initializer!==void 0&&(c.value=c.initializer?c.initializer.call(i):void 0,c.initializer=void 0),c.initializer===void 0&&(GX(e,t,c),c=null),c}var LO=function(e){return e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L1T3_KEY="L1T3_KEY",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY",e}({}),yo=function(e){return e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver",e}({}),u_=function(e){return e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",e}({}),eI=function(e){return e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR",e}({}),xs=function(e){return e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",e}({}),ui=function(e){return e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",e}({}),xe=function(e){return e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",e}({}),Kt=function(e){return e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed",e}({}),je=function(e){return e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.PRE_CONNECT_PC="pre_connect_pc",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",e}({}),Me=function(e){return e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag",e}({}),U0=function(e){return e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats",e}({}),ct=function(e){return e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list",e}({}),yi=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({}),Fe=function(e){return e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",e}({}),G=class extends X{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),C(this,"name","AgoraRTCException")}print(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(e,b)}throw(){super.throw(b)}};function rT(e){if(typeof e!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw b.error("Invalid Channel Name ".concat(e)),new G(I.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function nT(e){if(!function(t){return typeof t=="number"&&Math.floor(t)===t&&0<=t&&t<=4294967295}(e)&&!KJ(e,1,255))throw new G(I.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");typeof e=="string"&&b.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}var Qc=function(e){return e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e}({}),_2e={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},tI={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function rI(e,t){En(e.url,"".concat(t,".url"),1,1e3,!1),dr(e.x)||Vt(e.x,"".concat(t,".x"),0,1e4),dr(e.y)||Vt(e.y,"".concat(t,".y"),0,1e4),dr(e.width)||Vt(e.width,"".concat(t,".width"),0,1e4),dr(e.height)||Vt(e.height,"".concat(t,".height"),0,1e4),dr(e.zOrder)||Vt(e.zOrder,"".concat(t,".zOrder"),0,255),dr(e.alpha)||Vt(e.alpha,"".concat(t,".alpha"),0,1,!1)}var b2e={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},Kl=function(e){return e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address",e}({}),MO=function(e){return e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",e}({}),Wr=function(e){return e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",e}({});function Q3(e){if(!e.channelName)throw new G(I.INVALID_PARAMS,"invalid channelName in info");if(typeof e.uid!="number")throw new G(I.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&En(e.token,"info.token",1,2047),nT(e.uid),rT(e.channelName),!0}var hi=function(e){return e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile",e}({}),jc=function(e){return e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",e}({}),Bi=function(e){return e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",e}({}),np=function(e){return e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",e}({}),Ot=function(e){return e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low",e}({}),An=function(e){return e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.PRE_CONNECT_PC="pre-connect_pc",e}({}),h_=function(e){return e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON",e}({}),rn=function(e){return e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7",e}({}),St=function(e){return e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS",e}({}),Z3=[St.AFRICA,St.ASIA,St.CHINA,St.EUROPE,St.GLOBAL,St.INDIA,St.JAPAN,St.NORTH_AMERICA,St.OCEANIA,St.OVERSEA,St.SOUTH_AMERICA],Fn=function(e){return e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL",e}({}),iT={CHINA:{},ASIA:{CODE:Fn.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Fn.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Fn.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Fn.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Fn.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Fn.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Fn.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Fn.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Fn.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Fn.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Fn.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Fn.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Fn.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};kD&&(iT.CHINA={CODE:Fn.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});var jO=function(e){return e.UPDATE_BITRATE_LIMIT="update_bitrate_limit",e}({}),sQ=class extends fr{constructor(e,t){super(),C(this,"onICEConnectionStateChange",void 0),C(this,"onConnectionStateChange",void 0),C(this,"onDTLSTransportStateChange",void 0),C(this,"onDTLSTransportError",void 0),C(this,"onICETransportStateChange",void 0),C(this,"onFirstAudioReceived",void 0),C(this,"onFirstVideoReceived",void 0),C(this,"onFirstAudioDecoded",void 0),C(this,"onFirstVideoDecoded",void 0),C(this,"onFirstVideoDecodedTimeout",void 0),C(this,"onSelectedLocalCandidateChanged",void 0),C(this,"onSelectedRemoteCandidateChanged",void 0),C(this,"getLocalVideoStats",void 0)}},aQ=class extends sQ{constructor(e,t){super(e,t),C(this,"establishPromise",void 0)}},we=function(e){return e.VIDEO="video",e.AUDIO="audio",e}({}),so=function(e){return e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.RELAY=2]="RELAY",e}({}),Pc=function(e){return e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.TCP_RESTART=1]="TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",e}({}),ne=function(e){return e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack",e}({}),xt=function(e){return e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected",e}({}),Ne=function(e){return e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE",e}({}),Ms=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),Os=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),dn=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),cQ=function(e){return e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback",e.PRE_CONNECT_PC="transmitter:pre_connect_pc",e}({}),ic=function(e){return e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation",e}({}),qo=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),ga=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),Wh=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),Cr=function(e){return e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check",e}({}),Gh=function(e){return e.ABORT="abort",e}({}),id=function(e){return e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e}({}),w2e=function(e){return e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed",e}({}),S2e={[u_.ACCESS_POINT]:{[ui.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[ui.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[ui.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[ui.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[ui.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[ui.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[ui.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[u_.UNILBS]:{[xs.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[xs.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[xs.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[xs.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[xs.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[xs.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[xs.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[xs.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[xs.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[xs.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[xs.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[xs.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[u_.STRING_UID_ALLOCATOR]:{[eI.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[eI.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[eI.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function If(e){let t=S2e[Math.floor(e/1e4)];if(!t)return{desc:"unknown error",retry:!1};let r=t[e%1e4];if(!r){if(Math.floor(e/1e4)===u_.ACCESS_POINT){let n=e%1e4;if(n.toString()[0]==="1")return{desc:e.toString(),retry:!1};if(n.toString()[0]==="2")return{desc:e.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return r}var T2e={[xe.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[xe.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[xe.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[xe.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[xe.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[xe.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[xe.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[xe.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[xe.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[xe.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[xe.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[xe.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[xe.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[xe.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[xe.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[xe.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[xe.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[xe.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[xe.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[xe.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[xe.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[xe.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[xe.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[xe.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[xe.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[xe.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[xe.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[xe.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[xe.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[xe.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[xe.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[xe.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[xe.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[xe.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[xe.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[xe.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[xe.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[xe.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[xe.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[xe.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[xe.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[xe.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[xe.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[xe.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[xe.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[xe.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[xe.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[xe.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[xe.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[xe.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[xe.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[xe.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[xe.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[xe.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[xe.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[xe.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[xe.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[xe.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[xe.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[xe.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[xe.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[xe.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function F0(e){return T2e[e]||{desc:"UNKNOWN_ERROR_".concat(e),action:"failed"}}function eF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eF(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tF(e){return e.every(t=>t.readyState===WebSocket.CLOSED||t.readyState===WebSocket.CLOSING)}function rF(e,t){if(typeof e=="string")return e;let{proxy:r,host:n,port:i}=e;if(t){let o=D("JOIN_GATEWAY_FALLBACK_PORT")||443;return o===443?"wss://".concat(n,"/ws/?p=").concat(Number(i)+150):"wss://".concat(n,":").concat(o,"/ws/?p=").concat(Number(i)+150)}return r?"wss://".concat(r,"/ws/?h=").concat(n,"&p=").concat(i):"wss://".concat(n,":").concat(i)}var C2e=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,R2e=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,I2e=/wss:\/\/(.+):([0-9]+)\/?/,A2e=/wss:\/\/(.[^\/]+)\/?/,x2e=0,O2e=class{constructor(e,t){C(this,"id",0),C(this,"store",void 0),C(this,"recordIndex",void 0),C(this,"websockets",[]),C(this,"try443PortDuration",2e3),C(this,"forceCloseWSDuration",5e3),C(this,"try443PortTimeout",null),C(this,"forceCloseTimeout",null),C(this,"isTry443PortFailed",!1),C(this,"isNormalPortFailed",!1),C(this,"useDoubleDomain",!1),C(this,"useProxy",!1),C(this,"startTime",Date.now()),this.id=++x2e,this.try443PortDuration=D("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=e||5e3,this.store=t}closeAllWebsockets(){this.websockets.forEach(e=>{e.onopen=null,e.onclose=null,e.onmessage=null,e.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var e;let t=Date.now()-this.startTime;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];b.debug("[choose-best-ws ".concat((e=this.store)===null||e===void 0?void 0:e.clientId," ").concat(this.id,"] ").concat(t,"ms:"),...n)}createWebSocket(e,t,r){this.logger("createWebSocket:",e,{isTry443Port:t,hasTimeoutDetection:r});let n=D("GATEWAY_DOMAINS"),i=Date.now(),o=[],s=n.find(l=>{var d;return pe(d=e.host).call(d,l)});s||(this.useDoubleDomain=!1);let a=[];if(this.useDoubleDomain)n.forEach(l=>{a.push(rF(nI(nI({},e),{},{host:e.host.replace(s,l)}),t))});else{let l=nI({},e);if(t&&s){let d=n.find(u=>u!==s);d&&(l.host=l.host.replace(s,d))}a.push(rF(l,t))}try{a.forEach(l=>{let d=new WebSocket(l);d.binaryType="arraybuffer",o.push(d),this.logger("ws is connecting:",d.url)})}catch(l){if(this.logger("ws create failed"),o.forEach(d=>d.close()),o.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(e,t,r);if(!t&&Number(e.port)!==443)return this.createWebSocket(e,!0,r);throw new G(I.WS_ERR,"init websocket failed! Error: ".concat(l.toString()))}let c=L0();return this.store&&this.store.recordJoinChannelService({urls:o.map(l=>l.url),service:"gateway"},this.recordIndex),o.forEach(l=>{l.onopen=()=>{this.logger("onopen: ws ".concat(l.url," open cost ").concat(Date.now()-i,"ms")),this.websockets.forEach(d=>{d!==l&&(d.onopen=null,d.onclose=null,d.onmessage=null,d.close(),this.logger("close backup websocket: ".concat(d.url)))}),this.websockets.length=0,c.resolve(l)},l.onclose=d=>{this.logger("onclose: ws ".concat(l.url," closed cost ").concat(Date.now()-i,"ms state: ").concat(l.readyState)),t?this.isTry443PortFailed=tF(o):this.isNormalPortFailed=tF(o),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(t&&this.isTry443PortFailed||!t&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(d.reason)),c.reject({code:d.code,reason:h_.A_ROUND_WS_FAILED}))},l.onmessage=d=>this.logger("".concat(l.url," onmessage: ").concat(d.data))}),this.websockets.push(...o),r||(()=>{let l=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",c.isResolved),this.websockets.forEach(d=>d.readyState!==WebSocket.OPEN&&d.close())};if(t||this.useProxy)return this.logger("add 5s timeout at ".concat(t?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(l,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{if(this.logger("2s timeout, isWebsocket created: ",c.isResolved),c.isResolved)return l();yt().os===sn.MAC_OS&&_r()&&l(),this.createWebSocket(e,!0,!0).then(d=>c.resolve(d)).catch(d=>{this.isNormalPortFailed&&c.reject(d),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(l,this.forceCloseWSDuration)},this.try443PortDuration)})(),c.promise}chooseBestWebsocket(e,t,r,n){return this.useDoubleDomain=!!t,typeof e=="string"&&(e=function(i){let o,s,a;return[,o,s,a]=i.match(C2e)||[],o||([,s,a]=i.match(R2e)||[]),s&&a||([,s,a]=i.match(I2e)||[]),s&&a||([,s]=i.match(A2e)||[]),s||b.warning("un-destructible url: ",i),{proxy:o,host:s,port:a||"443"}}(e)),this.recordIndex=n,this.useProxy=!!e.proxy,r&&this.useProxy&&(b.warn("cannot use 443 only when use proxy"),r=!1),this.createWebSocket(e,!!r,!1).finally(()=>this.clearTimeout())}};function nF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}var lQ=class extends fr{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var t;pe(t=["tryNext","recover"]).call(t,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._state==="reconnecting"?this.emit(Fe.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(Fe.CONNECTED):this._state==="closed"?this.emit(Fe.CLOSED):this._state==="failed"&&this.emit(Fe.FAILED))}resetReconnectCount(e){b.debug("websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2],n=arguments.length>3&&arguments[3]!==void 0&&arguments[3],i=arguments.length>4&&arguments[4]!==void 0&&arguments[4],o=arguments.length>5?arguments[5]:void 0;super(),C(this,"connectionID",0),C(this,"currentURLIndex",0),C(this,"urls",[]),C(this,"_reconnectMode","tryNext"),C(this,"reconnectReason",void 0),C(this,"_initMutex",new Gn("websocket")),C(this,"name",void 0),C(this,"_state","closed"),C(this,"reconnectInterrupter",void 0),C(this,"websocket",void 0),C(this,"retryConfig",void 0),C(this,"reconnectCount",0),C(this,"forceCloseTimeout",5e3),C(this,"onlineReconnectListener",void 0),C(this,"useCompress",void 0),C(this,"tryDoubleDomain",!1),C(this,"use443PortOnly",!1),C(this,"wsInflateLength",0),C(this,"wsDeflateLength",0),C(this,"closeEstablishingWs",()=>{}),C(this,"store",void 0),C(this,"joinGatewayRecordIndex",void 0),this.store=o,this.name=e,this.retryConfig=function(d){for(var u=1;u<arguments.length;u++){var p=arguments[u]!=null?arguments[u]:{};u%2?nF(Object(p),!0).forEach(function(f){C(d,f,p[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(p)):nF(Object(p)).forEach(function(f){Object.defineProperty(d,f,Object.getOwnPropertyDescriptor(p,f))})}return d}({},t),this.useCompress=r,this.tryDoubleDomain=n,this.use443PortOnly=i;let{timeout:s,timeoutFactor:a}=t,c=Math.max(300,Math.floor(3*s/5)),l=Math.max(1.2,Math.floor(8*a)/10);oo.ONLINE&&(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=l),Dr.on(xp.NETWORK_STATE_CHANGE,(d,u)=>{d!==u&&(this.resetReconnectCount("network state change: ".concat(u," -> ").concat(d)),d===oo.ONLINE?(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=l):(this.retryConfig.timeout=s,this.retryConfig.timeoutFactor=a))})}getConnection(){return this.websocket||void 0}async init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3,r=await this._initMutex.lock();this.forceCloseTimeout=t,this.urls=e,this.state="connecting";try{let n=L0(),i=this.urls[this.currentURLIndex];D("ENABLE_PREALLOC_PC")&&this.emit(cQ.PRE_CONNECT_PC),this.createWebSocketConnection(i).then(n.resolve).catch(n.reject),this.once(Fe.CLOSED,()=>{n.reject(new X(I.WS_DISCONNECT))}),this.once(Fe.CONNECTED,n.resolve),await n.promise}catch{}finally{r()}}close(e,t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;let r=this.websocket;t?setTimeout(()=>r.close(),500):r.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,t){if(!this.websocket)return void b.warning("[".concat(this.name,"] can not reconnect, no websocket"));e!==void 0&&(this.reconnectMode=e),b.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(t)]},this.joinGatewayRecordIndex);let r=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),r&&r.bind(this.websocket)({code:9999,reason:t})}sendMessage(e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new X(I.WS_ABORT,"websocket is not ready");try{t||(e=JSON.stringify(e)),this.websocket.send(e)}catch(r){throw new X(I.WS_ERR,"send websocket message error"+r.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){let e=this.wsInflateLength,t=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:t}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e){var t;let r=L0();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;let n=l=>{var d;(d=this.store)===null||d===void 0||d.signalChannelOpen(),b.debug("[".concat(this.name,"] websocket opened:"),l),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),r.resolve()},i=async l=>{var d;if(b.debug("[".concat(this.name,"] websocket close ").concat((d=this.websocket)===null||d===void 0?void 0:d.url,", code: ").concat(l.code,", reason: ").concat(l.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)r.reject(new X(I.WS_DISCONNECT,"websocket close: ".concat(l.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=l.reason,this.state="reconnecting");let u=is(this,Fe.WILL_RECONNECT,this.reconnectMode,l.reason)||this.reconnectMode,p=await this.reconnectWithAction(u);if(this.state==="closed")return void b.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!p)return r.reject(new X(I.WS_DISCONNECT,"websocket reconnect failed: ".concat(l.code))),this.close(!0);r.resolve()}},o=l=>{this.emit(Fe.ON_MESSAGE,l)},s=l=>{b.warn("[".concat(this.connectionID,"] ws open error ").concat(l))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),D("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=D("GATEWAY_WSS_ADDRESS")),b.debug("[".concat(this.name,"] start connect, url:"),e);let a=(t=this.store)===null||t===void 0?void 0:t.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var c;let l=await this.chooseBestWebsocketConnection(e);this.websocket=l,n&&n(this.websocket.url),this.websocket.onclose=i,this.websocket.onmessage=o,this.websocket.onerror=s,(c=this.store)===null||c===void 0||c.recordJoinChannelService({endTs:Date.now(),status:"success"},a),this.joinGatewayRecordIndex=a}catch(l){let d=this.state==="closed",u=l instanceof X,p=u&&l.code===I.WS_ABORT,f=u&&l.code===I.WS_ERR,m=u?l.message:l&&(l.reason||l.toString());b.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(m)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:p?"aborted":"error",errors:[l]},a),d||f?(r.reject(d?new X(I.WS_DISCONNECT,"websocket is closed: ".concat(m)):new X(I.WS_ERR,"init websocket failed: ".concat(m))),f&&b.error("[".concat(this.name,"] init websocket failed: ").concat(m))):i&&i(l)}return r.promise}async reconnectWithAction(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;b.warning("[choose-best-ws] action: =>",e),this.onlineReconnectListener||Dr.isOnline||!Dr.onlineWaiter||(this.onlineReconnectListener=Dr.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let r=!0;if(this.reconnectInterrupter=()=>r=!1,t){let o=ND(this.reconnectCount,this.retryConfig);b.debug("[".concat(this.name,"] wait ").concat(o,"ms to reconnect websocket, mode: ").concat(e)),await de.race([Tn(o),this.onlineReconnectListener||new de(()=>{})])}if(this._state==="closed"||!r)return!1;this.reconnectCount+=1;let n=async(o,s)=>{this.emit(Fe.RECONNECT_CREATE_CONNECTION,s),await this.createWebSocketConnection(o)};try{if(e==="retry")this.emit(Fe.RECONNECT_WAITTING_FINISH,e),await n(this.urls[this.currentURLIndex],e);else if(e==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);b.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(Fe.RECONNECT_WAITTING_FINISH,e),await n(this.urls[this.currentURLIndex],e)}else e==="recover"&&(b.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(Fe.RECONNECT_WAITTING_FINISH,e),this.urls=await Dn(this,Fe.REQUEST_NEW_URLS),this.currentURLIndex=0,await n(this.urls[this.currentURLIndex],e))}catch(o){var i;b.error("[".concat(this.name,"] reconnect failed ").concat(o&&o.toString()));let s=o==null||(i=o.data)===null||i===void 0?void 0:i.desc;return Array.isArray(s)&&pe(s).call(s,"dynamic key expired")?(this.emit(Fe.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(e,t)}return!0}},MD=class extends lQ{constructor(e,t){super(e,t,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){let r=L0(),n=function(o,s){return new O2e(o,s)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{b.debug("[choose-best-ws] close establishing websockets"),n.closeAllWebsockets(),r.reject(new X(I.WS_ABORT,"choose best websocket aborted"))};let i=D("GATEWAY_DOMAINS");return b.debug("[choose-best-ws] currentDomain: ",e,", domains: ",i,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),n.chooseBestWebsocket(e,this.tryDoubleDomain,this.use443PortOnly,t).then(r.resolve).catch(r.reject),r.promise.finally(()=>{this.closeEstablishingWs=void 0})}},V0=class extends lQ{constructor(e,t){super(e,t,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){return new de((r,n)=>{let i=!1,o=[];this.closeEstablishingWs=()=>{b.debug("[choose-best-ws] close establishing websockets"),o.forEach(f=>{f.onclose=null,f.onopen=null,f.onmessage=null,f.close()}),n(new X(I.WS_ABORT,"choose best websocket aborted"))};let s=D("GATEWAY_DOMAINS"),a,c=e.indexOf("?h="),l=s.find(f=>c!==-1?pe(e).call(e,f,c):pe(e).call(e,f));b.debug("[choose-best-ws] currentDomain: ",l,", domains: ",s);let d=!this.tryDoubleDomain||!l;if(!d&&l){var u;let f=Date.now();try{s.forEach(m=>{let g=c===-1?e.replace(l,m):e.substr(0,c)+e.substr(c).replace(l,m),y=new WebSocket(g);y.binaryType="arraybuffer",o.push(y),b.debug("[choose-best-ws] ws is connecting:",y.url)})}catch{for(b.debug("[choose-best-ws] ws create failed, fallback to single url"),o.forEach(m=>m.close());o.length;)o.pop();d=!0}(u=this.store)===null||u===void 0||u.recordJoinChannelService({urls:o.map(m=>m.url),service:"gateway"},t),o.forEach(m=>{m.onopen=()=>{if(i)return;let g=Date.now()-f;b.debug("[choose-best-ws] ws open cost ".concat(g,"ms")),o.filter(y=>y!==m).forEach(y=>{b.debug("[choose-best-ws]close backup websocket: ".concat(y.url)),y.close()}),i=!0,r(m)},m.onclose=g=>{a=g,!i&&(o.find(y=>!(y.readyState===WebSocket.CLOSED||y.readyState===WebSocket.CLOSING))||(b.debug("[choose-best-ws] all websocket is closed"),i=!0,n(a)))},m.onmessage=g=>{b.debug("[choose-best-ws]".concat(m.url," onmessage: ").concat(g.data))}}),Tn(this.forceCloseTimeout).then(()=>{o.forEach(m=>{m.readyState!==WebSocket.OPEN&&m.close()})})}if(d){var p;let f;b.debug("[choose-best-ws] use single url: ",e),(p=this.store)===null||p===void 0||p.recordJoinChannelService({urls:[e],service:"gateway"},t);try{f=new WebSocket(e),o.push(f),f.binaryType="arraybuffer"}catch(m){let g=new X(I.WS_ERR,"init websocket failed! Error: ".concat(m.toString()));return b.error("[".concat(this.name,"]").concat(g)),void n(g)}f.onopen=()=>{r(f)},f.onclose=m=>{n(m)},f.onmessage=m=>{b.debug("[choose-best-ws]".concat(f.url," onmessage: ").concat(m.data))},Tn(this.forceCloseTimeout).then(()=>{f&&f.readyState!==WebSocket.OPEN&&f.close()})}}).then(r=>(this.closeEstablishingWs=void 0,r)).catch(r=>{throw this.closeEstablishingWs=void 0,r})}},N2e=class extends fr{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===Kt.CONNECTED?this.emit(je.WS_CONNECTED):e===Kt.RECONNECTING?this.emit(je.WS_RECONNECTING,this._websocketReconnectReason):e===Kt.CLOSED&&this.emit(je.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),C(this,"_disconnectedReason",void 0),C(this,"_websocketReconnectReason",void 0),C(this,"_connectionState",Kt.CLOSED),C(this,"reconnectToken",void 0),C(this,"websocket",void 0),C(this,"openConnectionTime",void 0),C(this,"clientId",void 0),C(this,"lastMsgTime",Date.now()),C(this,"uploadCache",[]),C(this,"uploadCacheInterval",void 0),C(this,"rttRolling",new eQ(5)),C(this,"pingpongTimer",void 0),C(this,"wsInflateDataTimer",void 0),C(this,"pingpongTimeoutCount",0),C(this,"joinResponse",void 0),C(this,"multiIpOption",void 0),C(this,"initError",void 0),C(this,"spec",void 0),C(this,"store",void 0),C(this,"onWebsocketMessage",r=>{if(r.data instanceof ArrayBuffer)return void this.emit(je.ON_BINARY_DATA,r.data);let n=JSON.parse(r.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(n,"_id")){let i="res-@".concat(n._id);this.emit(i,n._result,n._message)}else if(Object.prototype.hasOwnProperty.call(n,"_type")){if(this.emit(n._type,n._message),n._type===ct.ON_NOTIFICATION&&this.handleNotification(n._message),n._type===ct.ON_USER_BANNED)switch(n._message.error_code){case 14:this.close(Mt.UID_BANNED);break;case 15:this.close(Mt.IP_BANNED);break;case 16:this.close(Mt.CHANNEL_BANNED)}if(n._type===ct.ON_USER_LICENSE_BANNED)switch(n._message.error_code){case xe.ERR_LICENSE_MISSING:this.close(Mt.LICENSE_MISSING);break;case xe.ERR_LICENSE_EXPIRED:this.close(Mt.LICENSE_EXPIRED);break;case xe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Mt.LICENSE_MINUTES_EXCEEDED);break;case xe.ERR_LICENSE_PERIOD_INVALID:this.close(Mt.LICENSE_PERIOD_INVALID);break;case xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Mt.LICENSE_MULTIPLE_SDK_SERVICE);break;case xe.ERR_LICENSE_ILLEGAL:this.close(Mt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new MD("gateway-".concat(this.clientId),this.spec.retryConfig,!0,D("JOIN_GATEWAY_USE_DUAL_DOMAIN"),D("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Kt.CONNECTED&&this.reconnect("retry",kn.OFFLINE)})}async request(e,t,r,n){let i=qt(6,""),o={_id:i,_type:e,_message:t},s=this.websocket.connectionID,a=()=>new de((f,m)=>{if(this.connectionState===Kt.CONNECTED)return f();let g=()=>{this.off(je.WS_CLOSED,y),f()},y=()=>{this.off(je.WS_CONNECTED,g),m(new G(I.WS_ABORT))};this.once(je.WS_CONNECTED,g),this.once(je.WS_CLOSED,y),e!==Me.PUBLISH&&e!==Me.PUBLISH_DATASTREAM&&e!==Me.SUBSCRIBE&&e!==Me.SUBSCRIBE_DATASTREAM&&e!==Me.UNSUBSCRIBE&&e!==Me.UNSUBSCRIBE_DATASTREAM&&e!==Me.UNPUBLISH&&e!==Me.UNPUBLISH_DATASTREAM&&e!==Me.CONTROL&&e!==Me.RESTART_ICE||this.once(je.DISCONNECT_P2P,()=>{m(new G(I.DISCONNECT_P2P))}),e!==Me.PUBLISH&&e!==Me.RESTART_ICE||this.once(je.ABORT_P2P_EXECUTION,()=>{m(new G(I.DISCONNECT_P2P))})});if(this.connectionState!==Kt.CONNECTING&&this.connectionState!==Kt.RECONNECTING||e===Me.JOIN||e===Me.REJOIN||await a(),this.websocket.sendMessage(o,!0),n)return;let c=new de((f,m)=>{let g=!1,y=(E,w)=>{g=!0,f({isSuccess:E==="success",message:w||{}}),this.off(je.WS_CLOSED,v),this.off(je.WS_RECONNECTING,v),this.emit(je.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(i),y);let v=()=>{m(new G(I.WS_ABORT,"type: ".concat(e))),this.off(je.WS_CLOSED,v),this.off(je.WS_RECONNECTING,v),this.off("res-@".concat(i),y)};this.once(je.WS_CLOSED,v),this.once(je.WS_RECONNECTING,v),Tn(D("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==s||g||(b.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(je.REQUEST_TIMEOUT,e,t))})}),l=null;try{l=await c}catch(f){if(this.connectionState===Kt.CLOSED||e===Me.LEAVE)throw new G(I.WS_ABORT);return!this.spec.forceWaitGatewayResponse||r?f.throw():e===Me.JOIN||e===Me.REJOIN?null:(await a(),await this.request(e,t))}if(l.isSuccess)return l.message;let d=Number(l.message.error_code||l.message.code),u=F0(d),p=new G(I.UNEXPECTED_RESPONSE,"".concat(u.desc,": ").concat(l.message.error_str),{code:d,data:l.message,desc:u.desc});return u.action==="success"?l.message:(b.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(u.desc,", action: ").concat(u.action)),d===xe.ERR_TOO_MANY_BROADCASTERS?((e===Me.JOIN||e===Me.REJOIN)&&(this.initError=p,this.close()),p.throw()):u.action==="failed"?p.throw():u.action==="quit"?(this.initError=p,this.close(),p.throw()):(d===xe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,b.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",kn.MULTI_IP)):this.reconnect(u.action,kn.SERVER_ERROR),e===Me.JOIN||e===Me.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new de(r=>{let n=i=>{(!t||t(i))&&(this.off(e,n),r(i))};this.on(e,n)})}uploadWRTCStats(e){if(!this.store.sessionId)return void b.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));let t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(U0.WRTC_STATS,t)}upload(e,t){let r={_type:e,_message:t};try{this.websocket.sendMessage(r)}catch{let n=D("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(r),this.uploadCache.length>n&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Kt.CONNECTED)return;let i=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(i._type,i._message)},D("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){let r={_type:e,_message:t};this.websocket.sendMessage(r)}init(e,t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new de((r,n)=>{this.once(je.WS_CONNECTED,()=>r(this.joinResponse)),this.once(je.WS_CLOSED,()=>n(this.initError||new G(I.WS_ABORT))),this.connectionState=Kt.CONNECTING,this.websocket.init(e).catch(n),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||Mt.LEAVE,this.connectionState=Kt.CLOSED,b.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(je.ABORT_P2P_EXECUTION);let e=await Dn(this,je.REQUEST_JOIN_INFO),t=await this.request(Me.JOIN,e);if(!t)return this.emit(je.REPORT_JOIN_GATEWAY,h_.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(je.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Kt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new G(I.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");let e=j0(this,je.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;let t=await this.request(Me.REJOIN,e);return!!t&&(this.connectionState=Kt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),t.peers&&t.peers.forEach(r=>{this.emit(ct.ON_USER_ONLINE,{uid:r.uid}),r.audio&&this.emit(ct.ON_ADD_AUDIO_STREAM,{uid:r.uid,uint_id:r.uint_id,audio:!0,ssrcId:r.audio_ssrc}),r.video&&this.emit(ct.ON_ADD_VIDEO_STREAM,{uid:r.uid,uint_id:r.uint_id,video:!0,ssrcId:r.video_ssrc}),r.audio_mute?this.emit(ct.MUTE_AUDIO,{uid:r.uid}):this.emit(ct.UNMUTE_AUDIO,{uid:r.uid}),r.video_mute?this.emit(ct.MUTE_VIDEO,{uid:r.uid}):this.emit(ct.UNMUTE_VIDEO,{uid:r.uid}),r.audio_enable_local?this.emit(ct.ENABLE_LOCAL_AUDIO,{uid:r.uid}):this.emit(ct.DISABLE_LOCAL_AUDIO,{uid:r.uid}),r.video_enable_local?this.emit(ct.ENABLE_LOCAL_VIDEO,{uid:r.uid}):this.emit(ct.DISABLE_LOCAL_VIDEO,{uid:r.uid}),r.audio||r.video||this.emit(ct.ON_REMOVE_STREAM,{uid:r.uid,uint_id:r.uint_id})}),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleNotification(e){b.debug("[".concat(this.clientId,"] receive notification: "),e);let t=F0(e.code);if(t.action!=="success"){if(t.action!=="failed")return t.action==="quit"?(t.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Mt.UID_BANNED),void this.close()):void this.reconnect(t.action,kn.SERVER_ERROR);b.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;let e=D("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(b.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>D("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",kn.TIMEOUT):this.request(Me.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;let r=Date.now()-t;this.rttRolling.add(r),D("REPORT_STATS")&&this.send(Me.PING_BACK,{pingpongElapse:r})}).catch(r=>{})}handleWsInflateData(){let{wsInflateLength:e,wsDeflateLength:t}=this.websocket.getWsInflateData();e!==0&&t!==0&&this.upload(U0.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(Fe.RECONNECT_WAITTING_FINISH,e=>{this.emit(je.WS_RECONNECT_WAITTING_FINISH,e)}),this.websocket.on(Fe.RECONNECT_CREATE_CONNECTION,e=>{this.emit(je.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(Fe.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Fe.CLOSED,()=>{this.connectionState=Kt.CLOSED}),this.websocket.on(Fe.FAILED,()=>{this._disconnectedReason=Mt.NETWORK_ERROR,this.connectionState=Kt.CLOSED}),this.websocket.on(Fe.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===Kt.CONNECTED?this.connectionState=Kt.RECONNECTING:this.connectionState=Kt.CONNECTING}),this.websocket.on(Fe.WILL_RECONNECT,(e,t,r)=>{let n=j0(this,je.IS_P2P_DISCONNECTED),i=n||e!=="retry";n&&e==="retry"&&(b.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),e="tryNext",t=h_.P2P_DISCONNECTED),i&&(b.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(e)),this.emit(je.REPORT_JOIN_GATEWAY,t||h_.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(je.DISCONNECT_P2P)),r(e)}),this.websocket.on(Fe.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(e=>{b.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",kn.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit(je.REPORT_JOIN_GATEWAY,e,this.url||""),e instanceof G){if(e.code===I.UNEXPECTED_RESPONSE&&e.data.code===xe.ERR_NO_AUTHORIZED)return this.initError=new G(I.CAN_NOT_GET_GATEWAY_SERVER,"AgoraRTCError CAN_NOT_GET_GATEWAY_SERVER: dynamic key expired"),b.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",kn.SERVER_ERROR);b.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",kn.SERVER_ERROR):(this.initError=e,this.close())}})}),this.websocket.on(Fe.REQUEST_NEW_URLS,(e,t)=>{Dn(this,je.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)}),this.websocket.on(Fe.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ct.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(cQ.PRE_CONNECT_PC,()=>{this.emit(je.PRE_CONNECT_PC)})}},Pr=function(e){return e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",e}({});function iF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iF(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kp(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(D("TURN_DOMAIN")):(b.info("Unidentified as ip: ".concat(e,", use as host")),e)}function jD(e,t){e.addresses||(e.addresses=[]);let r=function(a,c){if(D("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return a.map(u=>{let{ip:p,port:f}=u;return{address:"".concat(p,":").concat(f)}});let l=D("GATEWAY_DOMAINS"),d=l[1]&&pe(c).call(c,l[1])?1:0;return a.map(u=>{let{domain_prefix:p,port:f,ip:m}=u;if(p)return{address:"".concat(p,".").concat(l[d++%l.length],":").concat(f)};let g=/^[\.\:\d]+$/.test(m),y=g?"".concat(m.replace(/[^\d]/g,"-"),".").concat(l[d++%l.length],":").concat(f):"".concat(m,":").concat(f);return g||b.info("Unidentified as ip: ".concat(m,", use as host")),{ip:m,port:f,address:y}})}(e.addresses,t),n=Array.isArray(e.detail)&&e.detail[18];if(n&&typeof n=="string"){let a=n.split(";");for(let c=0;c<a.length;c++){var i;let l=ci(i=a[c]).call(i);r[c]&&l&&(r[c].ip6=l)}}let o=e.detail&&e.detail.candidate,s;if(o){let[a,c]=o.split(":");a&&c&&(s={port:Number(c),ip:a,address:"".concat(a,":").concat(c)})}return{gatewayAddrs:r,apGatewayAddress:s,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function ao(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function oF(e){let t=e._encoderConfig;if(!t)return{};let r={resolution:t.width&&t.height?"".concat(ao(t.width),"x").concat(ao(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return typeof t.frameRate=="number"?(r.maxFrameRate=t.frameRate,r.minFrameRate=t.frameRate):t.frameRate&&(r.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,r.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),r}function sF(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function B0(e,t){let r,n,i;switch(t){case Pr.CHOOSE_SERVER:n=4096,i="choose server";break;case Pr.CLOUD_PROXY:n=1048576,i="proxy";break;case Pr.CLOUD_PROXY_5:n=4194304,i="proxy5";break;case Pr.CLOUD_PROXY_FALLBACK:n=4194310,i="proxy fallback";break;default:throw new G(I.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach(o=>{o.buffer&&o.buffer.flag===n&&(r={code:o.buffer.code,addresses:(o.buffer.edges_services||[]).map(s=>iE(iE({},s),{},{ticket:o.buffer.cert})),server_ts:e.enter_ts,uid:o.buffer.uid,cid:o.buffer.cid,cname:o.buffer.cname,detail:iE(iE({},o.buffer.detail),e.detail),flag:o.buffer.flag,opid:e.opid,cert:o.buffer.cert})}),!r)throw new G(I.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(i," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return r}async function dQ(e,t){return await de.all(e.addresses.map(async r=>({address:kp(r.ip),tcpport:r.port,udpport:r.port,username:t&&D("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():xn.username,password:t&&D("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await kO(t.toString()):xn.password})))}function UO(e,t){let r=t.getMediaStreamTrack(!0).getSettings(),n=t.videoHeight||r.height,i=t.videoWidth||r.width;return n&&i?Math.max(Math.min(n,i)/Math.min(ao(e.height),ao(e.width)),1):(b.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function od(e){let{candidateType:t,relayProtocol:r,type:n,address:i,port:o,protocol:s}=e;return n==="local-candidate"?{candidateType:t,relayProtocol:r,protocol:s}:{candidateType:t,relayProtocol:r,address:i,port:o,protocol:s}}var Ns,k2e=xr(oQ),P2e=sa("Array").values,D2e=Cc,L2e=Kn,M2e=Ti,j2e=P2e,iI=Array.prototype,U2e={DOMTokenList:!0,NodeList:!0},F2e=function(e){var t=e.values;return e===iI||M2e(iI,e)&&t===iI.values||L2e(U2e,D2e(e))?j2e:t},il=xr(F2e),aF=_s,V2e=Br,B2e=Un,$2e=qr,oI=VS,H2e=Ly,W2e=kS,G2e=Tc,z2e=PS,zh=Object.assign,cF=Object.defineProperty,K2e=V2e([].concat),q2e=!zh||$2e(function(){if(aF&&zh({b:1},zh(cF({},"a",{enumerable:!0,get:function(){cF(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),zh({},e)[r]!=7||oI(zh({},t)).join("")!=n})?function(e,t){for(var r=G2e(e),n=arguments.length,i=1,o=H2e.f,s=W2e.f;n>i;)for(var a,c=z2e(arguments[i++]),l=o?K2e(oI(c),o(c)):oI(c),d=l.length,u=0;d>u;)a=l[u++],aF&&!B2e(s,c,a)||(r[a]=c[a]);return r}:zh,Y2e=Xi,X2e=_Y,J2e=Vd,Q2e=Un,Z2e=Tc,eLe=function(e,t,r,n){try{return n?t(Y2e(r)[0],r[1]):t(r)}catch(i){X2e(e,"throw",i)}},tLe=EY,rLe=HS,nLe=El,lF=zS,iLe=rD,oLe=BS,dF=Array,wh=Br,sI=2147483647,sLe=/[^\0-\u007E]/,uQ=/[.\u3002\uFF0E\uFF61]/g,uF="Overflow: input needs wider integers to process",hF=RangeError,aLe=wh(uQ.exec),Pp=Math.floor,aI=String.fromCharCode,pF=wh("".charCodeAt),hQ=wh([].join),Fl=wh([].push),cLe=wh("".replace),lLe=wh("".split),dLe=wh("".toLowerCase),fF=function(e){return e+22+75*(e<26)},uLe=function(e,t,r){var n=0;for(e=r?Pp(e/700):e>>1,e+=Pp(e/t);e>455;)e=Pp(e/35),n+=36;return Pp(n+36*e/(e+38))},hLe=function(e){var t=[];e=function(v){for(var E=[],w=0,S=v.length;w<S;){var A=pF(v,w++);if(A>=55296&&A<=56319&&w<S){var N=pF(v,w++);(64512&N)==56320?Fl(E,((1023&A)<<10)+(1023&N)+65536):(Fl(E,A),w--)}else Fl(E,A)}return E}(e);var r,n,i=e.length,o=128,s=0,a=72;for(r=0;r<e.length;r++)(n=e[r])<128&&Fl(t,aI(n));var c=t.length,l=c;for(c&&Fl(t,"-");l<i;){var d=sI;for(r=0;r<e.length;r++)(n=e[r])>=o&&n<d&&(d=n);var u=l+1;if(d-o>Pp((sI-s)/u))throw hF(uF);for(s+=(d-o)*u,o=d,r=0;r<e.length;r++){if((n=e[r])<o&&++s>sI)throw hF(uF);if(n==o){for(var p=s,f=36;;){var m=f<=a?1:f>=a+26?26:f-a;if(p<m)break;var g=p-m,y=36-m;Fl(t,aI(fF(m+g%y))),p=Pp(g/y),f+=36}Fl(t,aI(fF(p))),a=uLe(s,u,l==c),s=0,l++}}s++,o++}return hQ(t,"")},pLe=Yt,UD=_s,fLe=SD,FD=Mn,mF=Vd,aa=Br,oE=$d,ks=$S,mLe=oD,FO=Kn,VD=q2e,Kh=function(e){var t=Z2e(e),r=rLe(this),n=arguments.length,i=n>1?arguments[1]:void 0,o=i!==void 0;o&&(i=J2e(i,n>2?arguments[2]:void 0));var s,a,c,l,d,u,p=oLe(t),f=0;if(!p||this===dF&&tLe(p))for(s=nLe(t),a=r?new this(s):dF(s);s>f;f++)u=o?i(t[f],f):t[f],lF(a,f,u);else for(d=(l=iLe(t,p)).next,a=r?new this:[];!(c=Q2e(d,l)).done;f++)u=o?eLe(l,i,[c.value,f],!0):c.value,lF(a,f,u);return a.length=f,a},ua=fD,gLe=pD.codeAt,yLe=function(e){var t,r,n=[],i=lLe(cLe(dLe(e),uQ,"."),".");for(t=0;t<i.length;t++)r=i[t],Fl(n,aLe(sLe,r)?"xn--"+hLe(r):r);return hQ(n,".")},Uc=bs,vLe=Hd,ELe=WS,pQ=MPe,fQ=bh,_Le=fQ.set,Qb=fQ.getterFor("URL"),bLe=pQ.URLSearchParams,wLe=pQ.getState,Hm=FD.URL,VO=FD.TypeError,sE=FD.parseInt,SLe=Math.floor,gF=Math.pow,Vs=aa("".charAt),ma=aa(/./.exec),lg=aa([].join),TLe=aa(1 .toString),CLe=aa([].pop),qh=aa([].push),cI=aa("".replace),RLe=aa([].shift),ILe=aa("".split),dg=aa("".slice),p_=aa("".toLowerCase),ALe=aa([].unshift),lI="Invalid scheme",Wm="Invalid host",yF="Invalid port",mQ=/[a-z]/i,xLe=/[\d+-.a-z]/i,dI=/\d/,OLe=/^0x/i,NLe=/^[0-7]+$/,kLe=/^\d+$/,vF=/^[\da-f]+$/i,PLe=/[\0\t\n\r #%/:<>?@[\\\]^|]/,DLe=/[\0\t\n\r #/:<>?@[\\\]^|]/,LLe=/^[\u0000-\u0020]+/,MLe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,jLe=/[\t\n\r]/g,Gm=function(e){var t,r,n,i;if(typeof e=="number"){for(t=[],r=0;r<4;r++)ALe(t,e%256),e=SLe(e/256);return lg(t,".")}if(typeof e=="object"){for(t="",n=function(o){for(var s=null,a=1,c=null,l=0,d=0;d<8;d++)o[d]!==0?(l>a&&(s=c,a=l),c=null,l=0):(c===null&&(c=d),++l);return l>a&&(s=c,a=l),s}(e),r=0;r<8;r++)i&&e[r]===0||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=TLe(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},f_={},gQ=VD({},f_,{" ":1,'"':1,"<":1,">":1,"`":1}),yQ=VD({},gQ,{"#":1,"?":1,"{":1,"}":1}),uI=VD({},yQ,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Nl=function(e,t){var r=gLe(e,0);return r>32&&r<127&&!FO(t,e)?e:encodeURIComponent(e)},aE={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ug=function(e,t){var r;return e.length==2&&ma(mQ,Vs(e,0))&&((r=Vs(e,1))==":"||!t&&r=="|")},EF=function(e){var t;return e.length>1&&ug(dg(e,0,2))&&(e.length==2||(t=Vs(e,2))==="/"||t==="\\"||t==="?"||t==="#")},ULe=function(e){return e==="."||p_(e)==="%2e"},hI={},_F={},pI={},bF={},wF={},fI={},SF={},TF={},cE={},lE={},mI={},gI={},yI={},vI={},CF={},EI={},Yh={},za={},RF={},Qd={},Dc={},BD=function(e,t,r){var n,i,o,s=Uc(e);if(t){if(i=this.parse(s))throw VO(i);this.searchParams=null}else{if(r!==void 0&&(n=new BD(r,!0)),i=this.parse(s,null,n))throw VO(i);(o=wLe(new bLe)).bindURL(this),this.searchParams=o}};BD.prototype={type:"URL",parse:function(e,t,r){var n,i,o,s,a,c=this,l=t||hI,d=0,u="",p=!1,f=!1,m=!1;for(e=Uc(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=cI(e,LLe,""),e=cI(e,MLe,"$1")),e=cI(e,jLe,""),n=Kh(e);d<=n.length;){switch(i=n[d],l){case hI:if(!i||!ma(mQ,i)){if(t)return lI;l=pI;continue}u+=p_(i),l=_F;break;case _F:if(i&&(ma(xLe,i)||i=="+"||i=="-"||i=="."))u+=p_(i);else{if(i!=":"){if(t)return lI;u="",l=pI,d=0;continue}if(t&&(c.isSpecial()!=FO(aE,u)||u=="file"&&(c.includesCredentials()||c.port!==null)||c.scheme=="file"&&!c.host))return;if(c.scheme=u,t)return void(c.isSpecial()&&aE[c.scheme]==c.port&&(c.port=null));u="",c.scheme=="file"?l=vI:c.isSpecial()&&r&&r.scheme==c.scheme?l=bF:c.isSpecial()?l=TF:n[d+1]=="/"?(l=wF,d++):(c.cannotBeABaseURL=!0,qh(c.path,""),l=RF)}break;case pI:if(!r||r.cannotBeABaseURL&&i!="#")return lI;if(r.cannotBeABaseURL&&i=="#"){c.scheme=r.scheme,c.path=ua(r.path),c.query=r.query,c.fragment="",c.cannotBeABaseURL=!0,l=Dc;break}l=r.scheme=="file"?vI:fI;continue;case bF:if(i!="/"||n[d+1]!="/"){l=fI;continue}l=cE,d++;break;case wF:if(i=="/"){l=lE;break}l=za;continue;case fI:if(c.scheme=r.scheme,i==Ns)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=ua(r.path),c.query=r.query;else if(i=="/"||i=="\\"&&c.isSpecial())l=SF;else if(i=="?")c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=ua(r.path),c.query="",l=Qd;else{if(i!="#"){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=ua(r.path),c.path.length--,l=za;continue}c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=ua(r.path),c.query=r.query,c.fragment="",l=Dc}break;case SF:if(!c.isSpecial()||i!="/"&&i!="\\"){if(i!="/"){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,l=za;continue}l=lE}else l=cE;break;case TF:if(l=cE,i!="/"||Vs(u,d+1)!="/")continue;d++;break;case cE:if(i!="/"&&i!="\\"){l=lE;continue}break;case lE:if(i=="@"){p&&(u="%40"+u),p=!0,o=Kh(u);for(var g=0;g<o.length;g++){var y=o[g];if(y!=":"||m){var v=Nl(y,uI);m?c.password+=v:c.username+=v}else m=!0}u=""}else if(i==Ns||i=="/"||i=="?"||i=="#"||i=="\\"&&c.isSpecial()){if(p&&u=="")return"Invalid authority";d-=Kh(u).length+1,u="",l=mI}else u+=i;break;case mI:case gI:if(t&&c.scheme=="file"){l=EI;continue}if(i!=":"||f){if(i==Ns||i=="/"||i=="?"||i=="#"||i=="\\"&&c.isSpecial()){if(c.isSpecial()&&u=="")return Wm;if(t&&u==""&&(c.includesCredentials()||c.port!==null))return;if(s=c.parseHost(u))return s;if(u="",l=Yh,t)return;continue}i=="["?f=!0:i=="]"&&(f=!1),u+=i}else{if(u=="")return Wm;if(s=c.parseHost(u))return s;if(u="",l=yI,t==gI)return}break;case yI:if(!ma(dI,i)){if(i==Ns||i=="/"||i=="?"||i=="#"||i=="\\"&&c.isSpecial()||t){if(u!=""){var E=sE(u,10);if(E>65535)return yF;c.port=c.isSpecial()&&E===aE[c.scheme]?null:E,u=""}if(t)return;l=Yh;continue}return yF}u+=i;break;case vI:if(c.scheme="file",i=="/"||i=="\\")l=CF;else{if(!r||r.scheme!="file"){l=za;continue}if(i==Ns)c.host=r.host,c.path=ua(r.path),c.query=r.query;else if(i=="?")c.host=r.host,c.path=ua(r.path),c.query="",l=Qd;else{if(i!="#"){EF(lg(ua(n,d),""))||(c.host=r.host,c.path=ua(r.path),c.shortenPath()),l=za;continue}c.host=r.host,c.path=ua(r.path),c.query=r.query,c.fragment="",l=Dc}}break;case CF:if(i=="/"||i=="\\"){l=EI;break}r&&r.scheme=="file"&&!EF(lg(ua(n,d),""))&&(ug(r.path[0],!0)?qh(c.path,r.path[0]):c.host=r.host),l=za;continue;case EI:if(i==Ns||i=="/"||i=="\\"||i=="?"||i=="#"){if(!t&&ug(u))l=za;else if(u==""){if(c.host="",t)return;l=Yh}else{if(s=c.parseHost(u))return s;if(c.host=="localhost"&&(c.host=""),t)return;u="",l=Yh}continue}u+=i;break;case Yh:if(c.isSpecial()){if(l=za,i!="/"&&i!="\\")continue}else if(t||i!="?")if(t||i!="#"){if(i!=Ns&&(l=za,i!="/"))continue}else c.fragment="",l=Dc;else c.query="",l=Qd;break;case za:if(i==Ns||i=="/"||i=="\\"&&c.isSpecial()||!t&&(i=="?"||i=="#")){if((a=p_(a=u))===".."||a==="%2e."||a===".%2e"||a==="%2e%2e"?(c.shortenPath(),i=="/"||i=="\\"&&c.isSpecial()||qh(c.path,"")):ULe(u)?i=="/"||i=="\\"&&c.isSpecial()||qh(c.path,""):(c.scheme=="file"&&!c.path.length&&ug(u)&&(c.host&&(c.host=""),u=Vs(u,0)+":"),qh(c.path,u)),u="",c.scheme=="file"&&(i==Ns||i=="?"||i=="#"))for(;c.path.length>1&&c.path[0]==="";)RLe(c.path);i=="?"?(c.query="",l=Qd):i=="#"&&(c.fragment="",l=Dc)}else u+=Nl(i,yQ);break;case RF:i=="?"?(c.query="",l=Qd):i=="#"?(c.fragment="",l=Dc):i!=Ns&&(c.path[0]+=Nl(i,f_));break;case Qd:t||i!="#"?i!=Ns&&(i=="'"&&c.isSpecial()?c.query+="%27":c.query+=i=="#"?"%23":Nl(i,f_)):(c.fragment="",l=Dc);break;case Dc:i!=Ns&&(c.fragment+=Nl(i,gQ))}d++}},parseHost:function(e){var t,r,n;if(Vs(e,0)=="["){if(Vs(e,e.length-1)!="]"||(t=function(i){var o,s,a,c,l,d,u,p=[0,0,0,0,0,0,0,0],f=0,m=null,g=0,y=function(){return Vs(i,g)};if(y()==":"){if(Vs(i,1)!=":")return;g+=2,m=++f}for(;y();){if(f==8)return;if(y()!=":"){for(o=s=0;s<4&&ma(vF,y());)o=16*o+sE(y(),16),g++,s++;if(y()=="."){if(s==0||(g-=s,f>6))return;for(a=0;y();){if(c=null,a>0){if(!(y()=="."&&a<4))return;g++}if(!ma(dI,y()))return;for(;ma(dI,y());){if(l=sE(y(),10),c===null)c=l;else{if(c==0)return;c=10*c+l}if(c>255)return;g++}p[f]=256*p[f]+c,++a!=2&&a!=4||f++}if(a!=4)return;break}if(y()==":"){if(g++,!y())return}else if(y())return;p[f++]=o}else{if(m!==null)return;g++,m=++f}}if(m!==null)for(d=f-m,f=7;f!=0&&d>0;)u=p[f],p[f--]=p[m+d-1],p[m+--d]=u;else if(f!=8)return;return p}(dg(e,1,-1)),!t))return Wm;this.host=t}else if(this.isSpecial()){if(e=yLe(e),ma(PLe,e)||(t=function(i){var o,s,a,c,l,d,u,p=ILe(i,".");if(p.length&&p[p.length-1]==""&&p.length--,(o=p.length)>4)return i;for(s=[],a=0;a<o;a++){if((c=p[a])=="")return i;if(l=10,c.length>1&&Vs(c,0)=="0"&&(l=ma(OLe,c)?16:8,c=dg(c,l==8?1:2)),c==="")d=0;else{if(!ma(l==10?kLe:l==8?NLe:vF,c))return i;d=sE(c,l)}qh(s,d)}for(a=0;a<o;a++)if(d=s[a],a==o-1){if(d>=gF(256,5-o))return null}else if(d>255)return null;for(u=CLe(s),a=0;a<s.length;a++)u+=s[a]*gF(256,3-a);return u}(e),t===null))return Wm;this.host=t}else{if(ma(DLe,e))return Wm;for(t="",r=Kh(e),n=0;n<r.length;n++)t+=Nl(r[n],f_);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return FO(aE,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||this.scheme=="file"&&t==1&&ug(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,s=e.path,a=e.query,c=e.fragment,l=t+":";return i!==null?(l+="//",e.includesCredentials()&&(l+=r+(n?":"+n:"")+"@"),l+=Gm(i),o!==null&&(l+=":"+o)):t=="file"&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+lg(s,"/"):"",a!==null&&(l+="?"+a),c!==null&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw VO(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new Af(e.path[0]).origin}catch{return"null"}return e!="file"&&this.isSpecial()?e+"://"+Gm(this.host)+(t!==null?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Uc(e)+":",hI)},getUsername:function(){return this.username},setUsername:function(e){var t=Kh(Uc(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Nl(t[r],uI)}},getPassword:function(){return this.password},setPassword:function(e){var t=Kh(Uc(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Nl(t[r],uI)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?Gm(e):Gm(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,mI)},getHostname:function(){var e=this.host;return e===null?"":Gm(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,gI)},getPort:function(){var e=this.port;return e===null?"":Uc(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||((e=Uc(e))==""?this.port=null:this.parse(e,yI))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+lg(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Yh))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){(e=Uc(e))==""?this.query=null:(Vs(e,0)=="?"&&(e=dg(e,1)),this.query="",this.parse(e,Qd)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){(e=Uc(e))!=""?(Vs(e,0)=="#"&&(e=dg(e,1)),this.fragment="",this.parse(e,Dc)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Af=function(e){var t=mLe(this,to),r=ELe(arguments.length,1)>1?arguments[1]:void 0,n=_Le(t,new BD(e,!1,r));UD||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},to=Af.prototype,Ps=function(e,t){return{get:function(){return Qb(this)[e]()},set:t&&function(r){return Qb(this)[t](r)},configurable:!0,enumerable:!0}};UD&&(ks(to,"href",Ps("serialize","setHref")),ks(to,"origin",Ps("getOrigin")),ks(to,"protocol",Ps("getProtocol","setProtocol")),ks(to,"username",Ps("getUsername","setUsername")),ks(to,"password",Ps("getPassword","setPassword")),ks(to,"host",Ps("getHost","setHost")),ks(to,"hostname",Ps("getHostname","setHostname")),ks(to,"port",Ps("getPort","setPort")),ks(to,"pathname",Ps("getPathname","setPathname")),ks(to,"search",Ps("getSearch","setSearch")),ks(to,"searchParams",Ps("getSearchParams")),ks(to,"hash",Ps("getHash","setHash"))),oE(to,"toJSON",function(){return Qb(this).serialize()},{enumerable:!0}),oE(to,"toString",function(){return Qb(this).serialize()},{enumerable:!0}),Hm&&(_I=Hm.createObjectURL,bI=Hm.revokeObjectURL,_I&&oE(Af,"createObjectURL",mF(_I,Hm)),bI&&oE(Af,"revokeObjectURL",mF(bI,Hm)));var _I,bI;vLe(Af,"URL"),pLe({global:!0,constructor:!0,forced:!fLe,sham:!UD},{URL:Af});var FLe=Yt,VLe=qr,BLe=WS,IF=bs,$Le=SD,AF=mo("URL");FLe({target:"URL",stat:!0,forced:!($Le&&VLe(function(){AF.canParse()}))},{canParse:function(e){var t=BLe(arguments.length,1),r=IF(e),n=t<2||arguments[1]===void 0?void 0:IF(arguments[1]);try{return!!new AF(r,n)}catch{return!1}}});var xF=xr(ja.URL),yn={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function Et(){return yn}function vQ(){return"setSinkId"in HTMLAudioElement.prototype&&(!D("RESTRICTION_SET_PLAYBACK_DEVICE")||(vd()||VJ())&&!xD())}function OF(){return!yn.supportUnifiedPlan||D("CHROME_FORCE_PLAN_B")&&Od()}var bn=function(e){return e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change",e}({});function Xh(e,t,r){return{sampleRate:e,stereo:t,bitrate:r}}function ft(e,t,r,n,i){return{width:e,height:t,frameRate:r,bitrateMin:n,bitrateMax:i}}function Ds(e,t,r,n,i){return{width:{max:e},height:{max:t},frameRate:r,bitrateMin:n,bitrateMax:i}}function wI(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}var HLe={"90p":ft(160,90),"90p_1":ft(160,90),"120p":ft(160,120,15,30,65),"120p_1":ft(160,120,15,30,65),"120p_3":ft(120,120,15,30,50),"120p_4":ft(212,120),"180p":ft(320,180,15,30,140),"180p_1":ft(320,180,15,30,140),"180p_3":ft(180,180,15,30,100),"180p_4":ft(240,180,15,30,120),"240p":ft(320,240,15,40,200),"240p_1":ft(320,240,15,40,200),"240p_3":ft(240,240,15,40,140),"240p_4":ft(424,240,15,40,220),"360p":ft(640,360,15,80,400),"360p_1":ft(640,360,15,80,400),"360p_3":ft(360,360,15,80,260),"360p_4":ft(640,360,30,80,600),"360p_6":ft(360,360,30,80,400),"360p_7":ft(480,360,15,80,320),"360p_8":ft(480,360,30,80,490),"360p_9":ft(640,360,15,80,800),"360p_10":ft(640,360,24,80,800),"360p_11":ft(640,360,24,80,1e3),"480p":ft(640,480,15,100,500),"480p_1":ft(640,480,15,100,500),"480p_2":ft(640,480,30,100,1e3),"480p_3":ft(480,480,15,100,400),"480p_4":ft(640,480,30,100,750),"480p_6":ft(480,480,30,100,600),"480p_8":ft(848,480,15,100,610),"480p_9":ft(848,480,30,100,930),"480p_10":ft(640,480,10,100,400),"720p":ft(1280,720,15,120,1130),"720p_auto":ft(1280,720,30,900,3e3),"720p_1":ft(1280,720,15,120,1130),"720p_2":ft(1280,720,30,120,2e3),"720p_3":ft(1280,720,30,120,1710),"720p_5":ft(960,720,15,120,910),"720p_6":ft(960,720,30,120,1380),"1080p":ft(1920,1080,15,120,2080),"1080p_1":ft(1920,1080,15,120,2080),"1080p_2":ft(1920,1080,30,120,3e3),"1080p_3":ft(1920,1080,30,120,3150),"1080p_5":ft(1920,1080,60,120,4780),"1440p":ft(2560,1440,30,120,4850),"1440p_1":ft(2560,1440,30,120,4850),"1440p_2":ft(2560,1440,60,120,7350),"4k":ft(3840,2160,30,120,8910),"4k_1":ft(3840,2160,30,120,8910),"4k_3":ft(3840,2160,60,120,13500)},WLe={"480p":Ds(640,480,5),"480p_1":Ds(640,480,5),"480p_2":Ds(640,480,30),"480p_3":Ds(640,480,15),"720p":Ds(1280,720,5),"720p_auto":ft(1280,720,30,900,3e3),"720p_1":Ds(1280,720,5),"720p_2":Ds(1280,720,30),"720p_3":Ds(1280,720,15),"1080p":Ds(1920,1080,5),"1080p_1":Ds(1920,1080,5),"1080p_2":Ds(1920,1080,30),"1080p_3":Ds(1920,1080,15)},GLe={"1SL1TL":wI(1,1),"3SL3TL":wI(3,3),"2SL3TL":wI(2,3)};function lc(e){return e||(e="480p_1"),typeof e=="string"?Object.assign({},HLe[e]):e}function SI(e){return typeof e=="string"?Object.assign({},WLe[e]):e}function dE(e){return typeof e=="string"?Object.assign({},GLe[e]):e}var zLe={speech_low_quality:Xh(16e3,!1),speech_standard:Xh(32e3,!1,18),music_standard:Xh(48e3,!1),standard_stereo:Xh(48e3,!0,56),high_quality:Xh(48e3,!1,128),high_quality_stereo:Xh(48e3,!0,192)};function Zb(e){return typeof e=="string"?Object.assign({},zLe[e]):e}var ip=[];function NF(e){return Xr(e,"mediaSource",["screen","window","application"]),!0}var fe=function(e){return e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track",e}({}),nr=function(e){return e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream",e}({}),xf=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),KLe=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),qLe=function(e){return e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY",e}({}),Vu=function(e){return e.TRANSCEIVER_UPDATED="transceiver-updated",e.SEI_TO_SEND="sei-to-send",e.SEI_RECEIVED="sei-received",e.TRACK_UPDATED="track-updated",e}({}),am=function(e){return e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed",e}({}),Yp=function(e){return e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.VIDEO_STATE_CHANGED="video-state-changed",e}({}),cm=function(e){return e.AUDIO="audio",e.VIDEO="video",e.DATA="data",e}({}),Ao=function(e){return e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source",e}({});(function(e){e.UPDATE_TRACK_SOURCE="update-track-source"})({});var BO={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},$O={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},EQ={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},YLe={uplinkNetworkQuality:0,downlinkNetworkQuality:0},_Q={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},_i=function(e){return e.ON_TRACK="on_track",e.ON_NODE="on_node",e}({}),Uo=function(e){return e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints",e}({}),zm=function(e){return e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND",e}({}),Cu=function(e){return e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",e}({}),si=function(e){return e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata",e}({}),Ka=function(e){return e[e.VideoStateStopped=0]="VideoStateStopped",e[e.VideoStateStarting=1]="VideoStateStarting",e[e.VideoStateDecoding=2]="VideoStateDecoding",e[e.VideoStateFrozen=3]="VideoStateFrozen",e}({}),TI={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370},m_=function(e){return e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error",e}({});function mt(e,t,r,n,i){var o,s,a={};return Object.keys(n).forEach(function(c){a[c]=n[c]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=ka(o=k2e(s=r.slice()).call(s)).call(o,function(c,l){return l(e,t,c)||c},a),i&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,t,a),a=null),a}function J(e,t,r){return(t=function(n){var i=function(o,s){if(typeof o!="object"||!o)return o;var a=o[Symbol.toPrimitive];if(a!==void 0){var c=a.call(o,"string");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n);return typeof i=="symbol"?i:i+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function sr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kF(Object(r),!0).forEach(function(n){J(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var bQ=class extends fr{set _mediaStreamTrack(e){e!==this.mediaStreamTrack&&(this.safeEmit(Vu.TRACK_UPDATED,e),this.mediaStreamTrack=e)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(e,t){super(),J(this,"trackMediaType",void 0),J(this,"_ID",void 0),J(this,"_rtpTransceiver",void 0),J(this,"_lowRtpTransceiver",void 0),J(this,"_hints",[]),J(this,"_isClosed",!1),J(this,"_originMediaStreamTrack",void 0),J(this,"mediaStreamTrack",void 0),J(this,"_external",{}),this._ID=t||qt(8,"track-"),this._originMediaStreamTrack=e,this.mediaStreamTrack=e,function(r){pe(ip).call(ip,r)||ip.push(r)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){return e||Nd(()=>{var t;_e.reportApiInvoke(null,{name:Gr.GET_MEDIA_STREAM_TRACK,options:[],tag:Er.TRACER}).onSuccess(((t=this._mediaStreamTrack)===null||t===void 0?void 0:t.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(e){return e===xf.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(e){let t=ip.indexOf(e);t!==-1&&ip.splice(t,1)}(this),this.emit(am.CLOSED),this.removeAllListeners(Vu.SEI_RECEIVED)}_updateRtpTransceiver(e,t){if(t===xf.LOW_STREAM){if(this._lowRtpTransceiver===e)return;this._lowRtpTransceiver=e}else{if(this._rtpTransceiver===e)return;this._rtpTransceiver=e}this.emit(Vu.TRANSCEIVER_UPDATED,e,t)}},Dp=class extends bQ{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(e,t){super(e,t),J(this,"_enabled",!0),J(this,"_muted",!1),J(this,"_isExternalTrack",!1),J(this,"_isClosed",!1),J(this,"_enabledMutex",void 0),J(this,"processor",void 0),J(this,"_processorContext",void 0),J(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Gn("".concat(this.getTrackId())),e.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var e,t;return(e=(t=this._originMediaStreamTrack)===null||t===void 0?void 0:t.label)!==null&&e!==void 0?e:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,b.debug("[".concat(this.getTrackId(),"] close")),this.emit(fe.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=r,e!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Wt(this,fe.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){b.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(am.TRACK_ENDED)}stateCheck(e,t){if(b.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(e,": ").concat(t,"]")),qc(t,e),this._enabled&&this._muted&&e==="enabled"&&t===!1)throw new X(I.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",b);if(!this._enabled&&!this._muted&&e==="muted"&&t===!0)throw new X(I.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",b)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():de.resolve([])}},PF=window.AudioContext||window.webkitAudioContext,_o=null,Ut=new class extends fr{constructor(){super(...arguments),J(this,"prevState",void 0),J(this,"curState",void 0),J(this,"currentTime",void 0),J(this,"currentTimeStuckAt",void 0),J(this,"interruptDetectorTrack",void 0),J(this,"onLocalAudioTrackMute",()=>{b.info("ios15-interruption-start"),this.emit(bn.IOS_15_16_INTERRUPTION_START)}),J(this,"onLocalAudioTrackUnmute",async()=>{b.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?b.info("ios15-interruption-end-canceled"):(_o&&await _o.suspend(),this.emit(bn.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(e){b.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){b.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function lm(){if(!_o){if(function(){if(!PF)return void b.error("your browser is not support web audio");b.info("create audio context");let e=sr({},D("WEBAUDIO_INIT_OPTIONS"));b.debug("audio context init option:",JSON.stringify(e)),_o=new PF(e),Ut.curState=_o.state,_o.onstatechange=()=>{Ut.prevState=Ut.curState,Ut.curState=_o?_o.state:void 0;let{prevState:t,curState:r}=Ut,n=r==="running",i=r==="interrupted",o=t==="running",s=t==="suspended",a=t==="interrupted",c=yt().osVersion;(Ei()||Js())&&o&&i&&(b.info("ios".concat(c,"-interruption-start")),Ut.emit(bn.IOS_INTERRUPTION_START)),(Ei()||Js())&&(s||a)&&n&&(b.info("ios".concat(c,"-interruption-end")),Ut.emit(bn.IOS_INTERRUPTION_END)),t!==r&&Ut.emit(bn.STATE_CHANGE,r,t)},setInterval(()=>{var t;let r=(t=_o)===null||t===void 0?void 0:t.currentTime;Ut.currentTime!==r?(Ut.currentTimeStuckAt&&(b.debug("AudioContext current time resume at ".concat(r)),Ut.currentTimeStuckAt=void 0),Ut.currentTime=r):(r!==Ut.currentTimeStuckAt&&(_e.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:r},tag:Er.TRACER}).onSuccess(),b.warning("AudioContext current time stuck at ".concat(r))),Ut.currentTimeStuckAt=r)},5e3),async function(t){let r=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"],n,i=!1,o=!1,s=!1;function a(g){t.state==="running"?c(!1):Ei()||Js()?t.state==="suspended"&&(c(!0),g&&t.resume().then(l,l)):t.state!=="closed"&&(c(!0),g&&t.resume().then(l,l))}function c(g){if(i!==g){i=g;for(let y=0,v=r;y<v.length;y+=1){let E=v[y];g?window.addEventListener(E,d,{capture:!0,passive:!0}):window.removeEventListener(E,d,{capture:!0,passive:!0})}}}function l(){a(!1)}function d(){a(!0)}function u(g){if(!s)if(n.paused)if(g){let y;p(!1),s=!0;try{y=n.play(),y?y.then(f,f):(n.addEventListener("playing",f),n.addEventListener("abort",f),n.addEventListener("error",f))}catch{f()}}else p(!0);else p(!1)}function p(g){if(o!==g){o=g;for(let y=0,v=r;y<v.length;y++){let E=v[y];g?window.addEventListener(E,m,{capture:!0,passive:!0}):window.removeEventListener(E,m,{capture:!0,passive:!0})}}}function f(){n.removeEventListener("playing",f),n.removeEventListener("abort",f),n.removeEventListener("error",f),s=!1,u(!1)}function m(){u(!0)}if(Ei()){let g=t.createMediaStreamDestination(),y=document.createElement("div");y.innerHTML="<audio x-webkit-airplay='deny'></audio>",n=y.children.item(0),n.controls=!1,n.disableRemotePlayback=!0,n.preload="auto",n.srcObject=g.stream,u(!0)}Ut.on(bn.STATE_CHANGE,function(){a(!0)}),a(!1)}(_o)}(),!_o)throw new X(I.NOT_SUPPORTED,"can not create audio context");return _o}return _o}function du(e){if(function(){if(CI!==null)return CI;let n=lm(),i=n.createBufferSource(),o=n.createGain(),s=n.createGain();i.connect(o),i.connect(s),i.disconnect(o);let a=!1;try{i.disconnect(o)}catch{a=!0}return i.disconnect(),CI=a,a}())return;let t=e.connect,r=e.disconnect;e.connect=(n,i,o)=>{var s;return e._inputNodes||(e._inputNodes=[]),pe(s=e._inputNodes).call(s,n)||(n instanceof AudioNode?(e._inputNodes.push(n),t.call(e,n,i,o)):t.call(e,n,i)),e},e.disconnect=(n,i,o)=>{r.call(e),n?Jb(e._inputNodes,n):e._inputNodes=[];for(let s of e._inputNodes)t.call(e,s)}}var CI=null;function $D(e,t){let r=!1,n=1/t;if(D("DISABLE_WEBAUDIO")){let i=window.setInterval(()=>{r?window.clearInterval(i):e(performance.now()/1e3)},1e3*n)}else{let i=lm(),o=i.createGain();o.gain.value=0,o.connect(i.destination);let s=()=>{if(r)return void(o=null);let a=i.createOscillator();a.onended=s,a.connect(o),a.start(0),a.stop(i.currentTime+n),e(i.currentTime)};s()}return()=>{r=!0}}var wQ=class{constructor(){J(this,"context",void 0),J(this,"analyserNode",void 0),J(this,"sourceNode",void 0),this.context=lm(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(e){if(e!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=e,e==null||e.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||Ei()||Js()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;let e=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(e);else{let r=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(r);for(let n=0;n<e.length;++n)e[n]=r[n]/128-1}let t=ka(e).call(e,(r,n)=>r+n*n,0)/e.length;return Math.max(10*Math.log10(t)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var e,t;(e=this.sourceNode)===null||e===void 0||e.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(t=this.sourceNode)===null||t===void 0||t.connect(this.analyserNode)}catch{b.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}},SQ=class extends fr{get processSourceNode(){return this.sourceNode}set processedNode(e){var t;if(!this.isDestroyed&&this._processedNode!==e){try{var r;(r=this.sourceNode)===null||r===void 0||r.disconnect(this.outputNode)}catch{}(t=this._processedNode)===null||t===void 0||t.disconnect(),this._processedNode=e,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),J(this,"outputNode",void 0),J(this,"outputTrack",void 0),J(this,"isPlayed",!1),J(this,"sourceNode",void 0),J(this,"context",void 0),J(this,"audioBufferNode",void 0),J(this,"destNode",void 0),J(this,"audioOutputLevel",0),J(this,"volumeLevelAnalyser",void 0),J(this,"_processedNode",void 0),J(this,"playNode",void 0),J(this,"isDestroyed",!1),J(this,"onNoAudioInput",void 0),J(this,"isNoAudioInput",!1),J(this,"_noAudioInputCount",0),this.context=lm(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),du(this.outputNode),this.volumeLevelAnalyser=new wQ}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=t=>{this.emit(Ao.ON_AUDIO_BUFFER,function(r){for(let n=0;n<r.outputBuffer.numberOfChannels;n+=1){let i=r.outputBuffer.getChannelData(n);for(let o=0;o<i.length;o+=1)i[o]=0}return r.inputBuffer}(t))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Et().webAudioMediaStreamDest)throw new X(I.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){this.context.state!=="running"&&ZS(()=>{Ut.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;Ei()||Js()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();let t=this.volumeLevelAnalyser.getAnalyserNode(),r;t.getFloatTimeDomainData?(r=new Float32Array(t.fftSize),t.getFloatTimeDomainData(r)):(r=new Uint8Array(t.fftSize),t.getByteTimeDomainData(r));let n=!1;for(let i=0;i<r.length;i++)r[i]!==0&&(n=!0);return n?(this.isNoAudioInput=!1,!0):(await Tn(200),await this.checkHasAudioInput(e?e+1:1)&&n)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var e,t;(e=this.processedNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var e;this.processedNode?(e=this.processedNode)===null||e===void 0||e.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}},TQ=class extends SQ{get isFreeze(){return!1}constructor(e,t,r){var n;if(super(),J(this,"sourceNode",void 0),J(this,"track",void 0),J(this,"clonedTrack",void 0),J(this,"audioElement",void 0),J(this,"isCurrentTrackCloned",!1),J(this,"isRemoteTrack",!1),J(this,"originVolumeLevelAnalyser",void 0),J(this,"rebuildWebAudio",async()=>{if(b.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void b.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>b.info("resume success")),b.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();let s=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?s.stop():this.isCurrentTrackCloned=!0;let a=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(a),du(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();let c=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(c,this.context.currentTime),du(this.outputNode),this.emit(Ao.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=a,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),e.kind!=="audio")throw new X(I.UNEXPECTED_ERROR);this.track=e;let i=new MediaStream([this.track]);if(this.isRemoteTrack=!!t,this.sourceNode=this.context.createMediaStreamSource(i),du(this.sourceNode),r){let s=r.clone();s.enabled=!0,this.clonedTrack=s,b.debug("create an unmuted track ".concat(s.id," from the original track ").concat(r.id," to get the volume"));let a=this.context.createMediaStreamSource(new MediaStream([s]));du(a),this.originVolumeLevelAnalyser=new wQ,this.originVolumeLevelAnalyser.updateSource(a)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=i;let o=yt();t&&o.os===sn.IOS&&Number((n=o.osVersion)===null||n===void 0?void 0:n.split(".")[0])<15&&(Ut.on(bn.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(s=>{s||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1;let t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t),du(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(Ao.UPDATE_SOURCE),this.audioElement.srcObject=t}destroy(){var e;this.audioElement.srcObject=null,this.audioElement.remove(),Ut.off("state-change",this.rebuildWebAudio),(e=this.originVolumeLevelAnalyser)===null||e===void 0||e.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(e){return this.context.createMediaStreamSource(new MediaStream([e]))}updateOriginTrack(e){let t=e.clone();t.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=t),b.debug("create an unmuted track ".concat(t.id," from the original track ").concat(e.id," to get the volume"));let r=this.context.createMediaStreamSource(new MediaStream([t]));du(r),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(r)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}};async function CQ(e,t,r){let n=(o,s)=>o?typeof o!="number"?o.max||o.exact||o.ideal||o.min||s:o:s,i={audio:!!r&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:n(t.height,1080),maxWidth:n(t.width,1920)}}};return t.frameRate&&typeof t.frameRate!="number"?(i.video.mandatory.maxFrameRate=t.frameRate.max,i.video.mandatory.minFrameRate=t.frameRate.min):typeof t.frameRate=="number"&&(i.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(i)}async function XLe(e,t){let r=await RQ(e.mediaSource),{sourceId:n,audio:i}=await function(o){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new de((a,c)=>{let l=document.createElement("div");l.innerText="share screen",l.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");let d=document.createElement("div");d.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");let u=document.createElement("div");u.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",u.setAttribute("style","height: 12%;");let p=document.createElement("div");p.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");let f=document.createElement("div");f.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");let m=document.createElement("button");m.innerHTML="cancel",m.setAttribute("style","width: 85px;"),m.onclick=()=>{document.body.removeChild(v);let E=new Error("NotAllowedError");E.name="NotAllowedError",c(E)};let g=s,y=document.createElement("div");if(s){let E=document.createElement("input");E.setAttribute("type","checkbox");let w=document.createElement("span");E.setAttribute("style","margin-right: 6px;"),w.innerText="Share audio",E.checked=g,E.onchange=()=>{g=E.checked},y.appendChild(E),y.appendChild(w)}f.appendChild(y),f.appendChild(m),d.appendChild(u),d.appendChild(p),d.appendChild(f);let v=document.createElement("div");v.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),v.appendChild(l),v.appendChild(d),document.body.appendChild(v),o.map(E=>{if(E.id){let w=document.createElement("div");w.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let S=E.thumbnail;try{let{width:A}=S.getSize();A>1920&&(S=S.resize({width:1920}))}catch(A){throw A&&A.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),A}w.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+S.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+E.name.replace(/[\u00A0-\u9999<>\&]/g,function(A){return"&#"+A.charCodeAt(0)+";"})+"</span>",w.onclick=()=>{document.body.removeChild(v),a({sourceId:E.id,audio:g})},p.appendChild(w)}})})}(r,t);return await CQ(n,e,i)}async function RQ(e){let t=["window","screen"];e!=="application"&&e!=="window"||(t=["window"]),e==="screen"&&(t=["screen"]);let r=YJ();if(!r)throw console.error("failed to fetch electron, please mount it to window"),new X(I.ELECTRON_IS_NULL);let n=null;try{var i;n=((i=r.desktopCapturer)===null||i===void 0?void 0:i.getSources({types:t}))||r.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch{n=null}n&&n.then||(n=new de((o,s)=>{r.desktopCapturer.getSources({types:t},(a,c)=>{a?s(a):o(c)})}));try{return await n}catch(o){throw new X(I.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,o.toString())}}var HO=new Gn("safari"),IQ=!1,AQ=!1;async function Ro(e,t){let r=0,n=null;for(;r<2;)try{n=await JLe(e,t,r>0);break}catch(i){if(i instanceof X)throw b.error("[".concat(t,"] ").concat(i.toString())),i;let o=g_(i.name||i.code||i,i.message);if(o.code===I.MEDIA_OPTION_INVALID){b.debug("[".concat(t,"] detect media option invalid, retry")),r+=1,await Tn(500);continue}throw b.error("[".concat(t,"] ").concat(o.toString())),o}if(!n)throw new X(I.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return n}async function JLe(e,t,r){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new X(I.NOT_SUPPORTED,"can not find getUserMedia");r&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));let n=Et(),i=new MediaStream;if(e.audioSource&&i.addTrack(e.audioSource),e.videoSource&&i.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return b.debug("Using Video Source/ Audio Source"),i;if(e.screen)if(YJ())e.screen.sourceId?Jh(i,await CQ(e.screen.sourceId,e.screen,e.screenAudio)):Jh(i,await XLe(e.screen,e.screenAudio));else if(vd()&&e.screen.extensionId&&e.screen.mandatory){if(!n.getStreamFromExtension)throw new X(I.NOT_SUPPORTED,"This browser does not support screen sharing");b.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));let p=await(s=e.screen.extensionId,a=t,new de((f,m)=>{try{chrome.runtime.sendMessage(s,{getStream:!0},g=>{if(!g||!g.streamId)return b.error("[".concat(a,"] No response from Chrome Plugin. Plugin not installed properly"),g),void m(new X(I.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));f(g.streamId)})}catch(g){b.error("[".concat(a,"] AgoraRTC screensharing plugin is not accessible(").concat(s,")"),g.toString()),m(new X(I.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=p,Jh(i,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(n.getDisplayMedia){var o;e.screen.mediaSource&&NF(e.screen.mediaSource);let p={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:(o=e.screen.displaySurface)!==null&&o!==void 0?o:e.screen.mediaSource==="screen"?"monitor":e.screen.mediaSource},{selfBrowserSurface:f,surfaceSwitching:m,systemAudio:g}=e.screen,y={selfBrowserSurface:f,surfaceSwitching:m,systemAudio:g};!f&&delete y.selfBrowserSurface,!m&&delete y.surfaceSwitching,!g&&delete y.systemAudio,b.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:p,audio:!!e.screenAudio,controls:y})),Jh(i,await navigator.mediaDevices.getDisplayMedia(sr({video:p,audio:!!e.screenAudio},y)))}else{if(!_r())throw b.error("[".concat(t,"] This browser does not support screenSharing")),new X(I.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&NF(e.screen.mediaSource);let p={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};b.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(p))),Jh(i,await navigator.mediaDevices.getUserMedia(p))}}var s,a;if(!e.video&&!e.audio)return i;let c={video:e.video,audio:e.audio},l=D("MEDIA_DEVICE_CONSTRAINTS");if(l)try{typeof l=="string"&&(l=JSON.parse(l)),c=PO(c,l)}catch{}b.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(c)),yt();let d,u=null;(Pn()||Ei()||Xb())&&(u=await HO.lock());try{d=await navigator.mediaDevices.getUserMedia(c)}catch(p){throw u&&u(),p}return c.audio&&(IQ=!0),c.video&&(AQ=!0),Jh(i,d),u&&u(),i}function g_(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new X(I.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new X(I.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new X(I.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new X(I.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new X(I.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new X(I.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return b.error("getUserMedia unexpected error",e),new X(I.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function Jh(e,t){let r=e.getVideoTracks()[0],n=e.getAudioTracks()[0],i=t.getVideoTracks()[0],o=t.getAudioTracks()[0];o&&(n&&e.removeTrack(n),e.addTrack(o)),i&&(r&&e.removeTrack(r),e.addTrack(i))}var Oo=new class extends fr{get state(){return this._state}set state(e){e!==this._state&&(this.emit(Cu.STATE_CHANGE,e),this._state=e)}constructor(){super(),J(this,"_state",zm.IDLE),J(this,"isAccessMicrophonePermission",!1),J(this,"isAccessCameraPermission",!1),J(this,"lastAccessMicrophonePermission",!1),J(this,"lastAccessCameraPermission",!1),J(this,"checkdeviceMatched",!1),J(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(D("ENUMERATE_DEVICES_INTERVAL")||(JS()||XS()===sn.HARMONY_OS)&&Od())&&this.updateDevicesInfo()},D("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(e=>b.error(e.toString()))}async enumerateDevices(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new X(I.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();let n=await navigator.mediaDevices.enumerateDevices(),i=this.checkMediaDeviceInfoIsOk(n),o=!this.isAccessMicrophonePermission&&e,s=!this.isAccessCameraPermission&&t;i.audio&&(o=!1),i.video&&(s=!1);let a=null,c=null,l=null;if(!r&&(o||s)){if(HO.isLocked&&(b.debug("[device manager] wait GUM lock"),(await HO.lock())(),b.debug("[device manager] GUM unlock")),IQ&&(o=!1,this.isAccessMicrophonePermission=!0),AQ&&(s=!1,this.isAccessCameraPermission=!0),b.debug("[device manager] check media device permissions",e,t,o,s),o&&s){try{l=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(d){let u=g_(d.name||d.code||d,d.message);if(u.code===I.PERMISSION_DENIED)throw u;b.warning("getUserMedia failed in getDevices",u)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(o){try{a=await navigator.mediaDevices.getUserMedia({audio:e})}catch(d){let u=g_(d.name||d.code||d,d.message);if(u.code===I.PERMISSION_DENIED)throw u;b.warning("getUserMedia failed in getDevices",u)}this.isAccessMicrophonePermission=!0}else if(s){try{c=await navigator.mediaDevices.getUserMedia({video:t})}catch(d){let u=g_(d.name||d.code||d,d.message);if(u.code===I.PERMISSION_DENIED)throw u;b.warning("getUserMedia failed in getDevices",u)}this.isAccessCameraPermission=!0}b.debug("[device manager] mic permission",e,"cam permission",t)}try{let d=await navigator.mediaDevices.enumerateDevices();return a&&a.getTracks().forEach(u=>u.stop()),c&&c.getTracks().forEach(u=>u.stop()),l&&l.getTracks().forEach(u=>u.stop()),a=null,c=null,l=null,d}catch(d){return a&&a.getTracks().forEach(u=>u.stop()),c&&c.getTracks().forEach(u=>u.stop()),l&&l.getTracks().forEach(u=>u.stop()),a=null,c=null,l=null,new X(I.ENUMERATE_DEVICES_FAILED,d.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(t=>t.kind==="audioinput")}async getCamerasDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter(t=>t.kind==="videoinput")}async getSpeakers(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(t=>t.kind==="audiooutput")}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach(r=>{r.device.label===e&&(t=r.device.deviceId)}),t}async getDeviceById(e){let t=(await this.enumerateDevices(!0,!0,!0)).find(r=>r.deviceId===e);if(!t)throw new X(I.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return t}async init(){this.state=zm.INITING;try{await this.updateDevicesInfo(),this.state=zm.INITEND}catch(e){throw b.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=zm.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new X(I.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){let e=await this.enumerateDevices(!0,!0,!0),t=Date.now(),r=[];if(e[0]&&e[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;let i=e.find(s=>s.kind==="audioinput"&&s.deviceId==="default"),o=e.find(s=>s.kind==="audiooutput"&&s.deviceId==="default");i&&o?o.groupId===i.groupId?b.debug("[device-check] default input ".concat(i.label," and output ").concat(o.label," is the same group")):b.warning("[device-check] default input ".concat(i.label," and output ").concat(o.label," is not the same group")):b.debug("[device-check] default input or output not found")}let n=this.checkMediaDeviceInfoIsOk(e);if(e.forEach(i=>{if(!i.deviceId)return;let o=this.deviceInfoMap.get("".concat(i.kind,"_").concat(i.deviceId));if((o?o.state:"INACTIVE")!=="ACTIVE"){let s={initAt:t,updateAt:t,device:i,state:"ACTIVE"};this.deviceInfoMap.set("".concat(i.kind,"_").concat(i.deviceId),s),r.push(s)}o&&(o.updateAt=t)}),this.deviceInfoMap.forEach((i,o)=>{i.state==="ACTIVE"&&i.updateAt!==t&&(i.state="INACTIVE",r.push(i))}),this.state!==zm.INITEND)return n.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(n.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));r.forEach(i=>{switch(i.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Cu.RECORDING_DEVICE_CHANGED,i);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(Cu.CAMERA_DEVICE_CHANGED,i);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Cu.PLAYOUT_DEVICE_CHANGED,i)}}),n.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),n.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){let t=e.filter(i=>i.kind==="audioinput"),r=e.filter(i=>i.kind==="videoinput"),n={audio:!1,video:!1};for(let i of t)if(i.label&&i.deviceId){n.audio=!0;break}for(let i of r)if(i.label&&i.deviceId){n.video=!0;break}return n}},RI=!1,bo=new class extends fr{constructor(){super(...arguments),J(this,"onAutoplayFailed",void 0),J(this,"onAudioAutoplayFailed",void 0)}};function xQ(){if(yt(),!RI){let e=t=>{t.preventDefault(),RI=!1,M0()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};RI=!0,M0()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),b.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),bo.onAutoplayFailed?bo.onAutoplayFailed():bo.onAudioAutoplayFailed?b.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):b.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),bo.emit("autoplay-failed")}}function OQ(e,t,r,n){if(!e)return;let i=_e.getBaseInfoBySessionId(e);if(!i)return;let o=i.info,s=Date.now(),a=sr(sr({},o),{},{vid:o.vid===void 0?0:Number(o.vid),lts:s,elapse:s-i.startTime,cbRegistered:bo.onAutoplayFailed||bo.onAudioAutoplayFailed?1:-1,errorMsg:r,mediaType:t,trackId:n,extend:void 0});_e.send({type:hr.AUTOPLAY_FAILED,data:a},!0)}var QLe=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],Ni=new class{constructor(){J(this,"onAutoplayFailed",void 0),J(this,"elementMap",new Map),J(this,"elementStateMap",new Map),J(this,"elementsNeedToResume",[]),J(this,"sinkIdMap",new Map),J(this,"autoResumeAfterInterruption",e=>{Array.from(this.elementMap.entries()).forEach(t=>{let[r,n]=t,i=this.elementStateMap.get(r),o=n.srcObject.getAudioTracks()[0],s=o&&o.readyState;if(b.debug("resume after interrupted, ele: ".concat(i," audio: ").concat(s," ").concat(e)),s==="live"){if(e)return n.pause(),void n.play();if(Ut.curState==="running")return Cf()?(n.pause(),void n.play()):void(i&&i==="paused"&&n.play())}})}),J(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[t,r]=e,n=r.srcObject.getAudioTracks()[0];n&&n.readyState==="live"&&(b.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),r.pause(),r.play())})}),this.autoResumeAudioElement(),Ut.on(bn.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Ut.on(bn.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),Ut.on(bn.STATE_CHANGE,()=>{Ei()&&Ut.prevState==="suspended"&&Ut.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(e,t){let r=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),r)try{await r.setSinkId(t)}catch(n){throw new X(I.PERMISSION_DENIED,"can not set sink id: "+n.toString())}}play(e,t,r,n){if(this.elementMap.has(t))return;let i=document.createElement("audio");i.autoplay=!0,i.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,i),this.elementMap.set(t,i),this.elementStateMap.set(t,si.INIT),this.setVolume(t,r);let o=this.sinkIdMap.get(t);if(o)try{i.setSinkId(o).catch(a=>{b.warning("[".concat(t,"] set sink id failed"),a.toString())})}catch(a){b.warning("[".concat(t,"] set sink id failed"),a.toString())}let s=i.play();s&&s.then&&s.catch(a=>{n&&OQ(n,"audio",a.message,t),b.warning("audio element play warning",a.toString()),this.elementMap.has(t)&&a.name==="NotAllowedError"&&(b.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(i),ZS(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),xQ()}))})}updateTrack(e,t){let r=this.elementMap.get(e);r&&(r.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)&&this.elementStateMap.get(e)==="playing"}setVolume(e,t){let r=this.elementMap.get(e);r&&(t=Math.max(0,Math.min(100,t)),r.volume=t/100)}stop(e){let t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;let r=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(r,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){QLe.forEach(r=>{t.addEventListener(r,n=>{let i=this.elementStateMap.get(e),o=n.type==="pause"?"paused":n.type;if(b.debug("[".concat(e,"] audio-element-status change ").concat(i," => ").concat(o)),n.type==="error"){let s=t==null?void 0:t.error;s&&b.error("[".concat(e,"] media error, code: ").concat(s.code,", message: ").concat(s.message))}this.elementStateMap.set(e,o)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){let e=()=>{this.elementsNeedToResume.forEach(t=>{t.play().then(r=>{b.debug("Auto resume audio element success")}).catch(r=>{b.warning("Auto resume audio element failed!",r)})}),this.elementsNeedToResume=[]};new de(t=>{document.body?t():window.addEventListener("load",()=>t())}).then(()=>{M0()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))})}};function Ar(){return function(e,t,r){let n=r.value;return typeof n=="function"&&(r.value=function(){this._isClosed&&new X(I.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",b);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];let a=n.apply(this,o);return a instanceof de?new de((c,l)=>{a.then(c).catch(l)}):a}),r}}var NQ=class extends fr{constructor(e){super(),J(this,"name","VideoProcessorDestination"),J(this,"ID","0"),J(this,"_source",void 0),J(this,"videoContext",void 0),J(this,"inputTrack",void 0),this.videoContext=e}get kind(){return"video"}get enabled(){return!0}pipe(){throw new X(I.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new X(I.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(e){if(e.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);e.track&&e.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=e.track,this.emit(_i.ON_TRACK,e.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(_i.ON_TRACK,void 0)}},kQ=class extends fr{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t){super(),J(this,"constraintsMap",new Map),J(this,"statsRegistry",[]),J(this,"usageRegistry",[]),J(this,"trackId",void 0),J(this,"direction",void 0),J(this,"_chained",!1),this.trackId=e,this.direction=t}async getConstraints(){return await Dn(this,Uo.REQUEST_CONSTRAINTS)}async requestApplyConstraints(e,t){var r;return b.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),Wt(this,Uo.REQUEST_UPDATE_CONSTRAINTS,Array.from(il(r=this.constraintsMap).call(r)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return b.info("processor ".concat(e.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(e),Wt(this,Uo.REQUEST_UPDATE_CONSTRAINTS,Array.from(il(t=this.constraintsMap).call(t)))}registerStats(e,t,r){this.statsRegistry.find(n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t)||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:r})}unregisterStats(e,t){let r=this.statsRegistry.findIndex(n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t);r!==-1&&this.statsRegistry.splice(r,1)}gatherStats(){let e=[];for(let{processorID:t,processorName:r,type:n,cb:i}of this.statsRegistry)try{let o=i();e.push({processorID:t,processorName:r,type:n,stats:o})}catch(o){b.error(new X(I.UNEXPECTED_ERROR,o.message))}return e}registerUsage(e,t){this.usageRegistry.find(r=>r.processorID===e.ID&&r.processorName===e.name)||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){let t=this.usageRegistry.findIndex(r=>r.processorID===e.ID&&r.processorName===e.name);t!==-1&&this.usageRegistry.splice(t,1)}async gatherUsage(){let e=[];if(!this.chained)return[];for(let{cb:t}of this.usageRegistry)try{let r=t();r instanceof de&&(r=await r),e.push(sr(sr({},r),{},{direction:this.direction}))}catch(r){b.error("gather extension usage error",r)}return e}getDirection(){return this.direction}},PQ=class extends fr{constructor(e){super(),J(this,"name","AudioProcessorDestination"),J(this,"ID","0"),J(this,"inputTrack",void 0),J(this,"inputNode",void 0),J(this,"audioProcessorContext",void 0),J(this,"_source",void 0),this.audioProcessorContext=e}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new X(I.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new X(I.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(_i.ON_TRACK,void 0),this.emit(_i.ON_NODE,void 0)}updateInput(e){if(e.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);e.track&&this.inputTrack!==e.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=e.track,this.emit(_i.ON_TRACK,this.inputTrack)),e.node&&this.inputNode!==e.node&&(this.audioProcessorContext.chained=!0,this.inputNode=e.node,this.emit(_i.ON_NODE,this.inputNode))}},DQ=class extends fr{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t,r){super(),J(this,"constraintsMap",new Map),J(this,"statsRegistry",[]),J(this,"audioContext",void 0),J(this,"trackId",void 0),J(this,"direction",void 0),J(this,"usageRegistry",[]),J(this,"_chained",!1),this.audioContext=e,this.trackId=t,this.direction=r}async getConstraints(){return Dn(this,Uo.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(e,t){var r;return b.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),Wt(this,Uo.REQUEST_UPDATE_CONSTRAINTS,Array.from(il(r=this.constraintsMap).call(r)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return this.constraintsMap.delete(e),Wt(this,Uo.REQUEST_UPDATE_CONSTRAINTS,Array.from(il(t=this.constraintsMap).call(t)))}registerStats(e,t,r){this.statsRegistry.find(n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t)||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:r})}unregisterStats(e,t){let r=this.statsRegistry.findIndex(n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t);r!==-1&&this.statsRegistry.splice(r,1)}gatherStats(){let e=[];for(let{processorID:t,processorName:r,type:n,cb:i}of this.statsRegistry)try{let o=i();e.push({processorID:t,processorName:r,type:n,stats:o})}catch(o){b.error(new X(I.UNEXPECTED_ERROR,o.message))}return e}registerUsage(e,t){this.usageRegistry.find(r=>r.processorID===e.ID&&r.processorName===e.name)||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){let t=this.usageRegistry.findIndex(r=>r.processorID===e.ID&&r.processorName===e.name);t!==-1&&this.usageRegistry.splice(t,1)}async gatherUsage(){let e=[];if(!this.chained)return[];for(let{cb:t}of this.usageRegistry)try{let r=t();r instanceof de&&(r=await r),e.push(sr(sr({},r),{},{direction:this.direction}))}catch(r){b.error("gather extension usage error",r)}return e}getDirection(){return this.direction}},WO=class extends fr{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),J(this,"context",void 0),J(this,"processSourceNode",void 0),J(this,"outputTrack",void 0),J(this,"processedNode",void 0),J(this,"clonedTrack",void 0),J(this,"outputNode",void 0),this.outputNode=new ZLe}setVolume(){}createOutputTrack(){throw new X(I.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}},ZLe=class{disconnect(){}connect(){}};function LQ(e){return new de((t,r)=>{let n=!1,i=document.createElement("video");i.setAttribute("autoplay",""),i.setAttribute("muted",""),i.muted=!0,i.autoplay=!0,i.setAttribute("playsinline",""),i.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(i);let o=Ei()?"canplay":"playing";i.addEventListener(o,()=>{let s=i.videoWidth,a=i.videoHeight;!s&&_r()||(n=!0,i.srcObject=null,i.remove(),t([s,a]))}),i.srcObject=new MediaStream([e]),i.play().catch(eT),setTimeout(()=>{n||(i.srcObject=null,i.remove(),t([i.videoWidth,i.videoHeight]))},4e3)})}function ew(e){let t={};e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId});let r=lc(e.encoderConfig);return r.width!=null&&(t.width=r.width),r.height!=null&&(t.height=r.height),!zJ()&&r.frameRate&&(t.frameRate=r.frameRate),VJ()&&typeof t.frameRate=="object"&&(t.frameRate.max=60),_r()&&(t.frameRate={ideal:30,max:30}),t}function DF(e){let t={};if(zJ()||(e.AGC!==void 0&&(t.autoGainControl=e.AGC),e.AEC!==void 0&&(t.echoCancellation=e.AEC),e.ANS!==void 0&&(t.noiseSuppression=e.ANS,vd()&&e.ANS&&(t.googHighpassFilter=e.ANS))),e.encoderConfig){let r=Zb(e.encoderConfig);t.channelCount=r.stereo?2:1,t.sampleRate=r.sampleRate,t.sampleSize=r.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),JS()&&(t.sampleRate=void 0),t}var eMe=e=>{let t=e._encoderConfig;if(!t)return;let{frameRate:r,width:n,height:i}=e.getMediaStreamTrackSettings(),{frameRate:o=r,width:s=n,height:a=i}=t;if(!o||!s||!a)return;s=KR(s),a=KR(a),o=KR(o);let{max:c,min:l}=function(f,m,g){let y=200*Math.pow(g/15,.6)*Math.pow(f*m/640/360,.75);return{min:Math.floor(y),max:Math.floor(4*y)}}(s,a,o),{bitrateMax:d,bitrateMin:u}=t||{};d||b.debug("calculate bitrate: [w: ".concat(s,", h: ").concat(a,", fps: ").concat(o,"] => [brMax: ").concat(d,", brMin: ").concat(u,"]"));let{maxFramerate:p}=D("ENCODER_CONFIG_LIMIT");return p&&typeof p=="number"&&(o=Math.min(o,p)),{frameRate:o,bitrateMax:d||c,bitrateMin:u||l,scaleResolutionDownBy:1,scale:0}},MQ=async(e,t,r)=>await(async(n,i,o)=>{let s=function(l){let d=[];for(let u=0;u<l.length;u+=2)d.push(parseInt(l.slice(u,u+2),16));return Uint8Array.from(d)}(ZJ(""+i+o)).slice(0,16),a=s.slice(0,12),c=await window.crypto.subtle.importKey("raw",s,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:a},c,n))})(e.buffer,t,r),HD=e=>{let t=document.createElement("canvas");return t.width=2,t.height=2,new de((r,n)=>{t.toBlob(async i=>{if(t.remove(),i){let o=await jQ(i);r({buffer:o,width:t.width,height:t.height})}else n(new X(I.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},e,1)})},jQ=async e=>{let t=await e.arrayBuffer();return new Uint8Array(t)},LF,MF,jF,UF,FF,VF,BF,$F,HF,WF,GF,zF,KF,qF,YF,XF,JF,QF,ar,ZF,eV,tV,rV,nV,iV,qa,oV,sV,aV,cV,lV,dV,uV,hV,pV,fV,mV,gV,yV,In,vr=(LF=Oe({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),MF=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),jF=Ar(),UF=Rf("LocalAudioTrack","_enabledMutex"),FF=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),VF=Ar(),BF=Rf("LocalAudioTrack","_enabledMutex"),$F=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),HF=Ar(),WF=Ar(),GF=Ar(),zF=Oe({argsMap:e=>[e.getTrackId()]}),KF=Ar(),qF=Oe({argsMap:e=>[e.getTrackId()]}),YF=Ar(),XF=Oe({argsMap:e=>[e.getTrackId()]}),JF=Oe({argsMap:(e,t)=>[e.getTrackId(),t.name]}),QF=Oe({argsMap:e=>[e.getTrackId()]}),mt((ar=class extends Dp{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?Ni.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,t,r,n){super(e,r),J(this,"trackMediaType",cm.AUDIO),J(this,"_encoderConfig",void 0),J(this,"_trackSource",void 0),J(this,"_enabled",!0),J(this,"_volume",100),J(this,"_useAudioElement",!0),J(this,"_bypassWebAudio",!1),J(this,"processor",void 0),J(this,"_processorContext",void 0),J(this,"_processorDestination",void 0),J(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!n,this._trackSource=new WO,D("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),D("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),Pn()&&!_o?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(e){Vt(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&Ni.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void b.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));let t=this._source.createOutputTrack();this._mediaStreamTrack!==t&&(this._mediaStreamTrack=t,Wt(this,fe.NEED_REPLACE_TRACK,this).then(()=>{b.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(r=>{b.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),r)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!vQ())throw new X(I.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Ni.setSinkID(this.getTrackId(),e)}async setEnabled(e,t,r){return this._setEnabled(e,t,r)}async _setEnabled(e,t,r){if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(b.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{r||(this._enabled=!0),await Wt(this,fe.NEED_ENABLE_TRACK,this),b.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(n){throw r||(this._enabled=!1),b.error("[".concat(this.getTrackId(),"] setEnabled to true error"),n.toString()),n}}else{this._originMediaStreamTrack.enabled=!1,r||(this._enabled=!1);try{await Wt(this,fe.NEED_DISABLE_TRACK,this)}catch(n){throw r||(this._enabled=!0),b.error("[".concat(this.getTrackId(),"] setEnabled to false error"),n.toString()),n}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,b.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await Wt(this,fe.NEED_MUTE_TRACK,this):await Wt(this,fe.NEED_UNMUTE_TRACK,this))}getStats(){return Nd(()=>{b.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),is(this,fe.GET_STATS)||sr({},BO)}setAudioFrameCallback(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Ao.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Ao.ON_AUDIO_BUFFER),this._source.on(Ao.ON_AUDIO_BUFFER,r=>e(r))}play(){b.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(b.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Ni.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){b.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Ni.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];b.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Ni.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:e,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Wt(this,fe.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return de.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new X(I.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new X(I.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;let t=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(e){e.on(_i.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(t),await Wt(this,fe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Wt(this,fe.NEED_REPLACE_TRACK,this))}),e.on(_i.ON_NODE,t=>{this._source.processedNode=t})}unbindProcessorDestinationEvents(e){e.removeAllListeners(_i.ON_TRACK),e.removeAllListeners(_i.ON_NODE)}bindProcessorContextEvents(e){e.on(Uo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(e){e.removeAllListeners(Uo.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof WO&&(this._trackSource=new TQ(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){let e=new DQ(this._source.context,this.getTrackId(),"local"),t=new PQ(e);return this._processorContext=e,this._processorDestination=t,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(t),this._source.on(Ao.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(Ni.stop(this.getTrackId()),this._source.play()),Wt(this,fe.NEED_REPLACE_MIXING_TRACK,this).then(()=>{b.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(r=>{b.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),r)})),{processorContext:e,processorDestination:t}}}).prototype,"setVolume",[LF],Object.getOwnPropertyDescriptor(ar.prototype,"setVolume"),ar.prototype),mt(ar.prototype,"setPlaybackDevice",[MF,jF],Object.getOwnPropertyDescriptor(ar.prototype,"setPlaybackDevice"),ar.prototype),mt(ar.prototype,"setEnabled",[UF,FF,VF],Object.getOwnPropertyDescriptor(ar.prototype,"setEnabled"),ar.prototype),mt(ar.prototype,"setMuted",[BF,$F,HF],Object.getOwnPropertyDescriptor(ar.prototype,"setMuted"),ar.prototype),mt(ar.prototype,"getStats",[WF],Object.getOwnPropertyDescriptor(ar.prototype,"getStats"),ar.prototype),mt(ar.prototype,"setAudioFrameCallback",[GF],Object.getOwnPropertyDescriptor(ar.prototype,"setAudioFrameCallback"),ar.prototype),mt(ar.prototype,"play",[zF,KF],Object.getOwnPropertyDescriptor(ar.prototype,"play"),ar.prototype),mt(ar.prototype,"stop",[qF,YF],Object.getOwnPropertyDescriptor(ar.prototype,"stop"),ar.prototype),mt(ar.prototype,"close",[XF],Object.getOwnPropertyDescriptor(ar.prototype,"close"),ar.prototype),mt(ar.prototype,"pipe",[JF],Object.getOwnPropertyDescriptor(ar.prototype,"pipe"),ar.prototype),mt(ar.prototype,"unpipe",[QF],Object.getOwnPropertyDescriptor(ar.prototype,"unpipe"),ar.prototype),ar),tw=(ZF=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),eV=Ar(),tV=Rf("MicrophoneAudioTrack","_enabledMutex"),rV=Oe({argsMap:(e,t,r)=>[e.getTrackId(),t,r]}),nV=Ar(),iV=Oe({argsMap:e=>[e.getTrackId()]}),mt((qa=class extends vr{get __className__(){return"MicrophoneAudioTrack"}constructor(e,t,r,n){super(e,t.encoderConfig?Zb(t.encoderConfig):{},n,D("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),J(this,"_config",void 0),J(this,"_deviceName","default"),J(this,"_constraints",void 0),J(this,"_originalConstraints",void 0),J(this,"_enabled",!0),this._config=t,this._constraints=r,this._originalConstraints=r,this._deviceName=e.label,typeof t.bypassWebAudio=="boolean"&&(this._bypassWebAudio=t.bypassWebAudio),(Cf()||OO())&&Ut.bindInterruptDetectorTrack(this)}async setDevice(e){if(b.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{let t=await Oo.getDeviceById(e),r={};r.audio=sr({},this._constraints),r.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let n=null;try{n=await Ro(r,this.getTrackId())}catch(i){throw b.error("[".concat(this.getTrackId(),"] setDevice failed"),i.toString()),n=await Ro({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(n.getAudioTracks()[0],!1),i}await this._updateOriginMediaStreamTrack(n.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(t){throw b.error("[".concat(this.getTrackId(),"] setDevice error"),t.toString()),t}else try{let t=await Oo.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(t){throw b.error("[".concat(this.getTrackId(),"] setDevice error"),t.toString()),t}b.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,t,r){if(t)return b.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(b.info("[".concat(this.getTrackId(),"] start setEnabled"),e),D("AUTO_RESET_AUDIO_ROUTE")&&(Ei()||Js())){let s=navigator.audioSession;s&&(e||(s.type="playback"),s.type="auto")}if(!e){var n;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(n=this._source.clonedTrack)===null||n===void 0||n.stop(),r||(this._enabled=!1);try{await Wt(this,fe.NEED_DISABLE_TRACK,this)}catch(s){throw b.error("[".concat(this.getTrackId(),"] setEnabled false failed"),s.toString()),s}return}let i=sr({},this._constraints),o=Oo.searchDeviceIdByName(this._deviceName);o&&!i.deviceId&&(i.deviceId=o);try{r||(this._enabled=!0);let s=await Ro({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!1),await Wt(this,fe.NEED_ENABLE_TRACK,this)}catch(s){throw r||(this._enabled=!1),b.error("[".concat(this.getTrackId(),"] setEnabled true failed"),s.toString()),s}b.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(Cf()||OO())&&Ut.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Ei()||Js())&&this._enabled&&!this._isClosed&&Ut.duringInterruption){let e=async()=>{Ut.off(bn.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(b.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};Ut.on(bn.IOS_INTERRUPTION_END,e)}else b.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(am.TRACK_ENDED)}async renewMediaStreamTrack(e){let t=e||this._constraints,r=Oo.searchDeviceIdByName(this._deviceName);if(r&&!t.deviceId&&(t.deviceId=r),this._constraints=t,this._enabled){this._originMediaStreamTrack.stop();let n=await Ro({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(n.getAudioTracks()[0],!0)}}bindProcessorContextEvents(e){super.bindProcessorContextEvents(e),e.on(Uo.REQUEST_UPDATE_CONSTRAINTS,async(t,r,n)=>{try{let i=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(i),r()}catch(i){n(i)}})}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(Uo.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[ZF,eV],Object.getOwnPropertyDescriptor(qa.prototype,"setDevice"),qa.prototype),mt(qa.prototype,"setEnabled",[tV,rV,nV],Object.getOwnPropertyDescriptor(qa.prototype,"setEnabled"),qa.prototype),mt(qa.prototype,"close",[iV],Object.getOwnPropertyDescriptor(qa.prototype,"close"),qa.prototype),qa),tMe=(oV=Oe({argsMap:(e,t)=>[e.getTrackId(),t,e.duration]}),sV=Ar(),aV=Oe({argsMap:e=>[e.getTrackId()]}),cV=Ar(),lV=Oe({argsMap:e=>[e.getTrackId()]}),dV=Ar(),uV=Oe({argsMap:e=>[e.getTrackId()]}),hV=Ar(),pV=Oe({argsMap:e=>[e.getTrackId()]}),fV=Ar(),mV=Oe({argsMap:e=>[e.getTrackId()]}),gV=Oe({argsMap:e=>[e.getTrackId()]}),yV=Ar(),mt((In=class extends vr{get __className__(){return"BufferSourceAudioTrack"}constructor(e,t,r,n){super(t.createOutputTrack(),r,n),J(this,"source",void 0),J(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=t,this._bufferSource.on(Ao.AUDIO_SOURCE_STATE_CHANGE,i=>{this.safeEmit(am.SOURCE_STATE_CHANGE,i)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){Vt(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}).prototype,"startProcessAudioBuffer",[oV,sV],Object.getOwnPropertyDescriptor(In.prototype,"startProcessAudioBuffer"),In.prototype),mt(In.prototype,"pauseProcessAudioBuffer",[aV,cV],Object.getOwnPropertyDescriptor(In.prototype,"pauseProcessAudioBuffer"),In.prototype),mt(In.prototype,"seekAudioBuffer",[lV,dV],Object.getOwnPropertyDescriptor(In.prototype,"seekAudioBuffer"),In.prototype),mt(In.prototype,"resumeProcessAudioBuffer",[uV,hV],Object.getOwnPropertyDescriptor(In.prototype,"resumeProcessAudioBuffer"),In.prototype),mt(In.prototype,"stopProcessAudioBuffer",[pV,fV],Object.getOwnPropertyDescriptor(In.prototype,"stopProcessAudioBuffer"),In.prototype),mt(In.prototype,"close",[mV],Object.getOwnPropertyDescriptor(In.prototype,"close"),In.prototype),mt(In.prototype,"setAudioBufferPlaybackSpeed",[gV,yV],Object.getOwnPropertyDescriptor(In.prototype,"setAudioBufferPlaybackSpeed"),In.prototype),In),on=class UQ extends vr{get __className__(){return"MixingAudioTrack"}get isActive(){for(let t of this.trackList)if(t._enabled&&!t._isClosed&&!t.muted)return!0;return!1}constructor(){let t=lm().createMediaStreamDestination();super(t.stream.getAudioTracks()[0],void 0,qt(8,"track-mix-")),J(this,"trackList",void 0),J(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=t,this.trackList=[]}hasAudioTrack(t){return this.trackList.indexOf(t)!==-1}addAudioTrack(t){this.trackList.indexOf(t)===-1?(b.debug("add ".concat(t.getTrackId()," to mixing track")),t._source.outputNode.connect(this.destNode),this.trackList.push(t),this.updateEncoderConfig()):b.debug("track ".concat(t.getTrackId()," is already added"))}removeAudioTrack(t){if(this.trackList.indexOf(t)!==-1){b.debug("remove ".concat(t.getTrackId()," from mixing track"));try{t._source.outputNode.disconnect(this.destNode)}catch{}Jb(this.trackList,t),this.updateEncoderConfig()}}updateEncoderConfig(){let t={};this.trackList.forEach(r=>{r._encoderConfig&&((r._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=r._encoderConfig.bitrate),(r._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=r._encoderConfig.sampleRate),(r._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=r._encoderConfig.sampleSize),r._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}_updateRtpTransceiver(t){this._rtpTransceiver!==t&&(this._rtpTransceiver=t,this.trackList.forEach(r=>{r instanceof UQ?r.emit(Vu.TRANSCEIVER_UPDATED,t):r._updateRtpTransceiver(t)}))}},rMe=class extends SQ{set currentState(e){e!==this._currentState&&(this._currentState=e,this.safeEmit(Ao.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),J(this,"audioBuffer",void 0),J(this,"sourceNode",void 0),J(this,"startPlayTime",0),J(this,"startPlayOffset",0),J(this,"pausePlayTime",0),J(this,"options",void 0),J(this,"currentLoopCount",0),J(this,"currentPlaybackSpeed",100),J(this,"_currentState","stopped"),this.audioBuffer=e,this.options=t,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(e){this.currentState==="stopped"?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):b.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=e,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(e){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=e/100),this.currentPlaybackSpeed=e}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){let e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e.playbackRate.value=this.currentPlaybackSpeed/100,e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}},vV=new Map,WD=class{get rendFrameRate(){if(this.renderStats&&this.renderStats.curTs!==this.renderStats.lastTs){let e=this.renderStats.curTs-this.renderStats.lastTs,t=(this.renderStats.renderNum-this.renderStats.lastRenderNum)/e;return this.renderStats.lastRenderNum=this.renderStats.renderNum,this.renderStats.lastTs=this.renderStats.curTs,t}return 0}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){e!==this._videoElementStatus&&(b.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}get videoState(){return this._videoState}set videoState(e){var t;e!==this._videoState&&(this._videoState=e,(t=this.onVideoStateChanged)===null||t===void 0||t.call(this,this.videoState))}constructor(e){J(this,"trackId",void 0),J(this,"config",void 0),J(this,"onFirstVideoFrameDecoded",void 0),J(this,"onVideoStateChanged",void 0),J(this,"freezeTimeCounterList",[]),J(this,"renderFreezeAccTime",0),J(this,"isKeepLastFrame",!1),J(this,"timeUpdatedCount",0),J(this,"freezeTime",0),J(this,"playbackTime",0),J(this,"lastTimeUpdatedTime",0),J(this,"autoplayFailed",!1),J(this,"videoTrack",void 0),J(this,"videoElement",void 0),J(this,"cacheVideoElement",void 0),J(this,"renderStats",void 0),J(this,"_videoState",Ka.VideoStateStopped),J(this,"videoElementCheckInterval",void 0),J(this,"videoElementFreezeTimeout",void 0),J(this,"_videoElementStatus",si.NONE),J(this,"isGettingVideoDimensions",!1),J(this,"startGetVideoDimensions",()=>{let t=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return b.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(t,500)};!this.isGettingVideoDimensions&&t()}),J(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&Ut.curState==="running"&&(b.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(R3())),O3()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),J(this,"handleVideoEvents",t=>{switch(t.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=si.PLAYING;break;case"loadeddata":if(this.videoState=Ka.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=si.CANPLAY;break;case"stalled":this.videoElementStatus=si.STALLED;break;case"suspend":this.videoElementStatus=si.SUSPEND;break;case"pause":this.videoElementStatus=si.PAUSED,Ei()||Js()||Pn()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(b.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=si.WAITING;break;case"abort":this.videoElementStatus=si.ABORT;break;case"ended":this.videoElementStatus=si.ENDED;break;case"emptied":this.videoElementStatus=si.EMPTIED;break;case"error":{let r=this.videoElement.error;r?(this.videoElementStatus=si.ERROR,b.error("[".concat(this.trackId,"] media error: ").concat(r.message," (").concat(r.code,")"))):b.debug("[".concat(this.trackId,"] media not been an error."));break}case"timeupdate":{let r=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=r);let n=r-this.lastTimeUpdatedTime,i=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=r,Fc.lastVisibleTime<Fc.lastHiddenTime||i<Fc.lastHiddenTime||i<Fc.lastVisibleTime)return;for(n>D("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=n),this.playbackTime+=n;this.playbackTime>=6e3;){this.playbackTime-=6e3;let o=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(o),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),J(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(b.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(R3())),O3()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=e.trackId,this.config=e,e.element instanceof HTMLVideoElement?this.videoElement=e.element:this.videoElement=document.createElement("video"),Ut.on(bn.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Ut.on(bn.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var e;return(e=this.videoElement.parentElement)!==null&&e!==void 0?e:void 0}updateConfig(e){this.config=e,this.trackId=e.trackId,e.element!==this.videoElement&&(this.destroy(),this.videoElement=e.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.initVideoElement())}play(e){let t=this.videoElement.play();t&&t.catch&&t.catch(n=>{e&&OQ(e,"video",n.message,this.trackId),n.name==="NotAllowedError"?(b.warning("detected video element autoplay failed",n),this.autoplayFailed=!0,this.handleAutoPlayFailed()):b.warning("[".concat(this.trackId,"] play warning: "),n)});let r=yt();if((r.name==="Safari"&&Number(r.version)===15||Cf())&&t&&t.then){let n=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};t.then(n).catch(n)}}getCurrentFrame(){let e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;let t=e.getContext("2d");if(!t)return b.error("create canvas context failed!"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);let r=t.getImageData(0,0,e.width,e.height);return e.remove(),r}async getCurrentFrameToUint8Array(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=document.createElement("canvas");r.width=this.videoElement.videoWidth,r.height=this.videoElement.videoHeight;let n=r.getContext("2d");return n?(n.drawImage(this.videoElement,0,0,r.width,r.height),new de((i,o)=>{r.toBlob(async s=>{if(r.remove(),s){let a=await jQ(s);i({buffer:a,width:r.width,height:r.height})}else o(new X(I.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},e,t<0?.1:t>1?1:t)})):await HD(e)}destroy(){this.renderStats=void 0,Ut.off(bn.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Ut.off(bn.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=Ka.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=si.INIT,!this.videoElementCheckInterval&&(EV.forEach(i=>{this.videoElement.addEventListener(i,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(i){return i!==document.body&&document.body.contains(i)})(this.videoElement)||(this.videoElementStatus=si.DESTROYED)},1e3),D("ENABLE_VIDEO_FRAME_CALLBACK"))){var e,t;let i,o=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",o),this.videoElementFreezeTimeout=window.setTimeout(s,D("VIDEO_FREEZE_DURATION")))},s=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===Ka.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=Ka.VideoStateFrozen:document.addEventListener("visibilitychange",o))},a=(c,l)=>{if(this.videoElementStatus===si.PLAYING){if(this.renderStats?(this.renderStats.renderNum++,this.renderStats.curTs=l.mediaTime):this.renderStats={lastTs:l.mediaTime,curTs:l.mediaTime,lastRenderNum:0,renderNum:0},i){let p=l.presentationTime-i.presentationTime;this.videoState===Ka.VideoStateStarting&&(this.videoState=Ka.VideoStateDecoding),this.videoState===Ka.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(s,D("VIDEO_FREEZE_DURATION"))),p<D("VIDEO_FREEZE_DURATION")&&this.videoState===Ka.VideoStateFrozen&&(this.videoState=Ka.VideoStateDecoding),p>D("VIDEO_FREEZE_DURATION")&&Fc.lastVisibleTime>=Fc.lastHiddenTime&&i.timestamp>Fc.lastVisibleTime&&i.timestamp>Fc.lastHiddenTime&&(this.renderFreezeAccTime+=p)}i=sr(sr({},l),{},{timestamp:c})}var d,u;D("ENABLE_VIDEO_FRAME_CALLBACK")&&((d=(u=this.videoElement).requestVideoFrameCallback)===null||d===void 0||d.call(u,a))};(e=(t=this.videoElement).requestVideoFrameCallback)===null||e===void 0||e.call(t,a)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),JS()&&!D("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");let r=yt();r.name==="Safari"&&Number(r.version)===15||Cf()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,_r()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,_r()&&this.videoElement.load());let n=this.videoElement.play();n!==void 0&&n.catch(i=>{b.debug("[".concat(this.trackId,"] playback interrupted"),i.toString())})}resetVideoElement(){EV.forEach(e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=si.NONE}handleAutoPlayFailed(){let e=t=>{t.preventDefault(),this.videoElement.play().then(()=>{b.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(r=>{b.error(r)}),this.autoplayFailed=!1,M0()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};M0()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),xQ()}},EV=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"],FQ=class extends WD{constructor(e){super(e),J(this,"container",void 0),J(this,"slot",void 0),this.slot=e.element,this.updateConfig(e)}updateConfig(e){this.config=e,this.trackId=e.trackId;let t=e.element;t!==this.slot&&(this.destroy(),this.slot=t),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){var t;(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)&&super.play(e)}getCurrentFrame(){var e;return(e=this.container)!==null&&e!==void 0&&e.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(e,r):await HD(e)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",D("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var e;!this.container||(e=this.container)!==null&&e!==void 0&&e.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var e;if((e=this.container)!==null&&e!==void 0&&e.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var e;(e=this.container)!==null&&e!==void 0&&e.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}},_V,bV,wV,SV,TV,CV,RV,IV,AV,xV,OV,NV,kV,PV,DV,LV,MV,jV,UV,FV,VV,BV,$V,HV,ht,WV,GV,zV,KV,qV,YV,XV,JV,vo,Qt=(_V=Oe({argsMap:(e,t,r)=>[e.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),bV=Ar(),wV=Oe({argsMap:e=>[e.getTrackId()]}),SV=Rf("LocalVideoTrack","_enabledMutex"),TV=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),CV=Ar(),RV=Rf("LocalVideoTrack","_enabledMutex"),IV=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),AV=Ar(),xV=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),OV=Ar(),NV=Ar(),kV=Oe({argsMap:(e,t,r)=>[e.getTrackId(),t,r]}),PV=Ar(),DV=Ar(),LV=Ar(),MV=Ar(),jV=Ar(),UV=Ar(),FV=Ar(),VV=Oe({argsMap:(e,t)=>[e.getTrackId(),t.name]}),BV=Oe({argsMap:e=>[e.getTrackId()]}),$V=Oe({argsMap:e=>[e.getTrackId()]}),HV=Oe({argsMap:(e,t,r)=>[e.getTrackId(),t.label,r]}),ht=class VQ extends Dp{get videoHeight(){if(Pn()){let{height:t}=this._mediaStreamTrack.getSettings();return this._videoHeight=t,this._videoHeight}return this._videoHeight}get videoWidth(){if(Pn()){let{width:t}=this._mediaStreamTrack.getSettings();return this._videoWidth=t,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==si.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}get __className__(){return"LocalVideoTrack"}constructor(t,r,n,i,o,s){if(super(t,o),J(this,"trackMediaType",cm.VIDEO),J(this,"_player",void 0),J(this,"isUseScaleResolutionDownBy",!1),J(this,"_videoVisibleTimer",null),J(this,"_previousVideoVisibleStatus",void 0),J(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),J(this,"_encoderConfig",void 0),J(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),J(this,"_optimizationMode",void 0),J(this,"_videoHeight",void 0),J(this,"_videoWidth",void 0),J(this,"_forceBitrateLimit",void 0),J(this,"_enabled",!0),J(this,"_processorDestination",void 0),J(this,"_processorContext",void 0),Pn()){let{width:a,height:c}=t.getSettings();this._videoWidth=a,this._videoHeight=c}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=r,this._scalabilityMode=n,this._optimizationMode=i,this._hints=s||[],this._hints.indexOf(nr.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(function(a,c,l){let d=yt();return!(d.name!==a||!d.osVersion)&&Number(d.version)===c}(Nt.CHROME,115)&&XS().indexOf("Windows")!==-1){let a=function(c,l){if("VideoFrame"in window&&"TransformStream"in window&&Et().supportWebRTCInsertableStream){let d=new MediaStreamTrackProcessor(c),u=new MediaStreamTrackGenerator({kind:"video"}),p,f,m=Date.now(),g=()=>{y&&(clearInterval(y),y=void 0),p&&(p.close(),p=void 0),c.stop(),f=void 0,u.removeEventListener("ended",g)},y=window.setInterval(()=>{if(f&&p&&Date.now()-m>1e3)try{u.readyState==="live"?f.enqueue(p.clone()):g()}catch{g()}},1e3),v=new TransformStream({transform:(E,w)=>{u.readyState==="live"?(f=w,m=Date.now(),p===void 0?(p=E,w.enqueue(E.clone())):(w.enqueue(p),p=E)):E.close()}});return u.addEventListener("ended",g),d.readable.pipeThrough(v).pipeTo(u.writable),u}}(t);a&&(b.info("local screen video track begin to inject frame"),this._mediaStreamTrack=a)}r&&this._hints.indexOf(nr.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(r),this._processorContext=new kQ(this.getTrackId(),"local"),this._processorDestination=new NQ(this.processorContext),this.bindProcessorDestinationEvents()}play(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="string"){let i=document.getElementById(t);i?t=i:(b.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}b.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));let n=sr(sr(sr({},this._getDefaultPlayerConfig()),r),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(n):(t instanceof HTMLVideoElement?this._player=new WD(n):this._player=new FQ(n),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{let i=this.getVideoElementVisibleStatus();this.safeEmit(am.VIDEO_ELEMENT_VISIBLE_STATUS,i)}catch{}},D("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,b.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(t,r){if(!r){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(b.info("[".concat(this.getTrackId(),"] start setEnabled"),t),!t){this._originMediaStreamTrack.enabled=!1;try{await Wt(this,fe.NEED_DISABLE_TRACK,this)}catch(n){throw b.error("[".concat(this.getTrackId(),"] setEnabled to false error"),n.toString()),n}return r||(this._enabled=!1),void b.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await Wt(this,fe.NEED_ENABLE_TRACK,this)}catch(n){throw b.error("[".concat(this.getTrackId(),"] setEnabled to true error"),n.toString()),n}b.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}async setMuted(t){t!==this._muted&&(this.stateCheck("muted",t),this._muted=t,this._originMediaStreamTrack.enabled=!t,b.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(t)),t?await Wt(this,fe.NEED_MUTE_TRACK,this):await Wt(this,fe.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(t,r){if(!this._enabled)throw new X(I.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(t=lc(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),t.width||t.height||t.frameRate){let n=ew({encoderConfig:t});(Pn()||Ei()||Js())&&(n.deviceId=void 0),b.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(n));try{await this._originMediaStreamTrack.applyConstraints(n),this.updateMediaStreamTrackResolution()}catch(i){let o=new X(I.UNEXPECTED_ERROR,i.toString());throw b.error("[".concat(this.getTrackId(),"] applyConstraints error"),o.toString()),o}}this._encoderConfig=t,this._hints.indexOf(nr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Wt(this,fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(n){return n.throw(b)}}getStats(){return Nd(()=>{b.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),is(this,fe.GET_STATS)||sr({},$O)}async setBeautyEffect(t){b.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(t,r):await HD(t)}async setBitrateLimit(t){if(b.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(t))),t){this._forceBitrateLimit=t,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<t.max_bitrate?this._encoderConfig.bitrateMax:t.max_bitrate:this._encoderConfig.bitrateMax=t.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=t.min_bitrate);try{await Wt(this,fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(b)}}}async setOptimizationMode(t){if(t!=="motion"&&t!=="detail"&&t!=="balanced")return void b.error(I.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");let r=this._optimizationMode;try{this._optimizationMode=t,await Wt(this,fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(n){throw this._optimizationMode=r,b.error("[".concat(this.getTrackId(),"] set optimization mode failed"),n.toString()),n}b.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(t,")"))}setScalabiltyMode(t){if(t.numSpatialLayers===1&&t.numTemporalLayers!==1)return b.error(I.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=t,b.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(t,")"))}updateMediaStreamTrackResolution(){LQ(this._originMediaStreamTrack).then(t=>{let[r,n]=t;this._videoHeight=n,this._videoWidth=r}).catch(eT)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(t){if(!this._enabled)throw new X(I.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");b.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(t)),t=lc(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),this._encoderConfig=t,this._hints.indexOf(nr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Wt(this,fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(b)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;let{width:t,height:r,frameRate:n}=this.getMediaStreamTrackSettings();if(!t||!r||!n)return;let{bitrateMax:i,bitrateMin:o}=this._encoderConfig;if(o==null||i==null){let{max:s,min:a}=function(c,l,d,u,p){let f=D("BITRATE_ADAPTER_TYPE");if(f==="DEFAULT_BITRATE")return{min:u,max:p};if(p===void 0){var m;let y=Math.floor(200*Math.pow(d/15,.6)*Math.pow(c*l/640/360,.75));p=f==="STANDARD_BITRATE"?4*y:2*y,u=(m=u)!==null&&m!==void 0?m:y}else{var g;u=(g=u)!==null&&g!==void 0?g:Math.floor(p/10)}return{min:u,max:p}}(t,r,n,o,i);this._encoderConfig.bitrateMin=a,this._encoderConfig.bitrateMax=s,b.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(t,", h: ").concat(r,", fps: ").concat(n,"] => [brMax: ").concat(s,", brMin: ").concat(a,"]"))}}getVideoElementVisibleStatus(){try{var t,r;let n=this==null||(t=this._player)===null||t===void 0?void 0:t.getContainerElement(),i={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:n==null?void 0:n.parentElement},{element:o,slot:s}=i;if(this.isPlaying&&o instanceof HTMLVideoElement&&s instanceof HTMLElement){let a=qJ.checkOneElementVisible(o),c=Object.assign({},a);if(c.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=c.visible;let l=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});c.visible?l.onSuccess("Video is visible"):l.onSuccess("Invisible because of ".concat(c.reason))}return c}return}catch(n){throw new X(I.GET_VIDEO_ELEMENT_VISIBLE_ERROR,n.message)}}async renewMediaStreamTrack(t){}pipe(t){if(this.processor===t)return t;if(t._source)throw new X(I.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;let t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],n=this._encoderConfig;t&&(n=sr(sr({},n),lc(t))),n=Su(n);let i=qt(8,"track-video-cloned-"),o=new VQ(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,n,Su(this._scalabilityMode),this._optimizationMode,i,Su(this._hints));return t&&n&&o.setEncoderConfiguration(n),b.debug("clone video track from ".concat(this.getTrackId()," to ").concat(i,", clone ").concat(r)),o}async replaceTrack(t,r){if(!(t instanceof MediaStreamTrack))throw new X(I.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(t.kind!=="video")throw new X(I.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(t,r,!0),this.updateMediaStreamTrackResolution()}sendSeiData(t){if(Nd(()=>{_e.reportApiInvoke(null,{name:Gr.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:Er.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!D("ENABLE_VIDEO_SEI")||!D("ENABLE_ENCODED_TRANSFORM"))return void b.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(t instanceof Uint8Array==0)return new X(I.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();let r=this.getRTCRtpTransceiver();if(!r)return void b.warning("Video track is not published, SEI can not be send");let n=r.sender.getParameters();if(n.codecs.length===0)return;let i=n.codecs[0].mimeType.toLocaleLowerCase();i==="video/h264"?this.safeEmit("sei-to-send",t):b.warning("SEI is not supported by ".concat(i))}bindProcessorDestinationEvents(){this.processorDestination.on(_i.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(),await Wt(this,fe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Wt(this,fe.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(_i.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Uo.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Uo.REQUEST_CONSTRAINTS)}},mt(ht.prototype,"play",[_V,bV],Object.getOwnPropertyDescriptor(ht.prototype,"play"),ht.prototype),mt(ht.prototype,"stop",[wV],Object.getOwnPropertyDescriptor(ht.prototype,"stop"),ht.prototype),mt(ht.prototype,"setEnabled",[SV,TV,CV],Object.getOwnPropertyDescriptor(ht.prototype,"setEnabled"),ht.prototype),mt(ht.prototype,"setMuted",[RV,IV,AV],Object.getOwnPropertyDescriptor(ht.prototype,"setMuted"),ht.prototype),mt(ht.prototype,"setEncoderConfiguration",[xV,OV],Object.getOwnPropertyDescriptor(ht.prototype,"setEncoderConfiguration"),ht.prototype),mt(ht.prototype,"getStats",[NV],Object.getOwnPropertyDescriptor(ht.prototype,"getStats"),ht.prototype),mt(ht.prototype,"setBeautyEffect",[kV,PV],Object.getOwnPropertyDescriptor(ht.prototype,"setBeautyEffect"),ht.prototype),mt(ht.prototype,"getCurrentFrameData",[DV],Object.getOwnPropertyDescriptor(ht.prototype,"getCurrentFrameData"),ht.prototype),mt(ht.prototype,"getCurrentFrameImage",[LV],Object.getOwnPropertyDescriptor(ht.prototype,"getCurrentFrameImage"),ht.prototype),mt(ht.prototype,"setBitrateLimit",[MV],Object.getOwnPropertyDescriptor(ht.prototype,"setBitrateLimit"),ht.prototype),mt(ht.prototype,"setOptimizationMode",[jV],Object.getOwnPropertyDescriptor(ht.prototype,"setOptimizationMode"),ht.prototype),mt(ht.prototype,"setScalabiltyMode",[UV],Object.getOwnPropertyDescriptor(ht.prototype,"setScalabiltyMode"),ht.prototype),mt(ht.prototype,"updateMediaStreamTrackResolution",[FV],Object.getOwnPropertyDescriptor(ht.prototype,"updateMediaStreamTrackResolution"),ht.prototype),mt(ht.prototype,"pipe",[VV],Object.getOwnPropertyDescriptor(ht.prototype,"pipe"),ht.prototype),mt(ht.prototype,"unpipe",[BV],Object.getOwnPropertyDescriptor(ht.prototype,"unpipe"),ht.prototype),mt(ht.prototype,"close",[$V],Object.getOwnPropertyDescriptor(ht.prototype,"close"),ht.prototype),mt(ht.prototype,"replaceTrack",[HV],Object.getOwnPropertyDescriptor(ht.prototype,"replaceTrack"),ht.prototype),ht),GO=(WV=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),GV=Ar(),zV=Rf("CameraVideoTrack","_enabledMutex"),KV=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),qV=Ar(),YV=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),XV=Ar(),JV=Oe({argsMap:e=>[e.getTrackId()]}),vo=class BQ extends Qt{get __className__(){return"CameraVideoTrack"}constructor(t,r,n,i,o,s){super(t,lc(r.encoderConfig),i,o,s),J(this,"_config",void 0),J(this,"_originalConstraints",void 0),J(this,"_constraints",void 0),J(this,"_enabled",!0),J(this,"_deviceName","default"),J(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(Cf()||OO())&&!function(){let a=yt();if(a.os!==sn.IOS||!a.osVersion)return!1;let c=a.osVersion.split(".");return Number(c[0])===15&&Number(c[1])>=2}()&&GJ()&&this._enabled&&!this._isClosed&&(b.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=r,this._originalConstraints=n,this._constraints=n,this._deviceName=t.label,this._encoderConfig=lc(this._config.encoderConfig),Ut.on(bn.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),Ut.on(bn.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(t){return typeof t=="string"?this._setDeviceById(t):t.deviceId?this._setDeviceById(t.deviceId):t.facingMode?this._setDeviceByFacingModel(t.facingMode):void 0}async _setDeviceById(t){if(b.info("[".concat(this.getTrackId(),"] set device to ").concat(t)),this._enabled)try{let r=await Oo.getDeviceById(t),n={};n.video=sr({},this._constraints),n.video.deviceId={exact:t},n.video.facingMode=void 0,this._originMediaStreamTrack.stop();let i=null;try{i=await Ro(n,this.getTrackId())}catch(o){throw b.error("[".concat(this.getTrackId(),"] setDevice failed"),o.toString()),i=await Ro({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),o}await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=r.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(r){throw b.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{let r=await Oo.getDeviceById(t);this._deviceName=r.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(r){throw b.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}b.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(t){b.info("[".concat(this.getTrackId(),"] set facingMode ").concat(t));let r={video:sr(sr({},this._constraints),{},{deviceId:void 0,facingMode:{exact:t}})};if(this._enabled){this._originMediaStreamTrack.stop();let n=null;try{n=await Ro(r,this.getTrackId())}catch(i){throw b.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),i.toString()),n=await Ro({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(n.getVideoTracks()[0],!1),i}await this._updateOriginMediaStreamTrack(n.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=t,this._config.cameraId=void 0,this._constraints=sr({},r.video),b.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(t,r){if(!r){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(b.info("[".concat(this.getTrackId(),"] start setEnabled"),t),t){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{let n=await Ro({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(n.getVideoTracks()[0],!1)}await Wt(this,fe.NEED_ENABLE_TRACK,this)}catch(n){throw b.error("[".concat(this.getTrackId(),"] setEnabled true error"),n.toString()),n}this.updateMediaStreamTrackResolution(),b.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),r||(this._enabled=!1);try{await Wt(this,fe.NEED_DISABLE_TRACK,this)}catch(n){throw b.error("[".concat(this.getTrackId(),"] setEnabled to false error"),n.toString()),n}b.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(t,r){if(!this._enabled)throw new X(I.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");t=lc(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate||t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate||t.bitrateMin);let n=kr(this._config);n.encoderConfig=t;let i=ew(n);(Pn()||Ei()||Js())&&(i.deviceId=void 0),b.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(i));try{await this._originMediaStreamTrack.applyConstraints(i),this.updateMediaStreamTrackResolution()}catch(o){let s=new X(I.UNEXPECTED_ERROR,o.toString());throw b.error("[".concat(this.getTrackId(),"] applyConstraints error"),s.toString()),s}this._config=n,this._constraints=i,this._originalConstraints=i,this._encoderConfig=t,this._hints.indexOf(nr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Wt(this,fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(o){return o.throw(b)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Ei()||Js())&&this._enabled&&!this._isClosed&&Ut.duringInterruption){let t=async()=>{Ut.off(bn.IOS_INTERRUPTION_END,t),this._enabled&&!this._isClosed&&(b.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};Ut.on(bn.IOS_INTERRUPTION_END,t)}else b.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(am.TRACK_ENDED)}async renewMediaStreamTrack(t){let r=t||this._constraints,n=Oo.searchDeviceIdByName(this._deviceName);if(n&&!r.deviceId&&(r.deviceId={exact:n}),this._enabled){let i=await Ro({video:r},this.getTrackId());this._constraints=r,await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),Ut.off(bn.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),Ut.off(bn.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],n=this._encoderConfig;t&&(n=sr(sr({},n),lc(t))),n=Su(n);let i=qt(8,"track-cam-cloned-"),o=new BQ(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,Su(sr(sr({},this._config),{},{encoderConfig:n})),Su(this._constraints),Su(this._scalabilityMode),this._optimizationMode,i);return t&&n&&o.setEncoderConfiguration(n),b.debug("clone track from ".concat(this.getTrackId()," to ").concat(i,", clone ").concat(r)),o}bindProcessorContextEvents(){this.processorContext.on(Uo.REQUEST_UPDATE_CONSTRAINTS,async(t,r,n)=>{try{let i=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(i),r()}catch(i){n(i)}}),this.processorContext.on(Uo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}},mt(vo.prototype,"setDevice",[WV,GV],Object.getOwnPropertyDescriptor(vo.prototype,"setDevice"),vo.prototype),mt(vo.prototype,"setEnabled",[zV,KV,qV],Object.getOwnPropertyDescriptor(vo.prototype,"setEnabled"),vo.prototype),mt(vo.prototype,"setEncoderConfiguration",[YV,XV],Object.getOwnPropertyDescriptor(vo.prototype,"setEncoderConfiguration"),vo.prototype),mt(vo.prototype,"close",[JV],Object.getOwnPropertyDescriptor(vo.prototype,"close"),vo.prototype),vo);function II(e,t,r,n){r.optimizationMode&&(n&&n.width&&n.height?(r.encoderConfig=sr(sr({},n),{},{bitrateMin:n.bitrateMin,bitrateMax:n.bitrateMax}),r.optimizationMode!=="motion"&&r.optimizationMode!=="detail"||(t.contentHint=r.optimizationMode,t.contentHint===r.optimizationMode?b.debug("[".concat(e,"] set content hint to"),r.optimizationMode):b.debug("[".concat(e,"] set content hint failed")))):b.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var QV,ZV,eB,tB,zo,rB,nB,iB,oB,sB,aB,ri,$Q=class extends bQ{getUserId(){return this._userId}constructor(e,t,r,n){super(e,"track-".concat(e.kind,"-").concat(t,"-").concat(n.clientId,"_").concat(qt(5,""))),J(this,"_userId",void 0),J(this,"_uintId",void 0),J(this,"_isDestroyed",!1),J(this,"store",void 0),J(this,"processor",void 0),J(this,"processorContext",void 0),this._userId=t,this._uintId=r,this.store=n}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,b.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}},Xp=(QV=Oe({argsMap:(e,t,r)=>[e.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),ZV=Oe({argsMap:e=>[e.getTrackId()]}),eB=Oe({argsMap:(e,t)=>[e.getTrackId(),t.name]}),tB=Oe({argsMap:e=>[e.getTrackId()]}),mt((zo=class extends $Q{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==si.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,t,r,n){super(e,t,r,n),J(this,"_videoVisibleTimer",null),J(this,"_previousVideoVisibleStatus",void 0),J(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),J(this,"trackMediaType",cm.VIDEO),J(this,"_videoWidth",void 0),J(this,"_videoHeight",void 0),J(this,"_player",void 0),J(this,"processorDestination",void 0),J(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new kQ(this.getTrackId(),"remote"),this.processorDestination=new NQ(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return Nd(()=>{b.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),is(this,fe.GET_STATS)||sr({},_Q)}play(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string"){let n=document.getElementById(e);n?e=n:(b.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}b.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));let r=sr(sr({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(r):(e instanceof HTMLVideoElement?this._player=new WD(r):this._player=new FQ(r),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Yp.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=n=>{this.safeEmit(Yp.VIDEO_STATE_CHANGED,n)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{let n=this.getVideoElementVisibleStatus();this.safeEmit(Yp.VIDEO_ELEMENT_VISIBLE_STATUS,n)}catch{}},D("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,b.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){LQ(this._originMediaStreamTrack).then(e=>{let[t,r]=e;this._videoHeight=r,this._videoWidth=t}).catch(eT)}_updatePlayerSource(){b.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;let r=this==null||(e=this._player)===null||e===void 0?void 0:e.getContainerElement(),n={track:this,element:this==null||(t=this._player)===null||t===void 0?void 0:t.getVideoElement(),slot:r==null?void 0:r.parentElement},{element:i,slot:o}=n;if(this.isPlaying&&i instanceof HTMLVideoElement&&o instanceof HTMLElement){let s=qJ.checkOneElementVisible(i),a=Object.assign({},s);if(a.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=a.visible;let c=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});a.visible?c.onSuccess("Video is visible"):c.onSuccess("Invisible because of ".concat(a.reason))}return a}return}catch(r){throw new X(I.GET_VIDEO_ELEMENT_VISIBLE_ERROR,r.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new X(I.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;let e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(_i.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(_i.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(Vu.SEI_RECEIVED,e)}}).prototype,"play",[QV],Object.getOwnPropertyDescriptor(zo.prototype,"play"),zo.prototype),mt(zo.prototype,"stop",[ZV],Object.getOwnPropertyDescriptor(zo.prototype,"stop"),zo.prototype),mt(zo.prototype,"pipe",[eB],Object.getOwnPropertyDescriptor(zo.prototype,"pipe"),zo.prototype),mt(zo.prototype,"unpipe",[tB],Object.getOwnPropertyDescriptor(zo.prototype,"unpipe"),zo.prototype),zo),Jp=(rB=Oe({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),nB=Oe({argsMap:(e,t)=>[e.getTrackId(),t]}),iB=Oe({argsMap:e=>[e.getTrackId()]}),oB=Oe({argsMap:e=>[e.getTrackId()]}),sB=Oe({argsMap:(e,t)=>[e.getTrackId(),t.name]}),aB=Oe({argsMap:e=>[e.getTrackId()]}),mt((ri=class extends $Q{get isPlaying(){return this._useAudioElement?Ni.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,t,r,n){super(e,t,r,n),J(this,"trackMediaType",cm.AUDIO),J(this,"_source",void 0),J(this,"_useAudioElement",!0),J(this,"_volume",100),J(this,"processorContext",void 0),J(this,"processorDestination",void 0),J(this,"_played",!1),J(this,"_bypassWebAudio",!1),D("DISABLE_WEBAUDIO")?(this._source=new WO,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new TQ(e,!0),D("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(Ao.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Yp.FIRST_FRAME_DECODED)}),this.processorContext=new DQ(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new PQ(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(Ao.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Ao.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Ao.ON_AUDIO_BUFFER),this._source.on(Ao.ON_AUDIO_BUFFER,r=>e(r))}setVolume(e){this._volume=e,this._useAudioElement?Ni.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!vQ())throw new X(I.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Ni.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Nd(()=>{b.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),is(this,fe.GET_STATS)||sr({},EQ)}play(){b.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(b.debug("[".concat(this.getTrackId(),"] use audio element to play")),Ni.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){b.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?Ni.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];b.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Ni.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new X(I.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new X(I.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new X(I.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;let t=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(_i.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(_i.ON_NODE,e=>{this._source.processedNode=e;let t=!e;this._useAudioElement!==t&&(this._played?(this.stop(),this._useAudioElement=t,this.play()):this._useAudioElement=t)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(_i.ON_TRACK),this.processorDestination.removeAllListeners(_i.ON_NODE)}}).prototype,"setVolume",[rB],Object.getOwnPropertyDescriptor(ri.prototype,"setVolume"),ri.prototype),mt(ri.prototype,"setPlaybackDevice",[nB],Object.getOwnPropertyDescriptor(ri.prototype,"setPlaybackDevice"),ri.prototype),mt(ri.prototype,"play",[iB],Object.getOwnPropertyDescriptor(ri.prototype,"play"),ri.prototype),mt(ri.prototype,"stop",[oB],Object.getOwnPropertyDescriptor(ri.prototype,"stop"),ri.prototype),mt(ri.prototype,"pipe",[sB],Object.getOwnPropertyDescriptor(ri.prototype,"pipe"),ri.prototype),mt(ri.prototype,"unpipe",[aB],Object.getOwnPropertyDescriptor(ri.prototype,"unpipe"),ri.prototype),ri),Fc=new class extends fr{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),J(this,"_lastHiddenTime",0),J(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),b.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}},HQ=class extends fr{constructor(e,t){super(),J(this,"trackMediaType",cm.DATA),J(this,"_version",1),J(this,"_type",3),J(this,"_config",void 0),J(this,"_originDataChannel",void 0),J(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),J(this,"_dataStreamPacketHandler",{serialize:r=>r,deserialize:r=>r}),J(this,"_datachannelEventMap",new Map),this._config=e,t&&(this._originDataChannel=t,this._bandDataChannelEvents(t)),this._initPacketHeader()}useDataStream(e){this._dataStreamPacketHandler=e}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return D("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var e,t;return(e=(t=this._originDataChannel)===null||t===void 0?void 0:t.readyState)!==null&&e!==void 0?e:"connecting"}get _originDataChannelId(){var e,t;return(e=(t=this._originDataChannel)===null||t===void 0?void 0:t.id)!==null&&e!==void 0?e:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new de((e,t)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&e();let r=setTimeout(()=>{var n;t(new X(I.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((n=this._originDataChannel)===null||n===void 0?void 0:n.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(r),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),e()},this._originDataChannel.onerror=()=>{throw clearTimeout(r),new X(I.DATACHANNEL_CONNECTION_TIMEOUT)}}else t(new X(I.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(e){this._originDataChannel=e,this._bandDataChannelEvents(e)}_initPacketHeader(){let e=new DataView(this._dataStreamPacketHeader);e.setUint16(0,this._version),e.setUint8(2,this._type),e.setUint8(3,this._config.id)}_bandDataChannelEvents(e){this._unbindDataChannelEvents(e),[m_.OPEN,m_.CLOSE,m_.ERROR].forEach(t=>{let r=()=>{this.emit(t)};this._datachannelEventMap.set(t,r),e.addEventListener(t,r)})}_unbindDataChannelEvents(e){Array.from(this._datachannelEventMap.entries()).forEach(t=>{let[r,n]=t;e.removeEventListener(r,n)}),this._datachannelEventMap.clear()}},nMe=class extends HQ{constructor(e){super(e),J(this,"_messageListener",void 0),this._messageListener=t=>{if(t.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);let r=t.data.slice(0,this._dataStreamPacketHeader.byteLength),n=new DataView(r).getUint8(3);if(n!==this.id)return void(D("SHOW_DATASTREAM2_LOG")&&b.debug("invalid datachannel id: ".concat(n," !== ").concat(this.id)));let i=t.data.slice(this._dataStreamPacketHeader.byteLength);i=this._dataStreamPacketHandler.deserialize(i),this.emit(m_.MESSAGE,i)}}_updateOriginDataChannel(e){super._updateOriginDataChannel(e),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}},iMe=class extends HQ{send(e){if(this._originDataChannel){let t=e;t=this._dataStreamPacketHandler.serialize(e);let r=new Uint8Array(this._dataStreamPacketHeader.byteLength+t.byteLength);r.set(new Uint8Array(this._dataStreamPacketHeader),0),r.set(new Uint8Array(t),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(r.buffer)}}};function y_(){let e=new Blob([atob("ZnVuY3Rpb24gZShlLHQsbil7bGV0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0LG4pLGE9W10sbz0wO2Zvcig7YS5sZW5ndGg8bjspbyszPG4mJjA9PT1yW29dJiYwPT09cltvKzFdJiYzPT09cltvKzJdJiYoMD09PXJbbyszXXx8MT09PXJbbyszXXx8Mj09PXJbbyszXXx8Mz09PXJbbyszXSk/KGEucHVzaChyW29dLHJbbysxXSxyW28rM10pLG8rPTQpOihhLnB1c2gocltvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYSl9ZnVuY3Rpb24gdChlLHQpe2NvbnN0IG49ZnVuY3Rpb24oZSl7Y29uc3QgdD1lLmxlbmd0aDtsZXQgbj1bXSxyPTA7Zm9yKDtyPHQ7KXIrMjx0JiYwPT09ZVtyXSYmMD09PWVbcisxXSYmKDA9PT1lW3IrMl18fDE9PT1lW3IrMl18fDI9PT1lW3IrMl18fDM9PT1lW3IrMl0pPyhuLnB1c2goZVtyXSxlW3IrMV0sMyxlW3IrMl0pLHIrPTMpOihuLnB1c2goZVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KHQpLHI9bi5sZW5ndGgsYT1NYXRoLmZsb29yKHIvMjU1KSxvPXIlMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNithKzErcitlLmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8YTspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1vLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkoZSksNitpK3IpLHMuYnVmZmVyfW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiU2FmYXJpIik+LTEmJi0xPT09bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJDaHJvbWUiKSYmKHNlbGYub25ydGN0cmFuc2Zvcm09bj0+e2NvbnN0IHI9bi50cmFuc2Zvcm1lcjtsZXQgYT1bXTtyLm9wdGlvbnMucG9ydC5vbm1lc3NhZ2U9ZT0+e2UuZGF0YS5zZWkmJmEucHVzaChlLmRhdGEuc2VpKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IG89ci5yZWFkYWJsZS5nZXRSZWFkZXIoKSxzPXIud3JpdGFibGUuZ2V0V3JpdGVyKCk7InJ4Ij09PXIub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1mdW5jdGlvbih0KXtjb25zdCBuPW5ldyBEYXRhVmlldyh0LmRhdGEpO2xldCByPTA7Zm9yKDtyKzQ8dC5kYXRhLmJ5dGVMZW5ndGg7KXtpZigwPT09bi5nZXRVaW50OChyKzApJiYwPT09bi5nZXRVaW50OChyKzEpJiYwPT09bi5nZXRVaW50OChyKzIpJiYxPT09bi5nZXRVaW50OChyKzMpJiY2PT09bi5nZXRVaW50OChyKzQpKXtsZXQgYT1yKzYsbz0wLHM9MDtmb3IoOzI1NT09PShzPW4uZ2V0VWludDgoYSsrKSk7KW8rPTI1NTtvKz1zO2NvbnN0IGk9ZSh0LmRhdGEsYSxvKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoaSl9cisrfXJldHVybiBudWxsfShyLnZhbHVlKTt0JiZuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7c2VpOnR9KX1zLndyaXRlKHIudmFsdWUpLG4ub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQobil9fSkpfShyKToidHgiPT09ci5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIGUobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgZT1hLnNoaWZ0KCk7ZSYmKHIudmFsdWUuZGF0YT10KHIudmFsdWUuZGF0YSxlKSl9cy53cml0ZShyLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0ocil9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKSk7Cg==")],{type:"text/javascript"});return setTimeout(()=>xF.revokeObjectURL(e),0),new Worker(xF.createObjectURL(e))}var uE=new Map,hE=new Map;function oMe(e,t,r){let n=new Uint8Array(e,t,r),i=[],o=0;for(;i.length<r;)o+3<r&&n[o]===0&&n[o+1]===0&&n[o+2]===3&&(n[o+3]===0||n[o+3]===1||n[o+3]===2||n[o+3]===3)?(i.push(n[o],n[o+1],n[o+3]),o+=4):(i.push(n[o]),o++);return new Uint8Array(i)}var pE=new Map;async function sMe(e,t){if(!Et().supportWebRTCEncodedTransform)return void b.warning("browser not support video encoded transform");if(pE.has(e)||!e.track)return;let r={track:e.track};if(vd()){if(!e.createEncodedStreams)return void b.warning("browser not support createEncodedStreams() API");let i=null;try{i=e.createEncodedStreams()}catch(a){return void b.error("create video-encoded-streams error",a&&a.message)}let o=[];t.on("sei-to-send",a=>{o.push(a)});let s=new TransformStream({transform(a,c){r.controller||(r.controller=c),e.track&&e.track.id!==r.track.id&&(b.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",n),r.track=e.track,r.track.addEventListener("ended",n));let l=o.shift();l&&(a.data=function(d,u){let p=function(E){let w=E.length,S=[],A=0;for(;A<w;)A+2<w&&E[A]===0&&E[A+1]===0&&(E[A+2]===0||E[A+2]===1||E[A+2]===2||E[A+2]===3)?(S.push(E[A],E[A+1],3,E[A+2]),A+=3):(S.push(E[A]),A++);return new Uint8Array(S)}(u),f=p.length,m=Math.floor(f/255),g=f%255,y=new Uint8Array(6+m+1+f+d.byteLength);y[0]=0,y[1]=0,y[2]=0,y[3]=1,y[4]=6,y[5]=101;let v=0;for(;v<m;)y[6+v]=255,v++;return y[6+v]=g,v++,y.set(p,6+v),y.set(new Uint8Array(d),6+v+f),y.buffer}(a.data,l)),c.enqueue(a)}});i.readable.pipeThrough(s).pipeTo(i.writable)}else{if(!Pn())return;{if(typeof RTCRtpScriptTransform>"u")return void b.warning("browser not support RTCRtpScriptTransform");let i=y_(),o=new MessageChannel;await new de(a=>i.onmessage=c=>{c.data==="registered"&&a(void 0)});let s=new RTCRtpScriptTransform(i,{name:"tx",port:o.port2},[o.port2]);e.transform=s,await new de(a=>i.onmessage=c=>{c.data==="started"&&a(void 0)}),t.on("sei-to-send",a=>{o.port1.postMessage({sei:a})}),o.port1.onmessage=a=>{var c;a.data.transformed&&e.track&&((c=e.track)===null||c===void 0?void 0:c.id)!==r.track.id&&(b.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",n),r.track=e.track,r.track.addEventListener("ended",n))},r.worker=i}}function n(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",n)}let i=pE.get(e);if(i){pE.delete(e);try{var o,s;(o=i.controller)===null||o===void 0||o.terminate(),(s=i.worker)===null||s===void 0||s.terminate()}catch(a){b.warning(a&&a.message)}}}pE.set(e,r),e.track.addEventListener("ended",n)}var Km=new Map;(function(){let e=yt();yn.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),yn.getStreamFromExtension=e.name===Nt.CHROME&&Number(e.version)>34,yn.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t=new RTCPeerConnection,r=!1;try{t.addTransceiver("audio"),r=!0}catch{}return t.close(),r}(),yn.supportMinBitrate=e.name===Nt.CHROME||e.name===Nt.EDGE,yn.supportSetRtpSenderParameters=function(){let t=yt();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!Od()||!(!Pn()&&!Xb())||t.name===Nt.FIREFOX&&Number(t.version)>=64)}(),e.name===Nt.SAFARI&&(Number(e.version)>=14?yn.supportDualStream=!0:yn.supportDualStream=!1),yn.webAudioMediaStreamDest=function(){let t=yt();return!(t.name===Nt.SAFARI&&Number(t.version)<12)}(),yn.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",yn.supportWebGL=typeof WebGLRenderingContext<"u",yn.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Od()||(yn.webAudioWithAEC=!0),yn.supportShareAudio=function(){let t=yt();return(t.os===sn.WIN_10||t.os===sn.WIN_81||t.os===sn.WIN_7||t.os===sn.LINUX||t.os===sn.MAC_OS||t.os===sn.CHROMIUM_OS)&&t.name===Nt.CHROME&&Number(t.version)>=74}(),yn.supportDataChannel=!!(xO(76)||function(t){let r=yt();return!(r.name!==Nt.FIREFOX||!r.osVersion)&&Number(r.version)>=t}(68)||$J(14)),yn.supportPCSetConfiguration=function(){let t=window.RTCPeerConnection;return!_r()&&!!t&&t.prototype.setConfiguration instanceof Function}(),yn.supportWebRTCEncodedTransform=function(){let t=yt();return t.name==="Chrome"&&Number(t.version)>=86||t.name==="Safari"&&Number(t.version)>=15}(),yn.supportWebRTCInsertableStream=function(){let t=yt();return(t.name===Nt.CHROME||t.name===Nt.EDGE)&&Number(t.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),yn.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,yn.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,ZS(()=>{yn.supportDualStreamEncoding=function(){let t=yt();return!!D("DISABLE_WEBAUDIO")||t.name==="Safari"&&Number(t.version)>=14||!!(t.name==="Chrome"&&/Windows/i.test(t.os||"")&&Number(t.version)>=100&&D("CHROME_DUAL_STREAM_USE_ENCODING"))}(),b.info("browser compatibility",JSON.stringify(yn),JSON.stringify(e))})})();var rw=class zO extends fr{constructor(t,r){super(),C(this,"signal",void 0),C(this,"token",void 0),C(this,"tokenTimeout",void 0),C(this,"tokenInterval",void 0),C(this,"_sequence",0),C(this,"userMap",new Map),C(this,"encoder",new TextEncoder),this.signal=t,this.token=r;let n=()=>{this.signal.connectionState===Kt.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(n,1e3):this.tokenInterval=window.setTimeout(n,3*D("P2P_TOKEN_INTERVAL"))};n()}async send(t,r,n,i,o){var s,a,c;if(this.userMap.size===0)return;let l=Array.from(il(s=this.userMap).call(s))[0].token;typeof r!="string"&&(r=JSON.stringify(r)),i=(a=i)!==null&&a!==void 0?a:qt(6,""),o=(c=o)!==null&&c!==void 0?c:this._sequence++;let d={_id:i,_type:t,_seq:o,_message:r,token:"".concat(this.token,"_").concat(l)};D("SHOW_P2P_LOG")&&b.debug("send message",d,"noNeedResponse : ".concat(n)),this.splitMessage(JSON.stringify(d)).forEach(p=>{this.signal.request(Me.DATA_STREAM,{payload:Ed(this.encoder.encode(p))})});let u=new de((p,f)=>{let m=window.setTimeout(()=>{this.off("res-@".concat(i,"_ack"),g),this.off("res-@".concat(i),v),this.off(Gh.ABORT,y),b.debug("[external-signal] request timeout, type: ".concat(t,", requestId: ").concat(i)),this.userMap.size===0?f(new X(I.INVALID_REMOTE_USER)):f(new X(I.TIMEOUT))},D("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),g=()=>{m&&window.clearTimeout(m),this.off(Gh.ABORT,y),n&&p()},y=()=>{m&&window.clearTimeout(m),this.off("res-@".concat(i,"_ack"),g),this.off("res-@".concat(i),v),f(new X(I.EXTERNAL_SIGNAL_ABORT,"type: ".concat(t,", requestId: ").concat(i)))};this.once(Gh.ABORT,y),this.once("res-@".concat(i,"_ack"),g);let v=(w,S)=>{E=!0,m&&window.clearTimeout(m),this.off("res-@".concat(i,"_ack"),g),this.off(Gh.ABORT,y),w==="success"?p(S):f(new X(I.P2P_MESSAGE_FAILED,"request ".concat(t," failed, requestId: ").concat(i)))},E=!1;n||(this.once("res-@".concat(i),v),Tn(D("SIGNAL_REQUEST_TIMEOUT")).then(()=>{E||b.warning("external_signal request timeout, type: ".concat(t,", requestId: ").concat(i,", ").concat(d))}))});try{return await u}catch(p){if(p.code===I.TIMEOUT)return await this.send(t,r,n,i,o);throw p}}onMessage(t){var r;let{_uid:n}=t,i,o=this.userMap.get(n);if(o)i=o.splitMessageMap;else{if(this.userMap.size>0||!("_type"in t)||t._type!==Cr.CHECK)return;let{token:l}=t;i=new Map,o={uid:n,isStart:!0,token:l,splitMessageMap:i,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(n,o),this.signal.emit(ct.ON_USER_ONLINE,{uid:n}),this.handleUserOnline()}if("id"in t&&"total"in t){var s;let{id:l,total:d}=t,u=(s=i.get(l))!==null&&s!==void 0?s:[];if(u.push(t),i.has(l)||i.set(l,u),u.length!==d)return;{let p=Vy(u).call(u,(f,m)=>f.index-m.index).map(f=>f.payload).join("");i.delete(l),(t=JSON.parse(p))._uid=n}}let{_type:a,token:c}=t;if(pe(r=[Cr.ACK,Cr.CHECK]).call(r,a))return a===Cr.CHECK&&this.handleCheckToken(o,c),void this.receiveMessage(t);c==="".concat(o.token,"_").concat(this.token)?this.handleReceivedMessage(t):b.debug('Receive unexpected message", '.concat(c,", cur_token: ").concat(o.token,"_").concat(this.token),t)}check(){let t={_id:qt(6,""),token:this.token,_type:Cr.CHECK};D("SHOW_P2P_LOG")&&b.debug("send message",t),this.signal.request(Me.DATA_STREAM,{payload:Ed(this.encoder.encode(JSON.stringify(t)))})}ack(t){let r={_id:t,_type:Cr.ACK,token:this.token};D("SHOW_P2P_LOG")&&b.debug("send message",r),this.signal.request(Me.DATA_STREAM,{payload:Ed(this.encoder.encode(JSON.stringify(r)))})}response(t,r,n){this.send(Cr.RESPONSE,JSON.stringify({success:!n,message:r}),!0,t)}handleReceivedMessage(t){let r=()=>{this.userMap.forEach(l=>{let{receivedMessagesMap:d,nextExpectedSequenceNumber:u}=l;for(;d.has(u);){let p=d.get(u);d.delete(u),this.receiveMessage(p),l.nextExpectedSequenceNumber++}})};if(!t)return void r();let{_uid:n,_seq:i}=t,o=this.userMap.get(n),{receivedMessagesMap:s,isStart:a,nextExpectedSequenceNumber:c}=o;if(i<c)return this.ack(t._id),void b.debug("[external-signal] receive old message, seq: ".concat(i,", ").concat(t._message));s.set(i,t),a&&i===c&&(this.receiveMessage(t),s.delete(c),o.nextExpectedSequenceNumber++,r())}receiveMessage(t){let{_id:r,_type:n,_message:i,_uid:o}=t;if(D("SHOW_P2P_LOG")&&b.debug("receive message",t),r){let s;switch(t._type!==Cr.ACK&&(i&&(s=JSON.parse(i)),this.ack(t._id)),t._type){case Cr.CANDIDATE:case Cr.CONTROL:this.signal.emit(n,s,o);break;case Cr.PUBLISH:case Cr.UNPUBLISH:case Cr.RESTART_ICE:case Cr.CALL:s.uid=o,Dn(this.signal,n,s).then(a=>{this.response(t._id,a)}).catch(()=>{this.response(t._id,void 0,!0)});break;case Cr.ACK:this.getListeners("res-@".concat(r,"_ack")).length>0&&this.emit("res-@".concat(r,"_ack"));break;case Cr.RESPONSE:{let{success:a,message:c}=s;this.emit("res-@".concat(r),a?"success":"failed",c);break}}}}splitMessage(t){if(t.length<zO.MAX_MESSAGE_SIZE)return[t];let r=[],{remoteToken:n}=JSON.parse(t),i=qt(6,""),o=0,s=800,a=Math.ceil(t.length/s);for(;t.length>0;){o++;let c={id:i,index:o,total:a,payload:t.slice(0,s),token:"".concat(this.token,"_").concat(n)};JSON.stringify(c).length>zO.MAX_MESSAGE_SIZE?s-=50:(r.push(c),t=t.slice(s))}return r.map(c=>JSON.stringify(c))}handleCheckToken(t,r){return t.token!==r?(b.debug("token changed, from ".concat(t.token," to ").concat(r)),this.reset(t.uid,r),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{b.debug("token timeout, ".concat(r)),this.reset(t.uid)},D("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){let t=await Dn(this.signal,Cr.CALL,void 0),r=await this.send(Cr.CALL,t);this.signal.emit(je.P2P_CONNECTION,r,!0)}async reset(t,r){let n=this.userMap.get(t);n&&(this.emit(Gh.ABORT),this.signal.emit(ct.ON_USER_OFFLINE,{uid:n.uid,reason:w2e.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),r||(b.debug("change local token from ".concat(r," to ").concat(r)),this.token=qt(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(Gh.ABORT)}};C(rw,"MAX_SIZE",1),C(rw,"MAX_MESSAGE_SIZE",1024);var cB=class extends fr{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===Kt.CONNECTED?this.emit(je.WS_CONNECTED):e===Kt.RECONNECTING?this.emit(je.WS_RECONNECTING,this._websocketReconnectReason):e===Kt.CLOSED&&this.emit(je.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),C(this,"_disconnectedReason",void 0),C(this,"_websocketReconnectReason",void 0),C(this,"_connectionState",Kt.CLOSED),C(this,"reconnectToken",void 0),C(this,"p2pToken",void 0),C(this,"websocket",void 0),C(this,"openConnectionTime",void 0),C(this,"clientId",void 0),C(this,"lastMsgTime",Date.now()),C(this,"uploadCache",[]),C(this,"uploadCacheInterval",void 0),C(this,"rttRolling",new eQ(5)),C(this,"pingpongTimer",void 0),C(this,"pingpongTimeoutCount",0),C(this,"joinResponse",void 0),C(this,"multiIpOption",void 0),C(this,"initError",void 0),C(this,"spec",void 0),C(this,"store",void 0),C(this,"_external_signal",void 0),C(this,"onWebsocketMessage",r=>{if(r.data instanceof ArrayBuffer)return void this.emit(je.ON_BINARY_DATA,r.data);let n=JSON.parse(r.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(n,"_id")){let i="res-@".concat(n._id);this.emit(i,n._result,n._message)}else if(Object.prototype.hasOwnProperty.call(n,"_type")){switch(n._type){case ct.ON_DATA_STREAM:return void this.handleDataStream(n._message);case ct.MUTE_AUDIO:case ct.MUTE_VIDEO:case ct.ON_P2P_LOST:case ct.ON_USER_ONLINE:return;case ct.ON_USER_OFFLINE:let{uid:i}=n._message;return b.debug("[".concat(this.clientId,"] user-offline uid: ").concat(i)),void this._external_signal.reset(i)}if(this.emit(n._type,n._message),n._type===ct.ON_NOTIFICATION&&this.handleNotification(n._message),n._type===ct.ON_USER_BANNED)switch(n._message.error_code){case 14:this.close(Mt.UID_BANNED);break;case 15:this.close(Mt.IP_BANNED);break;case 16:this.close(Mt.CHANNEL_BANNED)}if(n._type===ct.ON_USER_LICENSE_BANNED)switch(n._message.error_code){case xe.ERR_LICENSE_MISSING:this.close(Mt.LICENSE_MISSING);break;case xe.ERR_LICENSE_EXPIRED:this.close(Mt.LICENSE_EXPIRED);break;case xe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Mt.LICENSE_MINUTES_EXCEEDED);break;case xe.ERR_LICENSE_PERIOD_INVALID:this.close(Mt.LICENSE_PERIOD_INVALID);break;case xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Mt.LICENSE_MULTIPLE_SDK_SERVICE);break;case xe.ERR_LICENSE_ILLEGAL:this.close(Mt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new MD("gateway-".concat(this.clientId),this.spec.retryConfig,!0,D("JOIN_GATEWAY_USE_DUAL_DOMAIN"),D("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Kt.CONNECTED&&this.reconnect("retry",kn.OFFLINE)}),this.p2pToken=qt(6,""),this._external_signal=new rw(this,this.p2pToken)}async request(e,t,r,n){let i=qt(6,""),o={_id:i,_type:e,_message:t},s=this.websocket.connectionID,a=()=>new de((f,m)=>{if(this.connectionState===Kt.CONNECTED)return f();let g=()=>{this.off(je.WS_CLOSED,y),f()},y=()=>{this.off(je.WS_CONNECTED,g),m(new X(I.WS_ABORT))};this.once(je.WS_CONNECTED,g),this.once(je.WS_CLOSED,y)});if(this.connectionState!==Kt.CONNECTING&&this.connectionState!==Kt.RECONNECTING||e===Me.JOIN||e===Me.REJOIN||await a(),this.websocket.sendMessage(o,!0),n)return;let c=new de((f,m)=>{let g=!1,y=(E,w)=>{g=!0,f({isSuccess:E==="success",message:w||{}}),this.off(je.WS_CLOSED,v),this.off(je.WS_RECONNECTING,v),this.emit(je.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(i),y);let v=()=>{m(new X(I.WS_ABORT,"type: ".concat(e))),this.off(je.WS_CLOSED,v),this.off(je.WS_RECONNECTING,v),this.off("res-@".concat(i),y)};this.once(je.WS_CLOSED,v),this.once(je.WS_RECONNECTING,v),Tn(D("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==s||g||(b.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(je.REQUEST_TIMEOUT,e,t))})}),l=null;try{l=await c}catch(f){if(this.connectionState===Kt.CLOSED||e===Me.LEAVE)throw new X(I.WS_ABORT);return!this.spec.forceWaitGatewayResponse||r?f.throw():e===Me.JOIN||e===Me.REJOIN?null:(await a(),await this.request(e,t))}if(l.isSuccess)return l.message;let d=Number(l.message.error_code||l.message.code),u=F0(d),p=new X(I.UNEXPECTED_RESPONSE,"".concat(u.desc,": ").concat(l.message.error_str),{code:d,data:l.message,desc:u.desc});return u.action==="success"?l.message:(b.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(u.desc,", action: ").concat(u.action)),d===xe.ERR_TOO_MANY_BROADCASTERS?((e===Me.JOIN||e===Me.REJOIN)&&(this.initError=p,this.close()),p.throw()):u.action==="failed"?p.throw():u.action==="quit"?(this.initError=p,this.close(),p.throw()):(d===xe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,b.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",kn.MULTI_IP)):this.reconnect(u.action,kn.SERVER_ERROR),e===Me.JOIN||e===Me.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new de(r=>{let n=i=>{(!t||t(i))&&(this.off(e,n),r(i))};this.on(e,n)})}uploadWRTCStats(e){if(!this.store.sessionId)return void b.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));let t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(U0.WRTC_STATS,t)}upload(e,t){let r={_type:e,_message:t};try{this.websocket.sendMessage(r)}catch{let n=D("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(r),this.uploadCache.length>n&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Kt.CONNECTED)return;let i=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(i._type,i._message)},D("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){let r={_type:e,_message:t};this.websocket.sendMessage(r)}async sendExtensionMessage(e,t,r){return await this._external_signal.send(e,t,r)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new de((t,r)=>{this.once(je.WS_CONNECTED,()=>t(this.joinResponse)),this.once(je.WS_CLOSED,()=>r(this.initError||new X(I.WS_ABORT))),this.connectionState=Kt.CONNECTING,this.websocket.init(e).catch(r)})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=e||Mt.LEAVE,this.connectionState=Kt.CLOSED,b.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=qt(6,""),this._external_signal.clear(),this._external_signal=new rw(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(je.ABORT_P2P_EXECUTION);let e=await Dn(this,je.REQUEST_JOIN_INFO),t=await this.request(Me.JOIN,e);if(!t)return this.emit(je.REPORT_JOIN_GATEWAY,I.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(je.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Kt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleDataStream(e){try{var t;let r=Tu(e.payload),n=new TextDecoder().decode(r),i=JSON.parse(n);"total"in i&&"id"in i||pe(t=Object.values(Cr)).call(t,i._type)?(i._uid=e.uid,this._external_signal.onMessage(i)):this.emit(ct.ON_DATA_STREAM,e)}catch{this.emit(ct.ON_DATA_STREAM,e)}}handleNotification(e){b.debug("[".concat(this.clientId,"] receive notification: "),e);let t=F0(e.code);if(t.action!=="success"){if(t.action!=="failed")return t.action==="quit"?(t.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Mt.UID_BANNED),void this.close()):void this.reconnect(t.action,kn.SERVER_ERROR);b.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;let e=D("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(b.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>D("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",kn.TIMEOUT):this.request(Me.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;let r=Date.now()-t;this.rttRolling.add(r),D("REPORT_STATS")&&this.send(Me.PING_BACK,{pingpongElapse:r})}).catch(r=>{})}handleWebsocketEvents(){this.websocket.on(Fe.RECONNECT_WAITTING_FINISH,e=>{this.emit(je.WS_RECONNECT_WAITTING_FINISH,e)}),this.websocket.on(Fe.RECONNECT_CREATE_CONNECTION,e=>{this.emit(je.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(Fe.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Fe.CLOSED,()=>{this.connectionState=Kt.CLOSED}),this.websocket.on(Fe.FAILED,()=>{this._disconnectedReason=Mt.NETWORK_ERROR,this.connectionState=Kt.CLOSED}),this.websocket.on(Fe.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===Kt.CONNECTED?this.connectionState=Kt.RECONNECTING:this.connectionState=Kt.CONNECTING}),this.websocket.on(Fe.WILL_RECONNECT,(e,t,r)=>{e!=="retry"?(b.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0):b.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),r(e)}),this.websocket.on(Fe.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(e=>{if(this.emit(je.REPORT_JOIN_GATEWAY,e,this.url||""),e instanceof X&&e.code===I.UNEXPECTED_RESPONSE&&e.data.code===xe.ERR_NO_AUTHORIZED)return b.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",kn.SERVER_ERROR);b.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",kn.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(Fe.REQUEST_NEW_URLS,(e,t)=>{Dn(this,je.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)}),this.websocket.on(Fe.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ct.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}},WQ={exports:{}};WQ.exports=(()=>{var e={8:(n,i,o)=>{o.r(i),o.d(i,{Parser:()=>W,Printer:()=>H,parse:()=>O,print:()=>F});let s=`
`,a="".concat("\r").concat(s),c=" ",l;function d(P){return P>="0"&&P<="9"}function u(P){return P>="!"&&P<="~"}function p(P){return u(P)||P>=""&&P<="ÿ"}function f(P){return P==="!"||P>="#"&&P<="'"||P>="*"&&P<="+"||P>="-"&&P<="."||P>="0"&&P<="9"||P>="A"&&P<="Z"||P>="^"&&P<="~"}function m(P){return P>="1"&&P<="9"}function g(P){return P>="A"&&P<="Z"||P>="a"&&P<="z"}function y(P){return P==="d"||P==="h"||P==="m"||P==="s"}function v(P){return P>""&&P<"	"||P>"\v"&&P<"\f"||P>""&&P<"ÿ"}function E(P){return g(P)||d(P)||P==="+"||P==="/"}function w(P){return d(P)||g(P)||P==="+"||P==="/"||P==="-"||P==="_"}function S(P){return g(P)||d(P)||P==="+"||P==="/"}function A(P,_){var R=Object.keys(P);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(P);_&&(k=k.filter(function(z){return Object.getOwnPropertyDescriptor(P,z).enumerable})),R.push.apply(R,k)}return R}function N(P){for(var _=1;_<arguments.length;_++){var R=arguments[_]!=null?arguments[_]:{};_%2?A(Object(R),!0).forEach(function(k){L(P,k,R[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(R)):A(Object(R)).forEach(function(k){Object.defineProperty(P,k,Object.getOwnPropertyDescriptor(R,k))})}return P}function L(P,_,R){return _ in P?Object.defineProperty(P,_,{value:R,enumerable:!0,configurable:!0,writable:!0}):P[_]=R,P}(function(P){P.VERSION="v",P.ORIGIN="o",P.SESSION_NAME="s",P.INFORMATION="i",P.URI="u",P.EMAIL="e",P.PHONE="p",P.CONNECTION="c",P.BANDWIDTH="b",P.TIME="t",P.REPEAT="r",P.ZONE_ADJUSTMENTS="z",P.KEY="k",P.ATTRIBUTE="a",P.MEDIA="m"})(l||(l={}));class j{consumeText(_,R){let k=R;for(;k<_.length;){let z=_[k];if(z==="\0"||z==="\r"||z===s)break;k+=1}if(k-R==0)throw new Error("Invalid text, at ".concat(_));return k}consumeUnicastAddress(_,R,k){return this.consumeTill(_,R,c)}consumeOneOrMore(_,R,k){let z=R;for(;k(_[z]);)z++;if(z-R==0)throw new Error("Invalid rule at ".concat(R,"."));return z}consumeSpace(_,R){if(_[R]===c)return R+1;throw new Error("Invalid space at ".concat(R,"."))}consumeIP4Address(_,R){let k=R;for(let z=0;z<4;z++)if(k=this.consumeDecimalUChar(_,k),z!==3){if(_[k]!==".")throw new Error("Invalid IP4 address.");k++}return k}consumeDecimalUChar(_,R){let k=R;for(let U=0;U<3&&d(_[k]);U++,k++);if(k-R==0)throw new Error("Invalid decimal uchar.");let z=parseInt(_.slice(R,k));if(z>=0&&z<=255)return k;throw new Error("Invalid decimal uchar")}consumeIP6Address(_,R){let k=this.consumeHexpart(_,R);return _[k]===":"&&(k+=1,k=this.consumeIP4Address(_,k)),k}consumeHexpart(_,R){let k=R;if(_[k]===":"&&_[k+1]===":"){k+=2;try{k=this.consumeHexseq(_,k)}catch{}return k}if(k=this.consumeHexseq(_,k),_[k]===":"&&_[k+1]===":"){k+=2;try{k=this.consumeHexseq(_,k)}catch{}return k}return k}consumeHexseq(_,R){let k=R;for(;k=this.consumeHex4(_,k),_[k]===":"&&_[k+1]!==":";)k+=1;return k}consumeHex4(_,R){let k=0;for(;k<4;k++)if(!((z=_[R+k])>="0"&&z<="9"||z>="a"&&z<="f"||z>="A"&&z<="F")){if(k===0)throw new Error("Invalid hex 4");break}var z;return R+k}consumeFQDN(_,R){let k=R;for(;d(_[k])||g(_[k])||_[k]==="-"||_[k]===".";)k+=1;if(k-R<4)throw new Error("Invalid FQDN");return k}consumeExtnAddr(_,R){return this.consumeOneOrMore(_,R,p)}consumeMulticastAddress(_,R,k){switch(k){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(_,R);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(_,R);default:try{return this.consumeFQDN(_,R)}catch{return this.consumeExtnAddr(_,R)}}}consumeIP6MulticastAddress(_,R){let k=this.consumeHexpart(_,R);return _[k]==="/"?this.consumeInteger(_,k+1):k}consumeIP4MulticastAddress(_,R){let k=R+3,z=_.slice(R,k),U=parseInt(z);if(U<224||U>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let q=0;q<3;q++){if(_[k]!==".")throw new Error("Invalid IP4 multicast address.");k+=1,k=this.consumeDecimalUChar(_,k)}return _[k]==="/"&&(k+=1),k=this.consumeTTL(_,k),_[k]==="/"&&(k=this.consumeInteger(_,k)),k}consumeInteger(_,R){if(!m(_[R]))throw new Error("Invalid integer.");for(R+=1;d(_[R]);)R+=1;return R}consumeTTL(_,R){if(_[R]==="0")return R+1;if(!m(_[R]))throw new Error("Invalid TTL.");R+=1;for(let k=0;k<2&&d(_[R]);k++)R+=1;return R}consumeToken(_,R){return this.consumeOneOrMore(_,R,f)}consumeTime(_,R){let k=R;if(_[k]==="0")return k+1;for(m(_[k])&&(k+=1);d(_[k]);)k++;if(k-R<10)throw new Error("Invalid time");return k}consumeAddress(_,R){return this.consumeTill(_,R,c)}consumeTypedTime(_,R){let k=R;return k=this.consumeOneOrMore(_,k,d),y(_[k])?k+1:k}consumeRepeatInterval(_,R){if(!m(_[R]))throw new Error("Invalid repeat interval");for(R+=1;d(_[R]);)R+=1;return y(_[R])&&(R+=1),R}consumePort(_,R){return this.consumeOneOrMore(_,R,d)}consume(_,R,k){for(let z=0;z<k.length;z++){if(R+z>=_.length)throw new Error("consume exceeding value length");if(_[R+z]!==k[z])throw new Error("consume ".concat(k," failed at ").concat(z))}return R+k.length}consumeTill(_,R,k){let z=R;for(;z<_.length&&(typeof k!="string"||_[z]!==k)&&(typeof k!="function"||!k(_[z]));)z++;return z}}class W extends j{constructor(){super(),L(this,"records",[]),L(this,"currentLine",0)}parse(_){let R=this.probeEOL(_);this.records=_.split(R).filter(_t=>!!ci(_t).call(_t)).map(this.parseLine),this.currentLine=0;let k=this.parseVersion(),z=this.parseOrigin(),U=this.parseSessionName(),q=this.parseInformation(),ie=this.parseUri(),ue=this.parseEmail(),me=this.parsePhone(),De=this.parseConnection(),He=this.parseBandWidth(),Pe=this.parseTimeFields(),nt=this.parseKey(),Rt=this.parseSessionAttribute(),Ye=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:k,origin:z,sessionName:U,information:q,uri:ie,emails:ue,phones:me,connection:De,bandwidths:He,timeFields:Pe,key:nt,attributes:Rt,mediaDescriptions:Ye}}getCurrentRecord(){let _=this.records[this.currentLine];if(!_)throw new Error("Record doesn't exit.");return _}probeEOL(_){for(let R=0;R<_.length;R++)if(_[R]===s)return _[R-1]==="\r"?a:s;throw new Error("Invalid newline character.")}parseLine(_,R){if(_.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");let k=_[0];if(_[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:k,value:_.slice(2),line:R,cur:0}}parseSessionAttribute(){let _=new Y;for(;this.currentLine<this.records.length;){let R=this.getCurrentRecord();if(R.type!==l.ATTRIBUTE)break;let k={attField:this.extractOneOrMore(R,z=>f(z)&&z!==":"),_cur:0};R.value[R.cur]===":"&&(R.cur+=1,k.attValue=this.extractOneOrMore(R,v)),_.parse(k),this.currentLine++}return _.digest()}parseMediaAttributes(_){let R=new Z(_);for(;this.currentLine<this.records.length;){let k=this.getCurrentRecord();if(k.type!==l.ATTRIBUTE)break;let z={attField:this.extractOneOrMore(k,U=>f(U)&&U!==":"),_cur:0};k.value[k.cur]===":"&&(k.cur+=1,z.attValue=this.extractOneOrMore(k,v)),R.parse(z),this.currentLine++}return R.digest()}parseKey(){let _=this.getCurrentRecord();if(_.type===l.KEY){if(_.value==="prompt"||_.value==="clear:"||_.value==="base64:"||_.value==="uri:")return _.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){let _=this.getCurrentRecord();if(_.type===l.ZONE_ADJUSTMENTS){let R=[];for(;;)try{let k=this.extract(_,this.consumeTime);this.consumeSpaceForRecord(_);let z=!1;_.value[_.cur]==="-"&&(z=!0,_.cur+=1);let U=this.extract(_,this.consumeTypedTime);R.push({time:k,typedTime:U,back:z})}catch{break}if(R.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,R}return[]}parseRepeat(){let _=[];for(;;){let R=this.getCurrentRecord();if(R.type!==l.REPEAT)break;{let k=this.extract(R,this.consumeRepeatInterval),z=this.parseTypedTime(R);_.push({repeatInterval:k,typedTimes:z}),this.currentLine++}}return _}parseTypedTime(_){let R=[];for(;;)try{this.consumeSpaceForRecord(_),R.push(this.extract(_,this.consumeTypedTime))}catch{break}if(R.length===0)throw new Error("Invalid typed time.");return R}parseTime(){let _=this.getCurrentRecord(),R=this.extract(_,this.consumeTime);this.consumeSpaceForRecord(_);let k=this.extract(_,this.consumeTime);return this.currentLine++,{startTime:R,stopTime:k}}parseBandWidth(){let _=[];for(;this.currentLine<this.records.length;){let R=this.getCurrentRecord();if(R.type!==l.BANDWIDTH)break;{let k=this.extractOneOrMore(R,f);if(R.value[R.cur]!==":")throw new Error("Invalid bandwidth field.");R.cur++;let z=this.extractOneOrMore(R,d);_.push({bwtype:k,bandwidth:z}),this.currentLine++}}return _}parseVersion(){let _=this.getCurrentRecord();if(_.type!==l.VERSION)throw new Error("first sdp record must be version");let R=_.value.slice(0,this.consumeOneOrMore(_.value,0,d));if(R.length!==_.value.length)throw new Error('invalid proto version, "v='.concat(_.value,'"'));return this.currentLine++,R}parseOrigin(){let _=this.getCurrentRecord();if(_.type!==l.ORIGIN)throw new Error("second line of sdp must be origin");let R=this.extractOneOrMore(_,p);this.consumeSpaceForRecord(_);let k=this.extractOneOrMore(_,d);this.consumeSpaceForRecord(_);let z=this.extractOneOrMore(_,d);this.consumeSpaceForRecord(_);let U=this.extractOneOrMore(_,f);this.consumeSpaceForRecord(_);let q=this.extractOneOrMore(_,f);this.consumeSpaceForRecord(_);let ie=this.extract(_,this.consumeUnicastAddress);return this.currentLine++,{username:R,sessId:k,sessVersion:z,nettype:U,addrtype:q,unicastAddress:ie}}parseSessionName(){let _=this.getCurrentRecord();if(_.type===l.SESSION_NAME){let R=this.extract(_,this.consumeText);return this.currentLine++,R}}parseInformation(){let _=this.getCurrentRecord();if(_.type!==l.INFORMATION)return;let R=this.extract(_,this.consumeText);return this.currentLine++,R}parseUri(){let _=this.getCurrentRecord();if(_.type===l.URI)return this.currentLine++,_.value}parseEmail(){let _=[];for(;;){let R=this.getCurrentRecord();if(R.type!==l.EMAIL)break;_.push(R.value),this.currentLine++}return _}parsePhone(){let _=[];for(;;){let R=this.getCurrentRecord();if(R.type!==l.PHONE)break;_.push(R.value),this.currentLine++}return _}parseConnection(){let _=this.getCurrentRecord();if(_.type===l.CONNECTION){let R=this.extractOneOrMore(_,f);this.consumeSpaceForRecord(_);let k=this.extractOneOrMore(_,f);this.consumeSpaceForRecord(_);let z=this.extract(_,this.consumeAddress);return this.currentLine++,{nettype:R,addrtype:k,address:z}}}parseMedia(){let _=this.getCurrentRecord(),R=this.extract(_,this.consumeToken);this.consumeSpaceForRecord(_);let k=this.extract(_,this.consumePort);_.value[_.cur]==="/"&&(_.cur+=1,k+=this.extract(_,this.consumeInteger)),this.consumeSpaceForRecord(_);let z=[];for(z.push(this.extract(_,this.consumeToken));_.value[_.cur]==="/";)_.cur+=1,z.push(this.extract(_,this.consumeToken));if(z.length===0)throw new Error("Invalid proto");let U=this.parseFmt(_);return this.currentLine++,{mediaType:R,port:k,protos:z,fmts:U}}parseTimeFields(){let _=[];for(;this.getCurrentRecord().type===l.TIME;){let R=this.parseTime(),k=this.parseRepeat(),z=this.parseZone();_.push({time:R,repeats:k,zones:z})}return _}parseMediaDescription(){let _=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===l.MEDIA;){let R=this.parseMedia(),k=this.parseInformation(),z=this.parseConnections(),U=this.parseBandWidth(),q=this.parseKey(),ie=this.parseMediaAttributes(R);_.push({media:R,information:k,connections:z,bandwidths:U,key:q,attributes:ie})}return _}parseConnections(){let _=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===l.CONNECTION;)_.push(this.parseConnection());return _}parseFmt(_){let R=[];for(;;)try{this.consumeSpaceForRecord(_),R.push(this.extract(_,this.consumeToken))}catch{break}if(R.length===0)throw new Error("Invalid fmts");return R}extract(_,R){for(var k=arguments.length,z=new Array(k>2?k-2:0),U=2;U<k;U++)z[U-2]=arguments[U];let q=R.call(this,_.value,_.cur,...z),ie=_.value.slice(_.cur,q);return _.cur=q,ie}extractOneOrMore(_,R){let k=this.consumeOneOrMore(_.value,_.cur,R),z=_.value.slice(_.cur,k);return _.cur=k,z}consumeSpaceForRecord(_){if(_.value[_.cur]!==c)throw new Error("Invalid space at ".concat(_.cur,"."));_.cur+=1}}class V extends j{constructor(){super(...arguments),L(this,"attributes",void 0),L(this,"digested",!1)}extractOneOrMore(_,R,k){let z=this.consumeOneOrMore(_.attValue,_._cur,R),U=_.attValue.slice(_._cur,z),[q,ie]=k||[];if(typeof q=="number"&&U.length<q)throw new Error("error in length, should be more or equal than ".concat(q," characters."));if(typeof ie=="number"&&U.length>ie)throw new Error("error in length, should be less or equal than ".concat(ie," characters."));return _._cur=z,U}consumeAttributeSpace(_){if(_.attValue[_._cur]!==c)throw new Error("Invalid space at ".concat(_._cur,"."));_._cur+=1}extract(_,R){if(!_.attValue)throw new Error("Nothing to extract from attValue.");for(var k=arguments.length,z=new Array(k>2?k-2:0),U=2;U<k;U++)z[U-2]=arguments[U];let q=R.call(this,_.attValue,_._cur,...z),ie=_.attValue.slice(_._cur,q);return _._cur=q,ie}atEnd(_){if(!_.attValue)throw new Error;return _._cur>=_.attValue.length}peekChar(_){if(!_.attValue)throw new Error;return _.attValue[_._cur]}peek(_,R){if(!_.attValue)throw new Error;for(let k=0;k<R.length;k++)if(R[k]!==_.attValue[_._cur+k])return!1;return!0}parseIceUfrag(_){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(_,E,[4,256])}parseIcePwd(_){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(_,E,[22,256])}parseIceOptions(_){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");let R=[];for(;!this.atEnd(_);){R.push(this.extractOneOrMore(_,E));try{this.consumeAttributeSpace(_)}catch(k){if(this.atEnd(_))break;throw k}}this.attributes.iceOptions=R}parseFingerprint(_){let R=this.extract(_,this.consumeToken);this.consumeAttributeSpace(_);let k=this.extract(_,this.consumeTill);this.attributes.fingerprints.push({hashFunction:R,fingerprint:k})}parseExtmap(_){let R=this.extractOneOrMore(_,d),k;this.peekChar(_)==="/"&&(this.extract(_,this.consume,"/"),k=this.extract(_,this.consumeToken)),this.consumeAttributeSpace(_);let z=this.extract(_,this.consumeTill,c),U=N(N({entry:parseInt(R,10)},k&&{direction:k}),{},{extensionName:z});this.peekChar(_)===c&&(this.consumeAttributeSpace(_),U.extensionAttributes=this.extract(_,this.consumeTill)),this.attributes.extmaps.push(U)}parseSetup(_){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");let R=this.extract(_,this.consumeTill);if(R!=="active"&&R!=="passive"&&R!=="actpass"&&R!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=R}}class Y extends V{constructor(){super(...arguments),L(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(_){if(this.digested)throw new Error("already digested");try{switch(_.attField){case"group":this.parseGroup(_);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(_);break;case"ice-pwd":this.parseIcePwd(_);break;case"ice-options":this.parseIceOptions(_);break;case"fingerprint":this.parseFingerprint(_);break;case"setup":this.parseSetup(_);break;case"tls-id":this.parseTlsId(_);break;case"identity":this.parseIdentity(_);break;case"extmap":this.parseExtmap(_);break;case"msid-semantic":this.parseMsidSemantic(_);break;default:_.ignored=!0,this.attributes.unrecognized.push(_)}}catch(R){throw console.error("parsing session attribute ".concat(_.attField,' error, "a=').concat(_.attField,":").concat(_.attValue,'"')),R}if(!_.ignored&&_.attValue&&!this.atEnd(_))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(_){let R=this.extract(_,this.consumeToken),k=[];for(;!this.atEnd(_)&&this.peekChar(_)===c;)this.consumeAttributeSpace(_),k.push(this.extract(_,this.consumeToken));this.attributes.groups.push({semantic:R,identificationTag:k})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(_){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(_,w)}parseIdentity(_){let R=this.extractOneOrMore(_,S),k=[];for(;!this.atEnd(_)&&this.peekChar(_)===c;){this.consumeAttributeSpace(_);let z=this.extract(_,this.consumeToken);this.extract(_,this.consume,"=");let U=this.extractOneOrMore(_,q=>q!==c&&v(q));k.push({name:z,value:U})}this.attributes.identities.push({assertionValue:R,extensions:k})}parseMsidSemantic(_){this.peekChar(_)===c&&this.consumeAttributeSpace(_);let R={semantic:this.extract(_,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(_)}catch{break}if(this.peekChar(_)==="*"){this.extract(_,this.consume,"*"),R.applyForAll=!0;break}{let k=this.extract(_,this.consumeTill,c);R.identifierList.push(k)}}this.attributes.msidSemantic=R}}class Z extends V{constructor(_){super(),L(this,"attributes",void 0),_.protos.indexOf("RTP")!==-1||_.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(_){if(this.digested)throw new Error("already digested");try{switch(_.attField){case"extmap":this.parseExtmap(_);break;case"setup":this.parseSetup(_);break;case"ice-ufrag":this.parseIceUfrag(_);break;case"ice-pwd":this.parseIcePwd(_);break;case"ice-options":this.parseIceOptions(_);break;case"candidate":this.parseCandidate(_);break;case"remote-candidate":this.parseRemoteCandidate(_);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(_);break;case"rtpmap":this.parseRtpmap(_);break;case"ptime":this.parsePtime(_);break;case"maxptime":this.parseMaxPtime(_);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(_);break;case"ssrc":this.parseSSRC(_);break;case"fmtp":this.parseFmtp(_);break;case"rtcp-fb":this.parseRtcpFb(_);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(_);break;case"mid":this.parseMid(_);break;case"msid":this.parseMsid(_);break;case"imageattr":this.parseImageAttr(_);break;case"rid":this.parseRid(_);break;case"simulcast":this.parseSimulcast(_);break;case"sctp-port":this.parseSctpPort(_);break;case"max-message-size":this.parseMaxMessageSize(_);break;case"ssrc-group":this.parseSSRCGroup(_);break;default:_.ignored=!0,this.attributes.unrecognized.push(_)}}catch(R){throw console.error("parsing media attribute ".concat(_.attField,' error, "a=').concat(_.attField,":").concat(_.attValue,'"')),R}if(!_.ignored&&_.attValue&&!this.atEnd(_))throw new Error("attribute parsing error")}parseCandidate(_){let R=this.extractOneOrMore(_,E,[1,32]);this.consumeAttributeSpace(_);let k=this.extractOneOrMore(_,d,[1,5]);this.consumeAttributeSpace(_);let z=this.extract(_,this.consumeToken);this.consumeAttributeSpace(_);let U=this.extractOneOrMore(_,d,[1,10]);this.consumeAttributeSpace(_);let q=this.extract(_,this.consumeAddress);this.consumeAttributeSpace(_);let ie=this.extract(_,this.consumePort);this.consumeAttributeSpace(_),this.extract(_,this.consume,"typ"),this.consumeAttributeSpace(_);let ue={foundation:R,componentId:k,transport:z,priority:U,connectionAddress:q,port:ie,type:this.extract(_,this.consumeToken),extension:{}};for(this.peek(_," raddr")&&(this.extract(_,this.consume," raddr"),this.consumeAttributeSpace(_),ue.relAddr=this.extract(_,this.consumeAddress)),this.peek(_," rport")&&(this.extract(_,this.consume," rport"),this.consumeAttributeSpace(_),ue.relPort=this.extract(_,this.consumePort));this.peekChar(_)===c;){this.consumeAttributeSpace(_);let me=this.extract(_,this.consumeToken);this.consumeAttributeSpace(_),ue.extension[me]=this.extractOneOrMore(_,u)}this.attributes.candidates.push(ue)}parseRemoteCandidate(_){let R=[];for(;;){let k=this.extractOneOrMore(_,d,[1,5]);this.consumeAttributeSpace(_);let z=this.extract(_,this.consumeAddress);this.consumeAttributeSpace(_);let U=this.extract(_,this.consumePort);R.push({componentId:k,connectionAddress:z,port:U});try{this.consumeAttributeSpace(_)}catch{break}}this.attributes.remoteCandidatesList.push(R)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(_){let R=this.extract(_,this.consumeToken);this.consumeAttributeSpace(_);let k=this.extract(_,this.consumeTill,"/");this.extract(_,this.consume,"/");let z={encodingName:k,clockRate:this.extractOneOrMore(_,d)};this.atEnd(_)||this.peekChar(_)!=="/"||(this.extract(_,this.consume,"/"),z.encodingParameters=parseInt(this.extract(_,this.consumeTill),10));let U=this.attributes.payloads.find(q=>q.payloadType===parseInt(R,10));U?U.rtpMap=z:this.attributes.payloads.push({payloadType:parseInt(R,10),rtpMap:z,rtcpFeedbacks:[]})}parsePtime(_){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(_,this.consumeTill)}parseMaxPtime(_){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(_,this.consumeTill)}parseDirection(_){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=_.attField}parseSSRC(_){let R=this.extractOneOrMore(_,d);this.consumeAttributeSpace(_);let k=this.extract(_,this.consumeTill,":"),z;this.peekChar(_)===":"&&(this.extract(_,this.consume,":"),z=this.extract(_,this.consumeTill));let U=this.attributes.ssrcs.find(q=>q.ssrcId===parseInt(R,10));U?U.attributes[k]=z:this.attributes.ssrcs.push({ssrcId:parseInt(R,10),attributes:{[k]:z}})}parseFmtp(_){let R=this.extract(_,this.consumeTill,c);this.consumeAttributeSpace(_);let k=this.extract(_,this.consumeTill),z={};k.split(";").forEach(q=>{let[ie,ue]=q.split("=");ie=ci(ie).call(ie);let me=typeof ue=="string"?ci(ue).call(ue):null;typeof ie=="string"&&ie.length>0&&(z[ie]=me)});let U=this.attributes.payloads.find(q=>q.payloadType===parseInt(R,10));U?U.fmtp={parameters:z}:this.attributes.payloads.push({payloadType:parseInt(R,10),rtcpFeedbacks:[],fmtp:{parameters:z}})}parseFmtParameters(_){let R={},k=this.extract(_,this.consumeTill,"=");_._cur++;let z=this.extract(_,this.consumeTill,";");for(R[k]=z;_.attValue[_._cur]===";";){let U=this.extract(_,this.consumeTill,"=");_._cur++;let q=this.extract(_,this.consumeTill,";");R[U]=q}return R}parseRtcpFb(_){let R="";R=this.peekChar(_)==="*"?this.extract(_,this.consume,"*"):this.extract(_,this.consumeTill,c),this.consumeAttributeSpace(_);let k=this.extract(_,this.consumeTill,c),z;if(k==="trr-int")z={type:k,interval:this.extract(_,this.consumeTill)};else{let U={type:k};this.peekChar(_)===c&&(this.consumeAttributeSpace(_),U.parameter=this.extract(_,this.consumeToken),this.peekChar(_)===c&&(U.additional=this.extract(_,this.consumeTill))),z=U}if(R==="*")this.attributes.rtcpFeedbackWildcards.push(z);else{let U=this.attributes.payloads.find(q=>q.payloadType===parseInt(R,10));U?U.rtcpFeedbacks.push(z):this.attributes.payloads.push({payloadType:parseInt(R,10),rtcpFeedbacks:[z]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(_){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");let R={port:this.extract(_,this.consumePort)};this.peekChar(_)===c&&(this.consumeAttributeSpace(_),R.netType=this.extractOneOrMore(_,f),this.consumeAttributeSpace(_),R.addressType=this.extractOneOrMore(_,f),this.consumeAttributeSpace(_),R.address=this.extract(_,this.consumeAddress)),this.attributes.rtcp=R}parseMsid(_){let R={id:this.extractOneOrMore(_,f,[1,64])};this.peekChar(_)===c&&(this.consumeAttributeSpace(_),R.appdata=this.extractOneOrMore(_,f,[1,64])),this.attributes.msids.push(R)}parseImageAttr(_){this.attributes.imageattr.push(_.attValue)}parseRid(_){let R=this.extractOneOrMore(_,z=>g(z)||d(z)||z==="_"||z==="-");this.consumeAttributeSpace(_);let k={id:R,direction:this.extract(_,this.consumeToken),params:[]};if(this.peekChar(_)===c){if(this.consumeAttributeSpace(_),this.peek(_,"pt=")){this.extract(_,this.consume,"pt=");let z=[];for(;;){let U=this.extract(_,this.consumeToken);z.push(U);try{this.extract(_,this.consume,",")}catch{break}}k.payloads=z,this.peekChar(_)===c&&this.extract(_,this.consume,c)}for(;;){let z=this.extract(_,this.consumeToken);switch(z){case"depend":{let U={type:z,rids:this.extract(_,this.consume,"=").split(",")};k.params.push(U);break}default:{let U={type:z};this.peekChar(_)==="="&&(this.extract(_,this.consume,"="),U.val=this.extract(_,this.consumeTill,";")),k.params.push(U)}}try{this.extract(_,this.consume,";")}catch{break}}}this.attributes.rids.push(k)}parseSimulcast(_){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=_.attValue,this.extract(_,this.consumeTill)}parseSctpPort(_){this.attributes.sctpPort=this.extractOneOrMore(_,d,[1,5])}parseMaxMessageSize(_){this.attributes.maxMessageSize=this.extractOneOrMore(_,d,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(_){this.attributes.mid=this.extract(_,this.consumeToken)}parseSSRCGroup(_){let R=this.extract(_,this.consumeToken),k=[];for(;;)try{this.consumeAttributeSpace(_);let z=this.extract(_,this.consumeInteger);k.push(parseInt(z,10))}catch{break}this.attributes.ssrcGroups.push({semantic:R,ssrcIds:k})}}function te(P,_,R){return _ in P?Object.defineProperty(P,_,{value:R,enumerable:!0,configurable:!0,writable:!0}):P[_]=R,P}class H{constructor(){te(this,"eol",a)}print(_,R){let k="";return R&&(this.eol=R),k+=this.printVersion(_.version),k+=this.printOrigin(_.origin),k+=this.printSessionName(_.sessionName),k+=this.printInformation(_.information),k+=this.printUri(_.uri),k+=this.printEmail(_.emails),k+=this.printPhone(_.phones),k+=this.printConnection(_.connection),k+=this.printBandwidth(_.bandwidths),k+=this.printTimeFields(_.timeFields),k+=this.printKey(_.key),k+=this.printSessionAttributes(_.attributes),k+=this.printMediaDescription(_.mediaDescriptions),k}printVersion(_){return"v=".concat(_).concat(this.eol)}printOrigin(_){return"o=".concat(_.username," ").concat(_.sessId," ").concat(_.sessVersion," ").concat(_.nettype," ").concat(_.addrtype," ").concat(_.unicastAddress).concat(this.eol)}printSessionName(_){return _?"s=".concat(_).concat(this.eol):""}printInformation(_){return _?"i=".concat(_).concat(this.eol):""}printUri(_){return _?"u=".concat(_).concat(this.eol):""}printEmail(_){let R="";for(let k of _)R+="e=".concat(k).concat(this.eol);return R}printPhone(_){let R="";for(let k of _)R+="e=".concat(k).concat(this.eol);return R}printConnection(_){return _?"c=".concat(_.nettype," ").concat(_.addrtype," ").concat(_.address).concat(this.eol):""}printBandwidth(_){let R="";for(let k of _)R+="b=".concat(k.bwtype,":").concat(k.bandwidth).concat(this.eol);return R}printTimeFields(_){let R="";for(let k of _){R+="t=".concat(k.time.startTime," ").concat(k.time.startTime).concat(this.eol);for(let z of k.repeats)R+="r=".concat(z.repeatInterval," ").concat(z.typedTimes.join(" ")).concat(this.eol);k.zoneAdjustments&&(R+="z=",R+="z=".concat(k.zoneAdjustments.map(z=>"".concat(z.time," ").concat(z.back?"-":""," ").concat(z.typedTime)).join(" ")).concat(this.eol),R+=this.eol)}return R}printKey(_){return _?"k=".concat(_).concat(this.eol):""}printAttributes(_){let R="";for(let k of _)R+="a=".concat(k.attField).concat(k.attValue?":".concat(k.attValue):"").concat(this.eol);return R}printMediaDescription(_){let R="";for(let k of _)R+=this.printMedia(k.media),R+=this.printInformation(k.information),R+=this.printConnections(k.connections),R+=this.printBandwidth(k.bandwidths),R+=this.printKey(k.key),R+=this.printMediaAttributes(k);return R}printConnections(_){let R="";for(let k of _)R+=this.printConnection(k);return R}printMedia(_){return"m=".concat(_.mediaType," ").concat(_.port," ").concat(_.protos.join("/")," ").concat(_.fmts.join(" ")).concat(this.eol)}printSessionAttributes(_){return new K(this.eol).print(_)}printMediaAttributes(_){return new x(this.eol).print(_)}}class ${constructor(_){te(this,"eol",void 0),this.eol=_}printIceUfrag(_){return _===void 0?"":"a=ice-ufrag:".concat(_).concat(this.eol)}printIcePwd(_){return _===void 0?"":"a=ice-pwd:".concat(_).concat(this.eol)}printIceOptions(_){return _===void 0?"":"a=ice-options:".concat(_.join(c)).concat(this.eol)}printFingerprints(_){return _.length>0?_.map(R=>"a=fingerprint:".concat(R.hashFunction).concat(c).concat(R.fingerprint)).join(this.eol)+this.eol:""}printExtmap(_){return _.map(R=>"a=extmap:".concat(R.entry).concat(R.direction?"/".concat(R.direction):"").concat(c).concat(R.extensionName).concat(R.extensionAttributes?"".concat(c).concat(R.extensionAttributes):"").concat(this.eol)).join("")}printSetup(_){return _===void 0?"":"a=setup:".concat(_).concat(this.eol)}printUnrecognized(_){return _.map(R=>"a=".concat(R.attField).concat(R.attValue?":".concat(R.attValue):"").concat(this.eol)).join("")}}class K extends ${print(_){let R="";return R+=this.printGroups(_.groups),R+=this.printMsidSemantic(_.msidSemantic),R+=this.printIceLite(_.iceLite),R+=this.printIceUfrag(_.iceUfrag),R+=this.printIcePwd(_.icePwd),R+=this.printIceOptions(_.iceOptions),R+=this.printFingerprints(_.fingerprints),R+=this.printSetup(_.setup),R+=this.printTlsId(_.tlsId),R+=this.printIdentity(_.identities),R+=this.printExtmap(_.extmaps),R+=this.printUnrecognized(_.unrecognized),R}printGroups(_){let R="";return _.length>0&&(R+=_.map(k=>"a=group:".concat(k.semantic).concat(k.identificationTag.map(z=>"".concat(c).concat(z)).join("")).concat(this.eol)).join("")),R}printIceLite(_){return _===void 0?"":"a=ice-lite"+this.eol}printTlsId(_){return _?"a=tls-id:".concat(_).concat(this.eol):""}printIdentity(_){return _.length===0?"":_.map(R=>"a=identity:".concat(R.assertionValue).concat(R.extensions.map(k=>"".concat(c).concat(k.name).concat(k.value?"=".concat(k.value):"")))).join(this.eol)+this.eol}printMsidSemantic(_){if(!_)return"";let R="a=msid-semantic:".concat(_.semantic);return _.applyForAll?R+="".concat(c,"*"):_.identifierList.length>0&&(R+=_.identifierList.map(k=>"".concat(c).concat(k))),R+this.eol}}class x extends ${print(_){let R=_.attributes,k="";return k+=this.printRTCP(R.rtcp),k+=this.printIceUfrag(R.iceUfrag),k+=this.printIcePwd(R.icePwd),k+=this.printIceOptions(R.iceOptions),k+=this.printCandidates(R.candidates),k+=this.printRemoteCandidatesList(R.remoteCandidatesList),k+=this.printEndOfCandidates(R.endOfCandidates),k+=this.printFingerprints(R.fingerprints),k+=this.printSetup(R.setup),k+=this.printMid(R.mid),k+=this.printExtmap(R.extmaps),k+=this.printRTPRelated(R),k+=this.printPtime(R.ptime),k+=this.printMaxPtime(R.maxPtime),k+=this.printDirection(R.direction),k+=this.printSSRCGroups(R.ssrcGroups),k+=this.printSSRC(R.ssrcs),k+=this.printRTCPMux(R.rtcpMux),k+=this.printRTCPMuxOnly(R.rtcpMuxOnly),k+=this.printRTCPRsize(R.rtcpRsize),k+=this.printMSId(R.msids),k+=this.printImageattr(R.imageattr),k+=this.printRid(R.rids),k+=this.printSimulcast(R.simulcast),k+=this.printSCTPPort(R.sctpPort),k+=this.printMaxMessageSize(R.maxMessageSize),k+=this.printUnrecognized(R.unrecognized),k}printCandidates(_){return _.map(R=>"a=candidate:".concat(R.foundation).concat(c).concat(R.componentId).concat(c).concat(R.transport).concat(c).concat(R.priority).concat(c).concat(R.connectionAddress).concat(c).concat(R.port).concat(c,"typ").concat(c).concat(R.type).concat(R.relAddr?"".concat(c,"raddr").concat(c).concat(R.relAddr):"").concat(R.relPort?"".concat(c,"rport").concat(c).concat(R.relPort):"").concat(Object.keys(R.extension).map(k=>"".concat(c).concat(k).concat(c).concat(R.extension[k])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(_){return _.map(R=>"a=remote-candidates:".concat(R.join(c)).concat(this.eol)).join("")}printEndOfCandidates(_){return _===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(_){if(!_.payloads)return"";let R=_.payloads,k="";k+=_.rtcpFeedbackWildcards.map(z=>this.printRTCPFeedback("*",z)).join("");for(let z of R)k+=this.printRtpMap(z.payloadType,z.rtpMap),k+=this.printFmtp(z.payloadType,z.fmtp),k+=z.rtcpFeedbacks.map(U=>this.printRTCPFeedback(z.payloadType,U)).join("");return k}printFmtp(_,R){if(!R)return"";let k=Object.keys(R.parameters);return k.length===1&&R.parameters[k[0]]===null?"a=fmtp:".concat(_).concat(c).concat(k[0]).concat(this.eol):"a=fmtp:".concat(_).concat(c).concat(Object.keys(R.parameters).map(z=>"".concat(z,"=").concat(R.parameters[z])).join(";")).concat(this.eol)}printRtpMap(_,R){return R?"a=rtpmap:".concat(_).concat(c).concat(R.encodingName,"/").concat(R.clockRate).concat(R.encodingParameters?"/".concat(R.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(_,R){let k="a=rtcp-fb:".concat(_).concat(c),z=R;return z.type==="trr-int"?k+="ttr-int".concat(c).concat(z.interval):(k+="".concat(z.type),z.parameter&&(k+="".concat(c).concat(z.parameter),z.additional&&(k+="".concat(c).concat(z.additional)))),k+this.eol}printPtime(_){return _===void 0?"":"a=ptime:".concat(_).concat(this.eol)}printMaxPtime(_){return _===void 0?"":"a=maxptime:".concat(_).concat(this.eol)}printDirection(_){return _===void 0?"":"a=".concat(_).concat(this.eol)}printSSRC(_){return _.map(R=>Object.keys(R.attributes).map(k=>"a=ssrc:".concat(R.ssrcId.toString(10)).concat(c).concat(k).concat(R.attributes[k]?":".concat(R.attributes[k]):"").concat(this.eol)).join("")).join("")}printRTCPMux(_){return _===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(_){return _===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(_){return _===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(_){if(_===void 0)return"";let R="a=rtcp:".concat(_.port);return _.netType&&(R+="".concat(c).concat(_.netType)),_.addressType&&(R+="".concat(c).concat(_.addressType)),_.address&&(R+="".concat(c).concat(_.address)),R+this.eol}printMSId(_){return _.map(R=>"a=msid:".concat(R.id).concat(R.appdata?"".concat(c).concat(R.appdata):"").concat(this.eol)).join("")}printImageattr(_){return _.map(R=>"a=imageattr:".concat(R).concat(this.eol)).join("")}printRid(_){return _.map(R=>{let k="a=rid:".concat(R.id).concat(c).concat(R.direction);return R.payloads&&(k+="".concat(c,"pt=").concat(R.payloads.join(","))),R.params.length>0&&(k+="".concat(c).concat(R.params.map(z=>z.type==="depend"?"depend=".concat(z.rids.join(",")):"".concat(z.type,"=").concat(z.val)).join(";"))),k+this.eol}).join("")}printSimulcast(_){return _===void 0?"":"a=simulcast:".concat(_).concat(this.eol)}printSCTPPort(_){return _===void 0?"":"a=sctp-port:".concat(_).concat(this.eol)}printMaxMessageSize(_){return _===void 0?"":"a=max-message-size:".concat(_).concat(this.eol)}printMid(_){return _===void 0?"":"a=mid:".concat(_).concat(this.eol)}printSSRCGroups(_){return _.map(R=>"a=ssrc-group:".concat(R.semantic).concat(R.ssrcIds.map(k=>"".concat(c).concat(k.toString(10))).join("")).concat(this.eol)).join("")}}function O(P){return new W().parse(P)}function F(P,_){return new H().print(P,_)}}},t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}return r.d=(n,i)=>{for(var o in i)r.o(i,o)&&!r.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:i[o]})},r.o=(n,i)=>Object.prototype.hasOwnProperty.call(n,i),r.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r(8)})();var wn=WQ.exports;function KO(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:D("SVC_MODE");if(D("ENABLE_SVC"))return function(t){return t in LO}(e)?e:LO.L1T3}function lB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $0(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,{filterRTX:i,filterVideoFec:o,filterAudioFec:s,filterAudioCodec:a,filterVideoCodec:c}=t,{useXR:l}=r,d=[],u=[],p=[],f=[],m=!1,g=!1;if(wn.parse(e).mediaDescriptions.forEach(v=>{n&&n!==v.attributes.direction||(v.media.mediaType!=="video"||m||(u=v.attributes.payloads,f=v.attributes.extmaps,m=!0),v.media.mediaType!=="audio"||g||(d=v.attributes.payloads,p=v.attributes.extmaps,g=!0))}),!f||u.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!p||d.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(u.forEach(v=>{var E;(E=v.rtpMap)!==null&&E!==void 0&&E.clockRate&&(v.rtpMap.clockRate=parseInt(v.rtpMap.clockRate)),l&&v.rtcpFeedbacks.push({type:"rrtr"})}),d.forEach(v=>{var E;(E=v.rtpMap)!==null&&E!==void 0&&E.clockRate&&(v.rtpMap.clockRate=parseInt(v.rtpMap.clockRate)),l&&v.rtcpFeedbacks.push({type:"rrtr"})}),i&&(d=d.filter(v=>{var E;return((E=v.rtpMap)===null||E===void 0?void 0:E.encodingName.toLowerCase())!=="rtx"}),u=u.filter(v=>{var E;return((E=v.rtpMap)===null||E===void 0?void 0:E.encodingName.toLowerCase())!=="rtx"})),o&&(u=u.filter(v=>{var E;return!/(red)|(ulpfec)|(flexfec)/i.test(((E=v.rtpMap)===null||E===void 0?void 0:E.encodingName)||"")})),s&&(d=d.filter(v=>{var E;return!/(red)|(ulpfec)|(flexfec)/i.test(((E=v.rtpMap)===null||E===void 0?void 0:E.encodingName)||"")})),a&&(a==null?void 0:a.length)>0&&(d=d.filter(v=>{var E;return pe(a).call(a,((E=v.rtpMap)===null||E===void 0?void 0:E.encodingName.toLowerCase())||"")})),c&&(c==null?void 0:c.length)>0){let v=u.filter(E=>{var w;return pe(c).call(c,((w=E.rtpMap)===null||w===void 0?void 0:w.encodingName.toLowerCase())||"")});u=v.concat(i?[]:KD(v,u))}let y=D("UNSUPPORTED_VIDEO_CODEC");return y&&y.length>0&&(u=u.filter(v=>!(v.rtpMap&&pe(y).call(y,v.rtpMap.encodingName.toLowerCase())))),{audioCodecs:d,videoCodecs:u,audioExtensions:p,videoExtensions:f}}function sd(e){let t=wn.parse(e),r,n;for(let i of t.mediaDescriptions){if(!r){let o=i.attributes.iceUfrag,s=i.attributes.icePwd;if(!o||!s)throw new Error("Cannot get iceUfrag or icePwd from SDP.");r={iceUfrag:o,icePwd:s}}if(!n){let o=i.attributes.fingerprints;o.length>0&&(n={fingerprints:o})}}if(!n&&t.attributes.fingerprints.length>0&&(n={fingerprints:t.attributes.fingerprints}),!n||!r)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:r,dtlsParameters:n}}function GQ(e,t){let r=[],n=e.attributes.ssrcGroups.filter(s=>s.semantic==="FID"),i=e.attributes.ssrcGroups.find(s=>s.semantic==="SIM"),o=e.attributes.ssrcs;if(i)i.ssrcIds.forEach(s=>{var a;let c=(a=n.find(l=>l.ssrcIds[0]===s))===null||a===void 0?void 0:a.ssrcIds[1];r.push({ssrcId:s,rtx:t?c:void 0})});else if(n.length>0){let s=n[0].ssrcIds[0],a=n[0].ssrcIds[1];r.push({ssrcId:s,rtx:t?a:void 0})}else{if(o.length===0)throw new Error("No ssrcs found on local media description.");r.push({ssrcId:o[0].ssrcId})}return r}function uB(e,t,r){let{cname:n}=e,i;t?i=zQ(t):(i=e.iceParameters.candidates.map(d=>({foundation:d.foundation,componentId:"1",transport:d.protocol,priority:d.priority.toString(),connectionAddress:d.ip,port:d.port.toString(),type:d.type,extension:{}})),b.debug("Using candidates from gateway."));let o={fingerprints:e.dtlsParameters.fingerprints.map(d=>({hashFunction:d.algorithm,fingerprint:d.fingerprint}))},s={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd},a;switch(e.dtlsParameters.role){case"server":a="passive";break;case"client":a="active";break;case"auto":a="actpass"}let c=iw(e.rtpCapabilities),l=[];return Array.isArray(r)&&r.length>0&&r.forEach(d=>{l.push({kind:we.VIDEO,ssrcId:d.v,rtx:d.v_rtx,mslabel:"".concat(d.v,"_").concat(d.a)},{kind:we.AUDIO,ssrcId:d.a,mslabel:"".concat(d.v,"_").concat(d.a)})}),{dtlsParameters:o,iceParameters:s,candidates:i,rtpCapabilities:c,setup:a,cname:n,preSSRCs:l}}function zQ(e){let t=[];return e.ip&&typeof e.port=="number"&&(t=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],b.debug("Using remote candidate from AP ".concat(e.ip,":").concat(e.port)),e.ip6&&(t.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),b.debug("Using IPV6 remote candidate from AP ".concat(e.ip6,":").concat(e.port)))),t}function fu(e,t,r){let n=[],i=[];return e.forEach(o=>{let{ssrcId:s,rtx:a}=o,c=qt(8,"track-"),l={ssrcId:s,attributes:dB({label:c,mslabel:r=r||qt(10,""),msid:"".concat(r," ").concat(c)},t&&{cname:t})};if(n.push(l),a!==void 0){let d={ssrcId:a,attributes:dB({label:c,mslabel:r,msid:"".concat(r," ").concat(c)},t&&{cname:t})};n.push(d),i.push({semantic:"FID",ssrcIds:[s,a]})}}),e.length>1&&i.push({semantic:"SIM",ssrcIds:e.map(o=>{let{ssrcId:s}=o;return s})}),{ssrcs:n,ssrcGroups:i}}function Of(e,t){t instanceof vr&&e.attributes.payloads.forEach(r=>{var n;let i=(n=r.rtpMap)===null||n===void 0?void 0:n.encodingName.toLowerCase();if(!i||["opus","pcmu","pcma","g722"].indexOf(i)===-1)return;r.fmtp||(r.fmtp={parameters:{}}),r.fmtp.parameters.minptime="10",r.fmtp.parameters.useinbandfec="1";let o=t._encoderConfig;o&&i!=="pcmu"&&i!=="pcma"&&i!=="g722"&&(o.bitrate&&!_r()&&(r.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*o.bitrate))),o.sampleRate&&(r.fmtp.parameters.maxplaybackrate="".concat(o.sampleRate),r.fmtp.parameters["sprop-maxcapturerate"]="".concat(o.sampleRate)),o.stereo&&(r.fmtp.parameters.stereo="1",r.fmtp.parameters["sprop-stereo"]="1"))})}function GD(e){let t=e.attributes.unrecognized.findIndex(r=>r.attField==="x-google-flag"&&r.attValue==="conference");t!==-1&&e.attributes.unrecognized.splice(t,1)}function zD(e,t){var r;if(!(t instanceof Qt&&t._encoderConfig&&t._hints.indexOf(nr.SCREEN_TRACK)===-1))return;let n=t._encoderConfig;Et().supportMinBitrate&&n.bitrateMin&&e.attributes.payloads.forEach(i=>{var o,s;pe(o=["h264","h265","vp8","vp9","av1"]).call(o,((s=i.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase())||"")&&(i.fmtp||(i.fmtp={parameters:{}}),i.fmtp.parameters["x-google-min-bitrate"]="".concat(n.bitrateMin))}),Et().supportMinBitrate&&!pe(r=t._hints).call(r,nr.LOW_STREAM)&&n.bitrateMax&&e.attributes.payloads.forEach(i=>{var o,s;pe(o=["h264","h265","vp8","vp9","av1"]).call(o,((s=i.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase())||"")&&(i.fmtp||(i.fmtp={parameters:{}}),i.fmtp.parameters["x-google-start-bitrate"]="".concat(D("X_GOOGLE_START_BITRATE")||Math.floor(n.bitrateMax)))})}function KQ(e){if(e.media.mediaType!=="video")return;let t=yt();if(t.name!==Nt.SAFARI&&t.os!==sn.IOS)return;let r=e.attributes.extmaps.findIndex(n=>/video-orientation/g.test(n.extensionName));r!==-1&&e.attributes.extmaps.splice(r,1)}function nw(e,t,r){if(!t)return;let n,i;if(e.media.mediaType==="video"?(n=r.videoExtensions,i=r.videoCodecs):(n=r.audioExtensions,i=r.audioCodecs),t.twcc===!0){let o=n.find(s=>s.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");o&&(e.attributes.extmaps.find(s=>s.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||e.attributes.extmaps.push({entry:o.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(s,a){return a.filter(c=>!!s.find(l=>l.payloadType===c.payloadType&&!!l.rtcpFeedbacks.find(d=>d.type==="transport-cc")))}(i,e.attributes.payloads).forEach(s=>{s.rtcpFeedbacks.find(a=>a.type==="transport-cc")||s.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(t.twcc===!1){let o=e.attributes.extmaps.findIndex(s=>s.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");o!==-1&&e.attributes.extmaps.splice(o,1),e.attributes.payloads.forEach(s=>{let a=s.rtcpFeedbacks.findIndex(c=>c.type==="transport-cc");a!==-1&&s.rtcpFeedbacks.splice(a,1)})}if(t.remb===!0){let o=n.find(s=>s.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");o&&(e.attributes.extmaps.find(s=>s.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||e.attributes.extmaps.push({entry:o.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(s,a){return a.filter(c=>!!s.find(l=>l.payloadType===c.payloadType&&!!l.rtcpFeedbacks.find(d=>d.type==="goog-remb")))}(i,e.attributes.payloads).forEach(s=>{s.rtcpFeedbacks.find(a=>a.type==="goog-remb")||s.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(t.remb===!1){let o=e.attributes.extmaps.findIndex(s=>s.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");o!==-1&&e.attributes.extmaps.splice(o,1),e.attributes.payloads.forEach(s=>{let a=s.rtcpFeedbacks.findIndex(c=>c.type==="goog-remb");a!==-1&&s.rtcpFeedbacks.splice(a,1)})}}function qQ(e,t,r){if(_r()||e.media.mediaType!=="video"||!(t instanceof Qt)||r!=="vp9"&&r!=="vp8"||r==="vp8"&&!D("SIMULCAST")||r==="vp9"&&D("ENABLE_SVC")||t._scalabilityMode===void 0||t._scalabilityMode.numSpatialLayers<=1)return;let n=r==="vp8"?2:t._scalabilityMode.numSpatialLayers,i=e.attributes.ssrcs[0],o=e.attributes.ssrcGroups.find(a=>a.semantic==="FID"&&a.ssrcIds[0]===i.ssrcId),s={semantic:"SIM",ssrcIds:[i.ssrcId]};for(let a=1;a<n;a++)e.attributes.ssrcs.push({ssrcId:i.ssrcId+a,attributes:kr(i.attributes)}),s.ssrcIds.push(i.ssrcId+a),o&&(e.attributes.ssrcs.push({ssrcId:o.ssrcIds[1]+a,attributes:kr(i.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[i.ssrcId+a,o.ssrcIds[1]+a]}));e.attributes.ssrcGroups.unshift(s)}async function YQ(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=new RTCPeerConnection;r.addTransceiver("video",{direction:"sendonly"}),r.addTransceiver("audio",{direction:"sendonly"}),r.addTransceiver("video",{direction:"recvonly"}),r.addTransceiver("audio",{direction:"recvonly"});let n=(await r.createOffer()).sdp,{send:i,recv:o,sendrecv:s}=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0,d=$0(l,a,c,"sendonly"),u=$0(l,a,c,"recvonly"),p={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},m={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(qs(d,u,"videoExtensions",p,f,m),qs(d,u,"videoCodecs",p,f,m),qs(d,u,"audioExtensions",p,f,m),qs(d,u,"audioCodecs",p,f,m),D("RAISE_H264_BASELINE_PRIORITY")){let g=m.videoCodecs.findIndex(y=>{var v,E;return((v=y.rtpMap)===null||v===void 0?void 0:v.encodingName.toLocaleLowerCase())==="h264"&&((E=y.fmtp)===null||E===void 0?void 0:E.parameters["profile-level-id"])==="42001f"});if(g!==-1){let y=m.videoCodecs.findIndex(v=>{var E;return((E=v.rtpMap)===null||E===void 0?void 0:E.encodingName.toLocaleLowerCase())==="h264"});if(y<g){b.debug("raising H264 baseline profile priority");let v=m.videoCodecs[g];m.videoCodecs.splice(g,1),m.videoCodecs.splice(y,0,v)}y!==-1&&(f.videoCodecs=f.videoCodecs.filter(v=>{var E,w;return!(((E=v.rtpMap)===null||E===void 0?void 0:E.encodingName.toLocaleLowerCase())==="h264"&&((w=v.fmtp)===null||w===void 0?void 0:w.parameters["profile-level-id"])!=="42001f")})),y!==-1&&D("FILTER_SEND_H264_BASELINE")&&(p.videoCodecs=p.videoCodecs.filter(v=>{var E,w;return!(((E=v.rtpMap)===null||E===void 0?void 0:E.encodingName.toLocaleLowerCase())==="h264"&&((w=v.fmtp)===null||w===void 0?void 0:w.parameters["profile-level-id"])!=="42001f")}))}}return{send:p,recv:f,sendrecv:m}}(e,t,n);try{r.close()}catch{}return{send:i,recv:o,sendrecv:s}}function hB(){let e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=$0(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(qs(e,t,"videoExtensions",r,n,i),qs(e,t,"videoCodecs",r,n,i),qs(e,t,"audioExtensions",r,n,i),qs(e,t,"audioCodecs",r,n,i),D("RAISE_H264_BASELINE_PRIORITY")){let o=i.videoCodecs.findIndex(s=>s.rtpMap&&s.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&s.fmtp&&s.fmtp.parameters["profile-level-id"]==="42001f");if(o!==-1){let s=i.videoCodecs.findIndex(a=>a.rtpMap&&a.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(s<o){b.debug("raising H264 baseline profile priority");let a=i.videoCodecs[o];i.videoCodecs.splice(o,1),i.videoCodecs.splice(s,0,a)}s!==-1&&(n.videoCodecs=n.videoCodecs.filter(a=>!(a.rtpMap&&a.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&a.fmtp&&a.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:r,recv:n,sendrecv:i}}function qs(e,t,r,n,i,o){if(r==="videoExtensions"||r==="audioExtensions"){let s=[];return e[r].forEach(a=>{t[r].some((c,l)=>{if(a.entry===c.entry&&a.extensionName===c.extensionName)return s.push(l),!0})?o[r].push(a):n[r].push(a)}),void t[r].forEach((a,c)=>{s.indexOf(c)===-1&&i[r].push(a)})}if(r==="videoCodecs"||r==="audioCodecs"){let s=[];return e[r].forEach(a=>{t[r].some((c,l)=>{if(a.payloadType===c.payloadType&&JSON.stringify(a)===JSON.stringify(c))return s.push(l),!0})?o[r].push(a):n[r].push(a)}),void t[r].forEach((a,c)=>{s.indexOf(c)===-1&&i[r].push(a)})}}function iw(e){let{send:t,recv:r,sendrecv:n}=e;if(!n){if(!t||!r)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:r}}let i,o;return t?(i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i.audioCodecs=[...t.audioCodecs,...n.audioCodecs],i.videoCodecs=[...t.videoCodecs,...n.videoCodecs],i.audioExtensions=[...t.audioExtensions,...n.audioExtensions],i.videoExtensions=[...t.videoExtensions,...n.videoExtensions]):i=n,r?(o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o.audioCodecs=[...r.audioCodecs,...n.audioCodecs],o.videoCodecs=[...r.videoCodecs,...n.videoCodecs],o.audioExtensions=[...r.audioExtensions,...n.audioExtensions],o.videoExtensions=[...r.videoExtensions,...n.videoExtensions]):o=n,{send:i,recv:o}}function Nf(e){e.media.mediaType==="audio"&&e.attributes.payloads.filter(t=>{var r;return((r=t.rtpMap)===null||r===void 0?void 0:r.encodingName.toLowerCase())==="opus"}).forEach(t=>{t.fmtp||(t.fmtp={parameters:{}}),t.fmtp.parameters.stereo="1",t.fmtp.parameters["sprop-stereo"]="1"})}function Vg(e,t,r,n){let i=[];if(e===we.VIDEO){if(D("H264_PROFILE_LEVEL_ID")&&n==="h264"&&(i=t.videoCodecs.filter(o=>{var s;return pe(s=o.rtpMap&&o.rtpMap.encodingName.toLowerCase()||"").call(s,n)&&o&&o.fmtp&&o.fmtp.parameters["profile-level-id"]===D("H264_PROFILE_LEVEL_ID")})),!Array.isArray(i)||i.length===0){let o=[],s=[],a=[],c=[];if(r.videoCodecs.forEach(l=>{let d=l.rtpMap&&l.rtpMap.encodingName.toLowerCase()||"";pe(d).call(d,n)?o.push(l):pe(d).call(d,"vp9")?s.push(l):pe(d).call(d,"vp8")?a.push(l):pe(d).call(d,"h264")&&c.push(l)}),o.length===0){let l="";s.length!==0?(o=s,l="vp9"):a.length!==0?(o=a,l="vp8"):c.length!==0&&(o=c,l="h264"),b.warning("codec ".concat(n," not included in rtpCapabilities, fallback to default payloads: ").concat(l))}o.length!==0&&(i=t.videoCodecs.filter(l=>o.some(d=>d.payloadType===l.payloadType)))}if(i.length===0&&(b.warning("codec ".concat(n," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),i=t.videoCodecs),D("USE_PUB_RTX")||D("USE_SUB_RTX")){let o=KD(i,t.videoCodecs);i=[...i,...o]}}else i=t.audioCodecs.filter(o=>{var s;return pe(s=o.rtpMap&&o.rtpMap.encodingName.toLowerCase()||"").call(s,n)}),i.length===0&&(b.warning("codec ".concat(n," not included in rtpCapabilities, fallback to opus")),i=t.audioCodecs.filter(o=>{var s;return pe(s=o.rtpMap&&o.rtpMap.encodingName.toLowerCase()||"").call(s,"opus")}));return i}function KD(e,t){let r=e.map(n=>n.payloadType.toString());return t.filter(n=>n.rtpMap&&n.rtpMap.encodingName==="rtx"&&n.fmtp&&n.fmtp.parameters.apt&&pe(r).call(r,n.fmtp&&n.fmtp.parameters.apt))}async function fE(e,t,r){let n=t.toString(),i=JQ(n,"offer","remote","exchangeSDP");await e.setRemoteDescription({type:"offer",sdp:n});let o=await e.createAnswer();if(!o.sdp)throw new Error("cannot get answer sdp");let s=o.sdp;s=XQ(s,r||{}),i==null||i(s||""),await e.setLocalDescription({type:"answer",sdp:s})}function XQ(e,t,r){let n=wn.parse(e),{useXR:i}=t;return n.mediaDescriptions.forEach(o=>{var s;o.attributes.mid&&(Array.isArray(r)&&!pe(r).call(r,o.attributes.mid)||(o.media.mediaType==="audio"&&Nf(o),i&&pe(s=["audio","video"]).call(s,o.media.mediaType)&&o.attributes.payloads.forEach(a=>{a.rtcpFeedbacks.findIndex(c=>c.type==="rrtr")===-1&&a.rtcpFeedbacks.push({type:"rrtr"})})))}),wn.print(n)}function JQ(e,t,r,n){if(D("SDP_LOGGING"))return b.upload("exchanging ".concat(r," ").concat(t," SDP during P2PConnection.").concat(n,`
`),e),t==="offer"?i=>{JQ(i,"answer",r==="local"?"remote":"local",n)}:void 0}function Ya(e,t){return typeof D(e)===t?D(e):void 0}function pB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var AI=new Map,aMe=class extends fr{get state(){return this._state}set state(e){if(e===this._state)return;let t=this._state;this._state=e,e==="DISCONNECTED"&&this._disconnectedReason?this.emit(An.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(An.CONNECTION_STATE_CHANGE,e,t)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){b.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,t){super(),C(this,"store",void 0),C(this,"joinInfo",void 0),C(this,"key",void 0),C(this,"ntpOffset",0),C(this,"signal",void 0),C(this,"role",void 0),C(this,"inChannelInfo",{joinAt:null,duration:0}),C(this,"spec",void 0),C(this,"_state","DISCONNECTED"),C(this,"_statsCollector",void 0),C(this,"_disconnectedReason",void 0),C(this,"isSignalRecover",!1),C(this,"hasChangeBGPAddress",!1),C(this,"trafficStatsInterval",void 0),C(this,"networkQualityInterval",void 0),C(this,"_joinGatewayStartTime",0),C(this,"_signalTimeout",!1),C(this,"_clientRoleOptions",void 0),C(this,"_isProactiveJoin",!1),this.store=e,this.spec=t,this.signal=this.store.useP2P?new cB(kl(kl({},t),{},{retryConfig:t.websocketRetryConfig}),e):new N2e(kl(kl({},t),{},{retryConfig:t.websocketRetryConfig}),e),this._statsCollector=t.statsCollector,this.role=t.role||"audience",this._clientRoleOptions=t.clientRoleOptions,this.handleSignalEvents()}async join(e,t,r){this.store.joinGatewayStart(),e.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);let n=Date.now(),i=AI.get(e.cname);if(i||(i=new Map,AI.set(e.cname,i)),this._isProactiveJoin=!0,i.has(e.uid)){let c=new G(I.UID_CONFLICT);throw _e.joinGateway(e.sid,{lts:n,succ:!1,ec:c.code,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!e.proxyServer,signalChannel:"0",preload:e.preload}),this._isProactiveJoin=!1,c}i.set(e.uid,!0),this.joinInfo=e,this.key=t;let o=0;this.joinGatewayStartTime=n;let s=e.proxyServer;try{b.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(o));let c=e.gatewayAddrs.map(l=>{let{address:d}=l,[u,p]=d.split(":"),f={host:u,port:p};return e.proxyServer&&(f.proxy=e.proxyServer),f});o=(await this.signal.init(c,r)).uid,b.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(o," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(c){var a;throw b.error("[".concat(this.store.clientId,"] User join failed"),c.toString()),_e.joinGateway(e.sid,{lts:n,succ:!1,ec:((a=c.data)===null||a===void 0?void 0:a.desc)||c.code,errorMsg:c.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!s,signalChannel:"0",preload:e.preload}),this._isProactiveJoin=!1,i.delete(e.uid),this.signal.close(),c}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),b.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(c=>{b.warning("[".concat(this.store.clientId,"] get traffic stats error"),c.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(An.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(An.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(An.NETWORK_QUALITY,{uplinkNetworkQuality:sF(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:sF(this._statsCollector.trafficStats.B_dnq)}):this.emit(An.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),o}async leave(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){t!==Mt.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==Kt.CONNECTED||await function(r,n){return n===1/0?r:de.race([r,ADe(n)])}(this.signal.request(Me.LEAVE,void 0,!0),3e3)}catch(r){b.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),r)}this.signal.close(t),t!==Mt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,t,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));let n={state:"offer",p2p_id:this.store.p2pId,ortc:t,mode:this.spec.mode,extend:D("PUB_EXTEND"),twcc:!!D("PUBLISH_TWCC"),rtx:!!D("USE_PUB_RTX")};try{return(await this.signal.request(Me.PUBLISH,n,!0))._message}catch(i){if(r&&i.data&&i.data.code===xe.ERR_PUBLISH_REQUEST_INVALID)return b.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),i.toString()),await this.tryUnpubBeforeRepub(e,t),this.publish(e,t,!1);throw i}}async publishDataChannel(e,t,r){var n;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));let i={stream_id:t.streamId,ordered:t.ordered?1:0,max_retrans_times:(n=t.maxRetransmits)!==null&&n!==void 0?n:10,channel_id:t.channelId,metadata:t.metadata};try{await this.signal.request(Me.PUBLISH_DATASTREAM,i,!0)}catch(o){if(r&&o.data&&o.data.code===xe.ERR_PUBLISH_REQUEST_INVALID)return b.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),o.toString()),await this.tryUnpubDataChannelBeforeRepub(e,t),this.publishDataChannel(e,t,!1);throw o}}async unpublish(e,t){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(Me.UNPUBLISH,{stream_id:t,ortc:e},!0)}catch(r){b.warning("[".concat(this.store.clientId,"] unpublish warning: "),r)}}async unpublishDataChannel(e){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await de.all(e.map(t=>this.signal.request(Me.UNPUBLISH_DATASTREAM,{channel_id:t},!0)))}catch(t){b.warning("unpublish datachannels warning: ",t)}}async presubscribe(e,t,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));let n={stream_id:e,stream_type:t,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!D("SUBSCRIBE_TWCC"),rtx:!!D("USE_SUB_RTX")||void 0,extend:D("SUB_EXTEND"),svc:Array.isArray(D("SVC"))&&D("SVC").length!==0?D("SVC"):void 0};try{return await this.signal.request(Me.PRE_SUBSCRIBE,n,!0)}catch(i){if(r&&i.data&&i.data.code===xe.ERR_SUBSCRIBE_REQUEST_INVALID)return b.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),i.toString()),this.presubscribe(e,t,!1);throw i}}async subscribe(e,t,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));let n={stream_id:e,stream_type:t.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!D("SUBSCRIBE_TWCC"),rtx:!!D("USE_SUB_RTX"),extend:D("SUB_EXTEND"),ssrcId:t.ssrcId,svc:Array.isArray(D("SVC"))&&D("SVC").length!==0?D("SVC"):void 0};try{return(await this.signal.request(Me.SUBSCRIBE,n,!0))._message}catch(i){if(r&&i.data&&i.data.code===xe.ERR_SUBSCRIBE_REQUEST_INVALID)return b.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),i.toString()),await this.tryUnsubBeforeResub(e,t),await this.subscribe(e,t,!1);throw i}}async subscribeDataChannel(e,t,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));let n={uid:e,stream_id:t.id,channel_id:t.datachannelId};try{return void await this.signal.request(Me.SUBSCRIBE_DATASTREAM,n,!0)}catch(i){if(r&&i.data&&i.data.code===xe.ERR_SUBSCRIBE_REQUEST_INVALID)return b.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),i.toString()),await this.tryUnsubDataChannelBeforeResub(e,t),await this.subscribeDataChannel(e,t,!1);throw i}}async subscribeAll(e,t){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));let r={p2p_id:this.store.p2pId,users:e,dtx:!1,rtx:!!D("USE_SUB_RTX"),twcc:!!D("SUBSCRIBE_TWCC"),svc:Array.isArray(D("SVC"))&&D("SVC").length!==0?D("SVC"):void 0};try{return await this.signal.request(Me.SUBSCRIBE_STREAMS,r,!0)}catch(n){if(t&&n.data&&n.data.code===xe.ERR_SUBSCRIBE_REQUEST_INVALID)return b.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),n.toString()),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw n}}async setVideoProfile(e){let t=function(r){if(!(r.bitrateMax&&r.bitrateMin&&r.frameRate&&r.height&&r.width))return;let n=r.frameRate,i=r.width,o=r.height,s=!0;return typeof n!="number"&&(n=n.exact||n.ideal||n.max||n.min||0,n||(s=!1)),typeof i!="number"&&(i=i.exact||i.ideal||i.max||i.min||0,i||(s=!1)),typeof o!="number"&&(o=o.exact||o.ideal||o.max||o.min||0,n||(s=!1)),s?{stream_type:0,width:i,height:o,fps:n,start_bps:1e3*r.bitrateMax,min_bps:1e3*r.bitrateMin,target_bps:1e3*r.bitrateMax}:void 0}(e);if(t)return this.signal.request(Me.SET_VIDEO_PROFILE,t);b.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(e,t){try{await this.signal.request(Me.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:t},!0)}catch(r){b.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),r)}}async unsubscribeDataChannel(e,t){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await de.all(e.map(r=>this.signal.request(Me.UNSUBSCRIBE_DATASTREAM,{stream_id:r,uid:t},!0)))}catch(r){b.warning("unsubscribeDataChannel warning: ",r)}}async massUnsubscribe(e){try{await this.signal.request(Me.UNSUBSCRIBE_STREAMS,e,!0)}catch(t){b.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),t)}}async reconnectPC(e){let{iceParameters:t,dtlsParameters:r,rtpCapabilities:n}=e;return{gatewayEstablishParams:await this.signal.request(Me.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:t,dtlsParameters:r,rtpCapabilities:n}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(Me.GATEWAY_INFO)}async renewToken(e){await this.signal.request(Me.RENEW_TOKEN,e),this.key=e.token}async setClientRole(e,t){if(t&&(this._clientRoleOptions=Object.assign({},t)),this.state!=="CONNECTED")return void(this.role=e);let r,n=0;e==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(r=this._clientRoleOptions.delay,n=1):n=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:n=0,await this.signal.request(Me.SET_CLIENT_ROLE,{role:e,level:n,delay:r,client_ts:Date.now()}),this.role=e}async setRemoteVideoStreamType(e,t){await this.signal.request(Me.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:t})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(Me.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,t){await this.signal.request(Me.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:t})}async pickSVCLayer(e,t){await this.signal.request(Me.PICK_SVC_LAYER,{stream_id:e,spatial_layer:t.spatialLayer,temporal_layer:t.temporalLayer})}async setRTM2Flag(e){await this.signal.request(Me.SET_RTM2_FLAG,{rtm2_flag:e})}async sendExtensionMessage(e,t,r){if(this.signal instanceof cB)return this.signal.sendExtensionMessage(e,t,r)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),kl({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(Me.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){let e=AI.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;let e=function(t){let r;return r=t.startsWith("dc")?t.match(/(dc\:\/\/)?([^:]+):(\d+)/):t.match(/(wss\:\/\/)?([^:]+):(\d+)/),r?{username:xn.username,password:xn.password,turnServerURL:r[2],tcpport:parseInt(r[3])+30,udpport:parseInt(r[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(kl(kl({},xn),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;let e=await this.signal.request(Me.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),e.ntp_offset!=null&&(this.ntpOffset=e.ntp_offset),e.peer_delay.forEach(t=>{let r=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(n=>n.peer_uid===t.peer_uid);r&&r.B_st!==t.B_st&&ZS(()=>{this.emit(An.STREAM_TYPE_CHANGE,t.peer_uid,t.B_st)})}),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new G(I.UNEXPECTED_ERROR,"can not generate join message, no join info");let t=Object.assign({},this.joinInfo.apResponse),r=D("REPORT_APP_SCENARIO");if(typeof r!="string")try{r=JSON.stringify(r)}catch{r=void 0}r&&r.length>128&&(r=void 0);let n=!(_r()||BJ(87)||OF())&&typeof D("ENABLE_PRE_SUB")=="boolean"&&D("ENABLE_PRE_SUB"),i=!OF()&&Ya("ENABLE_PREALLOC_PC","boolean"),o=kl({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:os,browser:navigator.userAgent,process_id:D("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:t,extend:D("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:r,attributes:{userAttributes:{enablePublishedUserList:D("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:D("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof D("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?D("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof D("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?D("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof D("ENABLE_USER_LICENSE_CHECK")=="boolean"?D("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:D("USE_PUB_RTX")===!0||D("USE_SUB_RTX")===!0||void 0,disableFEC:D("DISABLE_FEC"),enableNTPReport:!!D("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!D("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!D("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:Ya("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!D("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!D("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:Ya("USE_XR","boolean"),enableLossbasedBwe:Ya("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!D("ENABLE_AUT_CC")||void 0,enableCCFallback:Ya("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:i,preSubNum:n?Ya("PRE_SUB_NUM","number"):void 0,enablePubTWCC:Ya("PUBLISH_TWCC","boolean"),enableSubTWCC:Ya("SUBSCRIBE_TWCC","boolean"),enablePubRTX:Ya("USE_PUB_RTX","boolean"),enableSubRTX:Ya("USE_SUB_RTX","boolean"),enableSubSVC:D("ENABLE_SVC")?D("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(D("SVC"))&&D("SVC").length!==0?D("SVC"):void 0}},join_ts:this.joinGatewayStartTime},e);return this.joinInfo.stringUid&&(o.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(o.aes_mode=this.joinInfo.aesmode,D("ENCRYPT_AES")?(o.aes_secret=this.joinInfo.aespassword,o.aes_encrypt=!0):o.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(o.aes_salt=this.joinInfo.aessalt)),t.addresses[this.signal.websocket.currentURLIndex]&&(o.ap_response.ticket=t.addresses[this.signal.websocket.currentURLIndex].ticket,delete t.addresses),this.joinInfo.defaultVideoStream!==void 0&&(o.default_video_stream=this.joinInfo.defaultVideoStream),o}getRejoinMessage(){if(!this.joinInfo)throw new G(I.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(je.WS_RECONNECT_WAITTING_FINISH,e=>{var t;pe(t=["tryNext","recover"]).call(t,e)&&this.joinInfo&&_e.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(je.WS_RECONNECT_CREATE_CONNECTION,e=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(je.WS_RECONNECTING,e=>{this.joinInfo&&_e.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||kn.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",_e.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:2}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(je.WS_CLOSED,e=>{let t;switch(e){case Mt.LEAVE:t=kn.LEAVE;break;case Mt.UID_BANNED:case Mt.IP_BANNED:case Mt.CHANNEL_BANNED:case Mt.SERVER_ERROR:t=kn.SERVER_ERROR;break;case Mt.FALLBACK:t=kn.FALLBACK;break;case Mt.LICENSE_MISSING:case Mt.LICENSE_EXPIRED:case Mt.LICENSE_MINUTES_EXCEEDED:case Mt.LICENSE_PERIOD_INVALID:case Mt.LICENSE_MULTIPLE_SDK_SERVICE:case Mt.LICENSE_ILLEGAL:case Mt.TOKEN_EXPIRE:t=e;break;default:t=kn.NETWORK_ERROR}b.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(t||"undefined -> "+kn.NETWORK_ERROR)),this.joinInfo&&_e.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===Mt.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t}),this._disconnectedReason=e,e!==Mt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(je.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(b.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),_e.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){let e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return void b.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e));Ft("EVENT_REPORT_DOMAIN",e[1]),Ft("EVENT_REPORT_BACKUP_DOMAIN",e[1]),Ft("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}}),this.signal.on(ct.ON_UPLINK_STATS,e=>{this._statsCollector.updateUplinkStats(e)}),this.signal.on(je.REQUEST_RECOVER,(e,t,r)=>{if(!this.joinInfo)return r(new G(I.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Dn(this,An.REQUEST_NEW_GATEWAY_LIST).then(t).catch(r)}),this.signal.on(je.REQUEST_JOIN_INFO,async e=>{var t;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void e(this.getJoinMessage({ortc:{}}));let{iceParameters:r,dtlsParameters:n,rtpCapabilities:i}=await Dn(this,An.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(t=this.joinInfo)===null||t===void 0?void 0:t.turnServer});e(this.getJoinMessage({ortc:{iceParameters:r,dtlsParameters:n,rtpCapabilities:i,version:"2"}}))}),this.signal.on(je.REQUEST_REJOIN_INFO,e=>{e(this.getRejoinMessage())}),this.signal.on(je.REPORT_JOIN_GATEWAY,(e,t)=>{if(!this.joinInfo)return;let r,n="";var i;e instanceof G?(r=((i=e.data)===null||i===void 0?void 0:i.desc)||e.code,n=e.message):r=e,_e.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:r,errorMsg:n,addr:t,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload}),this._isProactiveJoin=!1}),this.signal.on(je.IS_P2P_DISCONNECTED,e=>{e(j0(this,An.IS_P2P_DISCONNECTED))}),this.signal.on(je.DISCONNECT_P2P,()=>{this.emit(An.DISCONNECT_P2P)}),this.signal.on(je.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(je.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(je.JOIN_RESPONSE,e=>{let t=this.getCurrentGatewayAddress();this.emit(An.JOIN_RESPONSE,e,t)}),this.signal.on(je.PRE_CONNECT_PC,async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();let e=this.getCurrentGatewayAddress(),t=D("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(e&&t){let r=zQ(e);this.emit(An.PRE_CONNECT_PC,{candidates:r,fingerprint:t})}}})}async tryUnsubBeforeResub(e,t){try{await this.signal.request(Me.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[t]},!0)}catch(r){throw b.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),r),r}}async tryUnsubDataChannelBeforeResub(e,t){try{await this.signal.request(Me.UNSUBSCRIBE,{stream_id:t.id},!0)}catch(r){throw b.warning("unsubscribe datachannel warning",r),r}}async tryUnpubBeforeRepub(e,t){try{await this.signal.request(Me.UNPUBLISH,{stream_id:e,ortc:t},!0)}catch(r){throw b.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),r),r}}async tryUnpubDataChannelBeforeRepub(e,t){try{await this.signal.request(Me.UNPUBLISH_DATASTREAM,{channnel_id:t.channelId},!0)}catch(r){throw b.warning("unpublish datastream warning: ",r),r}}async tryMassUnsubBeforeResub(e){let t={users:e.map(r=>({stream_id:r.stream_id,stream_type:r.stream_type}))};try{await this.signal.request(Me.UNSUBSCRIBE_STREAMS,t,!0)}catch(r){throw b.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),r),r}}async muteLocal(e,t){let r={action:e.find(n=>n.stream_type===Ot.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(Me.CONTROL,r,!0,!0)}catch(n){throw b.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),n),n}}async unmuteLocal(e,t){let r={action:e.find(n=>n.stream_type===Ot.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(Me.CONTROL,r,!0,!0)}catch(n){throw b.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),n),n}}async muteRemote(e,t){let r={action:e===we.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(Me.CONTROL,r,!0,!0)}catch(n){throw b.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),n),n}}async unmuteRemote(e,t){let r={action:e===we.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(Me.CONTROL,r,!0,!0)}catch(n){throw b.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),n),n}}uploadWRTCStats(e){this.signal.uploadWRTCStats(e)}upload(e,t){this.signal.upload(e,t)}getSignalRTT(){return this.signal.rtt}async restartICE(e){let t={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{return await this.signal.request(Me.RESTART_ICE,t,!0)}catch(r){throw b.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),r),r}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,kn.P2P_FAILED)}getCurrentGatewayAddress(){var e,t;if(!D("GATEWAY_WSS_ADDRESS"))return D("USE_CANDIDATE_FROM_AP_DETAIL")&&(e=this.joinInfo)!==null&&e!==void 0&&e.apGatewayAddress?(b.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(t=this.joinInfo)!==null&&t!==void 0&&t.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(e){await this.signal.request(Me.SET_PARAMETER,{enablePublishAudioFilter:e})}},mE=0,xI=0;function Fa(e,t,r,n){return new de((i,o)=>{t.timeout=t.timeout||D("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!r?(t.data=JSON.stringify(t.data),mE+=cc(t.data)):r&&(t.data.size?mE+=t.data.size:t.data instanceof FormData?mE+=QJ(t.data):mE+=cc(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,Li.request(t).then(s=>{typeof s.data=="string"?xI+=cc(s.data):s.data instanceof ArrayBuffer||s.data instanceof Uint8Array?xI+=s.data.byteLength:xI+=cc(JSON.stringify(s.data)),n&&i({data:s.data,headers:s.headers}),i(s.data)}).catch(s=>{Li.isCancel(s)?o(new G(I.OPERATION_ABORTED,"cancel token canceled")):s.code==="ECONNABORTED"?o(new G(I.NETWORK_TIMEOUT,s.message)):s.response?o(new G(I.NETWORK_RESPONSE_ERROR,s.response.status)):o(new G(I.NETWORK_ERROR,s.message))})})}(function(){var e;function t(x){var O=0;return function(){return O<x.length?{done:!1,value:x[O++]}:{done:!0}}}var r=typeof Object.defineProperties=="function"?Object.defineProperty:function(x,O,F){return x==Array.prototype||x==Object.prototype||(x[O]=F.value),x},n,i=function(x){x=[typeof globalThis=="object"&&globalThis,x,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gp=="object"&&Gp];for(var O=0;O<x.length;++O){var F=x[O];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}(this);function o(x,O){if(O)e:{var F=i;x=x.split(".");for(var P=0;P<x.length-1;P++){var _=x[P];if(!(_ in F))break e;F=F[_]}(O=O(P=F[x=x[x.length-1]]))!=P&&O!=null&&r(F,x,{configurable:!0,writable:!0,value:O})}}function s(x){return(x={next:x})[Symbol.iterator]=function(){return this},x}function a(x){var O=typeof Symbol<"u"&&Symbol.iterator&&x[Symbol.iterator];return O?O.call(x):{next:t(x)}}if(o("Symbol",function(x){function O(_,R){this.A=_,r(this,"description",{configurable:!0,writable:!0,value:R})}if(x)return x;O.prototype.toString=function(){return this.A};var F="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",P=0;return function _(R){if(this instanceof _)throw new TypeError("Symbol is not a constructor");return new O(F+(R||"")+"_"+P++,R)}}),o("Symbol.iterator",function(x){if(x)return x;x=Symbol("Symbol.iterator");for(var O="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),F=0;F<O.length;F++){var P=i[O[F]];typeof P=="function"&&typeof P.prototype[x]!="function"&&r(P.prototype,x,{configurable:!0,writable:!0,value:function(){return s(t(this))}})}return x}),typeof Object.setPrototypeOf=="function")n=Object.setPrototypeOf;else{var c;e:{var l={};try{l.__proto__={a:!0},c=l.a;break e}catch{}c=!1}n=c?function(x,O){if(x.__proto__=O,x.__proto__!==O)throw new TypeError(x+" is not extensible");return x}:null}var d=n;function u(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function p(x){if(x.m)throw new TypeError("Generator is already running");x.m=!0}function f(x,O){return x.h=3,{value:O}}function m(x){this.g=new u,this.G=x}function g(x,O,F,P){try{var _=O.call(x.g.j,F);if(!(_ instanceof Object))throw new TypeError("Iterator result "+_+" is not an object");if(!_.done)return x.g.m=!1,_;var R=_.value}catch(k){return x.g.j=null,x.g.s(k),y(x)}return x.g.j=null,P.call(x.g,R),y(x)}function y(x){for(;x.g.h;)try{var O=x.G(x.g);if(O)return x.g.m=!1,{value:O.value,done:!1}}catch(F){x.g.v=void 0,x.g.s(F)}if(x.g.m=!1,x.g.l){if(O=x.g.l,x.g.l=null,O.F)throw O.D;return{value:O.return,done:!0}}return{value:void 0,done:!0}}function v(x){this.next=function(O){return x.o(O)},this.throw=function(O){return x.s(O)},this.return=function(O){return function(F,P){p(F.g);var _=F.g.j;return _?g(F,"return"in _?_.return:function(R){return{value:R,done:!0}},P,F.g.return):(F.g.return(P),y(F))}(x,O)},this[Symbol.iterator]=function(){return this}}function E(x,O){return O=new v(new m(O)),d&&x.prototype&&d(O,x.prototype),O}if(u.prototype.o=function(x){this.v=x},u.prototype.s=function(x){this.l={D:x,F:!0},this.h=this.C||this.u},u.prototype.return=function(x){this.l={return:x},this.h=this.u},m.prototype.o=function(x){return p(this.g),this.g.j?g(this,this.g.j.next,x,this.g.o):(this.g.o(x),y(this))},m.prototype.s=function(x){return p(this.g),this.g.j?g(this,this.g.j.throw,x,this.g.o):(this.g.s(x),y(this))},o("Array.prototype.entries",function(x){return x||function(){return function(O,F){O instanceof String&&(O+="");var P=0,_=!1,R={next:function(){if(!_&&P<O.length){var k=P++;return{value:F(k,O[k]),done:!1}}return _=!0,{done:!0,value:void 0}}};return R[Symbol.iterator]=function(){return R},R}(this,function(O,F){return[O,F]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var w=function(x,O){for(var F=0;F<x.length;F++)O(x[F])},S=function(x){return x.replace(/\r?\n|\r/g,`\r
`)},A=function(x,O,F){return O instanceof Blob?(F=F!==void 0?F+"":typeof O.name=="string"?O.name:"blob",O.name===F&&Object.prototype.toString.call(O)!=="[object Blob]"||(O=new File([O],F)),[String(x),O]):[String(x),String(O)]},N=function(x,O){if(x.length<O)throw new TypeError(O+" argument required, but only "+x.length+" present.")},L=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,j=L.FormData,W=L.XMLHttpRequest&&L.XMLHttpRequest.prototype.send,V=L.Request&&L.fetch,Y=L.navigator&&L.navigator.sendBeacon,Z=L.Element&&L.Element.prototype,te=L.Symbol&&Symbol.toStringTag;te&&(Blob.prototype[te]||(Blob.prototype[te]="Blob"),"File"in L&&!File.prototype[te]&&(File.prototype[te]="File"));try{new File([],"")}catch{L.File=function(x,O,F){return x=new Blob(x,F||{}),Object.defineProperties(x,{name:{value:O},lastModified:{value:+(F&&F.lastModified!==void 0?new Date(F.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),te&&Object.defineProperty(x,te,{value:"File"}),x}}var H=function(x){return x.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},$=function(x){this.i=[];var O=this;x&&w(x.elements,function(F){if(F.name&&!F.disabled&&F.type!=="submit"&&F.type!=="button"&&!F.matches("form fieldset[disabled] *"))if(F.type==="file"){var P=F.files&&F.files.length?F.files:[new File([],"",{type:"application/octet-stream"})];w(P,function(_){O.append(F.name,_)})}else F.type==="select-multiple"||F.type==="select-one"?w(F.options,function(_){!_.disabled&&_.selected&&O.append(F.name,_.value)}):F.type==="checkbox"||F.type==="radio"?F.checked&&O.append(F.name,F.value):(P=F.type==="textarea"?S(F.value):F.value,O.append(F.name,P))})};if((e=$.prototype).append=function(x,O,F){N(arguments,2),this.i.push(A(x,O,F))},e.delete=function(x){N(arguments,1);var O=[];x=String(x),w(this.i,function(F){F[0]!==x&&O.push(F)}),this.i=O},e.entries=function x(){var O,F=this;return E(x,function(P){if(P.h==1&&(O=0),P.h!=3)return O<F.i.length?P=f(P,F.i[O]):(P.h=0,P=void 0),P;O++,P.h=2})},e.forEach=function(x,O){N(arguments,1);for(var F=a(this),P=F.next();!P.done;P=F.next()){var _=a(P.value);P=_.next().value,_=_.next().value,x.call(O,_,P,this)}},e.get=function(x){N(arguments,1);var O=this.i;x=String(x);for(var F=0;F<O.length;F++)if(O[F][0]===x)return O[F][1];return null},e.getAll=function(x){N(arguments,1);var O=[];return x=String(x),w(this.i,function(F){F[0]===x&&O.push(F[1])}),O},e.has=function(x){N(arguments,1),x=String(x);for(var O=0;O<this.i.length;O++)if(this.i[O][0]===x)return!0;return!1},e.keys=function x(){var O,F,P,_,R=this;return E(x,function(k){if(k.h==1&&(O=a(R),F=O.next()),k.h!=3)return F.done?void(k.h=0):(P=F.value,_=a(P),f(k,_.next().value));F=O.next(),k.h=2})},e.set=function(x,O,F){N(arguments,2),x=String(x);var P=[],_=A(x,O,F),R=!0;w(this.i,function(k){k[0]===x?R&&(R=!P.push(_)):P.push(k)}),R&&P.push(_),this.i=P},e.values=function x(){var O,F,P,_,R=this;return E(x,function(k){if(k.h==1&&(O=a(R),F=O.next()),k.h!=3)return F.done?void(k.h=0):(P=F.value,(_=a(P)).next(),f(k,_.next().value));F=O.next(),k.h=2})},$.prototype._asNative=function(){for(var x=new j,O=a(this),F=O.next();!F.done;F=O.next()){var P=a(F.value);F=P.next().value,P=P.next().value,x.append(F,P)}return x},$.prototype._blob=function(){var x="----formdata-polyfill-"+Math.random(),O=[],F="--"+x+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(P,_){return typeof P=="string"?O.push(F+H(S(_))+`"\r
\r
`+S(P)+`\r
`):O.push(F+H(S(_))+'"; filename="'+H(P.name)+`"\r
Content-Type: `+(P.type||"application/octet-stream")+`\r
\r
`,P,`\r
`)}),O.push("--"+x+"--"),new Blob(O,{type:"multipart/form-data; boundary="+x})},$.prototype[Symbol.iterator]=function(){return this.entries()},$.prototype.toString=function(){return"[object FormData]"},Z&&!Z.matches&&(Z.matches=Z.matchesSelector||Z.mozMatchesSelector||Z.msMatchesSelector||Z.oMatchesSelector||Z.webkitMatchesSelector||function(x){for(var O=(x=(this.document||this.ownerDocument).querySelectorAll(x)).length;0<=--O&&x.item(O)!==this;);return-1<O}),te&&($.prototype[te]="FormData"),W){var K=L.XMLHttpRequest.prototype.setRequestHeader;L.XMLHttpRequest.prototype.setRequestHeader=function(x,O){K.call(this,x,O),x.toLowerCase()==="content-type"&&(this.B=!0)},L.XMLHttpRequest.prototype.send=function(x){x instanceof $?(x=x._blob(),this.B||this.setRequestHeader("Content-Type",x.type),W.call(this,x)):W.call(this,x)}}V&&(L.fetch=function(x,O){return O&&O.body&&O.body instanceof $&&(O.body=O.body._blob()),V.call(this,x,O)}),Y&&(L.navigator.sendBeacon=function(x,O){return O instanceof $&&(O=O._asNative()),Y.call(this,x,O)}),L.FormData=$}})();var H0=()=>{let e=D("AREAS");return e.length===0&&e.push(St.GLOBAL),ka(e).call(e,(t,r,n)=>{let i=QQ(r);return i?n===0?i:"".concat(t,",").concat(i):t},"")},QQ=e=>e===St.OVERSEA?"".concat(Fn.ASIA,",").concat(Fn.EUROPE,",").concat(Fn.AFRICA,",").concat(Fn.NORTH_AMERICA,",").concat(Fn.SOUTH_AMERICA,",").concat(Fn.OCEANIA):Fn[e],cMe=e=>{let t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map(r=>{let n=iT[r],i=Object.keys(n);i&&i.map(o=>{o!=="CODE"&&(t[o]=t[o].concat(n[o]))})}),t},v_={GLOBAL:{ASIA:[St.CHINA,St.JAPAN,St.INDIA,St.KOREA,St.HKMC],EUROPE:[],NORTH_AMERICA:[St.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},gE=Object.keys(v_[St.GLOBAL]),OI=[St.CHINA,St.NORTH_AMERICA,St.EUROPE,St.ASIA,St.JAPAN,St.INDIA,St.OCEANIA,St.SOUTH_AMERICA,St.AFRICA,St.KOREA,St.HKMC,St.US],lMe=function(e,t){let r=[];if(pe(e).call(e,St.GLOBAL)){let o=[St.GLOBAL,St.OVERSEA],s=Object.keys(iT);if(t===St.GLOBAL)throw new G(I.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===St.CHINA)r=[St.OVERSEA];else if(i=t,pe(gE).call(gE,i)){let a=(n=t,v_[St.GLOBAL][n]||[]),c=[...o,t,...a];r=s.filter(l=>!pe(c).call(c,l))}else if(function(a){let c=!1;return gE.forEach(l=>{var d;pe(d=v_[St.GLOBAL][l]).call(d,a)&&(c=!0)}),c}(t)){let a=function(l){let d;return gE.forEach(u=>{var p;pe(p=v_[St.GLOBAL][u]).call(p,l)&&(d=u)}),d}(t),c=[...o,a,t];r=s.filter(l=>!pe(c).call(c,l))}else r=e;r=function(a){let c=[];return OI.forEach(l=>{pe(a).call(a,l)&&c.push(l)}),c.concat(a.filter(l=>!pe(OI).call(OI,l)))}(r)}else r=e;var n,i;return r};function fB(e){var t,r;if(!e&&pe(t=D("AREAS")).call(t,St.EXTENSIONS))return b.debug("update area from ap : reset"),void qD(UDe,!0);if(!pe(r=D("AREAS")).call(r,St.GLOBAL)||!e)return;let n=iT.EXTENSIONS;n&&(n={CODE:QQ(St.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},b.debug("update area from ap success: ".concat(e,",config is "),n),Ft("AREAS",[St.EXTENSIONS],!0),Object.keys(n).map(i=>{i==="LOG_UPLOAD_SERVER"||i==="EVENT_REPORT_DOMAIN"||i==="EVENT_REPORT_BACKUP_DOMAIN"||i==="PROXY_SERVER_TYPE3"?Ft(i,n[i][0]):Ft(i,n[i])}))}function qD(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=_e.reportApiInvoke(null,{name:Gr.SET_AREA,options:e,tag:Er.TRACER});try{let n=[];if(typeof e=="string"&&(n=[e]),Array.isArray(e)&&(e.forEach(o=>{if(!pe(Z3).call(Z3,o))throw new G(I.INVALID_PARAMS,"invalid area code")}),n=e),Object.prototype.toString.call(e)==="[object Object]"){let{areaCode:o,excludedArea:s}=e;if(!o)throw new G(I.INVALID_PARAMS,"area code is needed");let a=o;typeof o=="string"&&(a=[o]),n=s?lMe(a,s):a}if(!t){if(nd.AREAS){let o=new G(I.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return r.onError(o),void b.warning("setArea is prohibited because of config-distribute")}if(pe(n).call(n,St.GLOBAL)&&D("AREAS")===St.EXTENSIONS){let o=new G(I.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return r.onError(o),void b.warning("setArea is prohibited because of ap extensions")}}Ft("AREAS",n,t);let i=cMe(n);Object.keys(i).map(o=>{o==="LOG_UPLOAD_SERVER"||o==="EVENT_REPORT_DOMAIN"||o==="EVENT_REPORT_BACKUP_DOMAIN"||o==="PROXY_SERVER_TYPE3"?Ft(o,i[o][0]):Ft(o,i[o])}),b.debug("set area success:",n.join(","))}catch(n){throw r.onError(n),n}r.onSuccess()}function mB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var NI=1;function dMe(e,t,r,n,i){NI+=1;let o={sid:r.sid,command:"convergeAllocateEdge",uid:"666",appId:r.appId,ts:Math.floor(Date.now()/1e3),seq:NI,requestId:NI,version:os,cname:r.cname},s={service_name:t,json_body:JSON.stringify(o)},a,c,l=e[0];return Ua(async()=>{a=Date.now();let d=await Fa(l,{data:s,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Date.now()-a,d.code!==0){let f=new G(I.UNEXPECTED_RESPONSE,"live streaming ap error, code"+d.code,{retry:!0,responseTime:c});throw b.error(f.toString()),f}let u=JSON.parse(d.json_body);if(u.code!==200){let f=new G(I.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(u.code,", reason: ").concat(u.reason),{code:u.code,responseTime:c});throw b.error(f.toString()),f}if(!u.servers||u.servers.length===0){let f=new G(I.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:u.code,responseTime:c});throw b.error(f.toString()),f}let p=function(f,m){return{addressList:f.servers.map(g=>"wss://".concat(g.address.replace(/\./g,"-"),".").concat(D("WORKER_DOMAIN"),":").concat(g.wss,"?serviceName=").concat(encodeURIComponent(m))),workerToken:f.workerToken,vid:f.vid}}(u,t);return D("LIVE_STREAMING_ADDRESS")&&(p.addressList=D("LIVE_STREAMING_ADDRESS")instanceof Array?D("LIVE_STREAMING_ADDRESS"):[D("LIVE_STREAMING_ADDRESS")]),qO(qO({},p),{},{responseTime:c})},(d,u)=>(_e.apworkerEvent(r.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(d.addressList),firstSuccess:u===0,responseTime:c,serverIp:e[u%e.length]}),!1),(d,u)=>(_e.apworkerEvent(r.sid,{success:!1,sc:d.data&&d.data.code||200,serviceName:t,responseTime:c,serverIp:e[u%e.length]}),!!(d.code!==I.OPERATION_ABORTED&&d.code!==I.UNEXPECTED_RESPONSE||d.data&&d.data.retry)&&(l=e[(u+1)%e.length],!0)),i)}var kI=1;function gB(e,t,r,n){let{url:i,areaCode:o}=e,{clientId:s,sid:a}=t,c=Date.now(),l,[d,u]=XD(t,o,[Pr.CHOOSE_SERVER]),p=Dr.networkState;return Ua(async()=>{p&&Dr.networkState===oo.OFFLINE&&Dr.onlineWaiter&&await de.race([Dr.onlineWaiter,Tn(n&&n.maxRetryTimeout||Fr.maxRetryTimeout)]),p=Dr.networkState;let{data:f,headers:m}=await Fa(i,{data:d,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l=m.http3==="1"?1:-1,_e.reportResourceTiming(i,a),ZQ(f,i,t,c,[Pr.CHOOSE_SERVER],l);let g=B0(f,Pr.CHOOSE_SERVER);return YD(g),jD(g,i)},f=>(f&&_e.joinChooseServer(a,{lts:c,succ:!0,csAddr:i,opid:u,serverList:f.gatewayAddrs.map(m=>m.address),ec:null,cid:f.cid.toString(),uid:f.uid.toString(),csIp:f.csIp,unilbsServerIds:[Pr.CHOOSE_SERVER].toString(),isHttp3:l}),!1),f=>f.code!==I.OPERATION_ABORTED&&(f.code===I.CAN_NOT_GET_GATEWAY_SERVER?f.data.retry:(_e.joinChooseServer(a,{lts:c,succ:!1,csAddr:i,serverList:null,opid:u,ec:f.code,csIp:f.data&&f.data.csIp,unilbsServerIds:[Pr.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:p}),isHttp3:l}),b.warning("[".concat(s||"sid-".concat(a.slice(0,6)),"] Choose server network error, retry"),f),!0)),n)}function yB(e,t,r,n){let i,{url:o,areaCode:s,serviceIds:a}=e,c=Date.now(),[l,d]=XD(t,s,a),u;return Ua(async()=>{u&&Dr.networkState===oo.OFFLINE&&Dr.onlineWaiter&&await de.race([Dr.onlineWaiter,Tn(n&&n.maxRetryTimeout||Fr.maxRetryTimeout)]),u=Dr.networkState;let{data:p,headers:f}=await Fa(o,{data:l,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);i=f.http3==="1"?1:-1,_e.reportResourceTiming(o,t.sid),ZQ(p,o,t,c,a,i);let m=B0(p,Pr.CHOOSE_SERVER),g=B0(p,t.cloudProxyServer==="proxy5"?Pr.CLOUD_PROXY_5:t.cloudProxyServer==="proxy3"||t.cloudProxyServer==="proxy4"?Pr.CLOUD_PROXY:Pr.CLOUD_PROXY_FALLBACK);return YD(m),{gatewayInfo:jD(m,o),proxyInfo:g,url:o}},p=>(p.gatewayInfo&&_e.joinChooseServer(t.sid,{lts:c,succ:!0,csAddr:o,serverList:p.gatewayInfo.gatewayAddrs.map(f=>f.address),ec:null,opid:d,cid:p.gatewayInfo.cid.toString(),uid:p.gatewayInfo.uid.toString(),csIp:p.gatewayInfo.csIp,unilbsServerIds:a.toString(),isHttp3:i}),p.proxyInfo&&_e.joinWebProxyAP(t.sid,{lts:c,sucess:1,apServerAddr:o,turnServerAddrList:p.proxyInfo.addresses.map(f=>f.ip).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:a.toString()}),!1),p=>p.code!==I.OPERATION_ABORTED&&(p.code===I.CAN_NOT_GET_GATEWAY_SERVER?p.data.retry:(_e.joinWebProxyAP(t.sid,{lts:c,sucess:0,apServerAddr:o,turnServerAddrList:null,errorCode:p.code,eventType:t.cloudProxyServer,unilbsServerIds:a.toString(),extend:JSON.stringify({networkState:u})}),b.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),p),!0)),n)}var ZQ=(e,t,r,n,i,o)=>{let{sid:s,clientId:a,cloudProxyServer:c}=r,l=[],d=u=>{u.flag===4096?_e.joinChooseServer(s,{lts:n,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:u.error.message,csIp:u.error.data&&u.error.data.csIp,unilbsServerIds:i.toString(),isHttp3:o}):u.flag!==1048576&&u.flag!==4194304&&u.flag!==4194310||_e.joinWebProxyAP(s,{lts:n,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:u.error.code,eventType:c,unilbsServerIds:i.toString()})};if(e.response_body.forEach(u=>{let p=u.buffer.code;if(u.uri===23&&p===0&&!u.buffer.edges_services)if(u.buffer.flag===4194310)b.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),u.buffer.edges_services=[];else{let f={error:new G(I.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:u.buffer.flag};l.push(f),d(f)}if(p!==0){let f=If(p),m={error:new G(I.CAN_NOT_GET_GATEWAY_SERVER,f.desc,{desc:f.desc,retry:f.retry,csIp:e.detail[502]}),flag:u.buffer.flag};u.buffer.flag===4194310?b.warning(m.error.toString()):l.push(m),d(m)}}),l.length)throw b.warning("[".concat(a||"sid-".concat(s.slice(0,6)),"] multi unilbs ").concat(t," failed, ").concat(l.map(u=>"flag: ".concat(u.flag,", message: ").concat(u.error.message,", retry: ").concat(u.error.data.retry)).join(" | "))),new G(I.CAN_NOT_GET_GATEWAY_SERVER,l.map(u=>"flag: ".concat(u.flag,", message: ").concat(u.error.message)).join(" | "),{retry:!!l.find(u=>u.error.data.retry),csIp:e.detail[502],desc:[...new Set(l.map(u=>{var p;return u==null||(p=u.error)===null||p===void 0||(p=p.data)===null||p===void 0?void 0:p.desc}).filter(u=>!!u))]})},YD=e=>{var t,r,n,i;if(e.addresses&&e.addresses.length===0&&e.code===0)throw new G(I.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(D("AP_AREA")&&((n=e.detail)!==null&&n!==void 0&&n[23]&&typeof((i=e.detail)===null||i===void 0?void 0:i[23])=="string"?fB(e.detail[23].toLowerCase()):fB()),(t=e.detail)!==null&&t!==void 0&&t[19]&&typeof((r=e.detail)===null||r===void 0?void 0:r[19])=="string"){let s=e.detail[19],a=s==null?void 0:s.split(";");for(let c=0;c<a.length;c++){var o;let l=ci(o=a[c]).call(o);e.addresses[c]&&a&&(e.addresses[c].fingerprint=l)}}if(D("GATEWAY_ADDRESS")&&D("GATEWAY_ADDRESS").length>0){b.debug("assign gateway address to",D("GATEWAY_ADDRESS"));let s=D("GATEWAY_ADDRESS").map(a=>{var c,l;let d=(c=(l=e.addresses.find(u=>u.ip===a.ip&&u.port===a.port))===null||l===void 0?void 0:l.fingerprint)!==null&&c!==void 0?c:"";return{ip:a.ip,port:a.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:d}});e.addresses=s}},uMe=(e,t)=>{if(e.response_body&&e.response_body.length){let r=e.response_body[0];if(r.buffer.code!==0){let n=If(r.buffer.code);throw new G(I.UPDATE_TICKET_FAILED,"[".concat(r.buffer.code,"]: ").concat(n.desc),{retry:n.retry})}return r.buffer.ticket}throw b.debug("update ticket request received ap response without response body:",t),new G(I.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},XD=(e,t,r)=>{let n=Math.floor(Math.random()*1e12),i={appid:e.appId,client_ts:Date.now(),opid:n,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:qO({6:e.stringUid,11:t,12:D("USE_NEW_TOKEN")?"1":void 0,22:t},e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:r,uid:e.uid||0}}]};i.request_bodies.forEach(s=>{e.multiIP&&e.multiIP.gateway_ip&&(s.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});let o=new FormData;return o.append("request",JSON.stringify(i)),[o,n]},hMe=(e,t)=>{let r=Math.floor(Math.random()*1e12),n={appid:e.appId,client_ts:Date.now(),opid:r,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map(o=>({ip:o.ip,port:o.port}))}}]},i=new FormData;return i.append("request",JSON.stringify(n)),[i,r]},Qp=0;function dm(e){return de.all(e.map(t=>t.then(r=>{throw r},r=>r))).then(t=>{throw t},t=>t)}var W0=async e=>{let{fragementLength:t,referenceList:r,asyncMapHandler:n,allFailedhandler:i,promisesCollector:o}=e,s=0,a=t,c,l=0,d=async()=>{let u=(()=>{let p=s*a,f=p+a;return r.slice(p,f).map(n)})();o&&o.push(...u);try{c=await dm(u)}catch(p){if(l+=a,s++,!(l>=r.length))return void await d();i(p)}u.forEach(p=>p.cancel())};return await d(),c},eZ=async e=>{let{referenceList:t,asyncMapHandler:r,closeFn:n}=e,i=t.length,o=0,s=async()=>{let a=r(t.shift());try{return await a}catch(c){if(o++,o>=i||n!=null&&n(c))throw c;return s()}};return s()};async function YO(e,t,r,n){return{gatewayInfo:await async function(i,o,s,a){let c=null,l=[],d=async()=>{let p=D("WEBCS_DOMAIN").slice(0,D("AJAX_REQUEST_CONCURRENT")).map(g=>({url:i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(g+"/api/v2/transpond/webrtc?v=2"):"https://".concat(g,"/api/v2/transpond/webrtc?v=2"),areaCode:H0()})),f=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:p.map(g=>g.url)}),m=await W0({fragementLength:D("FRAGEMENT_LENGTH"),referenceList:p,asyncMapHandler:g=>(b.debug("[".concat(i.clientId,"] Connect to choose_server:"),g.url),gB(g,i,o,s)),allFailedhandler:g=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:g},f),g[0]},promisesCollector:l});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},f),m},u=async()=>{if(await Tn(1e3),c!==null)return c;let p=D("WEBCS_DOMAIN_BACKUP_LIST").map(g=>({url:i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(g+"/api/v2/transpond/webrtc?v=2"):"https://".concat(g,"/api/v2/transpond/webrtc?v=2"),areaCode:H0()})),f=a.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:p.map(g=>g.url)}),m=await W0({fragementLength:D("FRAGEMENT_LENGTH"),referenceList:p,asyncMapHandler:g=>(b.debug("[".concat(i.clientId,"] Connect to backup choose_server:"),g.url),gB(g,i,o,s)),allFailedhandler:g=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:g},f),g[0]},promisesCollector:l});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},f),m};try{return c=await dm([d(),u()]),l.length&&l.forEach(p=>p.cancel&&typeof p.cancel=="function"&&p.cancel()),c}catch(p){throw p[0]}}(e,t,r,n)}}async function vB(e,t,r,n,i){let o=e.cloudProxyServer;if(o==="disabled"){if(e.useLocalAccessPoint)return await YO(e,t,r,i);if(D("JOIN_WITH_FALLBACK_MEDIA_PROXY")){let{gatewayInfo:p,proxyInfo:f}=await _B(e,t,r,i);if(e.turnServer&&e.turnServer.mode!=="auto")return{gatewayInfo:p};let m=f.map(g=>({turnServerURL:g.address,tcpport:g.tcpport||xn.tcpport,udpport:g.udpport||xn.udpport,username:g.username||xn.username,password:g.password||xn.password,forceturn:!1,security:!0}));if(i.useP2P){var s;let g=(s=e.uid)!==null&&s!==void 0?s:p.uid,y="glb:".concat(g.toString()),v=await kO(y),E=f.map(w=>({turnServerURL:w.address,tcpport:w.tcpport||xn.tcpport,udpport:w.udpport||xn.udpport,username:y,password:v,forceturn:!1,security:!0}));m.push(...E)}return e.turnServer={mode:"manual",servers:m},{gatewayInfo:p}}return await YO(e,t,r,i)}let{proxyInfo:a,gatewayInfo:c}=await _B(e,t,r,i),l={gatewayInfo:c},d=a.map(p=>({turnServerURL:p.address,tcpport:o==="proxy3"?void 0:p.tcpport?p.tcpport:xn.tcpport,udpport:o==="proxy4"?void 0:p.udpport?p.udpport:xn.udpport,username:p.username||xn.username,password:p.password||xn.password,forceturn:o!=="proxy4",security:o==="proxy5"}));if(i.useP2P){var u;let p=(u=e.uid)!==null&&u!==void 0?u:c.uid,f="glb:".concat(p.toString()),m=await kO(f),g=a.map(y=>({turnServerURL:y.address,tcpport:o==="proxy3"?void 0:y.tcpport||xn.tcpport,udpport:o==="proxy4"?void 0:y.udpport||xn.udpport,username:f,password:m,forceturn:o!=="proxy4",security:o==="proxy5"}));d.push(...g)}return e.turnServer={mode:"manual",servers:d},b.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(o)),l}async function tZ(e,t,r,n,i){let o=D("ACCOUNT_REGISTER").slice(0,D("AJAX_REQUEST_CONCURRENT")),s=[];s=t.proxyServer?o.map(c=>"https://".concat(t.proxyServer,"/ap/?url=").concat(c+"/api/v1")):o.map(c=>"https://".concat(c,"/api/v1"));let a=i==null?void 0:i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:s});try{let c=await async function(l,d,u,p,f){let m=Date.now(),g={sid:u.sid,opid:10,appid:u.appId,string_uid:d},y=l[0],v=await Ua(()=>Fa(y+"".concat(y.indexOf("?")===-1?"?":"&","action=stringuid"),{data:g,cancelToken:p,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(E,w)=>{if(E.code===0){if(E.uid<=0||E.uid>=Math.pow(2,32))throw b.error("Invalid Uint Uid ".concat(d," => ").concat(E.uid),E),_e.reqUserAccount(g.sid,{lts:m,success:!1,serverAddr:y,stringUid:g.string_uid,uid:E.uid,errorCode:I.INVALID_UINT_UID_FROM_STRING_UID,extend:g}),new G(I.INVALID_UINT_UID_FROM_STRING_UID);return _e.reqUserAccount(g.sid,{lts:m,success:!0,serverAddr:y,stringUid:g.string_uid,uid:E.uid,errorCode:null,extend:g}),!1}let S=If(E.code);return S.retry&&(y=l[(w+1)%l.length]),_e.reqUserAccount(g.sid,{lts:m,success:!1,serverAddr:y,stringUid:g.string_uid,uid:E.uid,errorCode:S.desc,extend:g}),S.retry},(E,w)=>E.code!==I.OPERATION_ABORTED&&(_e.reqUserAccount(g.sid,{lts:m,success:!1,serverAddr:y,stringUid:g.string_uid,uid:null,errorCode:E.code,extend:g}),y=l[(w+1)%l.length],!0),f);if(v.code!==0){let E=If(v.code);throw new G(I.UNEXPECTED_RESPONSE,E.desc)}return v}(s,e,t,r,n);return i==null||i.recordJoinChannelService({status:"success",endTs:Date.now()},a),c.uid}catch(c){throw i==null||i.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[c]},a),c}}async function pMe(e,t,r){let n=D("ACCOUNT_REGISTER"),i=[];i=t.proxyServer?n.map(o=>"https://".concat(t.proxyServer,"/ap/?url=").concat(o+"/api/v1")):n.map(o=>"https://".concat(o,"/api/v1"));try{return await eZ({referenceList:i,asyncMapHandler:o=>async function(s,a,c,l){let d=Date.now(),u={sid:c.sid,opid:10,appid:c.appId,string_uid:a};try{let p=await Fa(s+"".concat(s.indexOf("?")===-1?"?":"&","action=stringuid"),{data:u,cancelToken:l,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(p.code!==0){let f=If(p.code);throw new G(I.UNEXPECTED_RESPONSE,"preload sua error:".concat(f.desc),f)}if(p.uid<=0||p.uid>=Math.pow(2,32))throw new G(I.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:d,url:s,req:u,uid:p.uid,elapse:Date.now()-d}}catch(p){throw p}}(o,e,t,r),closeFn:o=>o.code===I.OPERATION_ABORTED||o.code===I.UNEXPECTED_RESPONSE&&!o.data.retry})}catch(o){throw o}}async function fMe(e,t,r){let n=D("CDS_AP").slice(0,D("AJAX_REQUEST_CONCURRENT")).map(c=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(c+"/api/v1"):"https://".concat(c,"/api/v1?action=config")),i=n.map(c=>function(l,d,u,p){let f=yt(),m={flag:64,cipher_method:0,features:{device:f.name,system:f.os,system_general:navigator.userAgent,vendor:d.appId,version:os,cname:d.cname,sid:d.sid,session_id:d.sid,detail:"",proxyServer:d.proxyServer}};return Ua(()=>Fa(l,{data:m,timeout:1e3,cancelToken:u,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,g=>g.code!==I.OPERATION_ABORTED,p)}(c,e,t,r)),o=null,s=null,a={};try{o=await dm(i)}catch(c){if(c.code===I.OPERATION_ABORTED)throw c;s=c}if(i.forEach(c=>c.cancel()),_e.reportApiInvoke(e.sid,{name:Gr.REQUEST_CONFIG_DISTRIBUTE,options:{error:s,res:o}}).onSuccess(),o&&o.test_tags)try{a=function(c){if(!c.test_tags)return{};let l=c.test_tags,d=Object.keys(l),u={};return d.forEach(p=>{var f;let m=ci(f=p.slice(4)).call(f),g=JSON.parse(l[p])[1];u[m]=g}),u}(o)}catch{}return a}async function EB(e,t){let r=D("WEBCS_DOMAIN").concat(D("WEBCS_DOMAIN_BACKUP_LIST")).map(n=>({url:"https://".concat(n,"/api/v2/transpond/webrtc?v=2"),areaCode:H0(),serviceIds:[Pr.CHOOSE_SERVER,Pr.CLOUD_PROXY_FALLBACK]}));try{return await eZ({referenceList:r,asyncMapHandler:n=>async function(i,o,s){let a,{url:c,areaCode:l,serviceIds:d}=i,u=Date.now(),[p,f]=XD(o,l,d),m=Dr.networkState;try{m&&Dr.networkState===oo.OFFLINE&&Dr.onlineWaiter&&await de.race([Dr.onlineWaiter,Tn(Fr.maxRetryTimeout)]),m=Dr.networkState;let{data:g,headers:y}=await Fa(c,{data:p,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);a=y.http3==="1"?1:-1,(w=>{let S=[];if(w.response_body.forEach(A=>{let N=A.buffer.code;if(A.uri===23&&N===0&&!A.buffer.edges_services)if(A.buffer.flag===4194310)A.buffer.edges_services=[];else{let L={error:new G(I.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:w.detail[502]}),flag:A.buffer.flag};S.push(L)}if(N!==0){let L=If(N),j={error:new G(I.CAN_NOT_GET_GATEWAY_SERVER,L.desc,{desc:L.desc,retry:L.retry,csIp:w.detail[502]}),flag:A.buffer.flag};A.buffer.flag===4194310?b.warning(j.error.toString()):S.push(j)}}),S.length)throw new G(I.CAN_NOT_GET_GATEWAY_SERVER,S.map(A=>"flag: ".concat(A.flag,", message: ").concat(A.error.message)).join(" | "),{retry:!!S.find(A=>A.error.data.retry),csIp:w.detail[502],desc:[...new Set(S.map(A=>{var N;return A==null||(N=A.error)===null||N===void 0||(N=N.data)===null||N===void 0?void 0:N.desc}).filter(A=>!!A))]})})(g);let v=B0(g,Pr.CHOOSE_SERVER),E=B0(g,Pr.CLOUD_PROXY_FALLBACK);return YD(v),{gatewayInfo:jD(v,c),proxyInfo:E,opid:f,requestTime:u,url:c,isHttp3:a,elapse:Date.now()-u}}catch(g){throw g}}(n,e,t),closeFn:n=>n.code===I.OPERATION_ABORTED||n.code===I.CAN_NOT_GET_GATEWAY_SERVER&&!n.data.retry})}catch(n){throw n}}async function _B(e,t,r,n){let i=D("PROXY_SERVER_TYPE3"),o=(f,m,g)=>{let y=g||i;return Array.isArray(y)&&(y=m%2==0?i[1]:i[0]),"https://".concat(y,"/ap/?url=").concat(f)},s=null,a=[],c=async()=>{let f=D("WEBCS_DOMAIN").slice(0,D("AJAX_REQUEST_CONCURRENT")).map((y,v)=>{let E;return E=e.cloudProxyServer==="disabled"&&e.proxyServer?o("".concat(y,"/api/v2/transpond/webrtc?v=2"),v,e.proxyServer):e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(y,"/api/v2/transpond/webrtc?v=2"):o("".concat(y,"/api/v2/transpond/webrtc?v=2"),v),{url:E,areaCode:H0(),serviceIds:[Pr.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?Pr.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?Pr.CLOUD_PROXY:Pr.CLOUD_PROXY_FALLBACK]}}),m=n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:f.map(y=>y.url)}),g=await W0({fragementLength:D("FRAGEMENT_LENGTH"),referenceList:f,asyncMapHandler:y=>(b.debug("[".concat(e.clientId,"] Connect to choose_server:"),y.url),yB(y,e,t,r)),allFailedhandler:y=>{throw n.recordJoinChannelService({endTs:Date.now(),status:"error",errors:y},m),y[0]},promisesCollector:a});return n.recordJoinChannelService({endTs:Date.now(),status:"success"},m),g},l=async()=>{if(await Tn(1e3),s!==null)return s;let f=D("WEBCS_DOMAIN_BACKUP_LIST").map((y,v)=>{let E;return E=e.cloudProxyServer==="disabled"&&e.proxyServer?o("".concat(y,"/api/v2/transpond/webrtc?v=2"),v,e.proxyServer):e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(y,"/api/v2/transpond/webrtc?v=2"):o("".concat(y,"/api/v2/transpond/webrtc?v=2"),v),{url:E,areaCode:H0(),serviceIds:[Pr.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?Pr.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?Pr.CLOUD_PROXY:Pr.CLOUD_PROXY_FALLBACK]}}),m=n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:f.map(y=>y.url)}),g=await W0({fragementLength:D("FRAGEMENT_LENGTH"),referenceList:f,asyncMapHandler:y=>(b.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),y.url),yB(y,e,t,r)),allFailedhandler:y=>{throw n.recordJoinChannelService({endTs:Date.now(),status:"error",errors:y},m),y[0]},promisesCollector:a});return n.recordJoinChannelService({endTs:Date.now(),status:"success"},m),g},d,u,p;try{({gatewayInfo:d,proxyInfo:u,url:p}=await dm([c(),l()]))}catch(f){throw f[0]}if(a.length&&a.forEach(f=>f.cancel&&typeof f.cancel=="function"&&f.cancel()),!d||!u)throw new G(I.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=p,e.cloudProxyServer!=="disabled"&&Array.isArray(i)&&p){let f=/^https?:\/\/(.+?)(\/.*)?$/.exec(p)[1];pe(i).call(i,f)&&(e.proxyServer=f,b.setProxyServer(f),_e.setProxyServer(f))}return s={gatewayInfo:d,proxyInfo:await dQ(u,d.uid)},s}async function mMe(e,t,r){let n=D("UAP_AP").slice(0,D("AJAX_REQUEST_CONCURRENT")).map(o=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(o+"/api/v1?action=uap"):"https://".concat(o,"/api/v1?action=uap")),i=n.map(o=>function(s,a,c,l){let d={command:"convergeAllocateEdge",sid:a.sid,appId:a.appId,token:a.token,ts:Date.now(),version:os,cname:a.cname,uid:a.uid.toString(),requestId:kI,seq:kI};kI+=1;let u={service_name:"tele_channel",json_body:JSON.stringify(d)};return Ua(async()=>{let p=await Fa(s,{data:u,cancelToken:c,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(p.code!==0){let m=new G(I.UNEXPECTED_RESPONSE,"cross channel ap error, code"+p.code,{retry:!0});throw b.error(m.toString()),m}let f=JSON.parse(p.json_body);if(f.code!==200){let m=new G(I.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(f.code,", reason: ").concat(f.reason));throw b.error(m.toString()),m}if(!f.servers||f.servers.length===0){let m=new G(I.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw b.error(m.toString()),m}return{vid:f.vid,workerToken:f.workerToken,addressList:(D("CHANNEL_MEDIA_RELAY_SERVERS")||f.servers).map(m=>"wss://".concat(m.address.replace(/\./g,"-"),".").concat(D("WORKER_DOMAIN"),":").concat(m.wss))}},void 0,p=>!!(p.code!==I.OPERATION_ABORTED&&p.code!==I.UNEXPECTED_RESPONSE||p.data&&p.data.retry),l)}(o,e,t,r));try{let o=await dm(i);return i.forEach(s=>s.cancel()),o}catch(o){throw o[0]}}async function gMe(e,t,r){let n=null,i=[],o=async s=>{let a=D(s?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(c=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(c+"/api/v2/transpond/webrtc?v=2"):"https://".concat(c,"/api/v2/transpond/webrtc?v=2"));return s&&(await Tn(1e3),n!==null)?n:await W0({fragementLength:D("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:c=>(b.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(s?"backup":""," choose_server:"),c),function(l,d,u,p){let[f]=hMe(d,[Pr.CHOOSE_SERVER]),m=Dr.networkState;return Ua(async()=>{m&&Dr.networkState===oo.OFFLINE&&Dr.onlineWaiter&&await de.race([Dr.onlineWaiter,Tn(p&&p.maxRetryTimeout||Fr.maxRetryTimeout)]),m=Dr.networkState;let g=await Fa(l,{data:f,cancelToken:u,headers:{"Content-Type":"multipart/form-data;"}},!0);return uMe(g,l)},()=>!1,g=>g.code!==I.OPERATION_ABORTED&&(g.code===I.UPDATE_TICKET_FAILED?g.data.retry:(b.warning("[".concat(d.clientId,"] update ticket network error, retry"),g),!0)),p)}(c,e,t,r)),allFailedhandler:c=>{throw c[0]},promisesCollector:i})};try{return n=await dm([o(!1),o(!0)]),i.length&&i.forEach(s=>s.cancel&&typeof s.cancel=="function"&&s.cancel()),n}catch(s){throw s[0]}}function bB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var yMe=class extends fr{get isSuccess(){return!!this.configs}constructor(){super(),C(this,"configs",void 0),C(this,"joinInfo",void 0),C(this,"cancelToken",void 0),C(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),C(this,"interval",void 0),C(this,"mutex",new Gn("config-distribute")),C(this,"mutableParamsRead",!1)}startGetConfigDistribute(e,t){this.joinInfo=e,this.cancelToken=t,this.interval&&this.stopGetConfigDistribute(),D("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},D("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,_e.reportApiInvoke(null,{options:void 0,name:Gr.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Er.TRACER}).onSuccess(JSON.stringify(nd))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void b.debug("[config-distribute] get config distribute interrupted have no joininfo");let e,t=await this.mutex.lock();try{e=await fMe(this.joinInfo,this.cancelToken,this.retryConfig),b.debug("[config-distribute] get config distribute",JSON.stringify(e)),e.limit_bitrate&&this.handleBitrateLimit(e.limit_bitrate),this.cacheGlobalParameterConfig(e),this.configs=e}catch(r){let n=new G(I.NETWORK_RESPONSE_ERROR,r);b.warning("[config-distribute] ".concat(n.toString()))}finally{t()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(e){var t;(t=e)&&t.uplink&&t.id&&t.uplink.max_bitrate!==void 0&&t.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(jO.UPDATE_BITRATE_LIMIT,e):this.emit(jO.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&wB({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(e){var t;let r=Vy(t=Object.keys(e).filter(i=>/^webrtc_ng_global_parameter/.test(i))).call(t);for(let i=0;i<r.length;i++)for(let o=r.length-1;o>i;o--){let s=r[o];if(typeof e[s].__priority=="number"){let a=e[s].__priority,c=r[o-1];if(typeof e[c].__priority=="number"){if(!(a>e[c].__priority))continue;{let l=s;r[o]=r[o-1],r[o-1]=l}}else{let l=s;r[o]=r[o-1],r[o-1]=l}}}let n={};r.forEach(i=>{let o=e[i],s=o.__expires;Object.keys(o).forEach(a=>{a==="__priority"||a==="__expires"||Object.prototype.hasOwnProperty.call(n,a)||(n[a]=wB({value:o[a]},s&&{expires:s}))})});try{(function(s){try{let a=Date.now();Object.keys(s).forEach(c=>{switch(c){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":case"ENABLE_AG_ADAPTATION":case"FORCE_AG_HIGH_FRAMERATE":case"FORCE_SUPPORT_AG_ADAPTATION":case"ENCODER_CONFIG_LIMIT":case"CAMERA_CAPTURE_CONFIG":case"ENABLE_PRELOAD":if(Object.prototype.hasOwnProperty.call(Ir,c)){let{value:l,expires:d}=s[c];if(d&&d<=a)return;nd[c]=l,Ir[c]=l,b.debug("Update global parameters from config distribute",c,l)}}})}catch(a){b.error("Error update config immediately: ".concat(s),a.message)}})(n);let i=JSON.stringify(n),o=window.btoa(i);window.localStorage.setItem("websdk_ng_global_parameter",o),b.debug("Caching global parameters ".concat(i))}catch(i){b.error("Error caching global parameters:",i.message)}}},vMe=class extends fr{constructor(){super(...arguments),C(this,"resultStorage",new Map)}setLocalAudioStats(e,t,r){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(r,t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(r,t))}setLocalVideoStats(e,t,r){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(r,t)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(r,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(r))}setRemoteAudioStats(e,t){let r=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",r,this.checkAudioOutputLevel(t))}setRemoteVideoStats(e,t){let r=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",r,this.checkVideoDecode(t))}record(e,t,r){if(D("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});let n=this.resultStorage.get(e);if(n&&(n.result.push(r),n.result.length>=5)){var i;let o=pe(i=n.result).call(i,!0);n.isPrevNormal&&!o&&this.emit("exception",SB[e],e,t),!n.isPrevNormal&&o&&this.emit("exception",SB[e]+2e3,e+"_RECOVER",t),n.isPrevNormal=o,n.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&e.receiveLevel===0)}checkAudioInputLevel(e,t){return t instanceof on&&!t.isActive||!!t.muted||e.sendVolumeLevel!==0}checkFramerateInput(e,t){let r=null;t._encoderConfig&&t._encoderConfig.frameRate&&(r=ao(t._encoderConfig.frameRate));let n=e.captureFrameRate;return!r||!n||!(r>10&&n<5||r<10&&r>=5&&n<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checkSendVideoBitrate(e,t){return!!t.muted||e.sendBitrate!==0}checkSendAudioBitrate(e,t){return t instanceof on&&!t.isActive||!!t.muted||e.sendBitrate!==0}checkVideoDecode(e){return e.receiveBitrate===0||e.decodeFrameRate!==0}},SB={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},$n=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){let r=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(r.length>0){let n=r[r.length-1];return Math.round(performance.now()-n.startTime)}return 0}measureFromPublishStart(e,t){let r=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(r.length>0){let n=r[r.length-1];return Math.round(performance.now()-n.startTime)}return 0}};function JD(e,t){this.v=e,this.k=t}function wt(e){return new JD(e,0)}var EMe=iX,_Me=Rc;Yt({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var e=_Me.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var bMe=Rc,wMe=om;Yt({target:"Promise",stat:!0,forced:!0},{try:function(e){var t=bMe.f(this),r=wMe(e);return(r.error?t.reject:t.resolve)(r.value),t.promise}});var XO=xr(EMe),rZ=sm.f("asyncIterator"),SMe=xr(rZ);function hg(e){var t,r;function n(o,s){try{var a=e[o](s),c=a.value,l=c instanceof JD;XO.resolve(l?c.v:c).then(function(d){if(l){var u=o==="return"?"return":"next";if(!c.k||d.done)return n(u,d);d=e[u](d).value}i(a.done?"return":"normal",d)},function(d){n("throw",d)})}catch(d){i("throw",d)}}function i(o,s){switch(o){case"return":t.resolve({value:s,done:!0});break;case"throw":t.reject(s);break;default:t.resolve({value:s,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(o,s){return new XO(function(a,c){var l={key:o,arg:s,resolve:a,reject:c,next:null};r?r=r.next=l:(t=r=l,n(o,s))})},typeof e.return!="function"&&(this.return=void 0)}function Ia(e){return function(){return new hg(e.apply(this,arguments))}}hg.prototype[typeof Ip=="function"&&SMe||"@@asyncIterator"]=function(){return this},hg.prototype.next=function(e){return this._invoke("next",e)},hg.prototype.throw=function(e){return this._invoke("throw",e)},hg.prototype.return=function(e){return this._invoke("return",e)};var TB=xr(ja.Object.getOwnPropertySymbols),TMe=Yt,CMe=XP.indexOf,RMe=MS,JO=x0([].indexOf),CB=!!JO&&1/JO([1],1,-0)<0;TMe({target:"Array",proto:!0,forced:CB||!RMe("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return CB?JO(this,e,t)||0:CMe(this,e,t)}});var IMe=sa("Array").indexOf,AMe=Ti,xMe=IMe,PI=Array.prototype,OMe=function(e){var t=e.indexOf;return e===PI||AMe(PI,e)&&t===PI.indexOf?xMe:t},RB=xr(OMe);function NMe(e,t){if(e==null)return{};var r,n,i=function(s,a){if(s==null)return{};var c,l,d={},u=iQ(s);for(l=0;l<u.length;l++)c=u[l],RB(a).call(a,c)>=0||(d[c]=s[c]);return d}(e,t);if(TB){var o=TB(e);for(n=0;n<o.length;n++)r=o[n],RB(t).call(t,r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Ws(e){if(Array.isArray(e))return e.map(r=>r);if(!IB(e))return e;let t={};for(let r in e){let n=e[r];IB(n)||Array.isArray(n)?t[r]=Ws(n):t[r]=n}return t}function IB(e){return!(typeof e!="object"||Array.isArray(e)||!e)}var DI=class{constructor(e){C(this,"input",[]),C(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}},Ec={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},G0={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:Ec,remoteCandidate:Ec}},nZ={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0},iZ={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},oZ={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},sZ={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function AB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var QD=class{constructor(e,t){C(this,"onFirstVideoReceived",void 0),C(this,"onFirstVideoDecoded",void 0),C(this,"onFirstAudioReceived",void 0),C(this,"onFirstVideoDecodedTimeout",void 0),C(this,"onFirstAudioDecoded",void 0),C(this,"onSelectedLocalCandidateChanged",void 0),C(this,"onSelectedRemoteCandidateChanged",void 0),C(this,"videoIsReady",!1),C(this,"videoIsReady2",{}),C(this,"pc",void 0),C(this,"options",void 0),C(this,"intervalTimer",void 0),C(this,"stats",Ws(G0)),C(this,"isFirstVideoReceived",{}),C(this,"isFirstVideoDecoded",{}),C(this,"isFirstAudioReceived",{}),C(this,"isFirstAudioDecoded",{}),C(this,"isFirstVideoDecodedTimeout",{}),C(this,"lossRateWindowStats",[]),this.pc=e,this.options=t,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new de(e=>{e({local:xB({},Ec),remote:xB({},Ec)})})}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,t){this.videoIsReady2[e]=t}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);let t=this.lossRateWindowStats.length,r=["videoSend","audioSend","videoRecv","audioRecv"],n=0,i=0,o=0,s=0;for(let a of r)e[a].forEach((c,l)=>{if(!this.lossRateWindowStats[t-1][a][l]||!this.lossRateWindowStats[0][a][l])return;let d=this.lossRateWindowStats[t-1][a][l].packets-this.lossRateWindowStats[0][a][l].packets,u=this.lossRateWindowStats[t-1][a][l].packetsLost-this.lossRateWindowStats[0][a][l].packetsLost;a==="videoSend"||a==="audioSend"?(n+=d,o+=u):(i+=d,s+=u),Number.isNaN(d)||Number.isNaN(d)?c.packetLostRate=0:c.packetLostRate=d<=0||u<=0?0:u/(d+u)});e.sendPacketLossRate=n<=0||o<=0?0:o/(n+o),e.recvPacketLossRate=i<=0||s<=0?0:s/(i+s)}};function OB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kMe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var PMe=class extends QD{constructor(){super(...arguments),C(this,"_stats",G0),C(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){let e=await this._getStats(),t=this.statsResponsesToObjects(e);this._stats=Ws(G0);let r=t.filter(i=>i.type==="ssrc");this.processSSRCStats(r);let n=t.find(i=>i.type==="VideoBwe");n&&this.processBandwidthStats(n),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach(t=>{var r;let n=pe(r=t.id).call(r,"send");switch("".concat(t.mediaType,"_").concat(n?"send":"recv")){case"video_send":{let i=Ws(iZ);i.codec=t.googCodecName,i.adaptionChangeReason="none",t.googCpuLimitedResolution&&(i.adaptionChangeReason="cpu"),t.googBandwidthLimitedResolution&&(i.adaptionChangeReason="bandwidth"),i.avgEncodeMs=Number(t.googAvgEncodeMs),i.inputFrame={width:Number(t.googFrameWidthInput)||Number(t.googFrameWidthSent),height:Number(t.googFrameHeightInput)||Number(t.googFrameHeightSent),frameRate:Number(t.googFrameRateInput)},i.sentFrame={width:Number(t.googFrameWidthSent),height:Number(t.googFrameHeightSent),frameRate:Number(t.googFrameRateInput)},i.firsCount=Number(t.googFirReceived),i.nacksCount=Number(t.googNacksReceived),i.plisCount=Number(t.googPlisReceived),i.frameCount=Number(t.framesEncoded),i.bytes=Number(t.bytesSent),i.packets=Number(t.packetsSent),i.packetsLost=Number(t.packetsLost),i.ssrc=Number(t.ssrc),i.rttMs=Number(t.googRtt||0),this._stats.videoSend.push(i),this._stats.rtt=i.rttMs;break}case"video_recv":{let i=Ws(nZ),o=this.lastDecodeVideoReceiverStats.get(Number(t.ssrc));if(i.codec=t.googCodecName,i.targetDelayMs=Number(t.googTargetDelayMs),i.renderDelayMs=Number(t.googRenderDelayMs),i.currentDelayMs=Number(t.googCurrentDelayMs),i.minPlayoutDelayMs=Number(t.googMinPlayoutDelayMs),i.decodeMs=Number(t.googDecodeMs),i.maxDecodeMs=Number(t.googMaxDecodeMs),i.receivedFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateReceived)},i.decodedFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateDecoded)},i.decodeFrameRate=Number(t.googFrameRateDecoded),i.outputFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateOutput)},i.jitterBufferMs=Number(t.googJitterBufferMs),i.firsCount=Number(t.googFirsSent),i.nacksCount=Number(t.googNacksSent),i.plisCount=Number(t.googPlisSent),i.framesDecodeCount=Number(t.framesDecoded),i.bytes=Number(t.bytesReceived),i.packets=Number(t.packetsReceived),i.packetsLost=Number(t.packetsLost),i.ssrc=Number(t.ssrc),i.packets>0&&!this.isFirstVideoReceived[i.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(i.ssrc),this.isFirstVideoReceived[i.ssrc]=!0),i.framesDecodeCount>0&&!this.isFirstVideoDecoded[i.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(i.ssrc,i.decodedFrame.width,i.decodedFrame.height),this.isFirstVideoDecoded[i.ssrc]=!0),o){let s=o.stats,a=Date.now()-o.lts;i.framesDecodeFreezeTime=s.framesDecodeFreezeTime,i.framesDecodeInterval=s.framesDecodeInterval,i.framesDecodeCount>s.framesDecodeCount&&this.isFirstVideoDecoded[i.ssrc]?(o.lts=Date.now(),i.framesDecodeInterval=a,i.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(t.ssrc,10))?i.framesDecodeFreezeTime+=i.framesDecodeInterval:this.setVideoIsReady2(parseInt(t.ssrc,10),!0))):i.framesDecodeCount<o.stats.framesDecodeCount&&(i.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(i.ssrc,{stats:kMe({},i),lts:Date.now()}),this._stats.videoRecv.push(i);break}case"audio_recv":{let i=Ws(sZ);i.codec=t.googCodecName,i.outputLevel=Math.abs(Number(t.audioOutputLevel))/32767,i.decodingCNG=Number(t.googDecodingCNG),i.decodingCTN=Number(t.googDecodingCTN),i.decodingCTSG=Number(t.googDecodingCTSG),i.decodingNormal=Number(t.googDecodingNormal),i.decodingPLC=Number(t.googDecodingPLC),i.decodingPLCCNG=Number(t.googDecodingPLCCNG),i.expandRate=Number(t.googExpandRate),i.accelerateRate=Number(t.googAccelerateRate),i.preemptiveExpandRate=Number(t.googPreemptiveExpandRate),i.secondaryDecodedRate=Number(t.googSecondaryDecodedRate),i.speechExpandRate=Number(t.googSpeechExpandRate),i.preferredJitterBufferMs=Number(t.googPreferredJitterBufferMs),i.jitterBufferMs=Number(t.googJitterBufferMs),i.jitterMs=Number(t.googJitterReceived),i.bytes=Number(t.bytesReceived),i.packets=Number(t.packetsReceived),i.packetsLost=Number(t.packetsLost),i.ssrc=Number(t.ssrc),i.receivedFrames=Number(t.googDecodingCTN)||Number(t.packetsReceived),i.droppedFrames=Number(t.googDecodingPLC)+Number(t.googDecodingPLCCNG)||Number(t.packetsLost),i.receivedFrames>0&&!this.isFirstAudioReceived[i.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(i.ssrc),this.isFirstAudioReceived[i.ssrc]=!0),i.decodingNormal>0&&!this.isFirstAudioDecoded[i.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(i.ssrc),this.isFirstAudioDecoded[i.ssrc]=!0),this._stats.audioRecv.push(i);break}case"audio_send":{let i=Ws(oZ);i.codec=t.googCodecName,i.inputLevel=Math.abs(Number(t.audioInputLevel))/32767,i.aecReturnLoss=Number(t.googEchoCancellationReturnLoss||0),i.aecReturnLossEnhancement=Number(t.googEchoCancellationReturnLossEnhancement||0),i.residualEchoLikelihood=Number(t.googResidualEchoLikelihood||0),i.residualEchoLikelihoodRecentMax=Number(t.googResidualEchoLikelihoodRecentMax||0),i.bytes=Number(t.bytesSent),i.packets=Number(t.packetsSent),i.packetsLost=Number(t.packetsLost),i.ssrc=Number(t.ssrc),i.rttMs=Number(t.googRtt||0),this._stats.rtt=i.rttMs,this._stats.audioSend.push(i);break}}})}_getStats(){return new de((e,t)=>{this.pc.getStats(e,t)})}statsResponsesToObjects(e){let t=[];return e.result().forEach(r=>{let n={id:r.id,timestamp:r.timestamp.valueOf().toString(),type:r.type};r.names().forEach(i=>{n[i]=r.stat(i)}),t.push(n)}),t}};function NB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Zd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var kB=class extends QD{constructor(){super(...arguments),C(this,"_stats",G0),C(this,"report",void 0),C(this,"lastDecodeVideoReceiverStats",new Map),C(this,"lastVideoFramesRecv",new Map),C(this,"lastVideoFramesSent",new Map),C(this,"lastVideoFramesDecode",new Map),C(this,"lastVideoFramesOutput",new Map),C(this,"lastVideoJBDelay",new Map),C(this,"lastAudioJBDelay",new Map),C(this,"mediaBytesSent",new Map),C(this,"mediaBytesRetransmit",new Map),C(this,"mediaBytesTargetEncode",new Map),C(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=Ws(G0),this.report.forEach(e=>{switch(e.type){case yo.OUTBOUND:case yo.INBOUND:{let t=e.mediaType||e.kind,r=!t&&"frameWidth"in e,n=!t&&!("frameWidth"in e);e.type===yo.OUTBOUND?t==="audio"||n?this.processAudioOutboundStats(e):(t==="video"||r)&&this.processVideoOutboundStats(e):e.type===yo.INBOUND&&(t==="audio"||n?this.processAudioInboundStats(e):(t==="video"||r)&&this.processVideoInboundStats(e));break}case yo.TRANSPORT:{let t=this.report.get(e.selectedCandidatePairId);t&&this.processCandidatePairStats(t);break}case yo.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){let e=await this.pc.getStats(),t={local:Zd({},Ec),remote:Zd({},Ec)};return e.forEach(r=>{let n;if(r.type===yo.TRANSPORT&&(n=e.get(r.selectedCandidatePairId)),r.type===yo.CANDIDATE_PAIR&&r.selected&&(n=r),n){let i=(o,s)=>{o.type=s.type,o.id=s.id,s.address&&(o.address=s.address),s.candidateType&&(o.candidateType=s.candidateType),s.port&&(o.port=s.port),s.priority&&(o.priority=s.priority),s.protocol&&(o.protocol=s.protocol),s.relayProtocol&&(o.relayProtocol=s.relayProtocol)};if(n.localCandidateId){let o=e.get(n.localCandidateId);o&&i(t.local,o)}if(n.remoteCandidateId){let o=e.get(n.remoteCandidateId);o&&i(t.remote,o)}}}),t}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach(t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}),this._stats.audioSend.forEach(t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){let t=this.report.get(e.localCandidateId);t&&this.processCandidateStats(t)}if(e.remoteCandidateId){let t=this.report.get(e.remoteCandidateId);t&&this.processCandidateStats(t)}}processCandidateStats(e){let t;e.type===yo.LOCAL_CANDIDATE&&(t=this._stats.selectedCandidatePair.localCandidate),e.type===yo.REMOTE_CANDIDATE&&(t=this._stats.selectedCandidatePair.remoteCandidate),t&&(t.type=e.type,t.id=e.id,e.address&&(t.address=e.address),e.candidateType&&(t.candidateType=e.candidateType),e.port&&(t.port=e.port),e.priority&&(t.priority=e.priority),e.protocol&&(t.protocol=e.protocol),e.relayProtocol&&(t.relayProtocol=e.relayProtocol),e.type===yo.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Zd({},t),Zd({},this.stats.selectedCandidatePair.localCandidate)),e.type===yo.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Zd({},t),Zd({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let t=this._stats.audioRecv.find(r=>r.ssrc===e.ssrc);t||(t=Ws(sZ),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.packetsDiscarded=e.packetsDiscarded,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,this.processAudioTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),typeof e.concealedSamples=="number"&&(t.concealedSamples=e.concealedSamples)}processVideoInboundStats(e){let t=this._stats.videoRecv.find(s=>s.ssrc===e.ssrc);t||(t=Ws(nZ),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded,t.framesDroppedCount=e.framesDropped,t.totalInterFrameDelay=e.totalInterFrameDelay,t.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay,t.totalFreezesDuration=e.totalFreezesDuration;let r=this.lastDecodeVideoReceiverStats.get(t.ssrc),n=this.lastVideoFramesDecode.get(t.ssrc),i=this.lastVideoFramesOutput.get(t.ssrc),o=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){let s=t.decodedFrame?t.decodedFrame.width:0,a=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,s,a),this.isFirstVideoDecoded[t.ssrc]=!0}if(r){let s=r.stats,a=o-r.lts;t.framesDecodeFreezeTime=s.framesDecodeFreezeTime,t.framesDecodeInterval=s.framesDecodeInterval,!this.isFirstVideoDecoded[t.ssrc]&&a>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[t.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(t.ssrc),this.isFirstVideoDecodedTimeout[t.ssrc]=!0),t.framesDecodeCount>s.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(r.lts=Date.now(),t.framesDecodeInterval=a,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<s.framesDecodeCount&&(t.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(r.stats.framesDecodeCount>e.framesDecoded?t.qpSumPerFrame=e.qpSum/e.framesDecoded:t.qpSumPerFrame=(e.qpSum-r.qpSum)/(e.framesDecoded-r.stats.framesDecodeCount))}n&&o-n.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-n.count)/((o-n.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:o,rate:t.decodeFrameRate})):n?t.decodeFrameRate=n.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:o,rate:0}),t.framesDroppedCount&&e.framesReceived&&(i&&o-i.lts>=800?(t.outputFrameRate=Math.round((e.framesReceived-t.framesDroppedCount-i.count)/((o-i.lts)/1e3)),this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:o,rate:Math.max(t.outputFrameRate,0)})):i?t.outputFrameRate=i.rate:this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:o,rate:0})),e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime),this.processVideoTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:Zd({},t),lts:r?r.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let t=this._stats.videoSend.find(n=>n.ssrc===e.ssrc);t||(t=Ws(iZ),this._stats.videoSend.push(t));let r=this.mediaBytesSent.get(e.ssrc);if(r)r.add(e.bytesSent);else{let n=new DI(10);n.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,n)}if(e.retransmittedBytesSent!==void 0){let n=this.mediaBytesRetransmit.get(e.ssrc);if(n)n.add(e.retransmittedBytesSent);else{let i=new DI(10);i.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,i)}}if(e.totalEncodedBytesTarget){let n=this.mediaBytesTargetEncode.get(e.ssrc);if(n)n.add(e.totalEncodedBytesTarget);else{let i=new DI(10);i.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,i)}}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,t.scalabilityMode=e.scalabilityMode,e.totalEncodeTime&&e.framesEncoded){let n=this.lastEncoderMs.get(e.ssrc);if(!n||n.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{let i=e.framesEncoded-n.lastFrameCount,o=e.totalEncodeTime-n.lastEncoderTime;t.avgEncodeMs=1e3*o/i}}if(e.framesEncoded&&e.qpSum){let n=this.lastEncoderMs.get(e.ssrc);!n||n.lastFrameCount>e.framesEncoded?t.qpSumPerFrame=e.qpSum/e.framesEncoded:t.qpSumPerFrame=(e.qpSum-n.lastQpSum)/(e.framesEncoded-n.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),this.processVideoTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{let n=this.findRemoteStatsId(e.ssrc,yo.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}}processAudioOutboundStats(e){let t=this._stats.audioSend.find(r=>r.ssrc===e.ssrc);if(t||(t=Ws(oZ),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{let r=this.findRemoteStatsId(e.ssrc,yo.REMOTE_INBOUND);r&&this.processRemoteInboundStats(r,t)}}findRemoteStatsId(e,t){var r;let n=Array.from(il(r=this.report).call(r)).find(i=>i.type===t&&i.ssrc===e);return n?n.id:null}processVideoMediaSource(e,t){let r=this.report.get(e);r&&r.width&&r.height&&r.framesPerSecond&&(t.inputFrame={width:r.width,height:r.height,frameRate:r.framesPerSecond})}processAudioMediaSource(e,t){let r=this.report.get(e);r&&(t.inputLevel=r.audioLevel)}processVideoTrackSenderStats(e,t,r){var n,i,o,s;let a=t?this.report.get(t):void 0,c=(n=a==null?void 0:a.framesSent)!==null&&n!==void 0?n:e.framesSent;if(typeof c!="number")return;let l=(i=a==null?void 0:a.frameWidth)!==null&&i!==void 0?i:e.frameWidth,d=(o=a==null?void 0:a.frameHeight)!==null&&o!==void 0?o:e.frameHeight,u=(s=a==null?void 0:a.framesPerSecond)!==null&&s!==void 0?s:e.framesPerSecond;if(typeof l=="number"&&typeof d=="number"||(l=0,d=0),u==null){let p=Date.now(),f=this.lastVideoFramesSent.get(r.ssrc);f&&p-f.lts>=800?(u=Math.round((c-f.count)/((p-f.lts)/1e3)),this.lastVideoFramesSent.set(r.ssrc,{count:c,lts:p,rate:u})):f?u=f.rate:this.lastVideoFramesSent.set(r.ssrc,{count:c,lts:p,rate:0})}r.sentFrame={width:l,height:d,frameRate:Math.max(0,u)}}processVideoTrackReceiverStats(e,t,r){var n,i,o,s,a;let c=t?this.report.get(t):void 0,l=(n=c==null?void 0:c.framesReceived)!==null&&n!==void 0?n:e.framesReceived,d=(i=c==null?void 0:c.frameWidth)!==null&&i!==void 0?i:e.frameWidth,u=(o=c==null?void 0:c.frameHeight)!==null&&o!==void 0?o:e.frameHeight,p=(s=c==null?void 0:c.jitterBufferDelay)!==null&&s!==void 0?s:e.jitterBufferDelay,f=(a=c==null?void 0:c.jitterBufferEmittedCount)!==null&&a!==void 0?a:e.jitterBufferEmittedCount;if(typeof l=="number"){let m=this.lastVideoFramesRecv.get(r.ssrc),g=Date.now();r.framesReceivedCount=l;let y=0;m&&g-m.lts>=800?(y=Math.round((l-m.count)/((g-m.lts)/1e3)),this.lastVideoFramesRecv.set(r.ssrc,{count:l,lts:g,rate:y})):m?y=m.rate:this.lastVideoFramesRecv.set(r.ssrc,{count:l,lts:g,rate:0}),r.receivedFrame={width:d||0,height:u||0,frameRate:y||0},r.decodedFrame={width:d||0,height:u||0,frameRate:r.decodeFrameRate||0},r.outputFrame={width:d||0,height:u||0,frameRate:r.outputFrameRate||r.decodeFrameRate||0}}if(p&&f){let m=this.lastVideoJBDelay.get(r.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0},g=m.jitterBufferMs,y=f-m.jitterBufferEmittedCount;y>0&&(g=1e3*(p-m.jitterBufferDelay)/y),r.jitterBufferMs=g,r.currentDelayMs=Math.round(g),this.lastVideoJBDelay.set(r.ssrc,{jitterBufferDelay:p,jitterBufferEmittedCount:f,jitterBufferMs:r.currentDelayMs})}}processAudioTrackSenderStats(e,t,r){var n,i,o,s;let a=t?this.report.get(t):void 0,c=(n=(i=a==null?void 0:a.echoReturnLoss)!==null&&i!==void 0?i:e.echoReturnLoss)!==null&&n!==void 0?n:0,l=(o=(s=a==null?void 0:a.echoReturnLossEnhancement)!==null&&s!==void 0?s:e.echoReturnLossEnhancement)!==null&&o!==void 0?o:0;r.aecReturnLoss=c,r.aecReturnLossEnhancement=l}processAudioTrackReceiverStats(e,t,r){var n,i,o,s,a,c,l;let d=t?this.report.get(t):void 0,u=(n=d==null?void 0:d.removedSamplesForAcceleration)!==null&&n!==void 0?n:e.removedSamplesForAcceleration,p=(i=d==null?void 0:d.totalSamplesReceived)!==null&&i!==void 0?i:e.totalSamplesReceived,f=(o=d==null?void 0:d.jitterBufferDelay)!==null&&o!==void 0?o:e.jitterBufferDelay,m=(s=d==null?void 0:d.jitterBufferEmittedCount)!==null&&s!==void 0?s:e.jitterBufferEmittedCount,g=(a=d==null?void 0:d.audioLevel)!==null&&a!==void 0?a:e==null?void 0:e.audioLevel,y=(c=d==null?void 0:d.totalSamplesDuration)!==null&&c!==void 0?c:e==null?void 0:e.totalSamplesDuration,v=(l=d==null?void 0:d.concealedSamples)!==null&&l!==void 0?l:e.concealedSamples;if(u&&p&&(r.accelerateRate=u/p),f&&m){let w=this.lastAudioJBDelay.get(r.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0},S=w.jitterBufferMs,A=m-w.jitterBufferEmittedCount;A>0&&(S=1e3*(f-w.jitterBufferDelay)/A),r.jitterBufferMs=Math.round(S),this.lastAudioJBDelay.set(r.ssrc,{jitterBufferDelay:f,jitterBufferEmittedCount:m,jitterBufferMs:r.jitterBufferMs})}r.outputLevel=g;let E=1920;y&&p&&(E=p/y/50,r.receivedFrames=Math.round(p/E)),v&&(r.droppedFrames=Math.round(v/E))}processRemoteInboundStats(e,t){let r=this.report.get(e);r&&(t.packetsLost=r.packetsLost,r.roundTripTime&&(t.rttMs=1e3*r.roundTripTime),r.jitter&&(t.jitterMs=1e3*r.jitter),r.timestamp&&(t.timestamp=r.timestamp))}getCodecFromCodecStats(e){let t=this.report.get(e);if(!t)return"";let r=t.mimeType.match(/\/(.*)$/);return r&&r[1]?r[1]:""}updateSendBitrate(){let e=0,t=null,r=null;this.mediaBytesSent.forEach(i=>{e+=i.diffMean()}),this.mediaBytesRetransmit.forEach(i=>{t=t===null?i.diffMean():t+i.diffMean()}),this.mediaBytesTargetEncode.forEach(i=>{r=r===null?i.diffMean():r+i.diffMean()});let n=t!==null?e-t:e;this._stats.bitrate={actualEncoded:8*n/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},t!==null&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),r!==null&&(this._stats.bitrate.targetEncoded=8*r/(this.options.updateInterval/1e3))}},DMe=class extends QD{updateStats(){return de.resolve()}};function ZD(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4,o=function(){let s=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return s&&s[0]?Number(s[0].split("/")[1]):null}();return o?o<76?new PMe(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:n,firstVideoDecodedTimeout:i}):new kB(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:n,firstVideoDecodedTimeout:i}):function(s){if(!window.RTCStatsReport)return!1;let a=s.getStats();return!!(a instanceof de||function(c){return!!c&&(typeof c=="object"||typeof c=="function")&&typeof c.then=="function"}(a))}(e)?new kB(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:n,firstVideoDecodedTimeout:i}):new DMe(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:n,firstVideoDecodedTimeout:i})}var PB=class{get localCapabilities(){return kr(this._localCapabilities)}get rtpCapabilities(){return kr(this._rtpCapabilities)}get candidates(){return kr(this._candidates)}get iceParameters(){return kr(this._iceParameters)}get dtlsParameters(){return kr(this._dtlsParameters)}constructor(e){C(this,"sessionDesc",void 0),C(this,"_localCapabilities",void 0),C(this,"_rtpCapabilities",void 0),C(this,"_candidates",void 0),C(this,"_iceParameters",void 0),C(this,"_dtlsParameters",void 0),C(this,"setup",void 0),C(this,"currentMidIndex",void 0),C(this,"cname","o/i14u9pJrxRKAsu"),C(this,"firefoxSsrcMidMap",new Map),e=kr(e);let{remoteIceParameters:t,remoteDtlsParameters:r,candidates:n,remoteRTPCapabilities:i,localCapabilities:o,direction:s,setup:a,videoCodec:c,audioCodec:l}=e,d;this.setup=a,d=s===yi.RECEIVE_ONLY?wn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):wn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=i,this._candidates=n,this._iceParameters=t,this._dtlsParameters=r,this._localCapabilities=o;let u=s===yi.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,p=s===yi.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,f=s===yi.RECEIVE_ONLY?i.send.videoCodecs:Vg(we.VIDEO,u,p,c),m=s===yi.RECEIVE_ONLY?i.send.audioCodecs:Vg(we.AUDIO,u,p,l);for(let g of d.mediaDescriptions)g.attributes.iceUfrag=t.iceUfrag,g.attributes.icePwd=t.icePwd,g.attributes.fingerprints=r.fingerprints,g.attributes.candidates=n,g.attributes.setup=this.setup,g.media.mediaType==="application"&&(g.attributes.sctpPort="5000"),g.media.mediaType==="video"&&(g.media.fmts=f.map(y=>y.payloadType.toString(10)),g.attributes.payloads=f,g.attributes.extmaps=u.videoExtensions),g.media.mediaType==="audio"&&(g.media.fmts=m.map(y=>y.payloadType.toString(10)),g.attributes.payloads=m,g.attributes.extmaps=u.audioExtensions,Nf(g));this.sessionDesc=d,this.currentMidIndex=d.mediaDescriptions.length-1}toString(){return wn.print(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every(t=>this.hasMid(t)):this.sessionDesc.mediaDescriptions.some(t=>t.attributes.mid===e)}send(e,t,r,n,i){r=r.replace(/ /g,"-");let{ssrcs:o,ssrcGroups:s}=fu(t,this.cname,D("SYNC_GROUP")?r:void 0),a=this.findPreloadMediaDesc(o);if(a){if(_r()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,a.attributes.mid),i&&(i.twcc||i.remb)){let c=this.sessionDesc.mediaDescriptions.indexOf(a);return this.sessionDesc.mediaDescriptions[c]=this.mungSendMediaDesc(a,i),{mid:a.attributes.mid,needExchangeSDP:!0}}return{mid:a.attributes.mid,needExchangeSDP:!1}}{let c=this.findAvailableMediaIndex(e,o,n),l;return c===-1?(l=this.createOrRecycleSendMedia(e,o,s,"sendonly",n,i),this.updateBundleMids()):(l=kr(this.sessionDesc.mediaDescriptions[c]),l.attributes.direction="sendonly",l.attributes.ssrcs=o,l.attributes.ssrcGroups=s,this.sessionDesc.mediaDescriptions[c]=this.mungSendMediaDesc(l,i)),_r()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,l.attributes.mid),{needExchangeSDP:!0,mid:l.attributes.mid}}}stopSending(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>r.attributes.mid&&e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(r=>{r.attributes.ssrcs=[]}),this.updateBundleMids()}receive(e,t,r){let n=[];return e.forEach(i=>{let o=i._mediaStreamTrack.kind,s=this.findAvailableRecvMediaIndex(o),a,c=!1;s===-1?(c=!0,a=this.createOrRecycleRecvMedia(i,[],"recvonly",t,r),this.updateBundleMids()):(a=kr(this.sessionDesc.mediaDescriptions[s]),a.attributes.direction="recvonly"),n.push({mid:a.attributes.mid,needCreateTransceiver:c})}),n}stopReceiving(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(r=>{r.media.port="0",r.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(e){let{foundation:t,protocol:r,address:n,port:i,type:o,relatedAddress:s,relatedPort:a,priority:c}=new RTCIceCandidate(e),l={foundation:t??"",componentId:"1",transport:r??"",priority:c?c+"":"",connectionAddress:n??"",port:i?i+"":"",type:o?o+"":"",relAddr:s??"",relPort:a?a+"":"",extension:{}};this.candidates.some(d=>d.priority===l.priority&&d.connectionAddress===l.connectionAddress&&d.port===l.port)||(this._candidates.push(l),this.sessionDesc.mediaDescriptions.forEach(d=>{d.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,t,r,n,i){let o=e._mediaStreamTrack.kind,s=this.rtpCapabilities.recv,a=Vg(o,s,this.localCapabilities.send,o===we.AUDIO?i:n),c=o===we.VIDEO?s.videoExtensions:s.audioExtensions,l="".concat(++this.currentMidIndex),d={media:{mediaType:o,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map(p=>p.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l)}};d=this.mungRecvMediaDsec(d,e);let u=this.findFirstClosedMedia(o);if(u){let p=this.sessionDesc.mediaDescriptions.indexOf(u);this.sessionDesc.mediaDescriptions[p]=d}else this.sessionDesc.mediaDescriptions.push(d);return d}muteRemote(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>pe(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="inactive"})}unmuteRemote(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>pe(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="recvonly"})}findAvailableMediaIndex(e,t,r){return this.sessionDesc.mediaDescriptions.findIndex(n=>{let i=n.media.mediaType===e&&n.media.port!=="0"&&(n.attributes.direction==="sendonly"||n.attributes.direction==="sendrecv")&&n.attributes.ssrcs.length===0;if(_r()){if(i){let o=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(o||n.attributes.mid!=="0"&&n.attributes.mid!=="1")||!(!o||o!==n.attributes.mid)}return!1}return i&&n.attributes.mid===r})}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex(t=>{let r=t.media.mediaType===e&&t.media.port!=="0"&&(t.attributes.direction==="recvonly"||t.attributes.direction==="sendrecv");return t.attributes.mid!=="0"&&t.attributes.mid!=="1"&&r})}predictReceivingMids(e){let t=[];for(let r=0;r<e;r++)t.push((this.currentMidIndex+r+1).toString(10));return t}restartICE(e){e=kr(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}createOrRecycleSendMedia(e,t,r,n,i,o){let s=this.rtpCapabilities.send,a=e===we.VIDEO?s.videoCodecs:s.audioCodecs,c=e===we.VIDEO?s.videoExtensions:s.audioExtensions;_r()&&(i="".concat(++this.currentMidIndex));let l={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map(u=>u.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:r,rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:i}};l=this.mungSendMediaDesc(l,o);let d=this.findFirstClosedMedia(e);if(d){let u=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[u]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}mungRecvMediaDsec(e,t,r){let n=kr(e);return GD(n),Of(n,t),zD(n,t),KQ(n),nw(n,r,this.localCapabilities.send),n}mungSendMediaDesc(e,t){let r=kr(e);return nw(r,t,this.localCapabilities.recv),Nf(r),r}updateRecvMedia(e,t){let r=this.sessionDesc.mediaDescriptions.findIndex(n=>n.attributes.mid===e);if(r!==-1){let n=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],t);this.sessionDesc.mediaDescriptions[r]=n}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(t=>{var r;return((r=t.attributes)===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId)===e[0].ssrcId})}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(t=>_r()?t.media.port==="0"&&t.media.mediaType===e:t.media.port==="0")}},LMe=["sdp"],Jt;function DB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Pl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var LB=(Jt=class op extends sQ{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,r;return(t=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&t!==void 0?t:null}get localCodecs(){return[]}set isInRestartIce(t){this._isInRestartIce=t}get isInRestartIce(){return this._isInRestartIce}constructor(t,r,n){super(t,r),C(this,"direction",void 0),C(this,"name",void 0),C(this,"store",void 0),C(this,"spec",void 0),C(this,"peerConnection",void 0),C(this,"initialOffer",void 0),C(this,"transport",void 0),C(this,"statsFilter",void 0),C(this,"localCandidateCount",0),C(this,"_isInRestartIce",!1),C(this,"mutex",new Gn("P2PConnection-mutex")),C(this,"onLocalCandidate",void 0),C(this,"remoteSDP",void 0),C(this,"pendingCandidates",[]),C(this,"localCapabilities",void 0),C(this,"isReady",!1),C(this,"restartCnt",0),C(this,"curTurnServerIndex",0),this.store=r,this.spec=t,this.peerConnection=new RTCPeerConnection(op.resolvePCConfiguration(t,r.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=n??yi.SEND_ONLY,this.name=this.direction===yi.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=ZD(this.peerConnection,D("STATS_UPDATE_INTERVAL"),void 0,_r()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(t){try{let r=await YQ();if(this.localCapabilities=iw(r),t){let{sdp:n}=t,i=NMe(t,LMe),o=function(){let d={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},u=$0(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),p={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},m={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(qs(u,d,"videoExtensions",p,f,m),qs(u,d,"videoCodecs",p,f,m),qs(u,d,"audioExtensions",p,f,m),qs(u,d,"audioCodecs",p,f,m),D("RAISE_H264_BASELINE_PRIORITY")){let g=m.videoCodecs.findIndex(y=>y.rtpMap&&y.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&y.fmtp&&y.fmtp.parameters["profile-level-id"]==="42001f");if(g!==-1){let y=m.videoCodecs.findIndex(v=>v.rtpMap&&v.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(y<g){b.debug("raising H264 baseline profile priority");let v=m.videoCodecs[g];m.videoCodecs.splice(g,1),m.videoCodecs.splice(y,0,v)}y!==-1&&D("FILTER_SEND_H264_BASELINE")&&(p.videoCodecs=p.videoCodecs.filter(v=>!(v.rtpMap&&v.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&v.fmtp&&v.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:p,recv:f,sendrecv:m}}({},{},n);this.remoteSDP=new PB({remoteIceParameters:i.iceParameters,remoteDtlsParameters:i.dtlsParameters,candidates:[],remoteRTPCapabilities:o,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;let s=await this.peerConnection.createAnswer();if(!s.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");let a=sd(s.sdp);await this.peerConnection.setLocalDescription(s);let c=await hB({},{},s.sdp);this.localCapabilities=iw(c);let l=this.peerConnection.getTransceivers()[0];return l!=null&&l.receiver&&l.receiver.transport&&this.tryBindTransportEvents(l.receiver.transport),Pl(Pl({},a),{},{sdp:s.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});let n=await this.peerConnection.createOffer();if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");let i=sd(n.sdp);return this.initialOffer=n,Pl(Pl({},i),{},{sdp:n.sdp})}}catch(r){throw new X(I.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);let{sdp:r,iceParameters:n,dtlsParameters:i}=t,o=await hB({},{},r);this.remoteSDP=new PB({remoteIceParameters:n,remoteDtlsParameters:i,candidates:[],remoteRTPCapabilities:o,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});let s=this.peerConnection.getTransceivers()[0];s!=null&&s.sender&&s.sender.transport&&this.tryBindTransportEvents(s.sender.transport)}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async addRemoteCandidate(t){try{t&&this.pendingCandidates.push(t),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(r=>{this.peerConnection.addIceCandidate(r)}),this.pendingCandidates=[])}catch(r){throw new X(I.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(r.toString()))}}send(t,r,n){var i=this;return Ia(function*(){let o=yield wt(i.mutex.lock("From P2PConnection.send"));try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");let s=[],a=i.remoteSDP.receive(t,r,n);t.forEach((y,v)=>{if(a[v].needCreateTransceiver){let E=i.peerConnection.addTransceiver(y._mediaStreamTrack,{direction:"sendonly"});s.push(E),y._updateRtpTransceiver(E)}else{let E=i.peerConnection.getTransceivers().find(w=>w.mid===a[v].mid);if(!E)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(a[v].mid));s.push(E),y._updateRtpTransceiver(E)}}),_r()&&D("SIMULCAST")===!0&&(yield wt(i.applySimulcastForFirefox(s,t)));let c=a.map(y=>y.mid),l=yield wt(i.peerConnection.createOffer()),d=i.mungSendOfferSDP(l.sdp,t,c),u=wn.parse(d),p=c.map(y=>{let v=u.mediaDescriptions.find(E=>E.attributes.mid===y);if(!v)throw new Error("Cannot extract ssrc from mediaDescription.");return GQ(v,D("USE_PUB_RTX"))}),f=s.map((y,v)=>{let E=c[v];return{localSSRC:p[v],id:E}});yield wt(i.peerConnection.setLocalDescription({type:"offer",sdp:d}));try{yield f}catch(y){let v=i.remoteSDP.toString();throw yield wt(i.peerConnection.setLocalDescription({type:"offer",sdp:d})),yield wt(i.peerConnection.setRemoteDescription({type:"answer",sdp:v})),yield wt(i.stopSending(c,!0)),y}yield wt(i.applySimulcastEncodings(s,t)),yield wt(i.applySendEncodings(s,t));let m=i.remoteSDP.toString(),g=i.logSDPExchange(d,"offer","local","send");return g==null||g(m),yield wt(i.setRemoteDescription({type:"answer",sdp:m})),s.map((y,v)=>{let E=c[v];return{localSSRC:p[v],id:E}})}catch(s){throw s instanceof X?s:new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(s.toString()))}finally{o()}})()}async stopSending(t,r){let n=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");let i=this.peerConnection.getTransceivers().filter(c=>t.indexOf(c.mid)!==-1);if(i.length!==t.length)throw new Error("Transceivers' length (".concat(i.length,") doesn't match mids' length (").concat(t.length,") when trying to call P2PConnection.stopSending."));i.map(c=>{var l;c.direction="inactive",(l=c.stop)===null||l===void 0||l.call(c)});let o=await this.peerConnection.createOffer(),s=this.logSDPExchange(o.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(o),this.remoteSDP.stopReceiving(t);let a=this.remoteSDP.toString();s==null||s(a),await this.setRemoteDescription({type:"answer",sdp:a})}catch(i){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(i.toString()))}finally{n&&n()}}async receive(t,r,n,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));let{mid:o,needExchangeSDP:s}=this.remoteSDP.send(t,r,n,i);if(s){let c=this.remoteSDP.toString(),l=this.logSDPExchange(c,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:c});let d=await this.peerConnection.createAnswer(),u=this.mungReceiveAnswerSDP(d.sdp,o,t);l==null||l(u||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:u}),b.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else b.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."));let a=this.peerConnection.getTransceivers().find(c=>c.mid===o);if(!a||a.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,mid:a.mid,transceiver:a}}catch(o){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(o.toString()))}}async mockReceive(t,r,n,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));let{mid:o,needExchangeSDP:s}=this.remoteSDP.send(t,r,n,i);if(s){let a=this.remoteSDP.toString(),c=this.logSDPExchange(a,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:a});let l=await this.peerConnection.createAnswer(),d=this.mungReceiveAnswerSDP(l.sdp,o,t);c==null||c(d||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:d}),b.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else b.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."))}catch(o){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(o.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);let r=this.remoteSDP.toString(),n=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:r});let i=await this.peerConnection.createAnswer();n==null||n(i.sdp||""),await this.peerConnection.setLocalDescription(i)}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async restartICE(t){try{if(this.store.p2pTransport===lu.Auto&&(this.store.p2pTransport=lu.SdRtn,Et().supportPCSetConfiguration&&this.peerConnection.setConfiguration(op.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,Et().supportPCSetConfiguration&&this.peerConnection.setConfiguration(op.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!t){this.restartCnt++,this.isReady=!1;let r=await this.peerConnection.createOffer({iceRestart:!0});if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");let{iceParameters:n}=sd(r.sdp);return this.store.descriptionStart(),this.direction===yi.SEND_ONLY&&await this.peerConnection.setLocalDescription(r),n}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(t),this.store.descriptionStart(),this.direction===yi.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});let r=await this.peerConnection.createAnswer();if(!r.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");let{iceParameters:n}=sd(r.sdp);return await this.peerConnection.setLocalDescription(r),n}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}close(){var t;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");let n=await this.peerConnection.createOffer(),i=this.mungSendOfferSDP(n.sdp,[r],[t]);this.remoteSDP.updateRecvMedia(t,r);let o=this.remoteSDP.toString(),s=this.logSDPExchange(i,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:i}),s==null||s(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(n){throw new X(I.EXCHANGE_SDP_FAILED,n.toString())}}async updateSendParameters(t,r){let n=this.peerConnection.getTransceivers().filter(i=>i.mid===t);n.length===1&&(this.isVP8Simulcast(r)?_r()||await this.applySimulcastEncodings(n,[r]):await this.applySendEncodings(n,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){let n=this.peerConnection.getTransceivers().find(i=>i.mid===r);n&&await n.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){let t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){let r=t[0].transport.iceTransport,{local:n,remote:i}=r.getSelectedCandidatePair();return{local:Pl(Pl({},Ec),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:Pl(Pl({},Ec),{},{candidateType:i.type,protocol:i.protocol,address:i.address,port:i.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t,r;pe(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=t=>{if(t.candidate){var r;t.candidate.candidate&&((r=this.onLocalCandidate)===null||r===void 0||r.call(this,t.candidate.toJSON())),this.localCandidateCount+=1}else b.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i={iceServers:[]};var o;return t.iceServers?i.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(QS(t.turnServer.servers)?i.iceServers=t.turnServer.servers:(i.iceServers&&i.iceServers.push(...op.turnServerConfigToIceServers(t.turnServer.servers,r,n)),D("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&t.turnServer.serversFromGateway&&i.iceServers.push(...op.turnServerConfigToIceServers(t.turnServer.serversFromGateway,r,n)),pe(o=[lu.Relay,lu.SdRtn]).call(o,r)&&(i.iceTransportPolicy="relay"),D("FORCE_TURN_TCP")?i.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(i.iceTransportPolicy="relay")}))),D("ENABLE_ENCODED_TRANSFORM")&&Et().supportWebRTCEncodedTransform&&(i.encodedInsertableStreams=!0),b.debug("P2PConnection p2pTransport is ".concat(r)),i}static turnServerConfigToIceServers(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=[],o=t.filter(a=>a.tcpport);b.debug("P2PConnection turnServers is ".concat(o,", current index is ").concat(n));let s=o.length>n?o[n]:o[0];switch(r){case lu.SdRtn:let a=t.filter(l=>{var d;return pe(d=l.username).call(d,"glb:")&&l.turnServerURL==l.turnServerURL}),c=a.length>n?a[n]:a[0];c&&(i.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(kp(c.turnServerURL),":").concat(c.tcpport,"?transport=udp")}),i.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(kp(c.turnServerURL),":").concat(c.tcpport,"?transport=tcp")}));break;case lu.Relay:s&&(i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=udp")}),i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(kp(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}));break;default:s&&(i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=udp")}),i.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(kp(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}),i.push({username:s.username,credential:s.password,credentialType:"password",urls:"stun:".concat(s.turnServerURL,":").concat(s.tcpport)}))}return i}tryBindTransportEvents(t){if(t){this.transport=t,t.onstatechange=()=>{var n;t!=null&&t.state&&((n=this.onDTLSTransportStateChange)===null||n===void 0||n.call(this,t.state))},t.onerror=n=>{var i;(i=this.onDTLSTransportError)===null||i===void 0||i.call(this,"error"in n?n.error:n)};let r=t.iceTransport;r&&(r.onstatechange=()=>{let n=t==null?void 0:t.iceTransport.state;var i;n&&((i=this.onICETransportStateChange)===null||i===void 0||i.call(this,n))},r.getSelectedCandidatePair&&(r.onselectedcandidatepairchange=()=>{if(r.getSelectedCandidatePair()){let{local:n,remote:i}=r.getSelectedCandidatePair();b.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:n.type,protocol:n.protocol}),", remote ").concat(JSON.stringify({candidateType:i.type,protocol:i.protocol,address:i.address,port:i.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,r){var n;if(r||(r=this.peerConnection.getSenders().find(d=>d.track===t._mediaStreamTrack)),!r)return b.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return b.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Et().supportSetRtpSenderParameters)return b.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");let i={},o={};switch(t._optimizationMode){case"motion":i.degradationPreference="maintain-framerate";break;case"detail":i.degradationPreference="maintain-resolution";break;default:i.degradationPreference="balanced"}if(t._encoderConfig){var s;let{bitrateMax:d,frameRate:u,scaleResolutionDownBy:p}=t._encoderConfig;d&&(o.maxBitrate=1e3*d),pe(s=t._hints).call(s,nr.LOW_STREAM)&&(u&&(o.maxFramerate=ao(u)),p&&p>=1&&(o.scaleResolutionDownBy=p))}if(D("DSCP_TYPE")&&Od()){var a;let d=D("DSCP_TYPE");pe(a=["very-low","low","medium","high"]).call(a,d)&&(o.networkPriority=d)}let c=r.getParameters(),l=(n=c.encodings)===null||n===void 0?void 0:n[0];_r()&&!l&&(i.encodings=[o]),l&&Object.assign(l,o),Object.assign(c,i),b.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(c.encodings))),await r.setParameters(c)}async applySendEncodings(t,r){try{if(!Et().supportSetRtpSenderParameters||t.length!==r.length)return;for(let n=0;n<t.length;n++){let i=t[n],o=r[n];o instanceof Qt&&!this.isVP8Simulcast(o)&&await this.updateRtpSenderEncodings(o,i.sender)}}catch{b.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r,n){let i=wn.parse(t);return r.forEach((o,s)=>{let a=n[s],c=i.mediaDescriptions.find(l=>l.attributes.mid===a);c&&(Of(c,o),qQ(c,o,this.store.codec))}),wn.print(i)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,n)=>{var i;(i=this.onFirstVideoDecoded)===null||i===void 0||i.call(this,t,r,n)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var n;(n=this.onSelectedLocalCandidateChanged)===null||n===void 0||n.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var n;(n=this.onSelectedRemoteCandidateChanged)===null||n===void 0||n.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let c=0;c<t.length;c++){var n,i,o,s,a;let l=t[c],d=r[c];if(d instanceof Qt&&!pe(n=d._hints).call(n,nr.LOW_STREAM)&&(i=d._encoderConfig)!==null&&i!==void 0&&i.bitrateMax&&((o=d._encoderConfig)===null||o===void 0?void 0:o.bitrateMax)>200&&(s=d._scalabilityMode)!==null&&s!==void 0&&s.numSpatialLayers&&((a=d._scalabilityMode)===null||a===void 0?void 0:a.numSpatialLayers)>1&&this.store.codec==="vp8"){let u={},p={high:1e3*(d._encoderConfig.bitrateMax-50),medium:5e4};u.encodings=[{rid:"m",active:!0,maxBitrate:p.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:p.high}];let f=l.sender.getParameters();await l.sender.setParameters(Object.assign(f,u))}}}async applySimulcastEncodings(t,r){if(!_r()&&t.length===r.length)for(let n=0;n<t.length;n++){let i=r[n];if(i instanceof Qt&&this.isVP8Simulcast(i)){let o=t[n],s={},a={high:1e3*(i._encoderConfig.bitrateMax-50),medium:5e4};s.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:a.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:a.medium,scaleResolutionDownBy:4}];let c=o.sender.getParameters();await o.sender.setParameters(Object.assign(c,s))}}}isVP8Simulcast(t){var r,n,i,o,s;return!!(t instanceof Qt&&D("SIMULCAST")&&this.store.codec==="vp8"&&!pe(r=t._hints).call(r,nr.LOW_STREAM)&&(n=t._encoderConfig)!==null&&n!==void 0&&n.bitrateMax&&((i=t._encoderConfig)===null||i===void 0?void 0:i.bitrateMax)>200&&(o=t._scalabilityMode)!==null&&o!==void 0&&o.numSpatialLayers&&((s=t._scalabilityMode)===null||s===void 0?void 0:s.numSpatialLayers)>1)}logSDPExchange(t,r,n,i){if(D("SDP_LOGGING"))return b.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(r," SDP during P2PConnection.").concat(i,`
`),t),r==="offer"?o=>{this.logSDPExchange(o,"answer",n==="local"?"remote":"local",i)}:void 0}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");let r=this.peerConnection.getTransceivers().filter(s=>s.mid&&t.indexOf(s.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(s=>{s.direction="inactive"});let n=await this.peerConnection.createOffer(),i=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(t);let o=this.remoteSDP.toString();i==null||i(o),await this.setRemoteDescription({type:"answer",sdp:o})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");let r=this.peerConnection.getTransceivers().filter(s=>s.mid&&t.indexOf(s.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async s=>{s.direction="sendonly"});let n=await this.peerConnection.createOffer(),i=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(t);let o=this.remoteSDP.toString();i==null||i(o),await this.setRemoteDescription({type:"answer",sdp:o})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}async getRemoteSSRC(t,r){var n,i;if(r=(n=r)!==null&&n!==void 0?n:(i=this.currentRemoteDescription)===null||i===void 0?void 0:i.sdp){var o;let s=(o=wn.parse(r).mediaDescriptions.find(a=>a.attributes.mid===t))===null||o===void 0?void 0:o.attributes.ssrcs;return s==null?void 0:s[0].ssrcId}}async setRemoteDescription(t){var r;await this.peerConnection.setRemoteDescription(t),pe(r=["connected","completed"]).call(r,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(t,r,n){let i=wn.parse(t),o=i.mediaDescriptions.find(s=>s.attributes.mid===r);return o&&n===we.AUDIO&&o.media.mediaType==="audio"&&Nf(o),wn.print(i)}},ve(Jt.prototype,"establish",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"establish"),Jt.prototype),ve(Jt.prototype,"connect",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"connect"),Jt.prototype),ve(Jt.prototype,"receive",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"receive"),Jt.prototype),ve(Jt.prototype,"mockReceive",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"mockReceive"),Jt.prototype),ve(Jt.prototype,"stopReceiving",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"stopReceiving"),Jt.prototype),ve(Jt.prototype,"restartICE",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"restartICE"),Jt.prototype),ve(Jt.prototype,"close",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"close"),Jt.prototype),ve(Jt.prototype,"updateEncoderConfig",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"updateEncoderConfig"),Jt.prototype),ve(Jt.prototype,"updateSendParameters",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"updateSendParameters"),Jt.prototype),ve(Jt.prototype,"replaceTrack",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"replaceTrack"),Jt.prototype),ve(Jt.prototype,"muteLocal",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"muteLocal"),Jt.prototype),ve(Jt.prototype,"unmuteLocal",[Ls],Object.getOwnPropertyDescriptor(Jt.prototype,"unmuteLocal"),Jt.prototype),Jt);function Ls(e,t,r){let n=e[t];if(typeof n!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){let i=this.mutex,o=await i.lock("From P2PConnection.".concat(t));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return await n.apply(this,a)}finally{o()}},r}function QO(e,t){let r=document.createElement("video"),n=document.createElement("canvas");r.setAttribute("style","display:none"),n.setAttribute("style","display:none"),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("autoplay",""),r.autoplay=!0,r.setAttribute("playsinline",""),n.width=ao(t.width),n.height=ao(t.height);let i=ao(t.framerate||15);document.body.append(r),document.body.append(n);let o=e._mediaStreamTrack;r.srcObject=new MediaStream([o]),r.play();let s=n.getContext("2d");if(!s)throw new G(I.UNEXPECTED_ERROR,"can not get canvas context");let a=Et(),c=n.captureStream(a.supportRequestFrame?0:i).getVideoTracks()[0];c.canvas||(c.canvas=n),n.startCapture=()=>{if(!r)return n.stopCapture&&n.stopCapture();if(r.paused&&r.play(),r.videoHeight>2&&r.videoWidth>2){let d=r.videoWidth,u=r.videoHeight/d,p=n.width*u;Math.abs(p-n.height)>=2&&(b.debug("adjust low stream resolution","".concat(n.width,"x").concat(n.height," -> ").concat(n.width,"x").concat(p)),n.height=p)}s.drawImage(r,0,0,n.width,n.height),c.requestFrame&&c.requestFrame(),o!==e._mediaStreamTrack&&(o=e._mediaStreamTrack,r.srcObject=new MediaStream([o]))},n.stopCapture=$D(()=>n.startCapture&&n.startCapture(),i);let l=c.stop;return c.stop=()=>{l.call(c),r&&(r.remove(),r.srcObject=null,r=null),n&&(n.width=0,n.remove(),n.stopCapture&&n.stopCapture(),n.startCapture=void 0,n.stopCapture=void 0,n=null),b.debug("clean low stream renderer")},c}var E_=function(e){return e[e.HEIGHT=2033]="HEIGHT",e[e.FRAME_RATE=2034]="FRAME_RATE",e[e.WIDTH=2035]="WIDTH",e}(E_||{}),tn=function(e){return e[e.FRAME_RATE=2002]="FRAME_RATE",e[e.WIDTH=2003]="WIDTH",e[e.HEIGHT=2004]="HEIGHT",e[e.PACKAGE_LOST=2005]="PACKAGE_LOST",e[e.AVG_ENCODE=2007]="AVG_ENCODE",e[e.NACKS=2009]="NACKS",e[e.PLIS=2010]="PLIS",e[e.FIRS=2011]="FIRS",e[e.BITRATE=2012]="BITRATE",e[e.PACKAGE_RATE=2031]="PACKAGE_RATE",e[e.ADAPTATION=2032]="ADAPTATION",e[e.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",e[e.BANDWIDTH=2061]="BANDWIDTH",e[e.RETRANSMIT=2062]="RETRANSMIT",e[e.TARGET_ENCODED=2064]="TARGET_ENCODED",e[e.TRANSMIT=2066]="TRANSMIT",e[e.FREEZE=2082]="FREEZE",e[e.DISABLED=2095]="DISABLED",e[e.PLAYER_STATUS=2128]="PLAYER_STATUS",e[e.QP_SUM=2143]="QP_SUM",e}(tn||{}),uu=function(e){return e[e.BITRATE=2069]="BITRATE",e[e.PACKAGE_LOST=2070]="PACKAGE_LOST",e[e.PACKAGE_RATE=2071]="PACKAGE_RATE",e[e.HEIGHT=2073]="HEIGHT",e[e.FRAME_RATE=2075]="FRAME_RATE",e[e.WIDTH=2077]="WIDTH",e}(uu||{}),Jn=function(e){return e[e.JITTER=-1]="JITTER",e[e.PACKAGE_LOST=2014]="PACKAGE_LOST",e[e.WIDTH=2018]="WIDTH",e[e.HEIGHT=2019]="HEIGHT",e[e.FRAME_RATE=2020]="FRAME_RATE",e[e.JITTER_BUFFER=2023]="JITTER_BUFFER",e[e.CURRENT_DELAY=2024]="CURRENT_DELAY",e[e.NACKS=2026]="NACKS",e[e.PLIS=2027]="PLIS",e[e.FIRS=2028]="FIRS",e[e.BITRATE=2029]="BITRATE",e[e.PACKAGE_RATE=2078]="PACKAGE_RATE",e[e.FREEZE=2084]="FREEZE",e[e.DISABLED=2101]="DISABLED",e[e.PLAYER_STATUS=2129]="PLAYER_STATUS",e[e.QP_SUM=2144]="QP_SUM",e[e.I_FRAME_DELAY=2149]="I_FRAME_DELAY",e}(Jn||{}),hu=function(e){return e[e.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",e[e.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",e[e.FRAME_RATE_OUTPUT=2155]="FRAME_RATE_OUTPUT",e[e.FREEZE_TIME=2109]="FREEZE_TIME",e[e.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER",e[e.FREEZE_DURATION=2156]="FREEZE_DURATION",e}(hu||{}),aZ=function(e){return e[e.PCM_LEVEL=2104]="PCM_LEVEL",e}(aZ||{}),Vl=function(e){return e[e.PACKAGE_LOST=-1]="PACKAGE_LOST",e[e.LEVEL=2038]="LEVEL",e[e.BITRATE=2039]="BITRATE",e[e.PACKAGE_RATE=2040]="PACKAGE_RATE",e[e.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",e[e.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",e[e.FREEZE=2081]="FREEZE",e[e.DISABLED=2096]="DISABLED",e}(Vl||{}),js=function(e){return e[e.BITRATE=2044]="BITRATE",e[e.PACKAGE_LOST=2045]="PACKAGE_LOST",e[e.PACKAGE_RATE=2046]="PACKAGE_RATE",e[e.CURRENT_DELAY=2047]="CURRENT_DELAY",e[e.JITTER_BUFFER=2054]="JITTER_BUFFER",e[e.JITTER=2055]="JITTER",e[e.FREEZE=2083]="FREEZE",e[e.DISABLED=2102]="DISABLED",e[e.PCM_LEVEL=2105]="PCM_LEVEL",e[e.PLAYER_STATUS=2130]="PLAYER_STATUS",e[e.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES",e}(js||{}),cZ=function(e){return e[e.FREEZE_TIME=-1]="FREEZE_TIME",e[e.LEVEL=2043]="LEVEL",e}(cZ||{}),Zo=function(e){return e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE",e}(Zo||{}),Lc=1e3,eu=3;function et(e,t,r){r!=null&&Number.isFinite(r)&&(e[t]=Math.round(Math.max(0,r)))}function MB(e){let t={[Zo.CONN_TYPE]:0,[Zo.RTT]:e.rtt};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{let r=e.selectedCandidatePair.localCandidate.relayProtocol;r==="udp"&&(t[Zo.CONN_TYPE]=1),r==="tcp"&&(t[Zo.CONN_TYPE]=3),r==="tls"&&(t[Zo.CONN_TYPE]=4);break}case"srflx":t[Zo.CONN_TYPE]=2}return t}function jB(e){let t=0;switch(e){case"none":t=0;break;case"cpu":t=1;break;case"bandwidth":t=2;break;case"other":t=3}return t}var lZ=class extends fr{constructor(e){super(),C(this,"store",void 0),C(this,"uploadWRTCStatsTimer",void 0),C(this,"uploadOutboundDenoiserStatsTimer",void 0),C(this,"uploadExtStatsTimer",void 0),C(this,"uploadExtUsageStatsTimer",void 0),C(this,"uploadInboundExtStatsTimer",void 0),C(this,"requestStats",void 0),C(this,"requestTransportStats",void 0),C(this,"requestLocalMedia",void 0),C(this,"requestRemoteMedia",void 0),C(this,"requestAllTracks",void 0),C(this,"requestVideoIsReady",void 0),C(this,"requestUploadStats",void 0),C(this,"requestUpload",void 0),C(this,"uploadOutboundStarted",!1),C(this,"uploadInboundStarted",!1),C(this,"uploadTransportStarted",!1),C(this,"uploadExtensionUsageStarted",!1),C(this,"lastRecvStats",void 0),C(this,"lastSendStats",void 0),C(this,"lastFullRecvStats",void 0),C(this,"lastFullSendStats",void 0),C(this,"needUploadRenderFreezeTime",!0),this.store=e}uploadWRTCStats(e){if(!this.requestStats||!this.requestUploadStats)return;let t,r;if(this.uploadTransportStarted&&(t=this.requestStats(),this.store.useP2P&&(r=this.requestStats(!0))),!t&&this.uploadOutboundStarted&&(t=this.requestStats()),!r&&this.uploadInboundStarted&&(r=this.requestStats(!0)),t||r){let n={};if(this.uploadTransportStarted&&t){let i=this.getTransportStats(t,r,e);i&&(n.misc=[i])}if(this.uploadOutboundStarted&&t){let i=this.getOutboundStats(t,e?this.lastSendStats:this.lastFullSendStats,e);i&&(n.outbound=[i])}if(this.uploadInboundStarted&&r){let i=this.getInboundStats(r,e?this.lastRecvStats:this.lastFullRecvStats,e);i&&(n.inbound=i)}this.requestUploadStats(n)}this.lastRecvStats=r,this.lastSendStats=t,e||(this.lastFullRecvStats=r,this.lastFullSendStats=t)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;let e=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted)return this.stopUploadWRTCStats();this.uploadWRTCStats(e!==eu),++e===eu+1&&(e=1)},Lc)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(e,t,r){if(!this.requestStats)return;if(r)return e.rtt==null?void 0:{addition:{[Zo.RTT]:e.rtt,[Zo.CONN_TYPE]:void 0}};let n=MB(e);if(this.store.useP2P){if(t){let i=MB(t);n[Zo.CONN_TYPE]+=i[Zo.CONN_TYPE]<<3}n[Zo.CONN_TYPE]+=110}else n[Zo.CONN_TYPE]+=100;return{addition:n}}getOutboundStats(e,t,r){if(!this.requestUploadStats||!this.requestLocalMedia)return;let n=this.requestLocalMedia();if(!n||n.length===0)return;let i,o,s;return n.forEach(a=>{let[c,{track:l,ssrcs:d}]=a;switch(c){case ne.LocalVideoLowTrack:case ne.LocalVideoTrack:if(c===ne.LocalVideoTrack){let u=function(m,g,y,v,E){let w=g.videoSend.find(W=>W.ssrc===m);if(!w)return;let S={},{sentFrame:A,inputFrame:N}=w;if(N&&A){let W=N.frameRate,V=A.frameRate;S[tn.FREEZE]=function(Y,Z){let te=!0;return te=!(Y<=5)&&(Y<=10?Z<3:Y<=20?Z<4:Z<5),te}(W,V)?1:0}if(et(S,tn.QP_SUM,w.qpSumPerFrame),E)return S;switch(A&&(et(S,tn.HEIGHT,A.height),et(S,tn.WIDTH,A.width),et(S,tn.FRAME_RATE,A.frameRate)),S[tn.DISABLED]=v._originMediaStreamTrack&&!v._originMediaStreamTrack.enabled||v._mediaStreamTrack&&!v._mediaStreamTrack.enabled?1:0,w.adaptionChangeReason){case"none":S[tn.ADAPTATION]=0;break;case"cpu":S[tn.ADAPTATION]=1;break;case"bandwidth":S[tn.ADAPTATION]=2;break;case"other":S[tn.ADAPTATION]=3}let L=0;w.adaptionChangeReason&&(L+=jB(w.adaptionChangeReason)),g.qualityLimitationReason&&(L+=jB(g.qualityLimitationReason)<<3),S[tn.ADAPTATION]=L,S[tn.PLAYER_STATUS]=TI[v._player?v._player.videoElementStatus:"uninit"],et(S,tn.NACKS,w.nacksCount),et(S,tn.PLIS,w.plisCount),et(S,tn.FIRS,w.firsCount),et(S,tn.AVG_ENCODE,w.avgEncodeMs);let j=y&&y.videoSend.find(W=>W.ssrc===m);if(j){let W=E?Lc:Lc*eu;j.timestamp&&w.timestamp&&(W=w.timestamp-j.timestamp),j.packets!=null&&w.packets!=null&&et(S,tn.PACKAGE_RATE,1e3*(w.packets-j.packets)/W),w.packetsLost!=null&&j.packetsLost!=null&&et(S,tn.PACKAGE_LOST,w.packetsLost-j.packetsLost),j.bytes!=null&&w.bytes!=null&&et(S,tn.BITRATE,8*(w.bytes-j.bytes)/W)}return S}(d[0].ssrcId,e,t,l,r),p=r?null:function(m,g,y){let v=g.videoSend.find(L=>L.ssrc===m);if(!v)return null;let E={},w=v.inputFrame,S=w&&w.height||y&&y.videoHeight||0,A=w&&w.width||y&&y.videoWidth||0,N=w&&w.frameRate||0;return et(E,E_.HEIGHT,S),et(E,E_.WIDTH,A),et(E,E_.FRAME_RATE,N),E}(d[0].ssrcId,e,l),f=r?null:function(m){let g={};return et(g,tn.RETRANSMIT,m.bitrate.retransmit),et(g,tn.TARGET_ENCODED,m.bitrate.targetEncoded),et(g,tn.ACTUAL_ENCODED,m.bitrate.actualEncoded),et(g,tn.TRANSMIT,m.bitrate.transmit),et(g,tn.BANDWIDTH,m.sendBandwidth),g}(e);o=Object.assign({},u,p,f)}else s=r?void 0:function(u,p,f){let m=p.videoSend.find(v=>v.ssrc===u);if(!m)return;let g={},y=m.sentFrame;if(y&&(et(g,uu.HEIGHT,y.height),et(g,uu.WIDTH,y.width),et(g,uu.FRAME_RATE,y.frameRate)),f){let v=f.videoSend.find(E=>E.ssrc===u);if(v){let E=Lc*eu;v.timestamp&&m.timestamp&&(E=m.timestamp-v.timestamp),v.packets!=null&&m.packets!=null&&et(g,uu.PACKAGE_RATE,1e3*(m.packets-v.packets)/E),m.packetsLost!=null&&v.packetsLost!=null&&et(g,uu.PACKAGE_LOST,m.packetsLost-v.packetsLost),v.bytes!=null&&m.bytes!=null&&et(g,uu.BITRATE,8*(m.bytes-v.bytes)/E)}}return g}(d[0].ssrcId,e,t);break;case ne.LocalAudioTrack:i=r?void 0:function(u,p,f,m){let g=p.audioSend.find(S=>S.ssrc===u);if(!g)return;let y={};y[Vl.DISABLED]=m._originMediaStreamTrack&&!m._originMediaStreamTrack.enabled||m._mediaStreamTrack&&!m._mediaStreamTrack.enabled?1:0;let v=100*m._source.getAccurateVolumeLevel(),E=g.inputLevel;if(E!=null){let S=Math.ceil(50*Math.log10(100*E+1));et(y,Vl.LEVEL,S)}et(y,aZ.PCM_LEVEL,v),et(y,Vl.AEC_RETURN_LOSS,g.aecReturnLoss),et(y,Vl.AEC_RETURN_LOSS_ENH,g.aecReturnLossEnhancement),y[Vl.FREEZE]=0;let w=f&&f.audioSend.find(S=>S.ssrc===u);if(w){let S=Lc*eu;w.timestamp&&g.timestamp&&(S=g.timestamp-w.timestamp),w.bytes!=null&&g.bytes!=null&&et(y,Vl.BITRATE,8*(g.bytes-w.bytes)/S),w.packets!=null&&g.packets!=null&&et(y,Vl.PACKAGE_RATE,1e3*(g.packets-w.packets)/S)}return y}(d[0].ssrcId,e,t,l)}}),{high:o,low:s,audio:i}}getInboundStats(e,t,r){if(!this.requestRemoteMedia)return;let n=this.requestRemoteMedia()||[],i=[];return n.forEach(o=>{let[s,a]=o,c={peer:s.uid};if(a.has(we.VIDEO)&&s.videoTrack){let l=s._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(s._videoSSRC)||!1,d=s.videoTrack?function(u,p,f,m,g,y,v){var E;let w=p.videoRecv.find(V=>V.ssrc===u);if(!w)return;let S={},{receivedFrame:A,outputFrame:N,decodeFrameRate:L}=w,j=f&&f.videoRecv.find(V=>V.ssrc===u);if(S[Jn.FREEZE]=g&&dZ.isRemoteVideoFreeze(m,w,j)?1:0,et(S,hu.FRAME_RATE_DECODE,L),et(S,Jn.QP_SUM,w.qpSumPerFrame),w.framesRateFirefox&&et(S,Jn.FRAME_RATE,w.framesRateFirefox),A&&et(S,Jn.FRAME_RATE,A.frameRate),j){let V=p.timestamp-f.timestamp||(v?Lc:eu*Lc);w.packetsLost!=null&&j.packetsLost!=null&&et(S,Jn.PACKAGE_LOST,w.packetsLost-j.packetsLost),j.bytes!=null&&w.bytes!=null&&et(S,Jn.BITRATE,8*(w.bytes-j.bytes)/V),j.packets!=null&&w.packets!=null&&et(S,Jn.PACKAGE_RATE,1e3*(w.packets-j.packets)/V)}if(v)return S;A?(et(S,Jn.HEIGHT,A.height),et(S,Jn.WIDTH,A.width)):m&&(et(S,Jn.HEIGHT,m._videoHeight||0),et(S,Jn.WIDTH,m._videoWidth||0)),N&&et(S,hu.FRAME_RATE_OUTPUT,N.frameRate);let W=(E=m._player)===null||E===void 0?void 0:E.rendFrameRate.toFixed(0);if(W&&et(S,hu.FRAME_RATE_RENDER,+W),et(S,Jn.JITTER_BUFFER,w.jitterBufferMs),et(S,Jn.CURRENT_DELAY,w.currentDelayMs),et(S,Jn.FIRS,w.firsCount),et(S,Jn.NACKS,w.nacksCount),et(S,Jn.PLIS,w.plisCount),m){S[Jn.DISABLED]=m._originMediaStreamTrack.enabled&&m._mediaStreamTrack.enabled?0:1;let V=m._player;if(V){let{freezeTimeCounterList:Y,renderFreezeAccTime:Z,videoElementStatus:te}=V;if(Y&&Y.length>0&&et(S,hu.FREEZE_TIME,Y.splice(0,1)[0]),y&&Fc.visibility==="visible"&&te===si.PLAYING&&Et().supportRequestVideoFrameCallback){let H=Math.min(6e3,Z);V.renderFreezeAccTime=Math.max(0,Z-H),et(S,hu.FREEZE_TIME_RENDER,H)}if(typeof w.totalFreezesDuration=="number"){let H=j&&j.totalFreezesDuration?w.totalFreezesDuration-j.totalFreezesDuration:w.totalFreezesDuration;et(S,hu.FREEZE_DURATION,1e3*H)}}}if(S[Jn.PLAYER_STATUS]=TI[m._player?m._player.videoElementStatus:"uninit"],j&&w.totalInterFrameDelay!==void 0&&w.totalSquaredInterFrameDelay!==void 0&&j.totalInterFrameDelay!==void 0&&j.totalSquaredInterFrameDelay!==void 0){let V=w.totalInterFrameDelay-j.totalInterFrameDelay,Y=w.totalSquaredInterFrameDelay-j.totalSquaredInterFrameDelay,Z=w.framesDecodeCount-j.framesDecodeCount,te=V/Z*1e3,H=Math.round(1e3*Math.sqrt((Y-Math.pow(V,2)/Z)/Z));!isNaN(H)&&te+H>Math.max(3*te,te+150)&&(S[Jn.I_FRAME_DELAY]=H)}return S}(s._videoSSRC,e,t,s.videoTrack,l===!0,this.needUploadRenderFreezeTime,r):void 0;d&&(c.video=d)}if(a.has(we.AUDIO)&&s.audioTrack){let l=s.audioTrack?function(d,u,p,f,m){let g=u.audioRecv.find(j=>j.ssrc===d);if(!g)return;let y={},v=p&&p.audioRecv.find(j=>j.ssrc===d),{receivedFrames:E,droppedFrames:w}=g;var S,A;if(et(y,js.JITTER,g.jitterMs),E!=null&&w!=null&&(y[js.FREEZE]=(A=w,(S=E)===0||100*A/S>20?1:0)),v){let j=u.timestamp-p.timestamp||(m?Lc:Lc*eu);g.packets!=null&&v.packets!=null&&et(y,js.PACKAGE_RATE,1e3*(g.packets-v.packets)/j),v.bytes!=null&&g.bytes!=null&&et(y,js.BITRATE,8*(g.bytes-v.bytes)/j),g.packetsLost!=null&&v.packetsLost!=null&&et(y,js.PACKAGE_LOST,g.packetsLost-v.packetsLost)}if(m)return y;let N=100*f._source.getAccurateVolumeLevel(),L=g.outputLevel;if(L!=null){let j=Math.ceil(50*Math.log10(100*L+1));et(y,cZ.LEVEL,j)}if(et(y,js.PCM_LEVEL,N),f&&(y[js.DISABLED]=f._originMediaStreamTrack.enabled&&f._mediaStreamTrack.enabled?0:1),et(y,js.JITTER_BUFFER,g.jitterBufferMs),et(y,js.CURRENT_DELAY,g.jitterBufferMs),y[js.PLAYER_STATUS]=TI[Ni.getPlayerState(f.getTrackId())],v){let j=g.concealedSamples-v.concealedSamples;j>0&&et(y,js.CONCEALED_SAMPLES,j)}return y}(s._audioSSRC,e,t,s.audioTrack,r):void 0;l&&(c.audio=l)}(c.video||c.audio)&&i.push(c)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,i}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;let e=(this.requestAllTracks()||[]).find(t=>t instanceof tw);if(e&&e._external.getDenoiserStats){let t=e._external.getDenoiserStats();t&&this.requestUpload(U0.DENOISER_STATS,t)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(e=>{e.getProcessorStats().forEach(t=>{this.requestUpload&&this.requestUpload(t.type,t.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(e=>{let[t,r]=e;r.has(we.VIDEO)&&t.videoTrack&&t.videoTrack.getProcessorStats().forEach(n=>{this.requestUpload&&this.requestUpload(n.type,n.stats)}),r.has(we.AUDIO)&&t.audioTrack&&t.audioTrack.getProcessorStats().forEach(n=>{this.requestUpload&&this.requestUpload(n.type,n.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);let e=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{let t=Date.now(),r={connectionInterval:D("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:t},n=[],i=this.requestAllTracks&&this.requestAllTracks()||[];for(let c of i)!c.muted&&c.enabled&&(n=n.concat(await c.getProcessorUsage()));let o=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(let[c,l]of o)l.has(we.VIDEO)&&c.videoTrack&&(n=n.concat(await c.videoTrack.getProcessorUsage())),l.has(we.AUDIO)&&c.audioTrack&&(n=n.concat(await c.audioTrack.getProcessorUsage()));if(n.length===0)return;r.details=function(c,l){let d={};for(let{id:m,value:g,level:y,direction:v}of c){var u;let E=(u=l.get(m))!==null&&u!==void 0?u:0,w=g===2?E+D("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:E;var p,f;l.set(m,w),d[m]?(g===2&&(d[m].value=g),y>d[m].level&&(d[m].level=y),v==="remote"&&(d[m].remoteUidCount+=1),d[m].totalTs=(p=l.get(m))!==null&&p!==void 0?p:0):d[m]={value:g,level:y,remoteUidCount:v==="local"?0:1,totalTs:(f=l.get(m))!==null&&f!==void 0?f:0}}return Object.keys(d).map(m=>{let{level:g,value:y,totalTs:v}=d[m];return{id:m,level:g,value:y,totalTs:v}})}(n,e);let s=Date.now(),a=s>t?s:t+1;this.requestUpload&&this.requestUpload(U0.EXTENSION_USAGE_STATS,{usageStats:r,sendTs:a})},D("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}},ql=class{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(e,t){C(this,"uid",void 0),C(this,"_uintid",void 0),C(this,"_trust_in_room_",!0),C(this,"_trust_audio_enabled_state_",!0),C(this,"_trust_video_enabled_state_",!0),C(this,"_trust_audio_mute_state_",!0),C(this,"_trust_video_mute_state_",!0),C(this,"_audio_muted_",!1),C(this,"_video_muted_",!1),C(this,"_audio_enabled_",!0),C(this,"_video_enabled_",!0),C(this,"_audio_added_",!1),C(this,"_video_added_",!1),C(this,"_is_pre_created",!1),C(this,"_video_pre_subscribed",!1),C(this,"_audio_pre_subscribed",!1),C(this,"_trust_video_stream_added_state_",!0),C(this,"_trust_audio_stream_added_state_",!0),C(this,"_audioTrack",void 0),C(this,"_videoTrack",void 0),C(this,"_dataChannels",[]),C(this,"_audioSSRC",void 0),C(this,"_videoSSRC",void 0),C(this,"_audioOrtc",void 0),C(this,"_videoOrtc",void 0),C(this,"_cname",void 0),C(this,"_rtxSsrcId",void 0),C(this,"_videoMid",void 0),C(this,"_audioMid",void 0),this.uid=e,this._uintid=t}},ya=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({});function MMe(e,t){var r;let n;switch(t){case ne.LocalAudioTrack:n=Ot.Audio;break;case ne.LocalVideoTrack:n=pe(r=e._hints).call(r,nr.SCREEN_TRACK)?Ot.Screen:Ot.High;break;case ne.LocalVideoLowTrack:n=Ot.Low}return n}function ZO(e){let t=Et();if(e.some(r=>r._bypassWebAudio))throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!t.webAudioMediaStreamDest)throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function LI(e,t){ZO(e);let r=new on;return e.forEach(n=>r.addAudioTrack(n)),r}var UB,FB,VB,BB,$B,HB,WB,GB,zB,KB,qB,or;function YB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ro=(UB=ha(ya.SEND_ONLY),FB=ha(ya.SEND_ONLY),VB=ha(),BB=ha(ya.RECEIVE_ONLY),$B=ha(ya.RECEIVE_ONLY),HB=ha(ya.RECEIVE_ONLY),WB=ha(ya.RECEIVE_ONLY),GB=ha(ya.RECEIVE_ONLY),zB=ha(ya.RECEIVE_ONLY),KB=ha(),qB=ha(ya.RECEIVE_ONLY),or=class extends fr{get state(){return this._state}set state(e){let t=this._state;this._state=e,this.emit(Ne.StateChange,t,this._state)}constructor(e,t){super(),C(this,"isPlanB",!1),C(this,"store",void 0),C(this,"statsUploader",void 0),C(this,"sendConnection",void 0),C(this,"recvConnection",void 0),C(this,"localTrackMap",new Map),C(this,"remoteUserMap",new Map),C(this,"localDataChannels",[]),C(this,"pendingLocalTracks",[]),C(this,"pendingRemoteTracks",[]),C(this,"statsCollector",void 0),C(this,"dtlsFailedCount",0),C(this,"sendMutex",new Gn("P2PChannel2-send-mutex")),C(this,"recvMutex",new Gn("P2PChannel2-recv-mutex")),C(this,"_state",xt.Disconnected),C(this,"_restartStates",["disconnected","failed"]),C(this,"reconnectInterval",void 0),C(this,"uploadUnplinkStarted",!1),C(this,"uploadDownlinkStarted",!1),C(this,"uplinkStateUploadInterval",void 0),C(this,"downlinkStatsUploadInterval",void 0),C(this,"handleMuteLocalTrack",async(r,n,i)=>{let o=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==xt.Connected)return void i(new X(I.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));let c=this.filterTobeMutedTracks(r);if(c.length===0)return void n();let l=c.find(f=>f[0]==="videoLowTrack");l&&l[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(c.map(f=>{let[,{id:m}]=f;return m}));let d=!1;var s,a;r.trackMediaType==="video"?d=!((s=this.localTrackMap.get(ne.LocalAudioTrack))===null||s===void 0||!s.track._muted):d=((a=this.localTrackMap.get(ne.LocalVideoTrack))===null||a===void 0?void 0:a.id)===void 0;let u=this.createMuteMessage(c);await Wt(this,Ne.RequestMuteLocal,u);let p=r.trackMediaType==="video"?id.MUTE_LOCAL_VIDEO:id.MUTE_LOCAL_AUDIO;await Wt(this,Ne.RequestP2PMuteLocal,{action:p,message:u,isMuteAll:d}),n()}catch(c){i(c)}finally{o()}}),C(this,"handleUnmuteLocalTrack",async(r,n,i)=>{let o=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==xt.Connected)return void i(new X(I.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));let s=this.filterTobeUnmutedTracks(r);if(s.length===0)return void n();await this.sendConnection.unmuteLocal(s.map(l=>{let[,{id:d}]=l;return d}));let a=this.createUnmuteMessage(s),c=r.trackMediaType==="video"?id.UNMUTE_LOCAL_VIDEO:id.UNMUTE_LOCAL_AUDIO;await Wt(this,Ne.RequestP2PMuteLocal,{action:c,message:a}),n()}catch(s){i(s)}finally{o()}}),C(this,"handleUpdateVideoEncoder",async(r,n,i)=>{let o=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{let s=this.localTrackMap.get(ne.LocalVideoTrack);if(!this.sendConnection||!s||s.track!==r||this.state!==xt.Connected)return void n();let{id:a,track:c}=s;a&&(await this.sendConnection.updateSendParameters(a,c),await this.sendConnection.updateEncoderConfig(a,c),this.emit(Ne.UpdateVideoEncoder,c)),n()}catch(s){i(s)}finally{o()}}),C(this,"handleUpdateVideoSendParameters",async(r,n,i)=>{let o=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{let s=this.localTrackMap.get(ne.LocalVideoTrack);if(!this.sendConnection||!s||s.track!==r||this.state!==xt.Connected)return void n();let{id:a,track:c}=s;a&&await this.sendConnection.updateSendParameters(a,c),n()}catch(s){i(s)}finally{o()}}),C(this,"handleReplaceTrack",async(r,n,i,o)=>{let s;b.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),typeof o=="boolean"&&o||(s=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var a;let l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:u}]=d;return r===u});if(!this.sendConnection||!l||l[1].id===void 0||this.state!==xt.Connected)return void n();if(await((a=this.sendConnection)===null||a===void 0?void 0:a.replaceTrack(r,l[1].id)),l[0]===ne.LocalVideoTrack&&Et().supportDualStreamEncoding){let d=this.localTrackMap.get(ne.LocalVideoLowTrack);if(d){let u=r._mediaStreamTrack.clone();d.track._originMediaStreamTrack.stop(),d.track._mediaStreamTrack=u,d.track._originMediaStreamTrack=u,await new de((p,f)=>{this.handleReplaceTrack(d.track,p,f,!0)})}}n()}catch(l){i(l)}finally{var c;(c=s)===null||c===void 0||c()}}),C(this,"handleGetLocalVideoStats",r=>{r(this.statsCollector.getLocalVideoTrackStats())}),C(this,"handleGetLocalAudioStats",r=>{r(this.statsCollector.getLocalAudioTrackStats())}),C(this,"handleGetRemoteVideoStats",r=>this.statsCollector.getRemoteVideoTrackStats(r.uid)[r.uid]),C(this,"handleGetRemoteAudioStats",r=>this.statsCollector.getRemoteAudioTrackStats(r.uid)[r.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new lZ(e),this.bindStatsUploaderEvents(),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(r=>{r&&(r.iceConnectionState!=="disconnected"&&r.iceConnectionState!=="failed"||this.handleDisconnect(r.direction))})},D("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,t){throw new X(I.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e){throw new X(I.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,t){let r;try{if(t){this.recvConnection&&(b.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),r=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new LB(e,this.store,yi.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);let n=await this.recvConnection.establish(t);return{iceParameters:n.iceParameters,dtlsParameters:n.dtlsParameters,sdp:n.sdp}}{this.state=xt.New,this.sendConnection&&(b.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),r=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new LB(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);let n=await this.sendConnection.establish();return{iceParameters:n.iceParameters,dtlsParameters:n.dtlsParameters,sdp:n.sdp}}}finally{r&&r()}}async p2pConnect(e){if(!this.sendConnection)throw new X(I.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=xt.Connected}async addRemoteCandidate(e,t){if(t===yi.RECEIVE_ONLY){if(!this.sendConnection)throw new X(I.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new X(I.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,t,r){var n=this;return Ia(function*(){let i=yield wt(n.sendMutex.lock("From P2PChannel.publish"));try{if(!n.sendConnection||n.state!==xt.Connected){n.throwIfTrackTypeNotMatch(e);let l=e.filter(d=>n.pendingLocalTracks.indexOf(d)===-1);return void(n.pendingLocalTracks=n.pendingLocalTracks.concat(l))}n.store.pubId=n.store.pubId+1,$n.markPublishStart(n.store.clientId,n.store.pubId);let o=n.filterTobePublishedTracks(e,t,r);if(o.length===0)return void(yield wt(n.tryToUnmuteAudio(e)));o.forEach(l=>{let{track:d,type:u}=l,p=Date.now();n.store.publish(d.getTrackId(),u===ne.LocalAudioTrack?"audio":"video",p)}),n.bindLocalTrackEvents(o);let s=yield wt(n.sendConnection.send(o.map(l=>{let{track:d}=l;return d}),n.store.codec,n.store.audioCodec)),a=(yield wt(s.next())).value,c=n.createGatewayPublishMessage(o,a);try{yield c}catch(l){throw s.throw(l),(l==null?void 0:l.code)===I.WS_ABORT&&o.forEach(d=>{let{track:u}=d;n.pendingLocalTracks.indexOf(u)===-1&&n.pendingLocalTracks.push(u)}),n.unbindLocalTrackEvents(o),l}yield wt(s.next()),o.forEach(l=>{let{type:d}=l;n.statsCollector.addLocalStats(d)}),n.statsUploader.startUploadOutboundStats(),n.assignLocalTracks(o,a),o.forEach(l=>{let{track:d,type:u}=l,p=Date.now();n.store.publish(d.getTrackId(),u===ne.LocalAudioTrack?"audio":"video",void 0,p)}),n.startUploadUplinkState()}finally{i()}})()}async unpublish(e){if(!this.sendConnection||this.state!==xt.Connected)return void(e.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(i=>!pe(e).call(e,i)));let t=this.filterTobeUnpublishedTracks(e);if(t.length===0)return;let r=t.find(i=>i[0]==="videoLowTrack");r&&r[1].track.close();let n=this.createGatewayUnpublishMessage(t);if(await this.sendConnection.stopSending(t.map(i=>{let[,{id:o}]=i;return o})),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map(i=>{let[o,{track:s}]=i;return{type:o,track:s}})),t.forEach(i=>{let[o]=i;this.statsCollector.removeLocalStats(o)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===xt.Connected)return r&&r[1].track.close(),n;e.forEach(i=>{let o=this.pendingLocalTracks.indexOf(i);o!==-1&&this.pendingLocalTracks.splice(o,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);let e=()=>{let t=[],r=[];Array.from(this.localTrackMap.entries()).forEach(n=>{let[i,{track:o,ssrcs:s}]=n,a={stream_type:MMe(o,i),ssrcs:s};o._muted||!o._enabled?t.push(a):r.push(a)}),t.length>0&&t.forEach(n=>{Wt(this,Ne.RequestMuteLocal,[n])}),r.length>0&&r.forEach(n=>{Wt(this,Ne.RequestUnmuteLocal,[n])})};e(),this.uplinkStateUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return Ia(function*(){throw new X(I.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(b.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Dn(this,Ne.RequestRePublish,this.pendingLocalTracks),this.emit(Ne.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new X(I.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,t,r,n){var i;if(!this.recvConnection)throw new X(I.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((i=this.remoteUserMap.get(e))!==null&&i!==void 0&&i.has(t))return;let{track:o,mid:s,transceiver:a}=await this.recvConnection.receive(t,[{ssrcId:r}],String(e.uid),n);t===we.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(o):(e._audioTrack=new Jp(o,e.uid,e._uintid,this.store),b.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),a&&e._audioTrack._updateRtpTransceiver(a),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=r,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(o):(e._videoTrack=new Xp(o,e.uid,e._uintid,this.store),b.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),a&&e._videoTrack._updateRtpTransceiver(a),this.bindRemoteTrackEvents(e,e._videoTrack));let c=this.remoteUserMap.get(e);c?c.set(t,s):this.remoteUserMap.set(e,new Map([[t,s]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();let l=this.pendingRemoteTracks.findIndex(d=>{let{user:u,kind:p}=d;return u.uid===e.uid&&t===p});l!==-1&&(this.pendingRemoteTracks.splice(l,1),this.emit(Ne.MediaReconnectEnd,e.uid))}async mockSubscribe(e,t,r,n){if(!this.recvConnection)throw new X(I.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(t,[{ssrcId:r}],String(e.uid),n)}async unsubscribe(e,t,r){let n=this.pendingRemoteTracks.filter(o=>{let{user:s,kind:a}=o;return t!==void 0?s.uid===e.uid&&t===a:s.uid===e.uid});if(n.forEach(o=>{let s=this.pendingRemoteTracks.indexOf(o);this.pendingRemoteTracks.splice(s,1)}),this.recvConnection||r||n.forEach(o=>{let{kind:s}=o;var a;if(s===we.AUDIO)(a=e._audioTrack)===null||a===void 0||a._destroy(),e._audioTrack=void 0;else if(s===we.VIDEO){var c;(c=e._videoTrack)===null||c===void 0||c._destroy(),e._videoTrack=void 0}}),!this.recvConnection)return;let i=this.filterTobeUnSubscribedTracks(e,t);i.length!==0&&(await this.recvConnection.stopReceiving(i.map(o=>{let[,{id:s}]=o;return s})),this.withdrawRemoteTracks(i),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),i.forEach(o=>{let[s,{kind:a}]=o;var c,l;if(a===we.VIDEO&&s._videoSSRC&&((c=this.recvConnection)===null||c===void 0||c.setStatsRemoteVideoIsReady(s._videoSSRC,!1)),a===we.VIDEO)this.unbindRemoteTrackEvents(s._videoTrack),r||((l=s._videoTrack)===null||l===void 0||l._destroy(),s._videoTrack=void 0);else if(a===we.AUDIO){var d;this.unbindRemoteTrackEvents(s._audioTrack),!r&&((d=s._audioTrack)===null||d===void 0||d._destroy(),s._audioTrack=void 0)}}),i.forEach(o=>{let[,{kind:s}]=o;Wt(this,Ne.RequestP2PMuteRemote,s)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);let e=()=>Array.from(this.remoteUserMap.entries()).forEach(t=>{let[,r]=t;[we.VIDEO,we.AUDIO].forEach(n=>{r.has(n)?Wt(this,Ne.RequestP2PUnmuteRemote,n):Wt(this,Ne.RequestP2PMuteRemote,n)})});e(),this.downlinkStatsUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new X(I.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new X(I.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new X(I.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new X(I.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,t){if(!this.recvConnection)return;let r=this.remoteUserMap.get(e);if(!r)return void b.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!r.get(t))return void b.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));let n=t===we.VIDEO?e._videoSSRC:e._audioSSRC;n!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(n,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.recvConnection)return;let r=this.remoteUserMap.get(e);if(!r)return void b.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."));r.get(t)||b.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."))}getAllTracks(e){let t=this.localTrackMap.get(ne.LocalAudioTrack);if((t==null?void 0:t.track)instanceof on){let r=t.track;return Array.from(this.localTrackMap.entries()).filter(n=>{let[i]=n;return i!==ne.LocalAudioTrack}).filter(n=>{let[i]=n;return!(e&&i===ne.LocalVideoLowTrack)}).map(n=>{let[,{track:i}]=n;return i}).concat(r.trackList)}return Array.from(this.localTrackMap.entries()).filter(r=>{let[n]=r;return!(e&&n===ne.LocalVideoLowTrack)}).map(r=>{let[,{track:n}]=r;return n})}reportPublishEvent(e,t,r,n,i){if(e){let s=this.localTrackMap.get(ne.LocalAudioTrack),a=n?this.localTrackMap.get(ne.LocalVideoLowTrack):this.localTrackMap.get(ne.LocalVideoTrack);_e.publish(this.store.sessionId,{eventElapse:$n.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:s==null?void 0:s.track.getTrackLabel(),videoName:a==null?void 0:a.track.getTrackLabel(),screenshare:(a==null?void 0:a.track._hints.indexOf(nr.SCREEN_TRACK))!==-1,audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}else{var o;r||(r=[]);let s=r.find(c=>c instanceof vr),a=n?(o=this.localTrackMap.get(ne.LocalVideoTrack))===null||o===void 0?void 0:o.track:r.find(c=>c instanceof Qt);_e.publish(this.store.sessionId,{eventElapse:$n.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:s==null?void 0:s.getTrackLabel(),videoName:a==null?void 0:a.getTrackLabel(),screenshare:(a==null?void 0:a._hints.indexOf(nr.SCREEN_TRACK))!==-1,audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}}reportSubscribeEvent(e,t,r,n){let i=n===we.VIDEO?r._videoSSRC:r._audioSSRC;i&&_e.subscribe(this.store.sessionId,{succ:e,ec:t,video:n===we.VIDEO,audio:n===we.AUDIO,peerid:r.uid,subscribeRequestid:n===we.VIDEO?r._videoSSRC:r._audioSSRC,p2pid:this.store.p2pId,eventElapse:$n.measureFromSubscribeStart(this.store.clientId,i)})}reset(){b.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Gn("P2PChannel2-send-mutex"),this.sendMutex=new Gn("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();let e=this.localTrackMap.get(ne.LocalAudioTrack);if((e==null?void 0:e.track)instanceof on){if(e.track.trackList.length>0){let t=e.track;e.track.trackList.forEach(r=>{t.removeAudioTrack(r)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=xt.Disconnected}getStats(e){var t,r;return e?(r=this.recvConnection)===null||r===void 0?void 0:r.getStats():(t=this.sendConnection)===null||t===void 0?void 0:t.getStats()}getRemoteVideoIsReady(e){var t;return((t=this.recvConnection)===null||t===void 0?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){let e=this.localTrackMap.get(ne.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){let e=this.localTrackMap.get(ne.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){let t=this.localTrackMap.get(e);return t&&t.track instanceof Qt||t&&t.track instanceof vr?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;let r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;let r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}getRemoteMedia(e){var t;let r=Array.from(wo(t=this.remoteUserMap).call(t)).find(n=>n.uid===e);return r?{audioTrack:r.audioTrack,audioSSRC:r._audioSSRC,videoTrack:r.videoTrack,videoSSRC:r._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(r=>{let[n]=r;return{uid:n.uid,level:n.audioTrack?100*n.audioTrack._source.getAccurateVolumeLevel():0}}),t=this.localTrackMap.get(ne.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Vy(e).call(e,(r,n)=>r.level-n.level),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(b.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=xt.Reconnecting,D("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t]=e;var r;t._videoTrack&&t._videoTrack._player&&((r=t._videoTrack._player.getVideoElement())===null||r===void 0||r.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var t;let[r,{track:n}]=e;switch(r){case ne.LocalVideoTrack:pe(t=n._hints).call(t,nr.LOW_STREAM)?n.close():this.pendingLocalTracks.push(n);break;case ne.LocalAudioTrack:n instanceof on?this.pendingLocalTracks=this.pendingLocalTracks.concat(n.trackList):this.pendingLocalTracks.push(n);case ne.LocalVideoLowTrack:}}),this.emit(Ne.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;Array.from(wo(r).call(r)).forEach(n=>{this.setPendingRemoteMedia(t,n)}),this.emit(Ne.MediaReconnectStart,t.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),b.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,t){for(let r of this.pendingRemoteTracks){let{user:n,kind:i}=r;if((e instanceof ql?e.uid:e)===n.uid&&t===i)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async restartICE(e,t){let r,n;if(e===yi.SEND_ONLY){if(!this.sendConnection)throw new X(I.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");r=await this.sendMutex.lock("From P2PChannel.restartICE"),n=this.sendConnection}else{if(!this.recvConnection)throw new X(I.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");r=await this.recvMutex.lock("From P2PChannel.restartICE"),n=this.recvConnection}try{if(t){let i=await n.restartICE(t);return n.isInRestartIce=!1,i}{let i=await n.restartICE();if(i){let o=await Dn(this,Ne.RequestP2PRestartICE,{direction:yi.RECEIVE_ONLY,iceParameter:i});await n.restartICE(o),n.isInRestartIce=!1}}}finally{r()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;let e=this.sendConnection.getStats(),t=this.localTrackMap.get(ne.LocalVideoTrack),r=this.localTrackMap.get(ne.LocalAudioTrack),n=e.videoSend.find(f=>{var m;return f.ssrc===(t==null||(m=t.ssrcs)===null||m===void 0?void 0:m[0].ssrcId)}),i=e.audioSend.find(f=>{var m;return f.ssrc===(r==null||(m=r.ssrcs)===null||m===void 0?void 0:m[0].ssrcId)});if(!n||!i)return 1;let o=is(this,Ne.NeedSignalRTT),s=n?n.rttMs:void 0,a=i?i.rttMs:void 0,c=s&&a?(s+a)/2:s||a,l=(c&&o?(c+o)/2:c||o)||0,d=100*e.sendPacketLossRate*.7/50+.3*l/1500,u=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,p=t==null?void 0:t.track;if(p&&p._encoderConfig&&p._hints.indexOf(nr.SCREEN_TRACK)===-1){let f=p._encoderConfig.bitrateMax,m=e.bitrate.actualEncoded;if(f&&m){let g=(1e3*f-m)/(1e3*f);return nQ[g<.15?0:g<.3?1:g<.45?2:g<.6?3:4][u]}}return u}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;let e=this.recvConnection.getStats(),t=0;return Array.from(this.remoteUserMap.entries()).forEach(r=>{let[n]=r,i=n._audioSSRC,o=n._videoSSRC,s=e.audioRecv.find(m=>m.ssrc===i),a=e.videoRecv.find(m=>m.ssrc===o);if(!s&&!a)return void(t+=1);let c=is(this,Ne.NeedSignalRTT),l=e.rtt,d=(l&&c?(l+c)/2:l||c)||0,u=s?s.jitterMs:void 0,p=e.recvPacketLossRate,f=.7*p*100/50+.3*d/1500;u&&(f=.6*p*100/50+.2*d/1500+.2*u/400),t+=f<.1?1:f<.17?2:f<.36?3:f<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new de((t,r)=>{this.handleMuteLocalTrack(e,t,r)})}filterTobePublishedTracks(e,t,r){let n=[],i=Et(),o=this.getAllTracks();e=Op(e=e.filter(c=>o.indexOf(c)===-1));let s=!1,a=!1;for(let c of e){if(c instanceof Qt&&(this.localTrackMap.has(ne.LocalVideoTrack)||s?new X(I.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(n.push({track:c,type:ne.LocalVideoTrack}),s=!0),t)){let l=this.getLowVideoTrack(c,r);n.push({track:l,type:ne.LocalVideoLowTrack})}if(c instanceof vr){let l=this.localTrackMap.get(ne.LocalAudioTrack);if(l){if(!(l.track instanceof on))throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");l.track.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0)}else if(a){let d=n.find(u=>{let{type:p}=u;return p===ne.LocalAudioTrack});if(!(d.track instanceof on))throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");d.track.addAudioTrack(c)}else{if(!i.webAudioMediaStreamDest||c instanceof on||c._bypassWebAudio)n.push({track:c,type:ne.LocalAudioTrack});else{let d=new on;d.addAudioTrack(c),n.push({track:d,type:ne.LocalAudioTrack})}a=!0}}}return n}filterTobeUnpublishedTracks(e){let t=[],r=this.getAllTracks();e=Op(e=e.filter(n=>r.indexOf(n)!==-1));for(let n of e){if(n instanceof vr){let i=this.localTrackMap.get(ne.LocalAudioTrack);if(!i)continue;i.track instanceof on?(i.track.removeAudioTrack(n),this.unbindLocalAudioTrackEvents(n),i.track.trackList.length===0&&(t.push([ne.LocalAudioTrack,i]),i.track.close())):t.push([ne.LocalAudioTrack,i])}if(n instanceof Qt){let i=this.localTrackMap.get(ne.LocalVideoTrack);if(!i)continue;t.push([ne.LocalVideoTrack,i]);let o=this.localTrackMap.get(ne.LocalVideoLowTrack);o&&t.push([ne.LocalVideoLowTrack,o])}}return t}bindLocalTrackEvents(e){e.forEach(t=>{let{track:r,type:n}=t;switch(n){case ne.LocalVideoTrack:r.addListener(fe.GET_STATS,this.handleGetLocalVideoStats),r.addListener(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.addListener(fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.addListener(fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case ne.LocalAudioTrack:this.bindLocalAudioTrackEvents(r);case ne.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){e instanceof on?e.trackList.forEach(r=>{r.addListener(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(fe.GET_STATS,this.handleGetLocalAudioStats),r.addListener(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(fe.GET_STATS,this.handleGetLocalAudioStats),e.addListener(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(fe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(t=>{let[r,{track:n}]=t;return{track:n,type:r}})),e.forEach(t=>{let{track:r,type:n}=t;switch(n){case ne.LocalVideoTrack:r.off(fe.GET_STATS,this.handleGetLocalVideoStats),r.off(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.off(fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.off(fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case ne.LocalAudioTrack:this.unbindLocalAudioTrackEvents(r);case ne.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof on?e.trackList.forEach(t=>{t.off(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(fe.GET_STATS,this.handleGetLocalAudioStats),t.off(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(fe.GET_STATS,this.handleGetLocalAudioStats),e.off(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof Xp&&t.addListener(fe.GET_STATS,r=>{r(this.handleGetRemoteVideoStats(e))}),t instanceof Jp&&t.addListener(fe.GET_STATS,r=>{r(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(fe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;r.has(we.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),r.has(we.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((r,n)=>{var i;let o,{track:s,type:a}=r;switch(a){case ne.LocalAudioTrack:o=Ot.Audio;break;case ne.LocalVideoTrack:o=pe(i=s._hints).call(i,nr.SCREEN_TRACK)?Ot.Screen:Ot.High;break;case ne.LocalVideoLowTrack:o=Ot.Low}return{kind:a===ne.LocalAudioTrack?we.AUDIO:we.VIDEO,stream_type:o,mid:t[n].id,ssrcs:t[n].localSSRC,isMuted:s.muted||!s.enabled}})}createGatewayUnpublishMessage(e){return e.map(t=>{var r;let n,[i,{track:o,ssrcs:s,id:a}]=t;switch(i){case ne.LocalVideoTrack:n=pe(r=o._hints).call(r,nr.SCREEN_TRACK)?Ot.Screen:Ot.High;break;case ne.LocalAudioTrack:n=Ot.Audio;break;case ne.LocalVideoLowTrack:n=Ot.Low}return{stream_type:n,ssrcs:s,mid:a}})}assignLocalTracks(e,t){e.forEach((r,n)=>{let{track:i,type:o}=r;this.localTrackMap.set(o,{track:i,id:t[n].id,ssrcs:t[n].localSSRC})})}withdrawLocalTracks(e){e.forEach(t=>{let[r]=t;this.localTrackMap.delete(r)})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{var r;b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(t,")")),this.emit(Ne.PeerConnectionStateChange,t),t!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),t==="connected"&&(e.isInRestartIce=!1),pe(r=this._restartStates).call(r,t)&&!e.isInRestartIce&&(t==="disconnected"&&await Tn(800),e.iceConnectionState!=="disconnected"&&e.iceConnectionState!=="failed"||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=t=>{t!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(t,")")),_e.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:t,tag:Er.TRACER}).onSuccess(),this.emit(Ne.IceConnectionStateChange,t)},e.onICETransportStateChange=t=>{b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(t,")"))},e.onDTLSTransportStateChange=t=>{b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(t,")"))},e.onDTLSTransportError=t=>{b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(t,")"))},e.onFirstAudioDecoded=t=>{var r;let n=Array.from(wo(r=this.remoteUserMap).call(r)).find(o=>o._audioSSRC===t);var i;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),(i=n.audioTrack)===null||i===void 0||i.emit(Yp.FIRST_FRAME_DECODED),_e.firstRemoteFrame(this.store.sessionId,vn.FIRST_AUDIO_DECODE,hr.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:$n.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=t=>{var r;let n=Array.from(wo(r=this.remoteUserMap).call(r)).find(i=>i._audioSSRC===t);n&&_e.firstRemoteFrame(this.store.sessionId,vn.FIRST_AUDIO_RECEIVED,hr.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:$n.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(t,r,n)=>{this.reportVideoFirstFrameDecoded(t,r,n)},e.onFirstVideoReceived=t=>{var r;let n=Array.from(wo(r=this.remoteUserMap).call(r)).find(i=>i._videoSSRC===t);n&&_e.firstRemoteFrame(this.store.sessionId,vn.FIRST_VIDEO_RECEIVED,hr.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:$n.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(t,r)=>{let n=t.candidateType==="relay",i=r.candidateType==="relay";r.candidateType!=="unknown"&&n===i||this.emit(Ne.ConnectionTypeChange,n),b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(od(r))," -> ").concat(JSON.stringify(od(t)),")"))},e.onSelectedRemoteCandidateChanged=(t,r)=>{b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(od(r))," -> ").concat(JSON.stringify(od(t)),")"))},e.onFirstVideoDecodedTimeout=t=>{this.reportVideoFirstFrameDecoded(t,void 0,void 0,!0)},e.onLocalCandidate=t=>{this.emit(Ne.LocalCandidate,{candidate:t,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){let t=e===yi.SEND_ONLY?this.sendConnection:this.recvConnection;t&&!t.isInRestartIce&&(t.isInRestartIce=!0,b.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(t.name,"] start use restartICE")),e===yi.SEND_ONLY?this.restartICE(e):Dn(this,Ne.RequestP2PRestartICE,{direction:yi.SEND_ONLY}))}filterTobeMutedTracks(e){let t=[];if(this.getAllTracks().indexOf(e)===-1)return t;let r=this.localTrackMap.get(ne.LocalAudioTrack);if(e instanceof vr&&(r==null?void 0:r.track)instanceof on)return r.track.isActive||t.push([ne.LocalAudioTrack,r]),t;let n=Array.from(this.localTrackMap.entries()).find(i=>{let[,{track:o}]=i;return e===o});if(n&&(t.push(n),n[0]===ne.LocalVideoTrack)){let i=this.localTrackMap.get(ne.LocalVideoLowTrack);i&&t.push([ne.LocalVideoLowTrack,i])}return t}filterTobeUnmutedTracks(e){let t=[],r=this.localTrackMap.get(ne.LocalAudioTrack);if(e instanceof vr&&(r==null?void 0:r.track)instanceof on)return r.track.isActive&&t.push([ne.LocalAudioTrack,r]),t;let n=Array.from(this.localTrackMap.entries()).find(i=>{let[,{track:o}]=i;return e===o});if(n)if(n[0]===ne.LocalVideoTrack){t.push(n);let i=this.localTrackMap.get(ne.LocalVideoLowTrack);i&&t.push([ne.LocalVideoLowTrack,i])}else t.push(n);return t}createMuteMessage(e){return e.map(t=>{var r;let n,[i,{track:o,ssrcs:s,id:a}]=t;switch(i){case ne.LocalAudioTrack:n=Ot.Audio;break;case ne.LocalVideoTrack:n=pe(r=o._hints).call(r,nr.SCREEN_TRACK)?Ot.Screen:Ot.High;break;case ne.LocalVideoLowTrack:n=Ot.Low}return{stream_type:n,ssrcs:s,mid:a}})}createUnmuteMessage(e){return e.map(t=>{var r;let n,[i,{track:o,ssrcs:s,id:a}]=t;switch(i){case ne.LocalAudioTrack:n=Ot.Audio;break;case ne.LocalVideoTrack:n=pe(r=o._hints).call(r,nr.SCREEN_TRACK)?Ot.Screen:Ot.High;break;case ne.LocalVideoLowTrack:n=Ot.Low}return{stream_type:n,ssrcs:s,mid:a}})}filterTobeUnSubscribedTracks(e,t){let r=[],n=this.remoteUserMap.get(e);if(!n)return r;if(t){let i=n.get(t);if(!i)return r;r.push([e,{kind:t,id:i}])}else Array.from(n.entries()).forEach(i=>{let[o,s]=i;r.push([e,{kind:o,id:s}])});return r}createUnsubscribeMessage(e){let t=[];return e.forEach(r=>{let[n,{kind:i,id:o}]=r;switch(i){case we.VIDEO:return void(n._videoSSRC&&t.push({stream_type:we.VIDEO,ssrcId:n._videoSSRC}));case we.AUDIO:return void(n._audioSSRC&&t.push({stream_type:we.AUDIO,ssrcId:n._audioSSRC}))}}),t}withdrawRemoteTracks(e){e.forEach(t=>{let[r,{kind:n}]=t,i=this.remoteUserMap.get(r);i&&(i.delete(n),Array.from(i.entries()).length===0&&this.remoteUserMap.delete(r))})}async updateBitrateLimit(e){let t=this.localTrackMap.get(ne.LocalVideoTrack),r=this.localTrackMap.get(ne.LocalVideoLowTrack);t&&await t.track.setBitrateLimit(e.uplink),r&&e.low_stream_uplink&&await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){let e=this.sendConnection.peerConnectionState,t=this.recvConnection.peerConnectionState;return e!=="connected"&&t!=="connected"}return!0}async tryToUnmuteAudio(e){for(let t=0;t<e.length;t++)if(e[t]instanceof vr){let r=this.filterTobeUnmutedTracks(e[t]);if(r.length===0)continue;let n=this.createUnmuteMessage(r);return void await Wt(this,Ne.RequestUnmuteLocal,n)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(e=>{let[,{ssrcs:t}]=e;return!!t}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!((t=this.recvConnection)===null||t===void 0||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(Ne.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(Ne.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Tn(ND(this.dtlsFailedCount,Fr)),this.emit(Ne.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(ne.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof Qt)}throwIfTrackTypeNotMatch(e){if(e.filter(t=>t instanceof Qt).length>1)throw new X(I.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(t=>t instanceof vr).length>1&&(e.some(t=>t instanceof vr&&t._bypassWebAudio)||!Et().webAudioMediaStreamDest))throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(let t of e){if(t instanceof Qt&&this.pendingLocalTracks.some(r=>r instanceof Qt))throw new X(I.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof vr&&this.pendingLocalTracks.some(r=>r instanceof vr)&&(!Et().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(r=>r instanceof vr&&r._bypassWebAudio)))throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){let r=!D("DISABLE_DUAL_STREAM_USE_ENCODING")&&Et().supportDualStreamEncoding,n=yE(yE({},{width:160,height:120,framerate:15,bitrate:50}),t),i;i=r?e._mediaStreamTrack.clone():QO(e,n);let o=qt(8,"track-low-"),s=new Qt(i,yE(yE({},r&&{scaleResolutionDownBy:UO(n,e)}),{},{frameRate:n.framerate,bitrateMax:n.bitrate,bitrateMin:n.bitrate}),void 0,void 0,o);return s.on(Vu.TRANSCEIVER_UPDATED,a=>{e._updateRtpTransceiver(a,xf.LOW_STREAM)}),s._hints.push(nr.LOW_STREAM),e.addListener(fe.NEED_CLOSE,()=>{s.close()}),s}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,t,r,n){var i;let o=Array.from(wo(i=this.remoteUserMap).call(i)).find(s=>s._videoSSRC===e);if(o){n||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());let s=this.store.keyMetrics,a=s.subscribe.find(c=>c.userId===o.uid&&c.type==="video");_e.firstRemoteVideoDecode(this.store.sessionId,vn.FIRST_VIDEO_DECODE,hr.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:r,subscribeElapse:$n.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:s.requestAPEnd||0,apStart:s.requestAPStart||0,joinGwEnd:s.joinGatewayEnd||0,joinGwStart:s.joinGatewayStart||0,pcEnd:s.peerConnectionEnd||0,pcStart:s.peerConnectionStart||0,subscriberEnd:(a==null?void 0:a.subscribeEnd)||0,subscriberStart:(a==null?void 0:a.subscribeStart)||0,videoAddNotify:(a==null?void 0:a.streamAdded)||0,state:n?1:0})}}async remoteMediaSsrcChanged(e,t,r){if(!this.recvConnection)return!1;let n=this.remoteUserMap.get(e);if(!n)return!1;let i=n.get(t);if(!i)return!1;let o=await this.recvConnection.getRemoteSSRC(i);return o!==void 0&&o!==r}isPreSubScribe(e){return!1}async publishDataChannel(e){throw new X(I.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new X(I.NOT_SUPPORTED)}async subscribeDataChannel(e,t){throw new X(I.NOT_SUPPORTED)}async unsubscribeDataChannel(e,t){throw new X(I.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,t){throw new X(I.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,t){throw new X(I.NOT_SUPPORTED)}async preConnect(e){throw new X(I.NOT_SUPPORTED)}getEstablishParams(){throw new X(I.NOT_SUPPORTED)}async reSubscribe(e){throw new X(I.NOT_SUPPORTED)}async updateVideoStreamParameter(e,t){throw new X(I.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:r}]=e;t===ne.LocalVideoLowTrack?r._updateRtpTransceiver(void 0,xf.LOW_STREAM):r._updateRtpTransceiver(void 0)})}},ve(or.prototype,"p2pConnect",[UB],Object.getOwnPropertyDescriptor(or.prototype,"p2pConnect"),or.prototype),ve(or.prototype,"unpublish",[FB],Object.getOwnPropertyDescriptor(or.prototype,"unpublish"),or.prototype),ve(or.prototype,"unpublishLowStream",[VB],Object.getOwnPropertyDescriptor(or.prototype,"unpublishLowStream"),or.prototype),ve(or.prototype,"subscribe",[BB],Object.getOwnPropertyDescriptor(or.prototype,"subscribe"),or.prototype),ve(or.prototype,"mockSubscribe",[$B],Object.getOwnPropertyDescriptor(or.prototype,"mockSubscribe"),or.prototype),ve(or.prototype,"unsubscribe",[HB],Object.getOwnPropertyDescriptor(or.prototype,"unsubscribe"),or.prototype),ve(or.prototype,"muteRemote",[WB],Object.getOwnPropertyDescriptor(or.prototype,"muteRemote"),or.prototype),ve(or.prototype,"unmuteRemote",[GB],Object.getOwnPropertyDescriptor(or.prototype,"unmuteRemote"),or.prototype),ve(or.prototype,"hasRemoteMediaWithLock",[zB],Object.getOwnPropertyDescriptor(or.prototype,"hasRemoteMediaWithLock"),or.prototype),ve(or.prototype,"disconnectForReconnect",[KB],Object.getOwnPropertyDescriptor(or.prototype,"disconnectForReconnect"),or.prototype),ve(or.prototype,"remoteMediaSsrcChanged",[qB],Object.getOwnPropertyDescriptor(or.prototype,"remoteMediaSsrcChanged"),or.prototype),or);function ha(e){return function(t,r,n){let i=t[r];if(typeof i!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];switch(e){case ya.SEND_ONLY:{let c=await this.sendMutex.lock("From P2PChannel2.".concat(r));try{return await i.apply(this,s)}finally{c()}}case ya.RECEIVE_ONLY:{let c=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await i.apply(this,s)}finally{c()}}default:{let c=await this.sendMutex.lock("From P2PChannel2.".concat(r)),l=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await i.apply(this,s)}finally{c(),l()}}}},n}}function XB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var dZ=class eN{constructor(t){C(this,"store",void 0),C(this,"onStatsException",void 0),C(this,"onUploadPublishDuration",void 0),C(this,"onStatsChanged",void 0),C(this,"localStats",new Map),C(this,"remoteStats",new Map),C(this,"updateStatsInterval",void 0),C(this,"trafficStats",void 0),C(this,"trafficStatsPeerList",[]),C(this,"uplinkStats",void 0),C(this,"exceptionMonitor",void 0),C(this,"p2pChannel",void 0),C(this,"scalabilityMode",LO.L1T1),C(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=t,this.exceptionMonitor=new vMe,this.exceptionMonitor.on("exception",(r,n,i)=>{this.onStatsException&&this.onStatsException(r,n,i)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(ne.LocalAudioTrack)||tu({},BO)}getLocalVideoTrackStats(){return this.localStats.get(ne.LocalVideoTrack)||tu({},$O)}getRemoteAudioTrackStats(t){let r=(o,s)=>{if(!this.trafficStats)return s;let a=this.trafficStats.peer_delay.find(c=>c.peer_uid===o);return a&&(s.publishDuration=a.B_ppad+(Date.now()-this.trafficStats.timestamp)),s},n={};if(t){var i;let o=(i=this.remoteStats.get(t))===null||i===void 0?void 0:i.audioStats;o&&(n[t]=r(t,o))}else Array.from(this.remoteStats.entries()).forEach(o=>{let[s,{audioStats:a}]=o;a&&(n[s]=r(s,a))});return n}getRemoteNetworkQualityStats(t){let r={};if(t){var n;let i=(n=this.remoteStats.get(t))===null||n===void 0?void 0:n.networkStats;i&&(r[t]=i)}else Array.from(this.remoteStats.entries()).forEach(i=>{let[o,{networkStats:s}]=i;s&&(r[o]=s)});return r}getRemoteVideoTrackStats(t){let r=(o,s)=>{if(!this.trafficStats)return s;let a=this.trafficStats.peer_delay.find(c=>c.peer_uid===o);return a&&(s.publishDuration=a.B_ppvd+(Date.now()-this.trafficStats.timestamp)),s},n={};if(t){var i;let o=(i=this.remoteStats.get(t))===null||i===void 0?void 0:i.videoStats;o&&(n[t]=r(t,o))}else Array.from(this.remoteStats.entries()).forEach(o=>{let[s,{videoStats:a}]=o;a&&(n[s]=r(s,a))});return n}getRTCStats(){let t=0,r=0,n=0,i=0,o=this.localStats.get(ne.LocalAudioTrack);o&&(t+=o.sendBytes,r+=o.sendBitrate);let s=this.localStats.get(ne.LocalVideoTrack);s&&(t+=s.sendBytes,r+=s.sendBitrate);let a=this.localStats.get(ne.LocalVideoLowTrack);a&&(t+=a.sendBytes,r+=a.sendBitrate),this.remoteStats.forEach(l=>{let{audioStats:d,videoStats:u}=l;d&&(n+=d.receiveBytes,i+=d.receiveBitrate),u&&(n+=u.receiveBytes,i+=u.receiveBitrate)});let c=1;return this.trafficStats&&(c+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:c,SendBitrate:r,SendBytes:t,RecvBytes:n,RecvBitrate:i,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(t){this.localStats.set(t,void 0)}removeLocalStats(t){t?this.localStats.delete(t):this.localStats.clear()}addRemoteStats(t){this.remoteStats.set(t,{})}removeRemoteStats(t){t?this.remoteStats.delete(t):this.remoteStats.clear()}addP2PChannel(t){this.p2pChannel=t}updateTrafficStats(t){t.peer_delay=t.peer_delay.filter(r=>r.B_ppad!==void 0||r.B_ppvd!==void 0),t.peer_delay.filter(r=>this.trafficStatsPeerList.indexOf(r.peer_uid)===-1).forEach(r=>{var n;let i=(n=this.p2pChannel)===null||n===void 0?void 0:n.getRemoteMedia(r.peer_uid),o=i!=null&&i.videoSSRC?$n.measureFromSubscribeStart(this.store.clientId,i.videoSSRC):0,s=i!=null&&i.audioSSRC?$n.measureFromSubscribeStart(this.store.clientId,i.audioSSRC):0;r.B_ppad!==void 0&&r.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(r.peer_uid,r.B_ppad,r.B_ppvd,o>s?o:s),this.trafficStatsPeerList.push(r.peer_uid))}),this.trafficStats=t}updateUplinkStats(t){this.uplinkStats&&this.uplinkStats.B_fir!==t.B_fir&&b.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(t.B_fir)),this.uplinkStats=t}static isRemoteVideoFreeze(t,r,n){if(!t)return!1;let i=!!n&&r.framesDecodeFreezeTime>n.framesDecodeFreezeTime,o=!n||r.framesDecodeCount>n.framesDecodeCount;return i||!o}static isRemoteAudioFreeze(t){return!!t&&t._isFreeze()}isLocalVideoFreeze(t){return!(!t.inputFrame||!t.sentFrame)&&t.inputFrame.frameRate>5&&t.sentFrame.frameRate<3}updateLocalStats(t){Array.from(this.localStats.entries()).forEach(r=>{let[n,i]=r;switch(n){case ne.LocalVideoTrack:case ne.LocalVideoLowTrack:{let s=i,a=tu({},$O),c=t.getStats(),l=t.getLocalMedia(n);if(c){let d=c.videoSend.find(u=>u.ssrc===(l==null?void 0:l.ssrcs[0].ssrcId));if(d){let u=t.getLocalVideoSize(),p=t.getEncoderConfig(ne.LocalVideoTrack);d.codec!=="H264"&&d.codec!=="H265"&&d.codec!=="VP8"&&d.codec!=="VP9"&&d.codec!=="AV1X"&&d.codec!=="AV1"||(a.codecType=d.codec),a.sendBytes=d.bytes,a.sendBitrate=s?8*Math.max(0,a.sendBytes-s.sendBytes):0,d.inputFrame?(a.captureFrameRate=d.inputFrame.frameRate,a.captureResolutionHeight=d.inputFrame.height,a.captureResolutionWidth=d.inputFrame.width):u&&(a.captureResolutionWidth=u.width,a.captureResolutionHeight=u.height),d.sentFrame?(a.sendFrameRate=d.sentFrame.frameRate,a.sendResolutionHeight=d.sentFrame.height,a.sendResolutionWidth=d.sentFrame.width):u&&(a.sendResolutionWidth=u.width,a.sendResolutionHeight=u.height),d.avgEncodeMs&&(a.encodeDelay=d.avgEncodeMs),p&&p.bitrateMax&&(a.targetSendBitrate=1e3*p.bitrateMax),a.sendPackets=d.packets,a.sendPacketsLost=d.packetsLost,a.sendJitterMs=d.jitterMs,a.sendRttMs=d.rttMs,a.totalDuration=s?s.totalDuration+1:1,a.totalFreezeTime=s?s.totalFreezeTime:0,this.isLocalVideoFreeze(d)&&(a.totalFreezeTime+=1),d.scalabilityMode&&this.scalabilityMode!==d.scalabilityMode&&(b.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(d.scalabilityMode)),this.scalabilityMode=d.scalabilityMode)}this.trafficStats&&(a.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var o;this.localStats.set(n,a),((s==null?void 0:s.sendResolutionWidth)!==a.sendResolutionWidth||(s==null?void 0:s.sendResolutionHeight)!==a.sendResolutionHeight)&&((o=this.onStatsChanged)===null||o===void 0||o.call(this,"resolution",{width:a.sendResolutionWidth,height:a.sendResolutionHeight})),a&&l&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,l.track,a);break}case ne.LocalAudioTrack:{let s=i,a=tu({},BO),c=t.getStats(),l=t.getLocalMedia(n);if(c){let d=c.audioSend.find(u=>u.ssrc===(l==null?void 0:l.ssrcs[0].ssrcId));if(d){if(d.codec!=="opus"&&d.codec!=="aac"&&d.codec!=="PCMU"&&d.codec!=="PCMA"&&d.codec!=="G722"||(a.codecType=d.codec),d.inputLevel)a.sendVolumeLevel=Math.round(32767*d.inputLevel);else{let u=t.getLocalAudioVolume();u&&(a.sendVolumeLevel=Math.round(32767*u))}a.sendBytes=d.bytes,a.sendPackets=d.packets,a.sendPacketsLost=d.packetsLost,a.sendJitterMs=d.jitterMs,a.sendRttMs=d.rttMs,a.sendBitrate=s?8*Math.max(0,a.sendBytes-s.sendBytes):0}}this.trafficStats&&(a.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(ne.LocalAudioTrack,a),a&&l&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,l.track,a);break}}})}updateRemoteStats(t){Array.from(this.remoteStats.entries()).forEach(r=>{var n,i;let[o,{videoStats:s,audioStats:a,videoPcStats:c}]=r,l=a,d=s,u=c,p=tu({},EQ),f=tu({},_Q),m=tu({},YLe),{audioTrack:g,videoTrack:y,audioSSRC:v,videoSSRC:E}=t.getRemoteMedia(o),w;w=t instanceof ro?t.getStats(!0):t.getStats();let S=(n=w)===null||n===void 0?void 0:n.audioRecv.find(L=>L.ssrc===v),A=(i=w)===null||i===void 0?void 0:i.videoRecv.find(L=>L.ssrc===E),N=this.trafficStats&&this.trafficStats.peer_delay.find(L=>L.peer_uid===o);if(S&&(S.codec!=="opus"&&S.codec!=="aac"&&S.codec!=="PCMU"&&S.codec!=="PCMA"&&S.codec!=="G722"||(p.codecType=S.codec),S.outputLevel?p.receiveLevel=Math.round(32767*S.outputLevel):g&&(p.receiveLevel=Math.round(32767*g.getVolumeLevel())),p.receiveBytes=S.bytes,p.receivePackets=S.packets,p.receivePacketsLost=S.packetsLost,p.receivePacketsDiscarded=S.packetsDiscarded,p.packetLossRate=p.receivePacketsLost/(p.receivePackets+p.receivePacketsLost),p.receiveBitrate=l?8*Math.max(0,p.receiveBytes-l.receiveBytes):0,p.totalDuration=l?l.totalDuration+1:1,p.totalFreezeTime=l?l.totalFreezeTime:0,p.freezeRate=p.totalFreezeTime/p.totalDuration,p.receiveDelay=S.jitterBufferMs,p.totalDuration>10&&eN.isRemoteAudioFreeze(g)&&(p.totalFreezeTime+=1)),A){A.codec!=="H264"&&A.codec!=="H265"&&A.codec!=="VP8"&&A.codec!=="VP9"&&A.codec!=="AV1X"&&A.codec!=="AV1"||(f.codecType=A.codec),f.receiveBytes=A.bytes,f.receiveBitrate=d?8*Math.max(0,f.receiveBytes-d.receiveBytes):0,f.decodeFrameRate=A.decodeFrameRate<0?0:A.decodeFrameRate,f.renderFrameRate=A.decodeFrameRate<0?0:A.decodeFrameRate,A.outputFrame&&(f.renderFrameRate=A.outputFrame.frameRate),A.receivedFrame?(f.receiveFrameRate=A.receivedFrame.frameRate,f.receiveResolutionHeight=A.receivedFrame.height,f.receiveResolutionWidth=A.receivedFrame.width):y&&(f.receiveResolutionHeight=y._videoHeight||0,f.receiveResolutionWidth=y._videoWidth||0),A.framesRateFirefox!==void 0&&(f.receiveFrameRate=Math.round(A.framesRateFirefox)),f.receivePackets=A.packets,f.receivePacketsLost=A.packetsLost,f.packetLossRate=f.receivePacketsLost/(f.receivePackets+f.receivePacketsLost),f.totalDuration=d?d.totalDuration+1:1,f.totalFreezeTime=d?d.totalFreezeTime:0,f.receiveDelay=A.jitterBufferMs||0;let L=!!E&&t.getRemoteVideoIsReady(E);y&&L&&eN.isRemoteVideoFreeze(y,A,u)&&(f.totalFreezeTime+=1),f.freezeRate=f.totalFreezeTime/f.totalDuration}N&&(p.end2EndDelay=N.B_ad,f.end2EndDelay=N.B_vd,p.transportDelay=N.B_ed,f.transportDelay=N.B_ed,p.currentPacketLossRate=N.B_ealr4/100,f.currentPacketLossRate=N.B_evlr4/100,m.uplinkNetworkQuality=N.B_punq?N.B_punq:0,m.downlinkNetworkQuality=N.B_pdnq?N.B_pdnq:0),this.remoteStats.set(o,{audioStats:p,videoStats:f,videoPcStats:A,networkStats:m}),g&&this.exceptionMonitor.setRemoteAudioStats(g,p),y&&this.exceptionMonitor.setRemoteVideoStats(y,f)})}},uZ=class{constructor(){C(this,"destChannelMediaInfos",new Map),C(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(e){Q3(e),this.srcChannelMediaInfo=e}addDestChannelInfo(e){Q3(e),this.destChannelMediaInfos.set(e.channelName,e)}removeDestChannelInfo(e){rT(e),this.destChannelMediaInfos.delete(e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}};function JB(e){if(!(e instanceof uZ))return new G(I.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();let t=e.getSrcChannelMediaInfo(),r=e.getDestChannelMediaInfo();if(!t)return new G(I.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(r.size===0)return new G(I.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}function QB(e){var t={},r=!1;function n(i,o){return r=!0,{done:!1,value:new JD(o=new XO(function(s){s(e[i](o))}),1)}}return t[Ip!==void 0&&vJ||"@@iterator"]=function(){return this},t.next=function(i){return r?(r=!1,i):n("next",i)},typeof e.throw=="function"&&(t.throw=function(i){if(r)throw r=!1,i;return n("throw",i)}),typeof e.return=="function"&&(t.return=function(i){return r?(r=!1,i):n("return",i)}),t}var jMe=xr(rZ);function ZB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function e6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZB(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Ht;function t6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t6(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var qm=(Ht=class pg extends aQ{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var r;return pe(r=Object.keys(tT)).call(r,t)}))]}constructor(t,r){super(t,r),C(this,"store",void 0),C(this,"peerConnection",void 0),C(this,"remoteSDP",void 0),C(this,"initialOffer",void 0),C(this,"statsFilter",void 0),C(this,"useRTX",!1),C(this,"localCapabilities",void 0),C(this,"localCandidateCount",0),C(this,"allCandidatesReceived",!1),C(this,"establishPromise",void 0),C(this,"mutex",new Gn("P2PConnection-mutex")),this.store=r,this.peerConnection=new RTCPeerConnection(pg.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=ZD(this.peerConnection,D("STATS_UPDATE_INTERVAL"),void 0,_r()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{let t=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");let r=sd(t.sdp),n=$0(t.sdp,{filterRTX:!this.useRTX,filterVideoFec:D("FILTER_VIDEO_FEC"),filterAudioFec:D("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=n,this.initialOffer=t,vE(vE({},r),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:n},offerSDP:t.sdp})}catch(t){throw new X(I.GET_LOCAL_CONNECTION_PARAMS_FAILED,t.toString())}}async updateRemoteConnect(){}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(n){C(this,"sessionDesc",void 0),C(this,"localCapabilities",void 0),C(this,"rtpCapabilities",void 0),C(this,"candidates",void 0),C(this,"iceParameters",void 0),C(this,"dtlsParameters",void 0),C(this,"setup",void 0),C(this,"currentMidIndex",void 0),C(this,"cname",void 0),n=kr(n);let{iceParameters:i,dtlsParameters:o,candidates:s,rtpCapabilities:a,setup:c,localCapabilities:l,sdkCodec:d,cname:u}=n,p=wn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=a,this.candidates=s,this.iceParameters=i,this.dtlsParameters=o,this.setup=c,this.localCapabilities=l,this.cname=u;for(let f=0;f<p.mediaDescriptions.length;f++){let m=p.mediaDescriptions[f];if(m.attributes.iceUfrag=i.iceUfrag,m.attributes.icePwd=i.icePwd,m.attributes.fingerprints=o.fingerprints,m.attributes.candidates=s,m.attributes.setup=c,m.media.mediaType==="video"){m.media.fmts=a.videoCodecs.map(y=>y.payloadType.toString(10));let g=a.videoCodecs.filter(y=>{var v,E;return(v=y.rtpMap)===null||v===void 0?void 0:pe(E=v.encodingName.toLowerCase()).call(E,d)});g.length===0&&(g=a.videoCodecs),m.attributes.payloads=g,m.attributes.extmaps=a.videoExtensions}m.media.mediaType==="audio"&&(m.media.fmts=a.audioCodecs.map(g=>g.payloadType.toString(10)),m.attributes.payloads=a.audioCodecs,m.attributes.extmaps=a.audioExtensions),p.mediaDescriptions[f]=this.mungMediaDesc(m)}this.sessionDesc=p,this.currentMidIndex=p.mediaDescriptions.length-1}toString(){return wn.print(this.sessionDesc)}send(n,i,o){let{ssrcs:s,ssrcGroups:a}=fu(i,this.cname),c=this.sessionDesc.mediaDescriptions.find(u=>n===we.VIDEO?u.media.mediaType==="video":u.media.mediaType==="audio"),l=s[0].attributes.label,d=s[0].attributes.mslabel;return c.attributes.ssrcs=c.attributes.ssrcs.concat(s),c.attributes.ssrcGroups=c.attributes.ssrcGroups.concat(a),{id:l,mslabel:d}}batchSend(n){return n.map(i=>{let{kind:o,ssrcMsg:s}=i;return this.send(o,s,void 0)})}stopSending(n){this.sessionDesc.mediaDescriptions.forEach(i=>{let o=[],s=[],a=[];i.attributes.ssrcs.forEach(c=>{pe(n).call(n,c.attributes.label||"")?a.push(c):o.push(c)}),i.attributes.ssrcGroups.forEach(c=>{var l;pe(l=a.map(d=>d.ssrcId)).call(l,c.ssrcIds[0])||s.push(c)}),i.attributes.ssrcs=o,i.attributes.ssrcGroups=s})}mute(n){let i=this.sessionDesc.mediaDescriptions.find(o=>o.attributes.mid===n);if(!i)throw new Error("mediaDescription not found with ".concat(n," in remote SDP when calling RemoteSDP.mute."));i.attributes.direction="inactive"}unmute(n){let i=this.sessionDesc.mediaDescriptions.find(o=>o.attributes.mid===n);if(!i)throw new Error("mediaDescription not found with ".concat(n," in remote SDP when calling RemoteSDP.unmute."));i.attributes.direction="sendonly"}receive(n,i,o){n.forEach((s,a)=>{let c=s._mediaStreamTrack,l=this.sessionDesc.mediaDescriptions.findIndex(u=>u.attributes.mid===c.kind),d=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[l],s);this.sessionDesc.mediaDescriptions[l]=d})}stopReceiving(n){}updateCandidates(n){n===so.TCP?this.candidates.forEach(i=>{this.candidates.findIndex(o=>o.transport==="tcp"&&o.connectionAddress===i.connectionAddress&&o.port===i.port)===-1&&this.candidates.push(e6(e6({},i),{},{foundation:"tcpcandidate",priority:Number(i.priority)-1+"",transport:"tcp",port:Number(i.port)+90+""}))}):this.candidates=this.candidates.filter(i=>i.transport!=="tcp");for(let i of this.sessionDesc.mediaDescriptions)i.attributes.candidates=this.candidates}restartICE(n){n=kr(n),this.iceParameters=n,this.sessionDesc.mediaDescriptions.forEach(i=>{i.attributes.iceUfrag=n.iceUfrag,i.attributes.icePwd=n.icePwd})}predictReceivingMids(n){let i=[];for(let o=0;o<n;o++)i.push((this.currentMidIndex+o+1).toString(10));return i}mungRecvMediaDsec(n,i){let o=kr(n);return Of(o,i),zD(o,i),o}updateRecvMedia(n,i){let o=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===n);if(o!==-1){let s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[o],i);this.sessionDesc.mediaDescriptions[o]=s}}bumpMid(n){this.currentMidIndex+=n}updateTrackLabel(n,i,o){let s=this.sessionDesc.mediaDescriptions.find(c=>n===we.VIDEO?c.attributes.mid==="video":c.attributes.mid==="audio");if(s){let c=s.attributes.ssrcs.find(l=>l.attributes.label===i);var a;c&&(c.attributes.label=o,(a=c.attributes.msid)===null||a===void 0||a.replace(i,o))}}mungMediaDesc(n){let i=kr(n);return GD(i),function(o){let s=o.attributes.extmaps.find(a=>a.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");s&&o.attributes.extmaps.splice(o.attributes.extmaps.indexOf(s),1),o.attributes.payloads.forEach(a=>{let c=a.rtcpFeedbacks.findIndex(l=>l.type==="transport-cc");c!==-1&&a.rtcpFeedbacks.splice(c,1)})}(i),i}getSSRC(n){for(let i of this.sessionDesc.mediaDescriptions)for(let o of i.attributes.ssrcs)if(o.attributes.label===n)return[o]}}(vE(vE({},t),{},{rtpCapabilities:t.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));let r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async updateRemoteRTPCapabilities(t,r){throw new X(I.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(t){}send(t,r){var n=this;return Ia(function*(){let i=yield wt(n.mutex.lock());try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");let o=t.map(p=>n.peerConnection.addTrack(p._mediaStreamTrack)),s=yield wt(n.peerConnection.createOffer()),a=wn.parse(s.sdp),c=t.map(p=>{let f=p._mediaStreamTrack,m=a.mediaDescriptions.find(g=>g.attributes.mid===f.kind);if(!m)throw new Error("Cannot extract ssrc from mediaDescription.");return function(g,y,v){let E=g.attributes.ssrcs.filter(S=>S.attributes.label===y),w=g.attributes.ssrcGroups;if(E.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(w&&E.length>1){let S=w.find(A=>A.ssrcIds.indexOf(E[0].ssrcId)!==-1);return S?[{ssrcId:S.ssrcIds[0],rtx:v?S.ssrcIds[1]:void 0}]:[{ssrcId:E[0].ssrcId}]}return[{ssrcId:E[0].ssrcId}]}(m,f.id,n.useRTX)}),l;try{l=yield c}catch(p){throw o.forEach(f=>{Pn()&&f.replaceTrack(null),n.peerConnection.removeTrack(f)}),p}let d=n.mungSendOfferSDP(s.sdp,t);n.remoteSDP.receive(t,r,l);let u=n.remoteSDP.toString();return yield wt(n.peerConnection.setLocalDescription({type:"offer",sdp:d})),yield wt(n.applySendEncodings(o,t)),yield wt(n.peerConnection.setRemoteDescription({type:"answer",sdp:u})),t.map((p,f)=>{let m=p._mediaStreamTrack.id;return{localSSRC:c[f],id:m}})}catch(o){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(o.toString()))}finally{i()}})()}async stopSending(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");let r=this.peerConnection.getSenders().filter(o=>{var s;return t.indexOf(((s=o.track)===null||s===void 0?void 0:s.id)||"")!==-1});if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");r.map(o=>{Pn()&&o.replaceTrack(null),this.peerConnection.removeTrack(o)});let n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(t);let i=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(r.toString()))}}async receive(t,r,n,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));let{id:o,mslabel:s}=this.remoteSDP.send(t,r,i),a=new de((d,u)=>{let p=setTimeout(()=>{u(new Error("Cannot receive track, id: ".concat(o)))},1e4),f=m=>{let g=yt();if((g.name==="Safari"&&Number(g.version)===11||Ei())&&m.track.id!==o&&m.streams[0].id===s){var y;let v=m.streams[0].getTracks()[0];return(y=this.remoteSDP)===null||y===void 0||y.updateTrackLabel(t,o,m.track.id),this.peerConnection.removeEventListener("track",f),clearTimeout(p),void d(v)}if(m.track.id===o)return this.peerConnection.removeEventListener("track",f),clearTimeout(p),void d(m.track)};this.peerConnection.addEventListener("track",f)}),c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:c});let l=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(l),{track:await a,id:o}}catch(o){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(o.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);let r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});let n=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(n)}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){}async unmuteRemote(t){}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");let r=this.peerConnection.getSenders().filter(n=>{var i;return t.indexOf(((i=n.track)===null||i===void 0?void 0:i.id)||"")!==-1});if(r.length!==t.length)throw new Error("sender' length doesn't match mids' length.");r.map(n=>{if(Pn()&&n.track)n.track.enabled=!1;else{let i=n.getParameters();i.encodings.forEach(o=>o.active=!1),n.setParameters(i)}})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");let r=this.peerConnection.getSenders().filter(o=>{var s;return t.indexOf(((s=o.track)===null||s===void 0?void 0:s.id)||"")!==-1});if(r.length!==t.length)throw new Error("Senders' length doesn't match mids' length.");r.map(async o=>{if(Pn()&&o.track)o.track.enabled=!0;else{let s=o.getParameters();s.encodings.forEach(a=>a.active=!0),await o.setParameters(s)}});let n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n);let i=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return Ia(function*(){let n=yield wt(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Et().supportPCSetConfiguration){let c=r.peerConnection.getConfiguration(),l=t===so.RELAY?"relay":"all";c.iceTransportPolicy!==l&&(b.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(c.iceTransportPolicy,"] to [").concat(l,"]")),c.iceTransportPolicy=l,r.peerConnection.setConfiguration(c))}else if(t===so.RELAY)return;t!==so.RELAY&&r.remoteSDP.updateCandidates(t);let i=yield wt(r.peerConnection.createOffer({iceRestart:!0}));if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");let o=sd(i.sdp),{remoteIceParameters:s}=yield o.iceParameters;r.remoteSDP.restartICE(s);let a=r.remoteSDP.toString();yield wt(r.peerConnection.setLocalDescription(i)),yield wt(r.peerConnection.setRemoteDescription({type:"answer",sdp:a}))}catch(i){b.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),i)}finally{n()}})()}close(){var t;this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");let n=await this.peerConnection.createOffer(),i=this.mungSendOfferSDP(n.sdp,[r]);this.remoteSDP.updateRecvMedia(r._mediaStreamTrack.kind,r);let o=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:i}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(n){throw new X(I.EXCHANGE_SDP_FAILED,n.toString())}}async updateSendParameters(t,r){let n=this.peerConnection.getSenders().filter(i=>{var o;return((o=i.track)===null||o===void 0?void 0:o.id)===t});n.length===1&&await this.applySendEncodings(n,[r])}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){let n=this.peerConnection.getSenders().find(i=>{var o;return((o=i.track)===null||o===void 0?void 0:o.id)===r});n&&await n.replaceTrack(t._mediaStreamTrack)}createDataChannels(t,r){throw new X(I.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(t){throw new X(I.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,b.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,b.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},D("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){let r={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(QS(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...pg.turnServerConfigToIceServers(t.turnServer.servers)),D("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...pg.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(n=>{n.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(t){let r=[];return t.forEach(n=>{n.security?n.tcpport&&r.push({username:n.username,credential:n.password,credentialType:"password",urls:"turns:".concat(n.turnServerURL,":").concat(n.tcpport,"?transport=tcp")}):(n.udpport&&r.push({username:n.username,credential:n.password,credentialType:"password",urls:"turn:".concat(n.turnServerURL,":").concat(n.udpport,"?transport=udp")}),n.tcpport&&r.push({username:n.username,credential:n.password,credentialType:"password",urls:"turn:".concat(n.turnServerURL,":").concat(n.tcpport,"?transport=tcp")}))}),r}async updateRtpSenderEncodings(t,r){var n;if(r||(r=this.peerConnection.getSenders().find(l=>{var d;return((d=l.track)===null||d===void 0?void 0:d.id)===t._mediaStreamTrack.id})),!r)return b.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(!Et().supportSetRtpSenderParameters)return b.warn("Browser not support set rtp-sender parameters");let i={},o={};if(t instanceof Qt)switch(t._optimizationMode){case"motion":i.degradationPreference="maintain-framerate";break;case"detail":i.degradationPreference="maintain-resolution";break;default:i.degradationPreference="balanced"}if(D("DSCP_TYPE")&&Od()){var s;let l=D("DSCP_TYPE");pe(s=["very-low","low","medium","high"]).call(s,l)&&(o.networkPriority=l)}let a=r.getParameters(),c=(n=a.encodings)===null||n===void 0?void 0:n[0];c&&Object.assign(c,o),Object.assign(a,i),b.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(a.encodings))),await r.setParameters(a)}async applySendEncodings(t,r){try{if(!Et().supportSetRtpSenderParameters||t.length!==r.length)return;for(let n=0;n<t.length;n++){let i=t[n],o=r[n];i&&o&&await this.updateRtpSenderEncodings(o,i)}}catch{b.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r){let n=wn.parse(t);return r.forEach((i,o)=>{let s=i._mediaStreamTrack,a=n.mediaDescriptions.find(c=>c.attributes.mid===s.kind);a&&Of(a,i)}),wn.print(n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,n)=>{var i;(i=this.onFirstVideoDecoded)===null||i===void 0||i.call(this,t,r,n)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var n;(n=this.onSelectedLocalCandidateChanged)===null||n===void 0||n.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var n;(n=this.onSelectedRemoteCandidateChanged)===null||n===void 0||n.call(this,t,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");let r=this.remoteSDP.batchSend(t).map((o,s)=>{let{id:a,mslabel:c}=o,{kind:l}=t[s];return new de((d,u)=>{let p=setTimeout(()=>{u(new Error("Cannot receive track, id: ".concat(a)))},1e4),f=m=>{let g=yt();if(g.name==="Safari"&&Number(g.version)===11&&m.track.id!==a&&m.streams[0].id===c){var y;let v=m.streams[0].getTracks()[0];return(y=this.remoteSDP)===null||y===void 0||y.updateTrackLabel(l,a,m.track.id),this.peerConnection.removeEventListener("track",f),clearTimeout(p),void d({track:v,id:a})}if(m.track.id===a)return this.peerConnection.removeEventListener("track",f),clearTimeout(p),void d({track:m.track,id:a})};this.peerConnection.addEventListener("track",f)})}),n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});let i=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(i),await de.all(r)}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async getRemoteSSRC(t){if(!this.remoteSDP)return;let r=this.remoteSDP.getSSRC(t);return r==null?void 0:r[0].ssrcId}setConfiguration(t){if(Et().supportPCSetConfiguration){let r=pg.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}},ve(Ht.prototype,"connect",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"connect"),Ht.prototype),ve(Ht.prototype,"stopSending",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"stopSending"),Ht.prototype),ve(Ht.prototype,"receive",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"receive"),Ht.prototype),ve(Ht.prototype,"stopReceiving",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"stopReceiving"),Ht.prototype),ve(Ht.prototype,"muteRemote",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"muteRemote"),Ht.prototype),ve(Ht.prototype,"unmuteRemote",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"unmuteRemote"),Ht.prototype),ve(Ht.prototype,"muteLocal",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"muteLocal"),Ht.prototype),ve(Ht.prototype,"unmuteLocal",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"unmuteLocal"),Ht.prototype),ve(Ht.prototype,"close",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"close"),Ht.prototype),ve(Ht.prototype,"updateEncoderConfig",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"updateEncoderConfig"),Ht.prototype),ve(Ht.prototype,"updateSendParameters",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"updateSendParameters"),Ht.prototype),ve(Ht.prototype,"replaceTrack",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"replaceTrack"),Ht.prototype),ve(Ht.prototype,"getRemoteSSRC",[Ko],Object.getOwnPropertyDescriptor(Ht.prototype,"getRemoteSSRC"),Ht.prototype),Ht);function Ko(e,t,r){let n=e[t];if(typeof n!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){let i=this.mutex,o=await i.lock("Locking from P2PConnection.".concat(t));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return await n.apply(this,a)}finally{o()}},r}function r6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Dl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r6(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Ym="9",n6=4e4,UMe=class{get localCapabilities(){return kr(this._localCapabilities)}get rtpCapabilities(){return kr(this._rtpCapabilities)}get candidates(){return kr(this._candidates)}get iceParameters(){return kr(this._iceParameters)}get dtlsParameters(){return kr(this._dtlsParameters)}constructor(e){C(this,"sessionDesc",void 0),C(this,"_localCapabilities",void 0),C(this,"_rtpCapabilities",void 0),C(this,"_candidates",void 0),C(this,"_iceParameters",void 0),C(this,"_dtlsParameters",void 0),C(this,"setup",void 0),C(this,"currentMidIndex",void 0),C(this,"cname",void 0),C(this,"firefoxSsrcMidMap",new Map),e=kr(e);let{iceParameters:t,dtlsParameters:r,candidates:n,rtpCapabilities:i,setup:o,localCapabilities:s,cname:a}=e;this._rtpCapabilities=i,this._candidates=n,this._iceParameters=t,this._dtlsParameters=r,this._localCapabilities=s,this.setup=o,this.cname=a,this.sessionDesc=this.updateRemoteRTPCapabilities(i),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(e){let t=this.candidates,r=this.dtlsParameters,n=this.iceParameters,i=this.rtpCapabilities.send,o=this.sessionDesc.mediaDescriptions.length-1;for(let s=1;s<e;s++){let a=2*s+2e4,c=2*s+n6,{ssrcs:l,ssrcGroups:d}=fu([{ssrcId:a}],this.cname),{ssrcs:u,ssrcGroups:p}=fu([{ssrcId:c,rtx:D("USE_SUB_RTX")?c+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:Ym,protos:["UDP","TLS","RTP","SAVPF"],fmts:i.videoCodecs.map(f=>f.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:n.iceUfrag,icePwd:n.icePwd,unrecognized:[],candidates:t,extmaps:i.videoExtensions,fingerprints:r.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:u,ssrcGroups:p,rtcpFeedbackWildcards:[],payloads:i.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++o)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:Ym,protos:["UDP","TLS","RTP","SAVPF"],fmts:i.audioCodecs.map(f=>f.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:n.iceUfrag,icePwd:n.icePwd,unrecognized:[],candidates:t,extmaps:i.audioExtensions,fingerprints:r.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:l,ssrcGroups:d,rtcpFeedbackWildcards:[],payloads:i.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++o)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return wn.print(this.sessionDesc)}send(e,t,r,n){let{ssrcs:i,ssrcGroups:o}=fu(t,this.cname,D("SYNC_GROUP")?r:void 0),s=this.findPreloadMediaDesc(i);if(s){if(_r()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,s.attributes.mid),n&&(n.twcc||n.remb)){let a=this.sessionDesc.mediaDescriptions.indexOf(s);return this.sessionDesc.mediaDescriptions[a]=this.mungSendMediaDesc(s,n),{mid:s.attributes.mid,needExchangeSDP:!0}}return{mid:s.attributes.mid,needExchangeSDP:!1}}{let a=this.findAvailableMediaIndex(e,i),c;return a===-1||a===1&&(Pn()||function(){let l=yt();return!(l.name!==Nt.CHROME||!l.osVersion)&&Number(l.version)<=90}())||a===0&&D("USE_SUB_RTX")||x3()?(c=this.createOrRecycleSendMedia(e,i,o,"sendonly",n),this.updateBundleMids()):(c=kr(this.sessionDesc.mediaDescriptions[a]),c.attributes.direction="sendonly",c.attributes.ssrcs=i,c.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[a]=this.mungSendMediaDesc(c,n)),_r()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,c.attributes.mid),{mid:c.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){let{mediaDesc:e,needExchangeSDP:t}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:e.attributes.mid,needExchangeSDP:t}}batchSend(e){let t=e.map(i=>{let{kind:o,ssrcMsg:s,mslabel:a}=i;return this.send(o,s,a)}),r=[],n=!1;return t.forEach(i=>{let{mid:o,needExchangeSDP:s}=i;s&&(n=!0),r.push(o)}),{mids:r,needExchangeSDP:n}}stopSending(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>r.attributes.mid&&e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(r=>{r.attributes.mid==="0"||_r()||x3()?r.attributes.ssrcs=[]:(r.attributes.ssrcs=[],r.attributes.direction="inactive",r.media.port="0")}),this.updateBundleMids()}mute(e){let t=this.sessionDesc.mediaDescriptions.find(r=>r.attributes.mid===e);if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){let t=this.sessionDesc.mediaDescriptions.find(r=>r.attributes.mid===e);if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}muteRemote(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>pe(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="inactive"})}unmuteRemote(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>pe(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="recvonly"})}receive(e,t,r,n){e.forEach((i,o)=>{this.createOrRecycleRecvMedia(i,[],"recvonly",t,r,n[o])}),this.updateBundleMids()}stopReceiving(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(r=>{r.media.port="0",r.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(e){let t=this.sessionDesc||wn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=e;let r=this.rtpCapabilities.send,n=this.localCapabilities.send;for(let i of t.mediaDescriptions){if(i.attributes.iceUfrag=this._iceParameters.iceUfrag,i.attributes.icePwd=this._iceParameters.icePwd,i.attributes.fingerprints=this._dtlsParameters.fingerprints,i.attributes.candidates=this._candidates,i.attributes.setup=this.setup,i.media.mediaType==="application"&&(i.attributes.sctpPort="5000"),i.media.mediaType==="video"){if(r.videoCodecs.length===0){let o=n.videoCodecs.filter(s=>{var a,c;return(a=s.rtpMap)===null||a===void 0?void 0:pe(c=a.encodingName.toLowerCase()).call(c,"vp8")})||[n.videoCodecs[0]];i.media.fmts=o.map(s=>s.payloadType.toString(10)),i.attributes.payloads=o,i.attributes.extmaps=[]}else if(i.media.fmts=r.videoCodecs.map(o=>o.payloadType.toString(10)),i.attributes.payloads=r.videoCodecs,i.attributes.extmaps=r.videoExtensions,D("PRELOAD_MEDIA_COUNT")>0){let{ssrcs:o,ssrcGroups:s}=fu([{ssrcId:n6,rtx:D("USE_SUB_RTX")?40001:void 0}],this.cname);i.attributes.ssrcs=o,i.attributes.ssrcGroups=s}}if(i.media.mediaType==="audio"){if(r.audioCodecs.length===0){let o=n.audioCodecs.filter(s=>{var a,c;return(a=s.rtpMap)===null||a===void 0?void 0:pe(c=a.encodingName.toLowerCase()).call(c,"opus")})||[n.audioCodecs[0]];i.media.fmts=o.map(s=>s.payloadType.toString(10)),i.attributes.payloads=o,i.attributes.extmaps=[]}else if(i.media.fmts=r.audioCodecs.map(o=>o.payloadType.toString(10)),i.attributes.payloads=r.audioCodecs,i.attributes.extmaps=r.audioExtensions,Nf(i),D("PRELOAD_MEDIA_COUNT")>0){let{ssrcs:o,ssrcGroups:s}=fu([{ssrcId:2e4}],this.cname);i.attributes.ssrcs=o,i.attributes.ssrcGroups=s}}}return this.sessionDesc=t,this.currentMidIndex=t.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(e){let t=this._candidates.filter(r=>r.transport==="udp");if(e===so.TCP){if(t.length===0)return;if(D("TCP_CANDIDATE_ONLY")){let r=this._candidates.filter(n=>n.transport==="tcp");t.forEach(n=>{r.findIndex(i=>i.connectionAddress===n.connectionAddress)===-1&&r.push(Dl(Dl({},n),{},{foundation:"tcpcandidate",priority:Number(n.priority)-1+"",transport:"tcp",port:Number(n.port)+90+""}))}),this._candidates=r}else{let r=[];t.forEach(n=>{r.push(Dl(Dl({},n),{},{foundation:"tcpcandidate",priority:Number(n.priority)-1+"",transport:"tcp",port:Number(n.port)+90+""}))}),this._candidates=[...t,...r]}}else if(e===so.RELAY){if(t.length!==0)return;{let r=this._candidates.filter(n=>n.transport==="tcp");r.forEach(n=>{t.push(Dl(Dl({},n),{},{foundation:"udpcandidate",priority:Number(n.priority)+1+"",transport:"udp",port:Number(n.port)-90+""}))}),this._candidates=[...t,...r]}}else t.length===0?(this._candidates.filter(r=>r.transport==="tcp").forEach(r=>{t.push(Dl(Dl({},r),{},{foundation:"udpcandidate",priority:Number(r.priority)+1+"",transport:"udp",port:Number(r.port)-90+""}))}),this._candidates=t):this._candidates=this._candidates.filter(r=>r.transport!=="tcp");for(let r of this.sessionDesc.mediaDescriptions)r.attributes.candidates=this.candidates}restartICE(e){e=kr(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}predictReceivingMids(e){let t=[];for(let r=0;r<e;r++)t.push((this.currentMidIndex+r+1).toString(10));return t}findAvailableMediaIndex(e,t){return this.sessionDesc.mediaDescriptions.findIndex(r=>{let n=r.media.mediaType===e&&r.media.port!=="0"&&(r.attributes.direction==="sendonly"||r.attributes.direction==="sendrecv")&&r.attributes.ssrcs.length===0;if(_r()){if(n){let i=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(i||r.attributes.mid!=="0"&&r.attributes.mid!=="1")||!(!i||i!==r.attributes.mid)}return!1}return n})}createOrRecycleDataChannel(){for(let r of this.sessionDesc.mediaDescriptions)if(r.media.mediaType==="application")return{mediaDesc:r,needExchangeSDP:!1};this.currentMidIndex+=1;let e="".concat(this.currentMidIndex),t={media:{mediaType:"application",port:Ym,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(e),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(t),{mediaDesc:t,needExchangeSDP:!0}}createOrRecycleRecvMedia(e,t,r,n,i,o){let s=e._mediaStreamTrack.kind,a=this.rtpCapabilities.recv,c=Vg(s,a,this.localCapabilities.send,s===we.VIDEO?n:i),l=s===we.VIDEO?a.videoExtensions:a.audioExtensions;this.currentMidIndex+=1;let d="".concat(this.currentMidIndex),u={media:{mediaType:s,port:Ym,protos:["UDP","TLS","RTP","SAVPF"],fmts:c.map(f=>f.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:l,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(d)}};u=this.mungRecvMediaDsec(u,e,o);let p=this.findFirstClosedMedia(s);if(p){let f=this.sessionDesc.mediaDescriptions.indexOf(p);this.sessionDesc.mediaDescriptions[f]=u}else this.sessionDesc.mediaDescriptions.push(u);return u}updateRemoteCodec(e,t,r){let n=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(u=>u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").filter(u=>{var p;return pe(p=Object.keys(tT)).call(p,u)}))],i=new Set(t);if(n.every(u=>i.has(u)))return b.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(t)),!1;let o=this._rtpCapabilities.recv.videoCodecs.filter(u=>t.some(p=>{var f;return pe(f=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(f,p)}));if(o.length===0)return b.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(n," codecs: ").concat(t)),!1;let s=[...new Set(o.map(u=>u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||""))],a;if(b.debug("updateRemoteCodec, from ".concat(n," to ").concat(s)),e.length===0)a=this.sessionDesc.mediaDescriptions.filter(u=>u.media.mediaType==="video"&&u.attributes.direction==="recvonly");else if(a=this.sessionDesc.mediaDescriptions.filter(u=>u.attributes.mid&&pe(e).call(e,u.attributes.mid)&&u.attributes.direction==="recvonly"),a.length!==e.length)return b.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(e,", codecs: ").concat(t)),!1;if(D("USE_PUB_RTX")||D("USE_SUB_RTX")){let u=KD(o,this.rtpCapabilities.recv.videoCodecs);o.push(...u)}this._rtpCapabilities.recv.videoCodecs=o;let c=this.localCapabilities.send,l=this.rtpCapabilities.recv,d=Vg(we.VIDEO,l,c,r);return a.forEach(u=>{let p=d.map(f=>f.payloadType.toString(10));b.debug("updateRemoteCodec mid: ".concat(u.attributes.mid,", from ").concat(u.attributes.payloads," to ").concat(d)),u.attributes.payloads=d,u.media.fmts=p}),!0}createOrRecycleSendMedia(e,t,r,n,i){let o=this.rtpCapabilities.send,s=e===we.VIDEO?o.videoCodecs:o.audioCodecs,a=e===we.VIDEO?o.videoExtensions:o.audioExtensions;this.currentMidIndex+=1;let c="".concat(this.currentMidIndex),l={media:{mediaType:e,port:Ym,protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map(u=>u.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:a,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:r,rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(c)}};l=this.mungSendMediaDesc(l,i);let d=this.findFirstClosedMedia(e);if(d){let u=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[u]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}mungRecvMediaDsec(e,t,r){let n=kr(e);return GD(n),Of(n,t),zD(n,t),KQ(n),nw(n,r,this.localCapabilities.send),n}mungSendMediaDesc(e,t){let r=kr(e);return nw(r,t,this.localCapabilities.recv),Nf(r),r}updateRecvMedia(e,t){let r=this.sessionDesc.mediaDescriptions.findIndex(n=>n.attributes.mid===e);if(r!==-1){let n=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],t);this.sessionDesc.mediaDescriptions[r]=n}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(t=>_r()?t.media.port==="0"&&t.media.mediaType===e:t.media.port==="0")}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(t=>{var r;return((r=t.attributes)===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId)===e[0].ssrcId})}getSSRC(e){var t;return(t=this.sessionDesc.mediaDescriptions.find(r=>r.attributes.mid===e))===null||t===void 0?void 0:t.attributes.ssrcs}};function i6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i6(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Bg=function(e){return e.BANDWIDTH="bandwidth",e.CPU="cpu",e.NONE="none",e.OTHER="other",e}({}),Zp=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e}(Zp||{}),ow=new Map;function o6(e,t,r,n){let{scale:i}=e;if(i===0&&n===Zp.UP||i>=t.length-1&&n===Zp.DOWN)return e;let o=Vc(Vc({},e),{},{scale:n===Zp.DOWN?++i:--i});switch(r){case"maintain-framerate":o=Vc(Vc({},o),t[i].motion);break;case"maintain-resolution":o=Vc(Vc({},o),t[i].detail);break;case"balanced":o=Vc(Vc({},o),t[i].balanced)}return o}function hZ(e,t){if(t){let r={overUse:0,underUse:0,adaptationList:pZ(t)};ow.set(e,r)}else ow.delete(e)}function pZ(e){let t=Vc({},e),{bitrateMax:r,frameRate:n,scaleResolutionDownBy:i,bitrateMin:o}=t,{MIN_FRAME_RATE:s,MAX_THRESHOLD_FRAMERATE:a,MAX_SCALE:c,BITRATE_MIN_THRESHOLD:l,BITRATE_MAX_THRESHOLD:d,BWE_SCALE_UP_THRESHOLD:u,BWE_SCALE_DOWN_THRESHOLD:p,PERF_SCALE_DOWN_THRESHOLD:f,PERF_SCALE_UP_THRESHOLD:m,BALANCE_BITRATE_FACTOR:g,BALANCE_FRAMERATE_FACTOR:y,BALANCE_RESOLUTION_FACTOR:v,MOTION_RESOLUTION_FACTOR:E,MOTION_BITRATE_FACTOR:w,DETAIL_FRAMERATE_FACTOR:S,DETAIL_BITRATE_FACTOR:A}=PD,N=Math.min(t.frameRate,a),L=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(p,1)*r),bwe_up:r,fps_down:Math.round(Math.pow(f,1)*N),fps_up:n},balanced:{scaleResolutionDownBy:1,frameRate:n,bitrateMax:r,bitrateMin:o},motion:{scaleResolutionDownBy:1,frameRate:n,bitrateMax:r,bitrateMin:o},detail:{scaleResolutionDownBy:1,frameRate:n,bitrateMax:r,bitrateMin:o}}];for(let j=1;j<=c;j++){let W={bwe_up:Math.round(Math.pow(u,j)*r),bwe_down:Math.round(Math.pow(p,j+1)*r),fps_up:Math.round(Math.pow(m,j)*N),fps_down:Math.round(Math.pow(f,j+1)*N)},V={scaleResolutionDownBy:i/Math.pow(v,j),frameRate:Math.max(Math.round(Math.pow(y,j)*n),s),bitrateMax:Math.max(Math.round(Math.pow(g,j)*r),d),bitrateMin:Math.max(Math.round(Math.pow(g,j)*o),l)},Y={scaleResolutionDownBy:i/Math.pow(E,j),frameRate:n,bitrateMax:Math.max(Math.round(Math.pow(w,j)*r),d),bitrateMin:Math.max(Math.round(Math.pow(w,j)*o),l)},Z={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(S,j)*n),s),bitrateMax:Math.max(Math.round(Math.pow(A,j)*r),d),bitrateMin:Math.max(Math.round(Math.pow(A,j)*o),l)};L.push({scale:j,threshold:W,balanced:V,motion:Y,detail:Z})}return L}function FMe(e,t,r,n,i,o){let s=ow.get(e)||{overUse:0,underUse:0,adaptationList:pZ(i)},{adaptationList:a}=s;ow.set(e,s);let{OVERUSE_TIMES_THRESHOLD:c,UNDERUSE_TIMES_THRESHOLD:l}=PD,{scale:d}=n,u,p;return typeof t=="number"&&t>0&&function(f,m,g,y){if(m>=g.length)return!1;let{threshold:{fps_down:v}}=g[m];return D("FORCE_AG_HIGH_FRAMERATE")&&y==="maintain-framerate"&&(v=g[0].threshold.fps_down),f<v}(t,d,a,o)&&(s.overUse++,p=Bg.CPU,s.overUse>c)||typeof r=="number"&&r>0&&function(f,m,g){if(m>=g.length)return!1;let{threshold:{bwe_down:y}}=g[m];return f<y}(r,d,a)&&(s.overUse++,p=Bg.BANDWIDTH,s.overUse>c)?(s.overUse=0,s.underUse=0,u=o6(n,a,o,Zp.DOWN),[u,p]):(typeof t=="number"&&t>0&&typeof r=="number"&&r>0&&function(f,m,g,y){if(m===0)return;let{threshold:{fps_up:v}}=g[m];return D("FORCE_AG_HIGH_FRAMERATE")&&y==="maintain-framerate"&&(v=g[1].threshold.fps_up),f>v}(t,d,a,o)&&function(f,m,g){if(m===0)return;let{threshold:{bwe_up:y}}=g[m];return f>y}(r,d,a)&&(s.underUse++,s.underUse>l&&(s.overUse=0,s.underUse=0,u=o6(n,a,o,Zp.UP),u.scale===0&&(p=Bg.NONE))),[u,p])}function s6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function MI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s6(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VMe(e){var t;return!!D("ENABLE_AG_ADAPTATION")&&!!(e instanceof GO||pe(t=e._hints).call(t,nr.CUSTOM_TRACK))&&(!!D("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(r){let n=yt();if(n.os!==sn.IOS||!n.osVersion)return!1;let i=n.osVersion.split(".");return Number(i[0])>=r}(14)&&HJ(17,4)||$J(14)&&WJ(17,4)))}var sw=new Map;function EE(e,t){let r=sw.get(e);if(r){let{timer:n}=r;window.clearTimeout(n),sw.delete(e)}t.qualityLimitationReason=Bg.NONE,hZ(e)}var pt;function a6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Xa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a6(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var pa=(pt=class fg extends aQ{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,r;return(t=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&t!==void 0?t:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var r;return pe(r=Object.keys(tT)).call(r,t)}))]}constructor(t,r){super(t,r),C(this,"store",void 0),C(this,"peerConnection",void 0),C(this,"id",qt(5,"connection-")),C(this,"remoteSDP",void 0),C(this,"initialOffer",void 0),C(this,"transportEventReceiver",void 0),C(this,"statsFilter",void 0),C(this,"extension",{useXR:D("USE_XR")}),C(this,"localCapabilities",void 0),C(this,"remoteCodecs",void 0),C(this,"localCandidateCount",0),C(this,"allCandidatesReceived",!1),C(this,"isPreallocation",!1),C(this,"preSSRCMap",new Map),C(this,"dataStreamChannelMap",new Map),C(this,"establishPromise",void 0),C(this,"recoveredDataChannelIds",[]),C(this,"currentDataChannelId",1),C(this,"mutex",new Gn("P2PConnection-mutex")),C(this,"qualityLimitationReason",Bg.NONE),this.store=r,this.peerConnection=new RTCPeerConnection(fg.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=ZD(this.peerConnection,D("STATS_UPDATE_INTERVAL"),void 0,_r()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(t){let r=this.preSSRCMap.get(t);if(r!==void 0){let n=this.peerConnection.getTransceivers().find(i=>i.mid===r);if(n)return{transceiver:n,track:n.receiver.track,id:r}}}async updateRemoteRTPCapabilities(t,r){if(this.remoteCodecs=r,!this.remoteSDP)return void b.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(r));if(this.remoteSDP.updateRemoteCodec(t,r,this.store.codec)){let n=await this.peerConnection.createOffer(),i=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n);let o=this.remoteSDP.toString();i==null||i(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}else b.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});let t=await this.peerConnection.createOffer();if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");let r=sd(t.sdp),n=await YQ({filterRTX:!D("USE_PUB_RTX")&&!D("USE_SUB_RTX"),filterVideoFec:D("FILTER_VIDEO_FEC"),filterAudioFec:D("FILTER_AUDIO_FEC"),filterVideoCodec:D("FILTER_VIDEO_CODEC")},this.extension);return this.localCapabilities=iw(n),this.initialOffer=t,Xa(Xa({},r),{},{rtpCapabilities:n,offerSDP:t.sdp})}catch(t){throw new X(I.GET_LOCAL_CONNECTION_PARAMS_FAILED,t.toString())}}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new UMe(Xa(Xa({},t),{},{localCapabilities:this.localCapabilities})),t.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);let r=this.remoteSDP.toString(),n=XQ(this.initialOffer.sdp,this.extension),i=this.logSDPExchange(n||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),i==null||i(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r});let o=this.peerConnection.getTransceivers()[0];if(o!=null&&o.receiver&&this.tryBindTransportEvents(o.receiver),D("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(D("PRELOAD_MEDIA_COUNT"));let a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});let c=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(c)}let{preSSRCs:s}=t;if(Array.isArray(s)&&s.length>0){let{mids:a}=this.remoteSDP.batchSend(s.map(c=>({kind:c.kind,ssrcMsg:[{ssrcId:c.ssrcId,rtx:c.rtx}],mslabel:c.mslabel})));a.forEach((c,l)=>{this.preSSRCMap.set(s[l].ssrcId,c)}),await fE(this.peerConnection,this.remoteSDP,this.extension),b.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async updateRemoteConnect(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");let{rtpCapabilities:r}=t;this.remoteSDP.updateRemoteRTPCapabilities(r),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);let{preSSRCs:n}=t;if(Array.isArray(n)&&n.length>0){let{mids:i}=this.remoteSDP.batchSend(n.map(o=>Object.assign({},{kind:o.kind,ssrcMsg:[{ssrcId:o.ssrcId,rtx:o.rtx}],mslabel:o.mslabel})));i.forEach((o,s)=>{this.preSSRCMap.set(n[s].ssrcId,o)})}await fE(this.peerConnection,this.remoteSDP,this.extension),b.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(r.toString()))}}send(t,r,n){var i=this;return Ia(function*(){let o=yield wt(i.mutex.lock("From P2PConnection.send"));try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");let s=[];t.forEach(g=>{let y=i.peerConnection.addTransceiver(g._mediaStreamTrack,{direction:"sendonly"});s.push(y),g._updateRtpTransceiver(y)}),_r()&&D("SIMULCAST")===!0&&(yield wt(i.applySimulcastForFirefox(s,t)));let a=yield wt(i.peerConnection.createOffer()),c=i.remoteSDP.predictReceivingMids(t.length),l=i.mungSendOfferSDP(a.sdp,t,c),d=wn.parse(l),u=c.map(g=>{let y=d.mediaDescriptions.find(v=>v.attributes.mid===g);if(!y)throw new Error("Cannot extract ssrc from mediaDescription.");return GQ(y,D("USE_PUB_RTX"))}),p;try{p=yield u}catch(g){p=[],i.remoteSDP.receive(t,r,n,p);let y=i.remoteSDP.toString();throw yield wt(i.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield wt(i.peerConnection.setRemoteDescription({type:"answer",sdp:y})),yield wt(i.stopSending(c,!0)),g}i.remoteSDP.receive(t,r,n,p);let f=i.remoteSDP.toString(),m=i.logSDPExchange(l,"offer","local","send");return yield wt(i.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield wt(i.applySimulcastEncodings(s,t)),yield wt(i.applySendEncodings(s,t)),m==null||m(f),yield wt(i.peerConnection.setRemoteDescription({type:"answer",sdp:f})),s.map((g,y)=>{let v=c[y];return{localSSRC:u[y],id:v,transceiver:g}})}catch(s){throw s instanceof X?s:new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(s.toString()))}finally{o()}})()}async createDataChannels(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let n=this.dataStreamChannelMap.get(t);if(n&&n.readyState==="open")b.debug("[P2PConnection] Channels are already available and can be reused directly.");else{let o=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof o!="number")throw new Error("create DataChannel error, because cannot get dc id");n=this.peerConnection.createDataChannel("datastream-channel",{id:o,negotiated:!0,ordered:!1,maxRetransmits:D("DATASTREAM_MAX_RETRANSMITS")}),n.binaryType="arraybuffer",this.dataStreamChannelMap.set(t,n)}r.forEach(o=>{o._updateOriginDataChannel(n)});let{needExchangeSDP:i}=this.remoteSDP.sendDataChannel();if(i){let o=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:o});let s=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(s),b.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else b.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(n){throw n instanceof X?n:new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(n.toString()))}}async stopDataChannels(t){try{let r=this.dataStreamChannelMap.get(t);return r&&(r.id&&this.recoveredDataChannelIds.push(r.id),r.close()),void this.dataStreamChannelMap.delete(t)}catch(r){throw r instanceof X?r:new X(I.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(r.toString()))}}async stopSending(t,r){let n=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");let i=this.peerConnection.getTransceivers().filter(c=>t.indexOf(c.mid)!==-1);if(i.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");i.map(c=>{var l;EE(this.id+c.mid,this),c.direction="inactive",(l=c.stop)===null||l===void 0||l.call(c)});let o=await this.peerConnection.createOffer(),s=this.logSDPExchange(o.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(o),this.remoteSDP.stopReceiving(t);let a=this.remoteSDP.toString();s==null||s(a),await this.peerConnection.setRemoteDescription({type:"answer",sdp:a})}catch(i){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(i.toString()))}finally{n&&n()}}async receive(t,r,n,i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));let{mid:o,needExchangeSDP:s}=this.remoteSDP.send(t,r,n,i);s&&(await fE(this.peerConnection,this.remoteSDP,this.extension),b.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP.")));let a=this.peerConnection.getTransceivers().find(c=>c.mid===o);if(!a)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,id:o,transceiver:a}}catch(o){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(o.toString()))}}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");let{mids:r,needExchangeSDP:n}=this.remoteSDP.batchSend(t);return n&&(await fE(this.peerConnection,this.remoteSDP,this.extension),b.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),r.map(i=>{let o=this.peerConnection.getTransceivers().find(s=>s.mid===i);if(!o)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:o.receiver.track,id:i,transceiver:o}})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");t.forEach(o=>{Array.from(this.preSSRCMap.entries()).some(s=>{let[a,c]=s;if(c===o)return this.preSSRCMap.delete(a),!0})}),this.remoteSDP.stopSending(t);let r=this.remoteSDP.toString(),n=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});let i=await this.peerConnection.createAnswer();n==null||n(i.sdp||""),await this.peerConnection.setLocalDescription(i)}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.mute(t);let r=this.remoteSDP.toString(),n=this.logSDPExchange(r,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});let i=await this.peerConnection.createAnswer();n==null||n(i.sdp||""),await this.peerConnection.setLocalDescription(i)}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(r.toString()))}}async unmuteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.unmute(t);let r=this.remoteSDP.toString(),n=this.logSDPExchange(r,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});let i=await this.peerConnection.createAnswer();n==null||n(i.sdp||""),await this.peerConnection.setLocalDescription(i)}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(r.toString()))}}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");let r=this.peerConnection.getTransceivers().filter(s=>s.mid&&t.indexOf(s.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(s=>{s.direction="inactive"});let n=await this.peerConnection.createOffer(),i=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(t);let o=this.remoteSDP.toString();i==null||i(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");let r=this.peerConnection.getTransceivers().filter(s=>s.mid&&t.indexOf(s.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async(s,a)=>{s.direction="sendonly"});let n=await this.peerConnection.createOffer(),i=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(t);let o=this.remoteSDP.toString();i==null||i(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(r){throw new X(I.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return Ia(function*(){let n=yield wt(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Et().supportPCSetConfiguration){let l=r.peerConnection.getConfiguration(),d=t===so.RELAY?"relay":"all";l.iceTransportPolicy!==d&&(b.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(l.iceTransportPolicy,"] to [").concat(d,"]")),l.iceTransportPolicy=d,r.peerConnection.setConfiguration(l))}else if(t===so.RELAY)return;r.remoteSDP.updateCandidates(t);let i=yield wt(r.peerConnection.createOffer({iceRestart:!0}));if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");let o=sd(i.sdp),{remoteIceParameters:s}=yield o.iceParameters;r.remoteSDP.restartICE(s);let a=r.remoteSDP.toString(),c=r.logSDPExchange(i.sdp||"","offer","local","restartICE");r.store.descriptionStart(),yield wt(r.peerConnection.setLocalDescription(i)),c==null||c(a),yield wt(r.peerConnection.setRemoteDescription({type:"answer",sdp:a}))}catch(i){b.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),i)}finally{n()}})()}close(){var t;this.peerConnection.getTransceivers().forEach(r=>{EE(this.id+r.mid,this)}),this.preSSRCMap.clear(),this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return Xa(Xa({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");let n=await this.peerConnection.createOffer(),i=this.mungSendOfferSDP(n.sdp,[r],[t]);this.remoteSDP.updateRecvMedia(t,r);let o=this.remoteSDP.toString(),s=this.logSDPExchange(i,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:i}),s==null||s(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(n){throw new X(I.EXCHANGE_SDP_FAILED,n.toString())}}async updateSendParameters(t,r){let n=this.peerConnection.getTransceivers().filter(i=>i.mid===t);n.length===1&&(this.isVP8Simulcast(r)?_r()||await this.applySimulcastEncodings(n,[r]):await this.applySendEncodings(n,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){let n=this.peerConnection.getTransceivers().find(i=>i.mid===r);n&&await n.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){let t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){let r=t[0].transport.iceTransport,{local:n,remote:i}=r.getSelectedCandidatePair();return{local:Xa(Xa({},Ec),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:Xa(Xa({},Ec),{},{candidateType:i.type,protocol:i.protocol,address:i.address,port:i.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,b.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,b.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},D("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){let r={iceServers:[]};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(QS(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...fg.turnServerConfigToIceServers(t.turnServer.servers)),D("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...fg.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),D("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(n=>{n.forceturn&&(r.iceTransportPolicy="relay")}))),D("ENABLE_ENCODED_TRANSFORM")&&Et().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),r}static turnServerConfigToIceServers(t){let r=[];return t.forEach(n=>{n.security?n.tcpport&&r.push({username:n.username,credential:n.password,credentialType:"password",urls:"turns:".concat(kp(n.turnServerURL),":").concat(n.tcpport,"?transport=tcp")}):(n.udpport&&!D("FORCE_TURN_TCP")&&r.push({username:n.username,credential:n.password,credentialType:"password",urls:"turn:".concat(n.turnServerURL,":").concat(n.udpport,"?transport=udp")}),n.tcpport&&r.push({username:n.username,credential:n.password,credentialType:"password",urls:"turn:".concat(n.turnServerURL,":").concat(n.tcpport,"?transport=tcp")}))}),r}tryBindTransportEvents(t){let r=t.transport;if(r){this.transportEventReceiver=t,r.onstatechange=()=>{var i;r!=null&&r.state&&((i=this.onDTLSTransportStateChange)===null||i===void 0||i.call(this,r.state))},r.onerror=i=>{var o;(o=this.onDTLSTransportError)===null||o===void 0||o.call(this,"error"in i?i.error:i)};let n=r.iceTransport;n&&(n.onstatechange=()=>{let i=r==null?void 0:r.iceTransport.state;var o;i&&((o=this.onICETransportStateChange)===null||o===void 0||o.call(this,i))},n.getSelectedCandidatePair&&(n.onselectedcandidatepairchange=()=>{if(n.getSelectedCandidatePair()){let{local:i,remote:o}=n.getSelectedCandidatePair();b.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:i.type,protocol:i.protocol}),", remote ").concat(JSON.stringify({candidateType:o.type,protocol:o.protocol,address:o.address,port:o.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,r){var n,i;if(r||(r=this.peerConnection.getSenders().find(g=>g.track===t._mediaStreamTrack)),!r)return b.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return b.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Et().supportSetRtpSenderParameters)return b.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");let o={},s={};switch(t._optimizationMode){case"motion":o.degradationPreference="maintain-framerate";break;case"detail":o.degradationPreference="maintain-resolution";break;case"balanced":o.degradationPreference="balanced"}let a=function(g,y){return g.getTransceivers().find(v=>v.sender.track===y||v.receiver.track===y)}(this.peerConnection,t._mediaStreamTrack),c=eMe(t);if(VMe(t)&&a&&r&&c&&this.getLocalVideoStats&&pe(n=["vp8","vp9"]).call(n,this.store.codec)){var l;let g=o.degradationPreference||(pe(l=t._hints).call(l,nr.CUSTOM_TRACK)?D("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(y,v,E,w,S,A){if(EE(y,E),S(v),w!=="balanced"&&w!=="maintain-framerate"&&w!=="maintain-resolution")return;let N=-1;hZ(y,v);let L=window.setInterval(()=>{let W=sw.get(y);if(!D("ENABLE_AG_ADAPTATION")||!W)return EE(y,E),void S(v);let V=A();if(V.sendPackets>0&&V.OutgoingAvailableBandwidth>0){if(N===-1)return void(N=Date.now());if(Date.now()-N<1e3)return;let Y=V.sendFrameRate,Z=V.OutgoingAvailableBandwidth,[te,H]=FMe(y,Y,Z,W.adaptationConfig,v,w);H&&(E.qualityLimitationReason=H),te&&W.adaptationConfig.scale!==te.scale&&(b.debug("[".concat(y,"] applyAdaptation: ").concat(E.qualityLimitationReason,`
           sendFps `).concat(Y,", bwe ").concat(Z,", switch from ").concat(W.adaptationConfig.scale," to ").concat(te.scale," ")),W.adaptationConfig=MI(MI({},W.adaptationConfig),te),S(te))}},D("CHECK_LOCAL_STATS_INTERVAL")),j=MI({},v);sw.set(y,{timer:L,adaptationConfig:j,originConfig:v,adaptationFunc:S}),b.debug("[".concat(y,"] start adaptation, originConfig: ").concat(JSON.stringify(v),", degradationPreference: ").concat(w))})(this.id+a.mid,c,this,g,y=>{r&&this.updateAdaptation(r,y)},this.getLocalVideoStats.bind(this))}if(t._encoderConfig){var d;let{bitrateMax:g,frameRate:y,scaleResolutionDownBy:v}=t._encoderConfig;g&&(s.maxBitrate=1e3*g),(pe(d=t._hints).call(d,nr.LOW_STREAM)||t.isUseScaleResolutionDownBy)&&(y&&(s.maxFramerate=ao(y)),v&&v>=1&&(s.scaleResolutionDownBy=v))}let{maxFramerate:u}=D("ENCODER_CONFIG_LIMIT");if(u&&typeof u=="number"&&(s.maxFramerate=s.maxFramerate?Math.min(s.maxFramerate,u):u),D("DSCP_TYPE")&&Od()){var p;let g=D("DSCP_TYPE");pe(p=["very-low","low","medium","high"]).call(p,g)&&(s.networkPriority=g)}let f=r.getParameters(),m=(i=f.encodings)===null||i===void 0?void 0:i[0];_r()&&!m&&(o.encodings=[s]),m&&Object.assign(m,s),Object.assign(f,o),b.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(f.encodings))),await r.setParameters(f),await async function(g,y,v){try{var E;if(!Et().supportSetRtpSenderParameters||!function(L){return L==="vp9"}(g)||!D("ENABLE_SVC"))return;let w={},S={},A=y.getParameters(),N=(E=A.encodings)===null||E===void 0?void 0:E[0];S.scalabilityMode=KO(v),N&&Object.assign(N,S),Object.assign(A,w),await y.setParameters(A),b.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(A.encodings)))}catch(w){b.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",w)}}(this.store.codec,r,D("SVC_MODE"))}async updateAdaptation(t,r){var n,i;if(!t)return b.debug("[updateAdaptation] no rtpSender found");if(!Et().supportSetRtpSenderParameters)return b.debug("[updateAdaptation] Browser not support set rtp-sender parameters");let o={},{bitrateMax:s,frameRate:a,scaleResolutionDownBy:c}=r;s&&(o.maxBitrate=1e3*s),a&&(o.maxFramerate=ao(a)),c&&c>=1&&pe(n=["vp8","vp9"]).call(n,this.store.codec)&&(o.scaleResolutionDownBy=c);let l=t.getParameters(),d=(i=l.encodings)===null||i===void 0?void 0:i[0];d&&Object.assign(d,o),Object.assign(l,{});try{await t.setParameters(l),b.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(l.encodings)))}catch(u){!("transport"in t)||t.transport&&t.transport.state==="connected"?this.peerConnectionState!=="connected"?b.debug("[updateAdaptation] peerConnection not connected}"):b.debug("[updateAdaptation] updateRtpSenderEncodings failed",u):b.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(t,r){try{if(!Et().supportSetRtpSenderParameters||t.length!==r.length)return;for(let n=0;n<t.length;n++){let i=t[n],o=r[n];o instanceof Qt&&!this.isVP8Simulcast(o)&&await this.updateRtpSenderEncodings(o,i.sender)}}catch{b.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r,n){let i=wn.parse(t);return r.forEach((o,s)=>{let a=n[s],c=i.mediaDescriptions.find(l=>l.attributes.mid===a);c&&(Of(c,o),qQ(c,o,this.store.codec))}),wn.print(i)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,n)=>{var i;(i=this.onFirstVideoDecoded)===null||i===void 0||i.call(this,t,r,n)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var n;(n=this.onSelectedLocalCandidateChanged)===null||n===void 0||n.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var n;(n=this.onSelectedRemoteCandidateChanged)===null||n===void 0||n.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let c=0;c<t.length;c++){var n,i,o,s,a;let l=t[c],d=r[c];if(d instanceof Qt&&!pe(n=d._hints).call(n,nr.LOW_STREAM)&&(i=d._encoderConfig)!==null&&i!==void 0&&i.bitrateMax&&((o=d._encoderConfig)===null||o===void 0?void 0:o.bitrateMax)>200&&(s=d._scalabilityMode)!==null&&s!==void 0&&s.numSpatialLayers&&((a=d._scalabilityMode)===null||a===void 0?void 0:a.numSpatialLayers)>1&&this.store.codec==="vp8"){let u={},p={high:1e3*(d._encoderConfig.bitrateMax-50),medium:5e4};u.encodings=[{rid:"m",active:!0,maxBitrate:p.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:p.high}];let f=l.sender.getParameters();await l.sender.setParameters(Object.assign(f,u))}}}async applySimulcastEncodings(t,r){if(!_r()&&t.length===r.length)for(let n=0;n<t.length;n++){let i=r[n];if(i instanceof Qt&&this.isVP8Simulcast(i)){let o=t[n],s={},a={high:1e3*(i._encoderConfig.bitrateMax-50),medium:5e4};s.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:a.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:a.medium,scaleResolutionDownBy:4}];let c=o.sender.getParameters();await o.sender.setParameters(Object.assign(c,s))}}}isVP8Simulcast(t){var r,n,i,o,s;return!!(t instanceof Qt&&D("SIMULCAST")&&this.store.codec==="vp8"&&!pe(r=t._hints).call(r,nr.LOW_STREAM)&&(n=t._encoderConfig)!==null&&n!==void 0&&n.bitrateMax&&((i=t._encoderConfig)===null||i===void 0?void 0:i.bitrateMax)>200&&(o=t._scalabilityMode)!==null&&o!==void 0&&o.numSpatialLayers&&((s=t._scalabilityMode)===null||s===void 0?void 0:s.numSpatialLayers)>1)}logSDPExchange(t,r,n,i){if(D("SDP_LOGGING"))return b.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(r," SDP during P2PConnection.").concat(i,`
`),t),r==="offer"?o=>{this.logSDPExchange(o,"answer",n==="local"?"remote":"local",i)}:void 0}async getRemoteSSRC(t){if(!this.remoteSDP)return;let r=this.remoteSDP.getSSRC(t);return r&&r.length!==0?r[0].ssrcId:void 0}setConfiguration(t){if(Et().supportPCSetConfiguration){let r=fg.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}},ve(pt.prototype,"updateRemoteRTPCapabilities",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"updateRemoteRTPCapabilities"),pt.prototype),ve(pt.prototype,"connect",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"connect"),pt.prototype),ve(pt.prototype,"updateRemoteConnect",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"updateRemoteConnect"),pt.prototype),ve(pt.prototype,"createDataChannels",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"createDataChannels"),pt.prototype),ve(pt.prototype,"receive",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"receive"),pt.prototype),ve(pt.prototype,"batchReceive",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"batchReceive"),pt.prototype),ve(pt.prototype,"stopReceiving",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"stopReceiving"),pt.prototype),ve(pt.prototype,"muteRemote",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"muteRemote"),pt.prototype),ve(pt.prototype,"unmuteRemote",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"unmuteRemote"),pt.prototype),ve(pt.prototype,"muteLocal",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"muteLocal"),pt.prototype),ve(pt.prototype,"unmuteLocal",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"unmuteLocal"),pt.prototype),ve(pt.prototype,"close",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"close"),pt.prototype),ve(pt.prototype,"updateEncoderConfig",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"updateEncoderConfig"),pt.prototype),ve(pt.prototype,"updateSendParameters",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"updateSendParameters"),pt.prototype),ve(pt.prototype,"replaceTrack",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"replaceTrack"),pt.prototype),ve(pt.prototype,"updateAdaptation",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"updateAdaptation"),pt.prototype),ve(pt.prototype,"getRemoteSSRC",[Ri],Object.getOwnPropertyDescriptor(pt.prototype,"getRemoteSSRC"),pt.prototype),pt);function Ri(e,t,r){let n=e[t];if(typeof n!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){let i=this.mutex,o=await i.lock("From P2PConnection.".concat(t));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return await n.apply(this,a)}finally{o()}},r}var it;function c6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ja(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c6(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l6(e){var t,r,n,i=2;for(typeof Symbol<"u"&&(r=jMe,n=Symbol.iterator);i--;){if(r&&(t=e[r])!=null)return t.call(e);if(n&&(t=e[n])!=null)return new __(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function __(e){function t(r){if(Object(r)!==r)return de.reject(new TypeError(r+" is not an object."));var n=r.done;return de.resolve(r.value).then(function(i){return{value:i,done:n}})}return __=function(r){this.s=r,this.n=r.next},__.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var n=this.s.return;return n===void 0?de.resolve({value:r,done:!0}):t(n.apply(this.s,arguments))},throw:function(r){var n=this.s.return;return n===void 0?de.reject(r):t(n.apply(this.s,arguments))}},new __(e)}var _E=(it=class extends fr{get state(){return this._state}set state(e){let t=this._state;this._state=e,this.emit(Ne.StateChange,t,this._state)}constructor(e,t){super(),C(this,"isPlanB",void 0),C(this,"store",void 0),C(this,"statsUploader",void 0),C(this,"connection",void 0),C(this,"localTrackMap",new Map),C(this,"remoteUserMap",new Map),C(this,"localDataChannels",[]),C(this,"remoteDataChannelMap",new Map),C(this,"pendingLocalTracks",[]),C(this,"pendingRemoteTracks",[]),C(this,"pendingLocalDataChannels",[]),C(this,"pendingRemoteDataChannels",[]),C(this,"statsCollector",void 0),C(this,"shouldForwardP2PCreation",void 0),C(this,"iceFailedCount",0),C(this,"dtlsFailedCount",0),C(this,"mutex",new Gn("P2PChannel-mutex")),C(this,"_state",xt.Disconnected),C(this,"_pcStatsUploadType",D("NEW_ICE_RESTART")?Pc.FIRST_CONNECTION:Pc.OLD_FIRST_CONNECTION),C(this,"_isInRestartIce",!1),C(this,"_isStartRestartIce",!1),C(this,"_restartStates",["disconnected","failed"]),C(this,"_restartTimer",void 0),C(this,"_isFirstConnected",!0),C(this,"handleMuteLocalTrack",async(r,n,i)=>{let o=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==xt.Connected)return void i(new X(I.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));let s=this.filterTobeMutedTracks(r);if(s.length===0)return void n();let a=s.find(l=>l[0]==="videoLowTrack");a&&a[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(s.map(l=>{let[,{id:d}]=l;return d}));let c=this.createMuteMessage(s);await Wt(this,Ne.RequestMuteLocal,c),n()}catch(s){i(s)}finally{o()}}),C(this,"handleUnmuteLocalTrack",async(r,n,i)=>{let o=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==xt.Connected)return void i(new X(I.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));let s=this.filterTobeUnmutedTracks(r);if(s.length===0)return void n();let a=s.find(l=>l[0]==="videoLowTrack");if(a){let l=a[1];if(l.track._originMediaStreamTrack.stop(),!D("DISABLE_DUAL_STREAM_USE_ENCODING")&&Et().supportDualStreamEncoding){let d=r._mediaStreamTrack.clone();l.track._mediaStreamTrack=d,l.track._originMediaStreamTrack=d}else{let d=QO(r,j0(this,Ne.RequestLowStreamParameter));l.track._mediaStreamTrack=d,l.track._originMediaStreamTrack=d}await new de((d,u)=>{this.handleReplaceTrack(l.track,d,u,!0)})}await this.connection.unmuteLocal(s.map(l=>{let[,{id:d}]=l;return d}));let c=this.createUnmuteMessage(s);await Wt(this,Ne.RequestUnmuteLocal,c),n()}catch(s){i(s)}finally{o()}}),C(this,"handleUpdateVideoEncoder",async(r,n,i)=>{let o=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{let s=this.localTrackMap.get(ne.LocalVideoTrack);if(!this.connection||!s||s.track!==r||this.state!==xt.Connected)return void n();let{id:a,track:c}=s;await this.connection.updateSendParameters(a,c),await this.connection.updateEncoderConfig(a,c),this.emit(Ne.UpdateVideoEncoder,c),n()}catch(s){i(s)}finally{o()}}),C(this,"handleUpdateVideoSendParameters",async(r,n,i)=>{let o=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{let s=this.localTrackMap.get(ne.LocalVideoTrack);if(!this.connection||!s||s.track!==r||this.state!==xt.Connected)return void n();let{id:a,track:c}=s;await this.connection.updateSendParameters(a,c),n()}catch(s){i(s)}finally{o()}}),C(this,"handleReplaceMixingTrack",async(r,n,i,o)=>{if(!this.connection||this.state!==xt.Connected)return void n();let s=LI([r]),a;b.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(s.getTrackId(),"]")),typeof o=="boolean"&&o||(a=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(r,s),n()}catch(l){i(l)}finally{var c;(c=a)===null||c===void 0||c()}}),C(this,"handleReplaceTrack",async(r,n,i,o)=>{let s;b.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),typeof o=="boolean"&&o||(s=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var a;let l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:u}]=d;return r===u});if(!this.connection||!l||this.state!==xt.Connected)return void n();if(await((a=this.connection)===null||a===void 0?void 0:a.replaceTrack(r,l[1].id)),this.isPlanB){let d=l[1];d.id=r._mediaStreamTrack.id,this.localTrackMap.set(l[0],d)}if(l[0]===ne.LocalVideoTrack&&!D("DISABLE_DUAL_STREAM_USE_ENCODING")&&Et().supportDualStreamEncoding){let d=this.localTrackMap.get(ne.LocalVideoLowTrack);if(d){let u=r._mediaStreamTrack.clone();d.track._originMediaStreamTrack.stop(),d.track._mediaStreamTrack=u,d.track._originMediaStreamTrack=u,await new de((p,f)=>{this.handleReplaceTrack(d.track,p,f,!0)})}}n()}catch(l){i(l)}finally{var c;(c=s)===null||c===void 0||c()}}),C(this,"handleGetRTCStats",r=>{r(this.statsCollector.getRTCStats())}),C(this,"handleGetLocalVideoStats",r=>{r(this.statsCollector.getLocalVideoTrackStats())}),C(this,"handleGetLocalAudioStats",r=>{r(this.statsCollector.getLocalAudioTrackStats())}),C(this,"handleGetRemoteVideoStats",r=>this.statsCollector.getRemoteVideoTrackStats(r.uid)[r.uid]),C(this,"handleGetRemoteAudioStats",r=>this.statsCollector.getRemoteAudioTrackStats(r.uid)[r.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new lZ(this.store),this.bindStatsUploaderEvents(),this.isPlanB=!Et().supportUnifiedPlan||D("CHROME_FORCE_PLAN_B")&&Od(),this.shouldForwardP2PCreation=D("FORWARD_P2P_CREATION")&&Et().supportPCSetConfiguration&&xD(),this.shouldForwardP2PCreation&&(this.connection=this.isPlanB?new qm({},this.store):new pa({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(e){var t;this.state=xt.New;let r=this.shouldForwardP2PCreation&&((t=this.connection)===null||t===void 0?void 0:t.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!r||(r&&this.connection&&(b.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.isPlanB?new qm(e,this.store):new pa(e,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new X(I.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=D("NEW_ICE_RESTART")?Pc.FIRST_CONNECTION:Pc.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e){if(!this.connection)throw new X(I.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");D("ENABLE_PREALLOC_PC")&&this.state===xt.Connected?await this.connection.updateRemoteConnect(e):(this.store.peerConnectionStart(),await this.connection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=xt.Connected)}updateRemoteRTPCapabilities(e){let t=Array.from(this.localTrackMap.entries()).filter(i=>{var o;let[s]=i;return pe(o=[ne.LocalVideoLowTrack,ne.LocalVideoTrack]).call(o,s)}),r=t.map(i=>{let[,{id:o}]=i;return o}),n=t.map(i=>{let[o]=i;return o});if(this.connection instanceof pa){if(_e.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(n),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!pe(e).call(e,this.store.codec)){let i=["vp9","vp8","h264"].find(o=>pe(e).call(e,o));i&&(this.store.codec=i,b.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(i,".")))}this.connection.updateRemoteRTPCapabilities(r,e)}}async getEstablishParams(){var e;if(this.connection instanceof pa&&this.connection.peerConnectionState!=="closed"&&pe(e=[xt.New,xt.Connected]).call(e,this.state))return this.connection.establishPromise}async publishDataChannel(e){if(!this.connection||this.state!==xt.Connected){if(this.state===xt.Disconnected)throw new X(I.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return e.forEach(r=>{var n;pe(n=this.pendingLocalDataChannels).call(n,r)||this.pendingLocalDataChannels.push(r)}),[]}let t=this.filterTobePublishedDataChannels(e);return t.length===0?[]:(t.forEach(r=>{let n=Date.now();this.store.publish(r.id.toString(),"datachannel",n)}),await this.connection.createDataChannels(this.store.uid,t),t.forEach(r=>{this.localDataChannels.push(r);let n=Date.now();this.store.publish(r.id+"","datachannel",void 0,n)}),e.map(r=>({streamId:r.id,ordered:r.ordered,maxRetransmits:r.maxRetransmits,metadata:r.metadata,channelId:r._originDataChannelId})))}publish(e,t,r){var n=this;return Ia(function*(){let i=yield wt(n.mutex.lock("From P2PChannel.publish"));try{if(!n.connection||n.state!==xt.Connected){if(n.state===xt.Disconnected)throw new X(I.UNEXPECTED_ERROR,"PeerConnection already disconnected.");n.throwIfTrackTypeNotMatch(e);let s=e.filter(a=>n.pendingLocalTracks.indexOf(a)===-1);return void(n.pendingLocalTracks=n.pendingLocalTracks.concat(s))}n.store.pubId=n.store.pubId+1,$n.markPublishStart(n.store.clientId,n.store.pubId);let o=n.filterTobePublishedTracks(e,t,r);if(o.length===0)return void(yield wt(n.tryToUnmuteAudio(e)));yield*QB(l6(n.doPublish(n.connection,o)))}finally{i()}})()}doPublish(e,t){var r=this;return Ia(function*(){t.forEach(u=>{let{track:p,type:f}=u,m=Date.now();r.store.publish(p.getTrackId(),f===ne.LocalAudioTrack?"audio":"video",m)}),r.bindLocalTrackEvents(t);let n=t.map(u=>{let{track:p}=u;return p}),i=yield wt(e.send(t.map(u=>{let{track:p}=u;return p}),r.store.codec,r.store.audioCodec)),o=(yield wt(i.next())).value,s=r.createGatewayPublishMessage(t,o),a;try{a=yield s}catch(u){throw i.throw(u),(u==null?void 0:u.code)===I.WS_ABORT&&t.forEach(p=>{let{track:f}=p;r.pendingLocalTracks.indexOf(f)===-1&&r.pendingLocalTracks.push(f)}),r.unbindLocalTrackEvents(t),u}let c=r.mapPubResToRemoteConfig(s,a),l=(yield wt(i.next(c))).value,d=D("ENABLE_VIDEO_SEI");n.forEach(async u=>{let p=u.getRTCRtpTransceiver();p&&d&&(u.trackMediaType===we.VIDEO?await sMe(p.sender,u):u.trackMediaType===we.AUDIO&&await async function(f){if(!Et().supportWebRTCEncodedTransform)return void b.warning("browser not support audio encoded transform");if(uE.has(f)||!f.track)return;let m={track:f.track};if(vd()){if(!f.createEncodedStreams)return void b.warning("browser not support createEncodedStreams() API");let y=null;try{y=f.createEncodedStreams()}catch(E){return void b.error("create audio-encoded-streams error",E&&E.message)}let v=new TransformStream({transform(E,w){m.controller||(m.controller=w),f.track&&f.track.id!==m.track.id&&(b.debug("audio track changed: ".concat(m.track.id," => ").concat(f.track.id)),m.track.removeEventListener("ended",g),m.track=f.track,m.track.addEventListener("ended",g)),w.enqueue(E)}});y.readable.pipeThrough(v).pipeTo(y.writable)}else if(Pn()){if(typeof RTCRtpScriptTransform>"u")return void b.warning("browser not support RTCRtpScriptTransform");let y=y_(),v=new MessageChannel;await new de(w=>y.onmessage=S=>{S.data==="registered"&&w(void 0)});let E=new RTCRtpScriptTransform(y,{name:"tx",port:v.port2},[v.port2]);f.transform=E,await new de(w=>y.onmessage=S=>{S.data==="started"&&w(void 0)}),v.port1.onmessage=w=>{var S;w.data.transformed&&f.track&&((S=f.track)===null||S===void 0?void 0:S.id)!==m.track.id&&(b.debug("audio track changed: ".concat(m.track.id," => ").concat(f.track.id)),m.track.removeEventListener("ended",g),m.track=f.track,m.track.addEventListener("ended",g))},m.worker=y}function g(){if(f.track){if(this.id!==f.track.id)return;f.track.removeEventListener("ended",g)}let y=uE.get(f);if(y){uE.delete(f);try{var v,E;(v=y.controller)===null||v===void 0||v.terminate(),(E=y.worker)===null||E===void 0||E.terminate()}catch(w){b.warning(w&&w.message)}}}uE.set(f,m),f.track.addEventListener("ended",g)}(p.sender))}),t.forEach(u=>{let{type:p}=u;r.statsCollector.addLocalStats(p)}),r.assignLocalTracks(t,l),r.statsUploader.startUploadOutboundStats(),t.forEach(u=>{let{track:p,type:f}=u,m=Date.now();r.store.publish(p.getTrackId(),f===ne.LocalAudioTrack?"audio":"video",void 0,m)})})()}async updateVideoStreamParameter(e,t){let r=this.localTrackMap.get(t);if(!r)return;if(!(r.track instanceof Qt))return b.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof pa||this.connection instanceof qm))return b.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");let{track:n}=r,i=function(o,s){let a={};return o.height&&o.width&&(a.scaleResolutionDownBy=UO(o,s)),a.maxFramerate=o.framerate?ao(o.framerate):void 0,a.maxBitrate=o.bitrate?1e3*o.bitrate:void 0,a}(e,n);if(n._encoderConfig||(n._encoderConfig={}),t!==ne.LocalVideoLowTrack||!D("DISABLE_DUAL_STREAM_USE_ENCODING")&&Et().supportDualStreamEncoding)i.scaleResolutionDownBy!=null&&(n._encoderConfig.scaleResolutionDownBy=i.scaleResolutionDownBy);else{let o=n._originMediaStreamTrack;if(!o.canvas)return b.warn("[".concat(n.getTrackId(),"] no canvas on track"));(function(s,a){let c=s.canvas;a.width&&(c.width=ao(a.width)),a.height&&(c.height=ao(a.height)),a.framerate&&(c.stopCapture&&c.stopCapture(),c.stopCapture=$D(()=>{!c.startCapture&&c.stopCapture&&c.stopCapture(),c.startCapture&&c.startCapture()},ao(a.framerate)))})(o,e)}i.maxBitrate!=null&&(n._encoderConfig.bitrateMax=i.maxBitrate/1e3),i.maxFramerate!=null&&(n._encoderConfig.frameRate&&typeof n._encoderConfig.frameRate=="object"?n._encoderConfig.frameRate.max=i.maxFramerate:n._encoderConfig.frameRate={max:i.maxFramerate}),b.debug("[".concat(n.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(n._encoderConfig))),await this.connection.updateRtpSenderEncodings(n)}publishLowStream(e){var t=this;return Ia(function*(){if(!t.connection||t.state!==xt.Connected)return;let r=yield wt(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{let i=t.localTrackMap.get(ne.LocalVideoTrack);if(!i)throw new X(I.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(ne.LocalVideoLowTrack))throw new X(I.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));let o=[{track:t.getLowVideoTrack(i.track,e),type:ne.LocalVideoLowTrack}];if(yield*QB(l6(t.doPublish(t.connection,o))),i.track.muted||!i.track.enabled){var n;let s=(n=t.localTrackMap.get(ne.LocalVideoLowTrack))===null||n===void 0?void 0:n.id;s!==void 0&&(yield wt(t.connection.muteLocal([s])))}}finally{r()}})()}async republish(){this.pendingLocalTracks.length>0&&(b.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Dn(this,Ne.RequestRePublish,this.pendingLocalTracks),this.emit(Ne.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(b.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Dn(this,Ne.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe(e){for(let t=this.pendingRemoteTracks.length-1;t>=0;t--){let{user:r,kind:n}=this.pendingRemoteTracks[t];(n!==we.AUDIO||r._audio_added_&&r._audioSSRC)&&(n!==we.VIDEO||r._video_added_&&r._videoSSRC)||this.pendingRemoteTracks.splice(t,1)}if(e)await Dn(this,Ne.RequestReSubscribe,this.pendingRemoteTracks);else for(let{user:t,kind:r}of this.pendingRemoteTracks)await this.subscribe(t,r,r===we.VIDEO?t._videoSSRC:t._audioSSRC);this.pendingRemoteTracks.forEach(t=>{let{user:r}=t;this.emit(Ne.MediaReconnectEnd,r.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==xt.Connected)return void e.forEach(n=>{let i=this.pendingLocalTracks.indexOf(n);i!==-1&&this.pendingLocalTracks.splice(i,1)});let t=this.filterTobeUnpublishedTracks(e);if(t.length===0)return;let r=t.find(n=>n[0]==="videoLowTrack");return r&&r[1].track.close(),this.doUnpublish(this.connection,t)}async unpublishDataChannel(e){if(!this.connection||this.state!==xt.Connected)return void e.forEach(r=>{let n=this.pendingLocalDataChannels.indexOf(r);n!==-1&&this.pendingLocalDataChannels.splice(n,1)});let t=this.filterTobeUnpublishedDataChannels(e);return t.length!==0?(t.forEach(r=>{let n=this.localDataChannels.indexOf(r);n!==-1&&this.localDataChannels.splice(n,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),t.map(r=>r.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==xt.Connected)return;let e=this.localTrackMap.get(ne.LocalVideoLowTrack);if(!e)return;e.track.close();let t=[[ne.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){let r=this.createGatewayUnpublishMessage(t);return await e.stopSending(t.map(n=>{let[,{id:i}]=n;return i})),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map(n=>{let[i,{track:o}]=n;return{type:i,track:o}})),t.forEach(n=>{let[i]=n;this.statsCollector.removeLocalStats(i)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),r}async subscribeDataChannel(e,t){if(!this.connection||this.state!==xt.Connected)throw new X(I.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");let r=t.filter(n=>{var i;return!((i=this.remoteDataChannelMap.get(e))!==null&&i!==void 0&&i.get(n.id))});if(r.length!==0)return await this.connection.createDataChannels(e.uid,r),r.forEach(n=>{var i;this.remoteDataChannelMap.has(e)?(i=this.remoteDataChannelMap.get(e))===null||i===void 0||i.set(n.id,n):this.remoteDataChannelMap.set(e,new Map([[n.id,n]]));let o=this.pendingRemoteDataChannels.findIndex(s=>{let{user:a,id:c}=s;return a.uid===e.uid&&c===n.id});o!==-1&&this.pendingRemoteDataChannels.splice(o,1)}),r.map(n=>n.id)}async subscribe(e,t,r,n,i){var o;if(!this.connection||this.state!==xt.Connected)throw new X(I.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((o=this.remoteUserMap.get(e))!==null&&o!==void 0&&o.has(t))return;let s,a,c,l=this.connection.getPreMedia(r);if(l)b.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(r,", no need to send sub to gateway.")),c=l.transceiver,s=l.track,a=l.id;else if(i){let p=i.find(m=>{let{stream_type:g}=m;return g===t});if(!p)throw new X(I.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));let f=await this.connection.receive(t,p.ssrcs,String(e._uintid),p.attributes);this.connection instanceof pa&&(c=f.transceiver),s=f.track,a=f.id}else{let p=await this.connection.receive(t,[{ssrcId:r,rtx:n}],String(e._uintid),void 0);this.connection instanceof pa&&(c=p.transceiver),s=p.track,a=p.id}t===we.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(s):(e._audioTrack=new Jp(s,e.uid,e._uintid,this.store),b.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),c&&e._audioTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(s):(e._videoTrack=new Xp(s,e.uid,e._uintid,this.store),b.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),c&&e._videoTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._videoTrack)),D("ENABLE_VIDEO_SEI")&&c&&(t==we.VIDEO?await async function(p){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Et().supportWebRTCEncodedTransform)return void b.warning("browser not support video encoded transform");if(!p.track)return;if(Km.has(p)){let y=Km.get(p);return void(y&&(y.onSei=f.onSei))}let m={track:p.track,onSei:f.onSei};if(vd()){if(!p.createEncodedStreams)return void b.warning("browser not support createEncodedStreams() API");let y=null;try{y=p.createEncodedStreams()}catch(E){return void b.error("create video-encoded-streams error",E&&E.message)}let v=new TransformStream({transform(E,w){m.controller||(m.controller=w),p.track&&p.track.id!==m.track.id&&(b.debug("video track changed: ".concat(m.track.id," => ").concat(p.track.id)),m.track.removeEventListener("ended",g),m.track=p.track,m.track.addEventListener("ended",g));let S=function(A){let N=new DataView(A.data),L=0;for(;L+4<A.data.byteLength;){if(N.getUint8(L+0)===0&&N.getUint8(L+1)===0&&N.getUint8(L+2)===0&&N.getUint8(L+3)===1&&N.getUint8(L+4)===6){let j=L+6,W=0,V=0;for(;(V=N.getUint8(j++))===255;)W+=255;W+=V;let Y=oMe(A.data,j,W);return new Uint8Array(Y)}L++}return null}(E);S&&m.onSei&&m.onSei(S),w.enqueue(E)}});y.readable.pipeThrough(v).pipeTo(y.writable)}else if(Pn()){if(typeof RTCRtpScriptTransform>"u")return void b.warning("browser not support RTCRtpScriptTransform");let y=y_(),v=new MessageChannel;await new de(w=>y.onmessage=S=>{S.data==="registered"&&w(void 0)});let E=new RTCRtpScriptTransform(y,{name:"rx",port:v.port2},[v.port2]);p.transform=E,await new de(w=>y.onmessage=S=>{S.data==="started"&&w(void 0)}),v.port1.onmessage=w=>{var S;w.data.transformed&&p.track&&((S=p.track)===null||S===void 0?void 0:S.id)!==m.track.id?(b.debug("video track changed: ".concat(m.track.id," => ").concat(p.track.id)),m.track.removeEventListener("ended",g),m.track=p.track,m.track.addEventListener("ended",g)):w.data.sei&&m.onSei&&m.onSei(w.data.sei)},m.worker=y}function g(){if(p.track){if(this.id!==p.track.id)return;p.track.removeEventListener("ended",g)}(function(y){let v=Km.get(y);if(v){Km.delete(y);try{var E,w;(E=v.controller)===null||E===void 0||E.terminate(),(w=v.worker)===null||w===void 0||w.terminate()}catch(S){b.warning(S&&S.message)}}})(p)}Km.set(p,m),p.track.addEventListener("ended",g)}(c.receiver,{onSei:p=>{var f;(f=e._videoTrack)===null||f===void 0||f._onSei(p)}}):t==we.AUDIO&&await async function(p){if(!Et().supportWebRTCEncodedTransform)return void b.warning("browser not support audio encoded transform");if(hE.has(p))return;let f={track:p.track};if(vd()){if(!p.createEncodedStreams)return void b.warning("browser not support createEncodedStreams() API");let g=null;try{g=p.createEncodedStreams()}catch(v){return void b.error("create audio-encoded-streams error",v&&v.message)}let y=new TransformStream({transform(v,E){f.controller||(f.controller=E),p.track&&p.track.id!==f.track.id&&(b.debug("audio track changed: ".concat(f.track.id," => ").concat(p.track.id)),f.track.removeEventListener("ended",m),f.track=p.track,f.track.addEventListener("ended",m)),E.enqueue(v)}});g.readable.pipeThrough(y).pipeTo(g.writable)}else if(Pn()){if(typeof RTCRtpScriptTransform>"u")return void b.warning("browser not support RTCRtpScriptTransform");let g=y_(),y=new MessageChannel;await new de(E=>g.onmessage=w=>{w.data==="registered"&&E(void 0)});let v=new RTCRtpScriptTransform(g,{name:"rx",port:y.port2},[y.port2]);p.transform=v,await new de(E=>g.onmessage=w=>{w.data==="started"&&E(void 0)}),y.port1.onmessage=E=>{var w;E.data.transformed&&p.track&&((w=p.track)===null||w===void 0?void 0:w.id)!==f.track.id&&(b.debug("audio track changed: ".concat(f.track.id," => ").concat(p.track.id)),f.track.removeEventListener("ended",m),f.track=p.track,f.track.addEventListener("ended",m))},f.worker=g}function m(){p.track.removeEventListener("ended",m),function(g){let y=hE.get(g);if(y){hE.delete(g);try{var v,E;(v=y.controller)===null||v===void 0||v.terminate(),(E=y.worker)===null||E===void 0||E.terminate()}catch(w){b.warning(w&&w.message)}}}(p)}hE.set(p,f),p.track.addEventListener("ended",m)}(c.receiver));let d=this.remoteUserMap.get(e);d?d.set(t,a):this.remoteUserMap.set(e,new Map([[t,a]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();let u=this.pendingRemoteTracks.findIndex(p=>{let{user:f,kind:m}=p;return f.uid===e.uid&&t===m});u!==-1&&(this.pendingRemoteTracks.splice(u,1),this.emit(Ne.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==xt.Connected)throw new X(I.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter(i=>{var o;let{user:s,mediaType:a}=i;return!((o=this.remoteUserMap.get(s))!==null&&o!==void 0&&o.has(a))});let t=[],r=new Map;e.forEach(i=>{if(!this.connection)return;let o=this.connection.getPreMedia(i.ssrcId);o?r.set(i.ssrcId,o):t.push(i)});let n=await this.connection.batchReceive(t.map(i=>{let{user:o,mediaType:s,ssrcId:a,rtxSsrcId:c}=i;return{kind:s,ssrcMsg:[{ssrcId:a,rtx:c}],mslabel:String(o._uintid)}}));t.forEach((i,o)=>{r.set(i.ssrcId,n[o])}),e.forEach(i=>{let{user:o,mediaType:s,ssrcId:a}=i,c=r.get(a);if(!c)return void b.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(o.uid," subscribe data,").concat(s,", ").concat(a));let{track:l,id:d,transceiver:u}=c;s===we.AUDIO?(o._audioTrack?o._audioTrack._updateOriginMediaStreamTrack(l):(o._audioTrack=new Jp(l,o.uid,o._uintid,this.store),b.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(o._audioTrack.getTrackId()))),u&&o._audioTrack._updateRtpTransceiver(u),this.bindRemoteTrackEvents(o,o._audioTrack)):(o._videoTrack?o._videoTrack._updateOriginMediaStreamTrack(l):(o._videoTrack=new Xp(l,o.uid,o._uintid,this.store),b.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(o._videoTrack.getTrackId()))),u&&o._videoTrack._updateRtpTransceiver(u),this.bindRemoteTrackEvents(o,o._videoTrack));let p=this.remoteUserMap.get(o);p?p.set(s,d):this.remoteUserMap.set(o,new Map([[s,d]])),this.statsCollector.addRemoteStats(o.uid),this.statsUploader.startUploadInboundStats();let f=this.pendingRemoteTracks.findIndex(m=>{let{user:g,kind:y}=m;return g.uid===o.uid&&s===y});f!==-1&&(this.pendingRemoteTracks.splice(f,1),this.emit(Ne.MediaReconnectEnd,o.uid))})}async unsubscribe(e,t,r){let n=this.pendingRemoteTracks.filter(s=>{let{user:a,kind:c}=s;return t!==void 0?a.uid===e.uid&&t===c:a.uid===e.uid});if(n.forEach(s=>{let a=this.pendingRemoteTracks.indexOf(s);this.pendingRemoteTracks.splice(a,1)}),this.connection&&this.state===xt.Connected||r||n.forEach(s=>{let{kind:a}=s;var c;if(a===we.AUDIO)(c=e._audioTrack)===null||c===void 0||c._destroy(),e._audioTrack=void 0;else if(a===we.VIDEO){var l;(l=e._videoTrack)===null||l===void 0||l._destroy(),e._videoTrack=void 0}}),!this.connection||this.state!==xt.Connected)return;let i=this.filterTobeUnSubscribedTracks(e,t);if(i.length===0)return;await this.connection.stopReceiving(i.map(s=>{let[,{id:a}]=s;return a}));let o=this.createUnsubscribeMessage(i);return this.withdrawRemoteTracks(i),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),i.forEach(s=>{let[a,{kind:c}]=s;var l,d;if(c===we.VIDEO&&a._videoSSRC&&((l=this.connection)===null||l===void 0||l.setStatsRemoteVideoIsReady(a._videoSSRC,!1)),c===we.VIDEO)this.unbindRemoteTrackEvents(a._videoTrack),r||((d=a._videoTrack)===null||d===void 0||d._destroy(),a._videoTrack=void 0);else if(c===we.AUDIO){var u;this.unbindRemoteTrackEvents(a._audioTrack),!r&&((u=a._audioTrack)===null||u===void 0||u._destroy(),a._audioTrack=void 0)}}),o}async unsubscribeDataChannel(e,t){if(t.forEach(i=>{let o=this.pendingRemoteDataChannels.findIndex(s=>s.id===i.id);o!==-1&&this.pendingRemoteDataChannels.splice(o,1)}),!this.connection)return;let r=this.filterTobeUnSubscribedDataChannels(e,t);if(r.length===0)return;t.forEach(i=>{i._close()});let n=this.remoteDataChannelMap.get(e);return r.forEach(i=>{n&&n.delete(i.id)}),n&&n.size===0&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),r.map(i=>i.id)}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let t=[];for(let{user:i,mediaType:o}of e){let s=this.pendingRemoteTracks.filter(a=>{let{user:c,kind:l}=a;return o!==void 0?c.uid===i.uid&&o===l:c.uid===i.uid});s.forEach(a=>{let c=this.pendingRemoteTracks.indexOf(a);this.pendingRemoteTracks.splice(c,1)}),t=t.concat(s)}if(!this.connection||this.state!==xt.Connected)return void t.forEach(i=>{let{user:o,kind:s}=i;var a;if(s===we.AUDIO)(a=o._audioTrack)===null||a===void 0||a._destroy(),o._audioTrack=void 0;else if(s===we.VIDEO){var c;(c=o._videoTrack)===null||c===void 0||c._destroy(),o._videoTrack=void 0}});let r=ka(e).call(e,(i,o)=>{let{user:s,mediaType:a}=o,c=this.filterTobeUnSubscribedTracks(s,a);return i.concat(c)},[]);if(r.length===0)return;await this.connection.stopReceiving(r.map(i=>{let[,{id:o}]=i;return o}));let n=this.createUnsubscribeAllMessage(r);return this.withdrawRemoteTracks(r),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),r.forEach(i=>{let[o,{kind:s}]=i;var a,c;if(s===we.VIDEO&&o._videoSSRC&&((a=this.connection)===null||a===void 0||a.setStatsRemoteVideoIsReady(o._videoSSRC,!1)),s===we.VIDEO)this.unbindRemoteTrackEvents(o._videoTrack),(c=o._videoTrack)===null||c===void 0||c._destroy(),o._videoTrack=void 0;else if(s===we.AUDIO){var l;this.unbindRemoteTrackEvents(o._audioTrack),(l=o._audioTrack)===null||l===void 0||l._destroy(),o._audioTrack=void 0}}),n}isPreSubScribe(e){return!this.connection||this.state!==xt.Connected?!1:!!this.connection.getPreMedia(e)}async muteRemote(e,t){if(!this.connection)return;let r=this.remoteUserMap.get(e);if(!r)return void b.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!r.get(t))return void b.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));let n=t===we.VIDEO?e._videoSSRC:e._audioSSRC;n!==void 0&&this.connection.setStatsRemoteVideoIsReady(n,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.connection)return;let r=this.remoteUserMap.get(e);if(!r)return void b.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."));r.get(t)||b.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."))}getAllTracks(e){let t=this.localTrackMap.get(ne.LocalAudioTrack);if((t==null?void 0:t.track)instanceof on){let r=t.track;return Array.from(this.localTrackMap.entries()).filter(n=>{let[i]=n;return i!==ne.LocalAudioTrack}).filter(n=>{let[i]=n;return!(e&&i===ne.LocalVideoLowTrack)}).map(n=>{let[,{track:i}]=n;return i}).concat(r.trackList)}return Array.from(this.localTrackMap.entries()).filter(r=>{let[n]=r;return!(e&&n===ne.LocalVideoLowTrack)}).map(r=>{let[,{track:n}]=r;return n})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,t,r,n,i){if(e){let s=this.localTrackMap.get(ne.LocalAudioTrack),a=n?this.localTrackMap.get(ne.LocalVideoLowTrack):this.localTrackMap.get(ne.LocalVideoTrack);_e.publish(this.store.sessionId,{eventElapse:$n.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:s==null?void 0:s.track.getTrackLabel(),videoName:a==null?void 0:a.track.getTrackLabel(),screenshare:(a==null?void 0:a.track._hints.indexOf(nr.SCREEN_TRACK))!==-1,audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}else{var o;r||(r=[]);let s=r.find(c=>c instanceof vr),a=n?(o=this.localTrackMap.get(ne.LocalVideoTrack))===null||o===void 0?void 0:o.track:r.find(c=>c instanceof Qt);_e.publish(this.store.sessionId,{eventElapse:$n.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:s==null?void 0:s.getTrackLabel(),videoName:a==null?void 0:a.getTrackLabel(),screenshare:(a==null?void 0:a._hints.indexOf(nr.SCREEN_TRACK))!==-1,audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}}reportSubscribeEvent(e,t,r,n){let i=n===we.VIDEO?r._videoSSRC:r._audioSSRC;i&&_e.subscribe(this.store.sessionId,{succ:e,ec:t,video:n===we.VIDEO,audio:n===we.AUDIO,peerid:r.uid,subscribeRequestid:i,p2pid:this.store.p2pId,eventElapse:$n.measureFromSubscribeStart(this.store.clientId,i),preSsrc:this.isPreSubScribe(i)})}reset(){b.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Gn("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.isPlanB?new qm({},this.store):new pa({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();let e=this.localTrackMap.get(ne.LocalAudioTrack);if((e==null?void 0:e.track)instanceof on){if(e.track.trackList.length>0){let t=e.track;e.track.trackList.forEach(r=>{t.removeAudioTrack(r)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=xt.Disconnected}getStats(){var e;return(e=this.connection)===null||e===void 0?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return((t=this.connection)===null||t===void 0?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){let e=this.localTrackMap.get(ne.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){let e=this.localTrackMap.get(ne.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){let t=this.localTrackMap.get(e);return t&&t.track instanceof Qt||t&&t.track instanceof vr?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;let r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;let r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}getRemoteMedia(e){var t;let r=Array.from(wo(t=this.remoteUserMap).call(t)).find(n=>n.uid===e);return r?{audioTrack:r.audioTrack,audioSSRC:r._audioSSRC,videoTrack:r.videoTrack,videoSSRC:r._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(r=>{let[n]=r;return{uid:n.uid,level:n.audioTrack?100*n.audioTrack._source.getAccurateVolumeLevel():0}}),t=this.localTrackMap.get(ne.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Vy(e).call(e,(r,n)=>r.level-n.level),e}async disconnectForReconnect(){this.connection&&(b.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=xt.Reconnecting,D("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t]=e;var r;t._videoTrack&&t._videoTrack._player&&((r=t._videoTrack._player.getVideoElement())===null||r===void 0||r.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())}),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.isPlanB?new qm({},this.store):new pa({},this.store),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var t;let[r,{track:n}]=e;switch(r){case ne.LocalVideoTrack:pe(t=n._hints).call(t,nr.LOW_STREAM)?n.close():this.pendingLocalTracks.push(n);break;case ne.LocalAudioTrack:n instanceof on?this.pendingLocalTracks=this.pendingLocalTracks.concat(n.trackList):this.pendingLocalTracks.push(n);case ne.LocalVideoLowTrack:}}),this.emit(Ne.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;Array.from(wo(r).call(r)).forEach(n=>{this.setPendingRemoteMedia(t,n)}),this.emit(Ne.MediaReconnectStart,t.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(e=>{this.pendingLocalDataChannels.push(e)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(e=>{let[t,r]=e;Array.from(wo(r).call(r)).forEach(n=>{this.setPendingRemoteDataChannel(t,n)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),b.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,t){for(let r of this.pendingRemoteDataChannels){let{user:n,id:i}=r;if((e instanceof ql?e.uid:e)===n.uid&&i===t)return!0}return!1}setPendingRemoteDataChannel(e,t){this.hasPendingRemoteDataChannel(e,t)||this.pendingRemoteDataChannels.push({user:e,id:t})}hasPendingRemoteMedia(e,t){for(let r of this.pendingRemoteTracks){let{user:n,kind:i}=r;if((e instanceof ql?e.uid:e)===n.uid&&t===i)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e){var t=this;return Ia(function*(){if(!t.connection||t.state!==xt.Connected)return;let r=yield wt(t.mutex.lock("From P2PChannel.restartICE")),n;try{n=yield wt(t.connection.restartICE(e));let o=yield wt(n.next());if(o.done)return;let s=o.value,a=yield s;switch(t.reportPCDisconnectedOrFailed(e),e){case so.TCP:t._pcStatsUploadType=Pc.TCP_RESTART;break;case so.RELAY:t._pcStatsUploadType=Pc.RELAY_RESTART;break;default:t._pcStatsUploadType=Pc.OLD_RESTART}t._isInRestartIce=!0,n.next(a)}catch(o){var i;(i=n)===null||i===void 0||i.throw(o)}finally{r()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;let e=this.connection.getStats(),t=this.localTrackMap.get(ne.LocalVideoTrack),r=this.localTrackMap.get(ne.LocalAudioTrack),n=e.videoSend.find(f=>f.ssrc===(t==null?void 0:t.ssrcs[0].ssrcId)),i=e.audioSend.find(f=>f.ssrc===(r==null?void 0:r.ssrcs[0].ssrcId));if(!n||!i)return 1;let o=is(this,Ne.NeedSignalRTT),s=n?n.rttMs:void 0,a=i?i.rttMs:void 0,c=s&&a?(s+a)/2:s||a,l=(c&&o?(c+o)/2:c||o)||0,d=100*e.sendPacketLossRate*.7/50+.3*l/1500,u=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,p=t==null?void 0:t.track;if(p&&p._encoderConfig&&p._hints.indexOf(nr.SCREEN_TRACK)===-1){let f=p._encoderConfig.bitrateMax,m=e.bitrate.actualEncoded;if(f&&m){let g=(1e3*f-m)/(1e3*f);return nQ[g<.15?0:g<.3?1:g<.45?2:g<.6?3:4][u]}}return u}getDownlinkNetworkQuality(){if(!this.connection)return 0;let e=this.connection.getStats(),t=0;return Array.from(this.remoteUserMap.entries()).forEach(r=>{let[n]=r,i=n._audioSSRC,o=n._videoSSRC,s=e.audioRecv.find(m=>m.ssrc===i),a=e.videoRecv.find(m=>m.ssrc===o);if(!s&&!a)return void(t+=1);let c=is(this,Ne.NeedSignalRTT),l=e.rtt,d=(l&&c?(l+c)/2:l||c)||0,u=s?s.jitterMs:void 0,p=e.recvPacketLossRate,f=.7*p*100/50+.3*d/1500;u&&(f=.6*p*100/50+.2*d/1500+.2*u/400),t+=f<.1?1:f<.17?2:f<.36?3:f<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new de((t,r)=>{this.handleMuteLocalTrack(e,t,r)})}async replaceTrack(e,t){var r;if(b.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(t.getTrackId(),"]")),!this.connection||this.state!==xt.Connected)return;let n=Array.from(this.localTrackMap.entries()).find(o=>{let[,{track:s}]=o;return e===s});if(!n)return;let i=n[0];if(e!==t&&(this.unbindLocalTrackEvents([{track:e,type:i}]),this.bindLocalTrackEvents([{track:t,type:i}]),n[1].track=t),await((r=this.connection)===null||r===void 0?void 0:r.replaceTrack(t,n[1].id)),this.isPlanB){let o=n[1];o.id=t._mediaStreamTrack.id,this.localTrackMap.set(i,o)}if(i===ne.LocalVideoTrack&&!D("DISABLE_DUAL_STREAM_USE_ENCODING")&&Et().supportDualStreamEncoding){let o=this.localTrackMap.get(ne.LocalVideoLowTrack);if(o){let s=e._mediaStreamTrack.clone();o.track._originMediaStreamTrack.stop(),o.track._mediaStreamTrack=s,o.track._originMediaStreamTrack=s,await new de((a,c)=>{this.handleReplaceTrack(o.track,a,c,!0)})}}}filterTobePublishedTracks(e,t,r){let n=[],i=this.getAllTracks();e=Op(e=e.filter(c=>i.indexOf(c)===-1));let o,s=!1,a=this.localTrackMap.get(ne.LocalAudioTrack);for(let c of e){if(c instanceof Qt&&(this.localTrackMap.has(ne.LocalVideoTrack)||s?new X(I.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(n.push({track:c,type:ne.LocalVideoTrack}),s=!0),t)){let l=this.getLowVideoTrack(c,r);n.push({track:l,type:ne.LocalVideoLowTrack})}if(c instanceof vr)if(a){let l=a.track;if(l instanceof on)ZO([c]),l.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0);else{let d=LI([l,c]);b.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(d.getTrackId(),"]")),this.replaceTrack(l,d)}}else o instanceof on?(ZO([c]),o.addAudioTrack(c)):o||!c._useAudioElement&&Et().webAudioMediaStreamDest&&!c._bypassWebAudio?o=LI(o?[c,o]:[c]):o=c}return o&&(b.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(o.getTrackId(),"]")),n.push({track:o,type:ne.LocalAudioTrack})),n}filterTobeUnpublishedTracks(e){let t=[],r=this.getAllTracks();e=Op(e=e.filter(n=>r.indexOf(n)!==-1));for(let n of e){if(n instanceof vr){let i=this.localTrackMap.get(ne.LocalAudioTrack);if(!i)continue;i.track instanceof on?(i.track.removeAudioTrack(n),this.unbindLocalAudioTrackEvents(n),i.track.trackList.length===0&&(t.push([ne.LocalAudioTrack,i]),i.track.close())):t.push([ne.LocalAudioTrack,i])}if(n instanceof Qt){let i=this.localTrackMap.get(ne.LocalVideoTrack);if(!i)continue;t.push([ne.LocalVideoTrack,i]);let o=this.localTrackMap.get(ne.LocalVideoLowTrack);o&&t.push([ne.LocalVideoLowTrack,o])}}return t}filterTobePublishedDataChannels(e){return e=(e=Op(e)).filter(t=>this.localDataChannels.findIndex(r=>r.id===t.id)===-1)}filterTobeUnpublishedDataChannels(e){return e=(e=(e=Op(e)).filter(t=>this.localDataChannels.indexOf(t)!==-1)).filter(t=>t._originDataChannel)}bindLocalTrackEvents(e){e.forEach(t=>{let{track:r,type:n}=t;switch(n){case ne.LocalVideoTrack:r.addListener(fe.GET_STATS,this.handleGetLocalVideoStats),r.addListener(fe.GET_RTC_STATS,this.handleGetRTCStats),r.addListener(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.addListener(fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.addListener(fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case ne.LocalAudioTrack:this.bindLocalAudioTrackEvents(r);case ne.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){e instanceof on?e.trackList.forEach(r=>{r.addListener(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(fe.GET_STATS,this.handleGetLocalAudioStats),r.addListener(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(fe.GET_STATS,this.handleGetLocalAudioStats),e.addListener(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||(e.addListener(fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(fe.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(t=>{let[r,{track:n}]=t;return{track:n,type:r}})),e.forEach(t=>{let{track:r,type:n}=t;switch(n){case ne.LocalVideoTrack:r.off(fe.GET_STATS,this.handleGetLocalVideoStats),r.off(fe.GET_RTC_STATS,this.handleGetRTCStats),r.off(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.off(fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.off(fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case ne.LocalAudioTrack:this.unbindLocalAudioTrackEvents(r);case ne.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof on?e.trackList.forEach(t=>{t.off(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(fe.GET_STATS,this.handleGetLocalAudioStats),t.off(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(fe.GET_STATS,this.handleGetLocalAudioStats),e.off(fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(fe.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof Xp&&t.addListener(fe.GET_STATS,r=>{r(this.handleGetRemoteVideoStats(e))}),t instanceof Jp&&t.addListener(fe.GET_STATS,r=>{r(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(fe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;r.has(we.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),r.has(we.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((r,n)=>{var i;let o,s,{track:a,type:c}=r;switch(c){case ne.LocalAudioTrack:o=Ot.Audio,s={dtx:a instanceof tw&&a._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case ne.LocalVideoTrack:o=pe(i=a._hints).call(i,nr.SCREEN_TRACK)?Ot.Screen:Ot.High,s=Ja(Ja({},oF(a)),{},{codec:this.store.codec,svc_mode:KO()});break;case ne.LocalVideoLowTrack:o=Ot.Low,s=Ja(Ja({},oF(a)),{},{codec:this.store.codec,svc_mode:KO()})}return{stream_type:o,attributes:s,ssrcs:t[n]}})}createGatewayUnpublishMessage(e){return e.map(t=>{var r;let n,[i,{track:o,ssrcs:s,id:a}]=t;switch(i){case ne.LocalVideoTrack:n=pe(r=o._hints).call(r,nr.SCREEN_TRACK)?Ot.Screen:Ot.High;break;case ne.LocalAudioTrack:n=Ot.Audio;break;case ne.LocalVideoLowTrack:n=Ot.Low}return{stream_type:n,ssrcs:s,mid:a}})}assignLocalTracks(e,t){e.forEach((r,n)=>{let{track:i,type:o}=r;this.localTrackMap.set(o,{track:i,id:t[n].id,ssrcs:t[n].localSSRC})})}withdrawLocalTracks(e){e.forEach(t=>{let[r]=t;this.localTrackMap.delete(r)})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{if(b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(t,")")),this.emit(Ne.PeerConnectionStateChange,t),t!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),t==="connected"&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),D("NEW_ICE_RESTART")){var r;if(pe(r=this._restartStates).call(r,t)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;let n=s=>{(e.iceConnectionState==="disconnected"||e.iceConnectionState==="checking"||e.iceConnectionState==="failed")&&(b.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(s)),is(this,Ne.QueryClientConnectionState)==="CONNECTED"&&this.emit(Ne.RequestRestartICE,s))},i=()=>{e.iceConnectionState!=="disconnected"&&e.iceConnectionState!=="checking"&&e.iceConnectionState!=="failed"||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),b.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Ne.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},o=D("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout(()=>{if(D("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Et().supportPCSetConfiguration)n(so.RELAY),this._restartTimer=window.setTimeout(i,o);else if(_r())n(so.UDP),this._restartTimer=window.setTimeout(i,4e3);else{if(n(so.TCP),Et().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout(()=>{n(so.RELAY),this._restartTimer=window.setTimeout(i,o)},o));this._restartTimer=window.setTimeout(i,o)}},800))}}else{if(t==="disconnected"&&e.iceConnectionState==="disconnected")return setTimeout(()=>{e.iceConnectionState==="disconnected"&&D("ICE_RESTART")&&is(this,Ne.QueryClientConnectionState)==="CONNECTED"&&this.emit(Ne.RequestRestartICE)},800),void setTimeout(()=>{e.peerConnectionState==="disconnected"&&(b.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout(()=>this.emit(Ne.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);t==="failed"&&(b.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout(()=>this.emit(Ne.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=t=>{t!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(t,")")),_e.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:t,tag:Er.TRACER}).onSuccess(),this.emit(Ne.IceConnectionStateChange,t)},e.onICETransportStateChange=t=>{b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(t,")"))},e.onDTLSTransportStateChange=t=>{b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(t,")"))},e.onDTLSTransportError=t=>{b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(t,")"))},e.onFirstAudioDecoded=t=>{var r;let n=Array.from(wo(r=this.remoteUserMap).call(r)).find(o=>o._audioSSRC===t);var i;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),(i=n.audioTrack)===null||i===void 0||i.emit(Yp.FIRST_FRAME_DECODED),_e.firstRemoteFrame(this.store.sessionId,vn.FIRST_AUDIO_DECODE,hr.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:$n.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=t=>{var r;let n=Array.from(wo(r=this.remoteUserMap).call(r)).find(i=>i._audioSSRC===t);n&&_e.firstRemoteFrame(this.store.sessionId,vn.FIRST_AUDIO_RECEIVED,hr.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:$n.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(t,r,n)=>{this.reportVideoFirstFrameDecoded(t,r,n)},e.onFirstVideoReceived=t=>{var r;let n=Array.from(wo(r=this.remoteUserMap).call(r)).find(i=>i._videoSSRC===t);n&&_e.firstRemoteFrame(this.store.sessionId,vn.FIRST_VIDEO_RECEIVED,hr.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:$n.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(t,r)=>{let n=t.candidateType==="relay",i=r.candidateType==="relay";r.candidateType!=="unknown"&&n===i||this.emit(Ne.ConnectionTypeChange,n),b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(od(r))," -> ").concat(JSON.stringify(od(t)),")"))},e.onSelectedRemoteCandidateChanged=(t,r)=>{b.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(od(r))," -> ").concat(JSON.stringify(od(t)),")"))},e.onFirstVideoDecodedTimeout=t=>{this.reportVideoFirstFrameDecoded(t,void 0,void 0,!0)},e.getLocalVideoStats=()=>{let t=this.statsCollector.getLocalVideoTrackStats(),r=this.statsCollector.getRTCStats();return Ja(Ja({},t),r)}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.getLocalVideoStats=void 0}filterTobeMutedTracks(e){let t=[];if(this.getAllTracks().indexOf(e)===-1)return t;let r=this.localTrackMap.get(ne.LocalAudioTrack);if(e instanceof vr&&(r==null?void 0:r.track)instanceof on)return r.track.isActive||t.push([ne.LocalAudioTrack,r]),t;let n=Array.from(this.localTrackMap.entries()).find(i=>{let[,{track:o}]=i;return e===o});if(n&&(t.push(n),n[0]===ne.LocalVideoTrack)){let i=this.localTrackMap.get(ne.LocalVideoLowTrack);i&&t.push([ne.LocalVideoLowTrack,i])}return t}filterTobeUnmutedTracks(e){let t=[],r=this.localTrackMap.get(ne.LocalAudioTrack);if(e instanceof vr&&(r==null?void 0:r.track)instanceof on)return r.track.isActive&&t.push([ne.LocalAudioTrack,r]),t;let n=Array.from(this.localTrackMap.entries()).find(i=>{let[,{track:o}]=i;return e===o});if(n)if(n[0]===ne.LocalVideoTrack){t.push(n);let i=this.localTrackMap.get(ne.LocalVideoLowTrack);i&&t.push([ne.LocalVideoLowTrack,i])}else t.push(n);return t}createMuteMessage(e){return e.map(t=>{var r;let n,[i,{track:o,ssrcs:s,id:a}]=t;switch(i){case ne.LocalAudioTrack:n=Ot.Audio;break;case ne.LocalVideoTrack:n=pe(r=o._hints).call(r,nr.SCREEN_TRACK)?Ot.Screen:Ot.High;break;case ne.LocalVideoLowTrack:n=Ot.Low}return{stream_type:n,ssrcs:s,mid:a}})}createUnmuteMessage(e){return e.map(t=>{var r;let n,[i,{track:o,ssrcs:s,id:a}]=t;switch(i){case ne.LocalAudioTrack:n=Ot.Audio;break;case ne.LocalVideoTrack:n=pe(r=o._hints).call(r,nr.SCREEN_TRACK)?Ot.Screen:Ot.High;break;case ne.LocalVideoLowTrack:n=Ot.Low}return{stream_type:n,ssrcs:s,mid:a}})}filterTobeUnSubscribedTracks(e,t){let r=[],n=this.remoteUserMap.get(e);if(!n)return r;if(t){let i=n.get(t);if(!i)return r;r.push([e,{kind:t,id:i}])}else Array.from(n.entries()).forEach(i=>{let[o,s]=i;r.push([e,{kind:o,id:s}])});return r}filterTobeUnSubscribedDataChannels(e,t){let r=[];return t.forEach(n=>{var i;(i=this.remoteDataChannelMap.get(e))!==null&&i!==void 0&&i.has(n.id)&&r.push(n)}),r}createUnsubscribeMessage(e){let t=[];return e.forEach(r=>{let[n,{kind:i,id:o}]=r;switch(i){case we.VIDEO:return void(n._videoSSRC&&t.push({stream_type:we.VIDEO,ssrcId:n._videoSSRC}));case we.AUDIO:return void(n._audioSSRC&&t.push({stream_type:we.AUDIO,ssrcId:n._audioSSRC}))}}),t}createUnsubscribeAllMessage(e){let t=new Map;return e.forEach(r=>{let[n,{kind:i}]=r;if(t.has(n)){let o=t.get(n);i===we.VIDEO?o|=rn.Video:o|=rn.Audio,t.set(n,o)}else i===we.VIDEO?t.set(n,rn.Video):t.set(n,rn.Audio)}),{users:Array.from(t.entries()).map(r=>{let[n,i]=r;return{stream_id:n.uid,stream_type:i}})}}withdrawRemoteTracks(e){e.forEach(t=>{let[r,{kind:n}]=t,i=this.remoteUserMap.get(r);i&&(i.delete(n),Array.from(i.entries()).length===0&&this.remoteUserMap.delete(r))})}async updateBitrateLimit(e){let t=this.localTrackMap.get(ne.LocalVideoTrack),r=this.localTrackMap.get(ne.LocalVideoLowTrack);t&&await t.track.setBitrateLimit(e.uplink),r&&e.low_stream_uplink&&await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(e,t){return e.map((r,n)=>{var i;let{stream_type:o}=r;return(i=t.find(s=>{let{stream_type:a}=s;return o===a}))===null||i===void 0?void 0:i.attributes})}async tryToUnmuteAudio(e){for(let r=0;r<e.length;r++)if(e[r]instanceof vr){var t;let n=this.filterTobeUnmutedTracks(e[r]);if(n.length===0)continue;await((t=this.connection)===null||t===void 0?void 0:t.unmuteLocal(n.map(o=>{let[,{id:s}]=o;return s})));let i=this.createUnmuteMessage(n);return void await Wt(this,Ne.RequestUnmuteLocal,i)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!((t=this.connection)===null||t===void 0||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(Ne.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(Ne.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Tn(ND(this.dtlsFailedCount,Fr)),this.emit(Ne.RequestReconnect)}async reconnectP2P(){let e=Array.from(this.localTrackMap.entries()),t=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),t.length>0&&await Dn(this,Ne.RequestUnpublishForReconnectPC,t),this.disconnectForReconnect(),this.emit(Ne.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(ne.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof Qt)}throwIfTrackTypeNotMatch(e){if(e.filter(t=>t instanceof Qt).length>1)throw new X(I.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(t=>t instanceof vr).length>1&&(e.some(t=>t instanceof vr&&t._bypassWebAudio)||!Et().webAudioMediaStreamDest))throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(let t of e){if(t instanceof Qt&&this.pendingLocalTracks.some(r=>r instanceof Qt))throw new X(I.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof vr&&this.pendingLocalTracks.some(r=>r instanceof vr)&&(!Et().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(r=>r instanceof vr&&r._bypassWebAudio)))throw new X(I.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){let r=!D("DISABLE_DUAL_STREAM_USE_ENCODING")&&Et().supportDualStreamEncoding,n=Ja(Ja({},{width:160,height:120,framerate:15,bitrate:50}),t),i;i=r?e._mediaStreamTrack.clone():QO(e,n);let o=qt(8,"track-low-"),s=new Qt(i,Ja(Ja({},r&&{scaleResolutionDownBy:UO(n,e)}),{},{frameRate:n.framerate,bitrateMax:n.bitrate,bitrateMin:n.bitrate}),void 0,void 0,o);return s.on(Vu.TRANSCEIVER_UPDATED,a=>{e._updateRtpTransceiver(a,xf.LOW_STREAM)}),s._hints.push(nr.LOW_STREAM),e.on("sei-to-send",a=>{s.emit("sei-to-send",a)}),e.addListener(fe.NEED_CLOSE,()=>{s.close()}),s}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof pa){var i,o,s,a;let c=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:l,dtlsTransportState:d,peerConnectionState:u}=this.connection,{local:p,remote:f}=await this.connection.getSelectedCandidatePair();_e.pcStats(this.store.sessionId,{startTime:c,eventElapse:e-c||0,iceconnectionsate:l,dtlsstate:d,connectionstate:u,intSucc:t?1:2,error:n,selectedLocalCandidateProtocol:(i=p==null?void 0:p.protocol)!==null&&i!==void 0?i:"",selectedLocalCandidateType:(o=p.candidateType)!==null&&o!==void 0?o:"",selectedLocalCandidateAddress:"".concat(p.address,":").concat(p.port),selectedRemoteCandidateProtocol:(s=f.protocol)!==null&&s!==void 0?s:"",selectedRemoteCandidateType:(a=f.candidateType)!==null&&a!==void 0?a:"",selectedRemoteCandidateAddress:"".concat(f.address,":").concat(f.port),restartCnt:r,preallocation:this.connection.isPreallocation})}}reportVideoFirstFrameDecoded(e,t,r,n){var i;let o=Array.from(wo(i=this.remoteUserMap).call(i)).find(s=>s._videoSSRC===e);if(o){n||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());let s=this.store.keyMetrics,a=s.subscribe.find(c=>c.userId===o.uid&&c.type==="video");_e.firstRemoteVideoDecode(this.store.sessionId,vn.FIRST_VIDEO_DECODE,hr.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:r,subscribeElapse:$n.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:s.requestAPEnd||0,apStart:s.requestAPStart||0,joinGwEnd:s.joinGatewayEnd||0,joinGwStart:s.joinGatewayStart||0,pcEnd:s.peerConnectionEnd||0,pcStart:s.peerConnectionStart||0,subscriberEnd:(a==null?void 0:a.subscribeEnd)||0,subscriberStart:(a==null?void 0:a.subscribeStart)||0,videoAddNotify:(a==null?void 0:a.streamAdded)||0,state:n?1:0,firstFrame:(a==null?void 0:a.firstFrame)||0})}}async remoteMediaSsrcChanged(e,t,r){if(!this.connection)return!1;let n=this.remoteUserMap.get(e);if(!n)return!1;let i=n.get(t);if(!i)return!1;let o=await this.connection.getRemoteSSRC(i);return o!==void 0&&o!==r}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:r}]=e;t===ne.LocalVideoLowTrack?r._updateRtpTransceiver(void 0,xf.LOW_STREAM):r._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed(e){this.connection&&this.connection instanceof pa&&(this.connection.iceConnectionState!=="disconnected"&&this.connection.iceConnectionState!=="checking"&&this.connection.iceConnectionState!=="failed"||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===Pc.TCP_RESTART&&e===so.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,Pc.DISCONNECTED_OR_FAILED)))}},ve(it.prototype,"startP2PConnection",[ni],Object.getOwnPropertyDescriptor(it.prototype,"startP2PConnection"),it.prototype),ve(it.prototype,"connect",[ni],Object.getOwnPropertyDescriptor(it.prototype,"connect"),it.prototype),ve(it.prototype,"updateRemoteRTPCapabilities",[ni],Object.getOwnPropertyDescriptor(it.prototype,"updateRemoteRTPCapabilities"),it.prototype),ve(it.prototype,"publishDataChannel",[ni],Object.getOwnPropertyDescriptor(it.prototype,"publishDataChannel"),it.prototype),ve(it.prototype,"unpublish",[ni],Object.getOwnPropertyDescriptor(it.prototype,"unpublish"),it.prototype),ve(it.prototype,"unpublishDataChannel",[ni],Object.getOwnPropertyDescriptor(it.prototype,"unpublishDataChannel"),it.prototype),ve(it.prototype,"unpublishLowStream",[ni],Object.getOwnPropertyDescriptor(it.prototype,"unpublishLowStream"),it.prototype),ve(it.prototype,"subscribeDataChannel",[ni],Object.getOwnPropertyDescriptor(it.prototype,"subscribeDataChannel"),it.prototype),ve(it.prototype,"subscribe",[ni],Object.getOwnPropertyDescriptor(it.prototype,"subscribe"),it.prototype),ve(it.prototype,"massSubscribe",[ni],Object.getOwnPropertyDescriptor(it.prototype,"massSubscribe"),it.prototype),ve(it.prototype,"unsubscribe",[ni],Object.getOwnPropertyDescriptor(it.prototype,"unsubscribe"),it.prototype),ve(it.prototype,"unsubscribeDataChannel",[ni],Object.getOwnPropertyDescriptor(it.prototype,"unsubscribeDataChannel"),it.prototype),ve(it.prototype,"massUnsubscribe",[ni],Object.getOwnPropertyDescriptor(it.prototype,"massUnsubscribe"),it.prototype),ve(it.prototype,"muteRemote",[ni],Object.getOwnPropertyDescriptor(it.prototype,"muteRemote"),it.prototype),ve(it.prototype,"unmuteRemote",[ni],Object.getOwnPropertyDescriptor(it.prototype,"unmuteRemote"),it.prototype),ve(it.prototype,"hasRemoteMediaWithLock",[ni],Object.getOwnPropertyDescriptor(it.prototype,"hasRemoteMediaWithLock"),it.prototype),ve(it.prototype,"disconnectForReconnect",[ni],Object.getOwnPropertyDescriptor(it.prototype,"disconnectForReconnect"),it.prototype),ve(it.prototype,"updateBitrateLimit",[ni],Object.getOwnPropertyDescriptor(it.prototype,"updateBitrateLimit"),it.prototype),ve(it.prototype,"remoteMediaSsrcChanged",[ni],Object.getOwnPropertyDescriptor(it.prototype,"remoteMediaSsrcChanged"),it.prototype),it);function ni(e,t,r){let n=e[t];if(typeof n!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){let i=this.mutex,o=await i.lock("From P2PChannel.".concat(t));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return await n.apply(this,a)}finally{o()}},r}var fZ={};function Xm(e){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&b.debug("install service ".concat(e.name)),fZ[e.name]=e}function mg(e){let t=fZ[e];if(!t)throw new X(I.INVALID_OPERATION,"".concat(e," not found, please use AgoraRTC.use(").concat(e,"Service) to load it first"));return t}function d6(e,t){return mg("DataStream").create(e,t)}function u6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function h6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u6(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var BMe=Date.now(),$Me=20,tN=new Map,b_=new Map;async function mZ(e){let t=tN.get(e),r=Array.isArray(t)&&t[t.length-1],n=b_.get(e);if(!r)return void(n.isSyncing=!1);let i={uid:r.uid,payload:r.payload};n.firstRecvTs===0&&(n.firstRecvTs=r.recvTs,n.firstSendTs=r.sendTs);let o=r.sendTs-n.firstSendTs,s=o-(Date.now()-n.firstRecvTs);s>0&&(n.firstRecvTs=Date.now()-o);let a=r.mediaDelay+s;a<=0?(t.pop(),gZ(r.context,i),a=0):a=Math.min(a,$Me),setTimeout(()=>t.length&&mZ(e),a)}function gZ(e,t){e.safeEmit(ut.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)}function HMe(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return gZ(r,{uid:e.uid,payload:e.payload});let n="".concat(r.id,"-").concat(e.uid),i=tN.get(n)||[],o=i.findIndex(l=>e.sendTs>=l.sendTs),s=h6(h6({},e),{},{context:r,mediaDelay:t,recvTs:Date.now()});o===-1?i.push(s):i.splice(o,0,s),tN.set(n,i);let a=!1;var c;b_.has(n)?a=!((c=b_.get(n))===null||c===void 0||!c.isSyncing):b_.set(n,{isSyncing:a,firstRecvTs:0,firstSendTs:0}),a||mZ(n)}var WMe=yt().name;function p6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function f6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p6(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ef="websdk_ng_cache_parameter",GMe=D("MAX_PRELOAD_ASYNC_LENGTH"),zMe=1e4,mu=new Map,gu=[],jI=null,UI=0,FI=0,bE=new Map,KMe=function(e,t){let r=[],n=0,i=async()=>{let o=r.shift();o&&await o(),r.length>0&&n<t?i():n--};return async function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return new de(async(c,l)=>{r.push(async()=>{try{let d=await e(...s);c(d)}catch(d){l(d)}}),n<t&&(n++,i())})}}(yZ,GMe),VI=Li.CancelToken.source();async function yZ(e,t,r,n,i,o){try{if(!D("ENABLE_PRELOAD"))return;if(!Et().supportWebCrypto)return void Nd(()=>{b.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!r&&r!==null)throw new X(I.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&En(r,"token",1,2047),En(e,"appid",1,2047),rT(t),n&&nT(n);let s=Np();b.debug("preload channel ".concat(t,", uid is ").concat(n));let a={appId:e,cname:t,token:r||e,uid:typeof n!="string"?n:null,sid:s,proxyServer:i},c,l;typeof n=="string"?(a.stringUid=n,[l,c]=await de.all([pMe(n,{sid:s,appId:e},VI.token),EB(f6(f6({},a),{},{token:r||e,uid:0}),VI.token)]),a.uid=l.uid,c.gatewayInfo.uid=a.uid,c.gatewayInfo.res.uid=a.uid):(o&&(a.stringUid=o),c=await EB(a,VI.token));let d={sid:s,appId:e,cname:t,token:r||e,uid:a.stringUid||n,intUid:a.uid||c.gatewayInfo.uid,stringUid:a.stringUid,ts:Date.now(),sua:l,ap:c};await async function(u){let p;try{u.uid&&vZ({appId:u.appId,cname:u.cname,token:u.token,uid:u.uid,stringUid:u.stringUid});let f=bZ(u),m=await async function(y,v){try{let E=await window.crypto.subtle.importKey("raw",JJ(v),"AES-GCM",!1,["encrypt"]),w=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},E,Tu(window.btoa(JSON.stringify(y))));return Ed(new Uint8Array(w))}catch{return}}(u,u.token||u.appId);if(!m)return;p=_Z(ef);let g=p?JSON.parse(p):[];g.push({[f]:m}),g.length>D("AP_CACHE_NUM")&&g.shift(),aw(ef,JSON.stringify(g))}catch(f){b.warn("Error caching server parameters:",f.message),aw(ef,"")}}(d),UI++}catch(s){throw FI++,function(a){jI||(jI=window.setTimeout(()=>{let l="";bE.forEach((d,u)=>{l+="".concat(u,": ").concat(d," ;")}),_e.reportApiInvoke(null,{name:Gr.PRELOAD,options:{success:UI,failed:FI,err:l}}).onError(a),UI=0,FI=0,bE.clear(),jI=null},zMe));let c=bE.get(a.code)||0;bE.set(a.code,c+1)}(s),s}}async function m6(e){try{let t=vZ(e);if(!t||e.cloudProxyServer!=="disabled")return;let r=await async function(n,i){try{let o=await window.crypto.subtle.importKey("raw",JJ(i),"AES-GCM",!1,["decrypt"]),s=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},o,Tu(n));return JSON.parse(window.atob(Ed(new Uint8Array(s))))}catch{return}}(t,e.token||e.appId);if(!r||!function(n,i){return n.cname===i.cname&&n.appId===i.appId&&n.token===i.token?i.stringUid?n.stringUid===i.stringUid:typeof i.uid=="number"?n.uid===i.uid:n.uid==i.uid:!1}(r,e))return;if(r&&Date.now()-r.ts<D("AP_CACHE_LIFETIME"))return r}catch(t){b.warn("Error get preloadInfo",t.message)}}function vZ(e){let t;try{if(t=_Z(ef),!t)return;let r=JSON.parse(t),n=bZ(e),i=function(s,a){for(let c=s.length-1;c>=0;c--)if(a(s[c]))return c;return-1}(r,s=>n in s);if(i===-1)return;let o=r.splice(i,1)[0];return aw(ef,JSON.stringify(r)),o[n]}catch(r){b.warn("Error delete preload info: ".concat(t),r.message),aw(ef,"")}}function e2(e){if(e){let t=mu.get(e);t&&(window.clearTimeout(t),t=null,mu.delete(e)),pe(gu).call(gu,e)||e.cloudProxyServer!=="disabled"||gu.push(e)}if(mu.size<D("AP_CACHE_NUM")&&gu.length>0){let t=gu.shift();mu.set(t,window.setTimeout(async()=>{let{appId:r,cname:n,token:i,stringUid:o,uid:s,proxyServer:a}=t;try{await KMe(r,n,i,s,a,o),mu.has(t)&&e2(t)}catch(c){b.warn("update preload failed",c.message),EZ(t)}},D("AP_UPDATE_INTERVAL")))}}function EZ(e){let t=gu.indexOf(e);t!==-1&&gu.splice(t,1);let r=mu.get(e);r&&(window.clearTimeout(r),r=null,mu.delete(e),e2())}function g6(e,t){let r=e.sua,n=e.ap;t&&r&&_e.reqUserAccount(e.sid,{lts:r.requestTime,elapse:r.elapse,success:!0,serverAddr:r.url,stringUid:t,uid:e.intUid,errorCode:null,extend:r.req}),_e.reportResourceTiming(e.ap.url,e.sid),_e.joinWebProxyAP(e.sid,{lts:n.requestTime,elapse:n.elapse,sucess:1,apServerAddr:n.url,turnServerAddrList:n.proxyInfo.addresses.map(i=>i.ip).join(","),eventType:"disabled",unilbsServerIds:[Pr.CHOOSE_SERVER,Pr.CLOUD_PROXY_FALLBACK].toString()}),_e.joinChooseServer(e.sid,{lts:n.requestTime,elapse:n.elapse,succ:!0,csAddr:n.url,opid:n.opid,serverList:n.gatewayInfo.gatewayAddrs.map(i=>i.address),ec:null,cid:n.gatewayInfo.cid.toString(),uid:n.gatewayInfo.uid.toString(),csIp:n.gatewayInfo.csIp,unilbsServerIds:[Pr.CHOOSE_SERVER].toString(),isHttp3:n.isHttp3})}function _Z(e){return window.atob(window.localStorage.getItem(e)||"")}function aw(e,t){window.localStorage.setItem(e,window.btoa(t))}function bZ(e){let t="".concat(e.appId,"_").concat(e.cname);return typeof e.uid=="string"&&(t+="_s_".concat(e.uid)),typeof e.uid=="number"&&(t+="_".concat(e.uid)),e.token&&(t+="_".concat(e.token)),ZJ(t)}function qMe(e){let t=function(){let r=JMe.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(r,n){let i=r.appId;i!==void 0&&(Nr(n,10),Ll(n,i));let o=r.cid;o!==void 0&&(Nr(n,16),Nr(n,o));let s=r.cname;s!==void 0&&(Nr(n,26),Ll(n,s));let a=r.deviceId;a!==void 0&&(Nr(n,34),Ll(n,a));let c=r.elapse;c!==void 0&&(Nr(n,40),Ml(n,c));let l=r.fileSize;l!==void 0&&(Nr(n,48),Ml(n,Qh(l)));let d=r.height;d!==void 0&&(Nr(n,56),Ml(n,Qh(d)));let u=r.jpg;u!==void 0&&(Nr(n,66),Nr(n,u.length),y6(n,u));let p=r.networkType;p!==void 0&&(Nr(n,72),Ml(n,Qh(p)));let f=r.osType;f!==void 0&&(Nr(n,80),Ml(n,Qh(f)));let m=r.requestId;m!==void 0&&(Nr(n,90),Ll(n,m));let g=r.sdkVersion;g!==void 0&&(Nr(n,98),Ll(n,g));let y=r.sequence;y!==void 0&&(Nr(n,104),Ml(n,Qh(y)));let v=r.sid;v!==void 0&&(Nr(n,114),Ll(n,v));let E=r.timestamp;E!==void 0&&(Nr(n,120),Ml(n,E));let w=r.uid;w!==void 0&&(Nr(n,128),Nr(n,w));let S=r.vid;S!==void 0&&(Nr(n,136),Nr(n,S));let A=r.width;A!==void 0&&(Nr(n,144),Ml(n,Qh(A)));let N=r.service;N!==void 0&&(Nr(n,152),Nr(n,N));let L=r.callbackData;L!==void 0&&(Nr(n,162),Nr(n,L.length),y6(n,L));let j=r.ticket;j!==void 0&&(Nr(n,170),Ll(n,j));let W=r.vendorConfigs;W!==void 0&&(Nr(n,178),Ll(n,W))}(e,t),function(r){let n=r.bytes,i=r.limit;return n.length===i?n:n.subarray(0,i)}(t)}function YMe(e){return function(r){let n={};e:for(;!QMe(r);){let i=gg(r);switch(i>>>3){case 0:break e;case 1:n.code=gg(r);break;case 2:n.msg=v6(r,gg(r));break;case 3:n.requestId=v6(r,gg(r));break;case 4:n.timestamp=ZMe(r,!1);break;default:XMe(r,7&i)}}return n}({bytes:t=e,offset:0,limit:t.length});var t}function XMe(e,t){switch(t){case 0:for(;128&Fs(e););break;case 2:BI(e,gg(e));break;case 5:BI(e,4);break;case 1:BI(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function Qh(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}var JMe=[];function BI(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function QMe(e){return e.offset>=e.limit}function oT(e,t){let r=e.bytes,n=e.offset,i=e.limit,o=n+t;if(o>r.length){let s=new Uint8Array(2*o);s.set(r),e.bytes=s}return e.offset=o,o>i&&(e.limit=o),n}function wZ(e,t){let r=e.offset;if(r+t>e.limit)throw new Error("Read past limit");return e.offset+=t,r}function y6(e,t){let r=oT(e,t.length);e.bytes.set(t,r)}function v6(e,t){let r=wZ(e,t),n=String.fromCharCode,i=e.bytes,o="�",s="";for(let a=0;a<t;a++){let c,l,d,u,p=i[a+r];128&p?(224&p)==192?a+1>=t?s+=o:(c=i[a+r+1],(192&c)!=128?s+=o:(u=(31&p)<<6|63&c,u<128?s+=o:(s+=n(u),a++))):(240&p)==224?a+2>=t?s+=o:(c=i[a+r+1],l=i[a+r+2],(49344&(c|l<<8))!=32896?s+=o:(u=(15&p)<<12|(63&c)<<6|63&l,u<2048||u>=55296&&u<=57343?s+=o:(s+=n(u),a+=2))):(248&p)==240?a+3>=t?s+=o:(c=i[a+r+1],l=i[a+r+2],d=i[a+r+3],(12632256&(c|l<<8|d<<16))!=8421504?s+=o:(u=(7&p)<<18|(63&c)<<12|(63&l)<<6|63&d,u<65536||u>1114111?s+=o:(u-=65536,s+=n(55296+(u>>10),56320+(1023&u)),a+=3))):s+=o:s+=n(p)}return s}function Ll(e,t){let r=t.length,n=0;for(let s=0;s<r;s++){let a=t.charCodeAt(s);a>=55296&&a<=56319&&s+1<r&&(a=(a<<10)+t.charCodeAt(++s)-56613888),n+=a<128?1:a<2048?2:a<65536?3:4}Nr(e,n);let i=oT(e,n),o=e.bytes;for(let s=0;s<r;s++){let a=t.charCodeAt(s);a>=55296&&a<=56319&&s+1<r&&(a=(a<<10)+t.charCodeAt(++s)-56613888),a<128?o[i++]=a:(a<2048?o[i++]=a>>6&31|192:(a<65536?o[i++]=a>>12&15|224:(o[i++]=a>>18&7|240,o[i++]=a>>12&63|128),o[i++]=a>>6&63|128),o[i++]=63&a|128)}}function Fs(e){return e.bytes[wZ(e,1)]}function E6(e,t){let r=oT(e,1);e.bytes[r]=t}function gg(e){let t,r=0,n=0;do t=Fs(e),r<32&&(n|=(127&t)<<r),r+=7;while(128&t);return n}function Nr(e,t){for(t>>>=0;t>=128;)E6(e,127&t|128),t>>>=7;E6(e,t)}function ZMe(e,t){let r,n=0,i=0,o=0;return r=Fs(e),n=127&r,128&r&&(r=Fs(e),n|=(127&r)<<7,128&r&&(r=Fs(e),n|=(127&r)<<14,128&r&&(r=Fs(e),n|=(127&r)<<21,128&r&&(r=Fs(e),i=127&r,128&r&&(r=Fs(e),i|=(127&r)<<7,128&r&&(r=Fs(e),i|=(127&r)<<14,128&r&&(r=Fs(e),i|=(127&r)<<21,128&r&&(r=Fs(e),o=127&r,128&r&&(r=Fs(e),o|=(127&r)<<7))))))))),{low:n|i<<28,high:i>>>4|o<<24,unsigned:t}}function Ml(e,t){let r=t.low>>>0,n=(t.low>>>28|t.high<<4)>>>0,i=t.high>>>24,o=i===0?n===0?r<16384?r<128?1:2:r<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:i<128?9:10,s=oT(e,o),a=e.bytes;switch(o){case 10:a[s+9]=i>>>7&1;case 9:a[s+8]=o!==9?128|i:127&i;case 8:a[s+7]=o!==8?n>>>21|128:n>>>21&127;case 7:a[s+6]=o!==7?n>>>14|128:n>>>14&127;case 6:a[s+5]=o!==6?n>>>7|128:n>>>7&127;case 5:a[s+4]=o!==5?128|n:127&n;case 4:a[s+3]=o!==4?r>>>21|128:r>>>21&127;case 3:a[s+2]=o!==3?r>>>14|128:r>>>14&127;case 2:a[s+1]=o!==2?r>>>7|128:r>>>7&127;case 1:a[s]=o!==1?128|r:127&r}}var _6={},b6={},cw=4294967296,eje=cw*cw,w6=eje/2;SZ(0,!0);var S6=SZ(0),tje=z0(0,-2147483648,!1),rje=z0(-1,2147483647,!1);function SZ(e,t){let r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=b6[e],n)?n:(r=z0(e,0,!0),i&&(b6[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=_6[e],n)?n:(r=z0(e,e<0?-1:0,!1),i&&(_6[e]=r),r)}function z0(e,t,r){return{low:0|e,high:0|t,unsigned:!!r}}function nje(e,t){if(isNaN(e))return S6;{if(e<=-w6)return tje;if(e+1>=w6)return rje}return e<0?S6:z0(e%cw|0,e/cw|0,t)}function T6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}var ije=class TZ extends fr{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;let r=this._connectionState;this._connectionState=t,this.emit(ga.CONNECTION_STATE_CHANGE,t,r)}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(t){var r;super(),C(this,"name","AgoraRTCImageModeration"),C(this,"_connectionState",qo.CONNECTING),C(this,"_sequence",0),C(this,"_moderationStartTime",void 0),C(this,"_workerConnection",void 0),C(this,"_workerMessageLengthLimit",void 0),C(this,"_qualityRatio",void 0),C(this,"_connectInfo",void 0),C(this,"_cancelTokenSource",Li.CancelToken.source()),C(this,"_retryConfig",void 0),C(this,"_moderationInterval",void 0),C(this,"_moderationTimer",null),C(this,"_moderationMode",1),C(this,"_quality",1),C(this,"_qualityTimer",null),C(this,"_ticket",void 0),C(this,"_moderationIntervalMinimum",void 0),C(this,"_uploadFailedNum",0),C(this,"_uploadNum",0),C(this,"_uploadTimer",null),C(this,"_extraInfo",void 0),C(this,"_vendor",""),C(this,"_encoder",new TextEncoder),C(this,"_moderationId",void 0),C(this,"inspectImage",()=>{if(this.connectionState!==qo.CONNECTED)throw new G(I.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===qo.CONNECTED?this.requestToInspectImage():b.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=qt(5,"image-moderation-"),this._workerMessageLengthLimit=D("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=D("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(r=t.interval)!==null&&r!==void 0?r:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),this._qualityRatio=D("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new V0("worker-"+this._moderationId,Fr),this.on(ga.STATE_CHANGE,(n,i)=>{b.debug("[".concat(this._moderationId,"] Moderation operation :").concat(Wh[n]," ").concat(i||""))}),this.handleWorkerEvents()}async init(t,r){this.emit(ga.STATE_CHANGE,Wh.CONNECT_AP),this._connectInfo=t;let n=this._cancelTokenSource.token;return this._retryConfig=r,new de((i,o)=>{this.on(ga.CONNECTION_STATE_CHANGE,(s,a)=>{s===qo.CONNECTED&&i()}),this.requestAP(t,n,r).then(s=>{this.connectWorker(s)}).catch(s=>{o(s)})})}updateConfig(t){var r;this._moderationInterval=(r=t.interval)!==null&&r!==void 0?r:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),b.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(t))),this.connectionState===qo.CONNECTED&&this.inspectImage()}async requestAP(t,r,n){let i=D("WEBCS_DOMAIN").map(c=>"https://".concat(c,"/api/v1")),o=await function(c,l,d,u){let{appId:p,areaCode:f,cname:m,sid:g,token:y,uid:v}=l;Qp++;let E="moderation_plugin",w={service_name:E,json_body:JSON.stringify({appId:p,areaCode:f,cname:m,command:"allocateEdge",requestId:Qp,seq:Qp,sid:g,appToken:y,ts:Date.now(),uid:v+""})},S,A,N=c[0];return Ua(async()=>{S=Date.now();let L=await Fa(N,{data:w,cancelToken:d,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(A=Date.now()-S,L.code!==0){let V=new G(I.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+L.code,{retry:!0,responseTime:A});throw b.error(V.toString()),V}let j=JSON.parse(L.json_body);if(j.code!==200){let V=new G(I.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(j.code,", reason: ").concat(j.reason),{code:j.code,responseTime:A});throw b.error(V.toString()),V}if(!j.servers||!Array.isArray(j.servers)||j.servers.length===0){let V=new G(I.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:j.code,responseTime:A});throw b.error(V.toString()),V}if(!j.servers.some(V=>!!V.wss)){let V=new G(I.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:j.code,responseTime:A});throw b.error(V.toString()),V}let W=D("IMAGE_MODERATION_WORKER_HOST");return{addressList:j.servers.map(V=>{let{address:Y,wss:Z}=V;if(Y&&Z)return"wss://".concat(Y.replace(/\./g,"-"),".").concat(W,":").concat(Z,"/moderation")}).filter(V=>!!V),workerToken:j.workerToken,vid:j.vid,ticket:j.appTicket,responseTime:A}},(L,j)=>(_e.apworkerEvent(g,{success:!0,sc:200,serviceName:E,responseDetail:JSON.stringify(L.addressList),firstSuccess:j===0,responseTime:A,serverIp:c[j%c.length]}),!1),(L,j)=>(_e.apworkerEvent(g,{success:!1,sc:L.data&&L.data.code||200,serviceName:E,responseTime:A,serverIp:c[j%c.length]}),!!(L.code!==I.OPERATION_ABORTED&&L.code!==I.UNEXPECTED_RESPONSE||L.data&&L.data.retry)&&(N=c[(j+1)%c.length],!0)),u)}(i,t,r,n);this.emit(ga.STATE_CHANGE,Wh.AP_CONNECTED);let{addressList:s,ticket:a}=o;return this._ticket=a,s}async connectWorker(t){this.emit(ga.STATE_CHANGE,Wh.CONNECT_WORKER),await this._workerConnection.init(t,1e4)}handleWorkerEvents(){this._workerConnection.on(Fe.CONNECTED,async()=>{this.emit(ga.STATE_CHANGE,Wh.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=qo.CONNECTED}),this._workerConnection.on(Fe.CLOSED,()=>{this.connectionState=qo.CLOSED}),this._workerConnection.on(Fe.FAILED,()=>{this.connectionState=qo.CLOSED}),this._workerConnection.on(Fe.RECONNECTING,()=>{this.connectionState=this.connectionState===qo.CONNECTED?qo.RECONNECTING:qo.CONNECTING}),this._workerConnection.on(Fe.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){let r=YMe(new Uint8Array(t.data));D("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&b.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(r)),this._uploadNum++,r.code===void 0||r.code===0||(this._uploadFailedNum++,b.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(r.code,", msg is ").concat(r.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{_e.reportApiInvoke(this._connectInfo.sid||null,{name:Gr.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,r.code],tag:Er.TRACER}).onError(new G(I.IMAGE_MODERATION_UPLOAD_FAILED,r.msg)),this._uploadTimer=null},D("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else b.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(Fe.WILL_RECONNECT,(t,r,n)=>{t==="recover"&&n(t),n("tryNext")}),this._workerConnection.on(Fe.REQUEST_NEW_URLS,(t,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(r)})}static intToLong(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}async requestToInspectImage(){let t=is(this,ga.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void(D("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&b.debug("Only the track being played can be inspected"));this._sequence++;let n=await this.generateRequestData(t,r);this._workerConnection.sendMessage(n,!0,!0)}else D("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&b.debug("Only the track being published can be inspected")}async generateRequestData(t,r){let{appId:n,cname:i,cid:o,vid:s,sid:a,uid:c}=r,l=Date.now(),d=await t.getCurrentFrameImage("image/jpeg",this.quality),u=await MQ(d,n,i),p=this._sequence+"-"+o+"-"+c+"-"+l+"-"+qt(12,""),f={appId:n,cid:o,cname:i,deviceId:"",elapse:TZ.intToLong(Number(l-this._moderationStartTime)),fileSize:d.buffer.byteLength,height:d.height,width:d.width,jpg:u,networkType:6,osType:7,requestId:p,sdkVersion:"4.22.0",sequence:this._sequence,sid:a,timestamp:nje(l),uid:c,vid:s,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete f.callbackData;let m=qMe(f);if(m.byteLength<this._workerMessageLengthLimit){if(D("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){let g=function(y){for(var v=1;v<arguments.length;v++){var E=arguments[v]!=null?arguments[v]:{};v%2?T6(Object(E),!0).forEach(function(w){C(y,w,E[w])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(E)):T6(Object(E)).forEach(function(w){Object.defineProperty(y,w,Object.getOwnPropertyDescriptor(E,w))})}return y}({},f);delete g.jpg,b.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(g))}return m}{let g=this.quality*this._qualityRatio;return this.quality=g,await this.generateRequestData(t,{appId:n,cname:i,cid:o,vid:s,sid:a,uid:c})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Li.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=qo.CLOSED,this.emit(ga.STATE_CHANGE,Wh.CLOSED)}};function CZ(e){if(Vt(e.interval,"interval",1e3,1/0),e&&e.extraInfo&&e.extraInfo.length>1024)throw new G(I.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(e&&e.vendor&&e.vendor.length>1024)throw new G(I.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}var oje={name:"ImageModeration",create:function(e){let{config:t}=e;return CZ(t),new ije(t)}},C6,R6,I6,A6,x6,O6,N6,k6,P6,D6,L6,M6,j6,U6,F6,V6,B6,$6,H6,W6,G6,z6,K6,q6,Y6,X6,J6,Q6,Z6,e8,t8,r8,n8,i8,o8,s8,a8,c8,l8,d8,he;function u8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function va(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u8(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}Gn.setLogger(b);var sje=(C6=Oe(),R6=Oe({argsMap:(e,t)=>{if(!Array.isArray(t)){if(!(t instanceof Dp))return[t];t=[t]}return t.map(r=>r?Object(r).toString():"null")}}),I6=Oe({argsMap:(e,t)=>(t||(t=[]),Array.isArray(t)||t.trackMediaType!==cm.DATA?(Array.isArray(t)||(t=[t]),t.map(r=>r.getTrackId())):[t.getChannelId()])}),A6=Oe({argsMap:(e,t,r,n)=>[typeof t=="object"?t.uid:t,r,n]}),x6=Oe({argsMap:(e,t,r)=>[t,r]}),O6=Oe({argsMap:(e,t)=>t.map(r=>{let{user:n,mediaType:i}=r;return[n==null?void 0:n.uid,i]})}),N6=Oe({argsMap:(e,t,r,n)=>[typeof t=="object"?t.uid:t,r,n]}),k6=Oe({argsMap:(e,t)=>t.map(r=>{let{user:n,mediaType:i}=r;return{uid:n==null?void 0:n.uid,mediaType:i}})}),P6=Oe(),D6=Oe(),L6=Oe(),M6=Oe(),j6=Oe(),U6=Oe(),F6=Oe(),V6=Oe(),B6=Oe(),$6=Oe(),H6=Oe(),W6=Oe(),G6=Oe(),z6=Oe(),K6=Oe({argsMap:(e,t)=>[t]}),q6=Oe(),Y6=Oe(),X6=Oe(),J6=Oe(),Q6=Oe(),Z6=Oe(),e8=Oe(),t8=Oe(),r8=Oe({argsMap:(e,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),n8=Oe(),i8=Oe(),o8=Oe(),s8=Oe(),a8=Oe(),c8=Oe(),l8=Oe({reportResult:!0}),d8=Oe(),he=class extends fr{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return((e=this._config)===null||e===void 0?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e){let t;if(super(),C(this,"store",void 0),C(this,"_uid",void 0),C(this,"_channelName",void 0),C(this,"_uintUid",void 0),C(this,"_users",[]),C(this,"_config",void 0),C(this,"_clientId",void 0),C(this,"_appId",void 0),C(this,"_sessionId",null),C(this,"_key",void 0),C(this,"_rtmConfig",{}),C(this,"_joinInfo",void 0),C(this,"_gateway",void 0),C(this,"_statsCollector",void 0),C(this,"_configDistribute",void 0),C(this,"_leaveMutex",new Gn("client-leave")),C(this,"_publishMutex",new Gn("client-publish")),C(this,"_renewTokenMutex",new Gn("client-renewtoken")),C(this,"_subscribeMutex",new Gn("client-subscribe")),C(this,"_encryptionMode","none"),C(this,"_encryptionSecret",null),C(this,"_encryptionSalt",null),C(this,"_encryptDataStream",!1),C(this,"_encryptDataStreamKey",null),C(this,"_encryptDataStreamIv",null),C(this,"_proxyServer",void 0),C(this,"_turnServer",{servers:[],mode:"auto"}),C(this,"_cloudProxyServerMode","disabled"),C(this,"_isDualStreamEnabled",!1),C(this,"_defaultStreamFallbackType",void 0),C(this,"_lowStreamParameter",void 0),C(this,"_streamFallbackTypeCacheMap",new Map),C(this,"_remoteStreamTypeCacheMap",new Map),C(this,"_axiosCancelSource",Li.CancelToken.source()),C(this,"_audioVolumeIndicationInterval",void 0),C(this,"_networkQualityInterval",void 0),C(this,"_userOfflineTimeout",void 0),C(this,"_streamRemovedTimeout",void 0),C(this,"_liveTranscodeStreamingClient",void 0),C(this,"_liveRawStreamingClient",void 0),C(this,"_channelMediaRelayClient",void 0),C(this,"_networkQualitySensitivity","normal"),C(this,"_p2pChannel",void 0),C(this,"_useLocalAccessPoint",!1),C(this,"_setLocalAPVersion",void 0),C(this,"_joinAndNotLeaveYet",!1),C(this,"_numberOfJoinCount",0),C(this,"_remoteDefaultVideoStreamType",void 0),C(this,"_inspect",void 0),C(this,"_moderation",void 0),C(this,"_license",void 0),C(this,"_pendingPublishedUsers",[]),C(this,"ntpAlignErrorCount",0),C(this,"remoteInboundOffset",0),C(this,"_handleLocalTrackEnable",(r,n,i)=>{this.publish(r,!1).then(n).catch(i)}),C(this,"_handleLocalTrackDisable",(r,n,i)=>{this.unpublish(r).then(n).catch(i)}),C(this,"_handleUserOnline",r=>{if(D("BLOCK_LOCAL_CLIENT")&&Jd(r.uid,this.channelName))return void b.debug("[".concat(r.uid,"] will be ignored in local"));this.isStringUID&&typeof r.uid!="string"&&b.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));let n=this._users.find(i=>i.uid===r.uid);if(n)n._trust_in_room_=!0,n._is_pre_created&&(n._is_pre_created=!1,this.safeEmit(ut.USER_JOINED,n));else{let i=new ql(r.uid,r.uint_id||r.uid);this._users.push(i),b.debug("[".concat(this._clientId,"] user online"),r.uid),this.safeEmit(ut.USER_JOINED,i)}}),C(this,"_handleUserOffline",r=>{if(D("BLOCK_LOCAL_CLIENT")&&Jd(r.uid,this.channelName))return;let n=this._users.find(i=>i.uid===r.uid);n&&(this._handleRemoveStream(r),this._handleRemoveDataChannels(r),n._audio_pre_subscribed||n._video_pre_subscribed?n._is_pre_created=!0:Jb(this._users,n),this._remoteStreamTypeCacheMap.delete(n.uid),this._streamFallbackTypeCacheMap.delete(n.uid),b.debug("[".concat(this._clientId,"] user offline"),r.uid,"reason:",r.reason),this.safeEmit(ut.USER_LEAVED,n,r.reason))}),C(this,"_handleAddAudioOrVideoStream",(r,n,i,o,s,a,c)=>{if(D("BLOCK_LOCAL_CLIENT")&&Jd(n,this.channelName))return;let l=this._users.find(u=>u.uid===n);if(!l)return void b.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));b.debug("[".concat(this._clientId,"] stream added with uid ").concat(n,", type ").concat(r)),this.store.subscribe(l.uid,r,void 0,void 0,void 0,Date.now());let d=r==="audio"?l.hasAudio:l.hasVideo;l._uintid||(l._uintid=s||n),r==="audio"?l._trust_audio_stream_added_state_=!0:l._trust_video_stream_added_state_=!0,r==="audio"?(l._audio_added_=!0,i!==void 0&&(l._audioSSRC=i),o!==void 0&&(l._cname=o),a&&(l._audioOrtc=a)):(l._video_added_=!0,i!==void 0&&(l._videoSSRC=i),o!==void 0&&(l._cname=o),c!==void 0&&(l._rtxSsrcId=c),a&&(l._videoOrtc=a)),(r==="audio"?l.hasAudio:l.hasVideo)&&!d&&(b.info("[".concat(this._clientId,"] remote user ").concat(l.uid," published ").concat(r)),this.safeEmit(ut.USER_PUBLISHED,l,r)),r==="video"?_e.onGatewayStream(this._sessionId,vn.ON_ADD_VIDEO_STREAM,hr.ON_ADD_VIDEO_STREAM,{peer:s||n,ssrc:l._videoSSRC}):_e.onGatewayStream(this._sessionId,vn.ON_ADD_AUDIO_STREAM,hr.ON_ADD_AUDIO_STREAM,{peer:s||n,ssrc:l._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(l,r,i).then(u=>{if(u&&(b.debug("[".concat(this._clientId,"] resubscribe ").concat(r," for user ").concat(l.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof _E))return this._p2pChannel.unsubscribe(l,r,!0).then(()=>this._subscribe(l,r,!0).catch(p=>{b.error("[".concat(this._clientId,"] resubscribe error"),p.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(l,r)&&(b.debug("[".concat(this._clientId,"] resubscribe ").concat(r," for user ").concat(l.uid," after reconnect.")),this._subscribe(l,r,!0).catch(u=>{b.error("[".concat(this._clientId,"] resubscribe error"),u.toString())}))}),C(this,"_handleRemoveStream",r=>{if(D("BLOCK_LOCAL_CLIENT")&&Jd(r.uid,this.channelName))return;let n=this._users.find(o=>o.uid===r.uid);if(!n)return void b.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));b.debug("[".concat(this._clientId,"] stream removed with uid ").concat(r.uid));let i=()=>{};n.hasAudio&&n.hasVideo?i=()=>{b.info("[".concat(this._clientId,"] remote user ").concat(n.uid," unpublished audio track")),this.safeEmit(ut.USER_UNPUBLISHED,n,"audio"),b.info("[".concat(this._clientId,"] remote user ").concat(n.uid," unpublished video track")),this.safeEmit(ut.USER_UNPUBLISHED,n,"video")}:n.hasVideo?i=()=>{b.info("[".concat(this._clientId,"] remote user ").concat(n.uid," unpublished video track")),this.safeEmit(ut.USER_UNPUBLISHED,n,"video")}:n.hasAudio&&(i=()=>{b.info("[".concat(this._clientId,"] remote user ").concat(n.uid," unpublished audio track")),this.safeEmit(ut.USER_UNPUBLISHED,n,"audio")}),n._video_pre_subscribed||n._audio_pre_subscribed||(n._trust_audio_stream_added_state_=!0,n._trust_video_stream_added_state_=!0,n._audio_added_=!1,n._video_added_=!1,this._p2pChannel instanceof _E&&this._p2pChannel.unsubscribe(n).then(o=>{if(o)return this._gateway.unsubscribe(o,n.uid)}),n._audioSSRC=void 0,n._videoSSRC=void 0,n._audioOrtc=void 0,n._videoOrtc=void 0,n._rtxSsrcId=void 0),_e.onGatewayStream(this._sessionId,vn.ON_REMOVE_STREAM,hr.ON_REMOVE_STREAM,{peer:r.uint_id||r.uid}),i()}),C(this,"_handleSetStreamLocalEnable",(r,n,i)=>{if(D("BLOCK_LOCAL_CLIENT")&&Jd(n,this.channelName))return;let o=this._users.find(c=>c.uid===n);if(!o)return void b.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));b.debug("[".concat(this._clientId,"] local ").concat(r," ").concat(i?"enabled":"disabled"," with uid ").concat(n));let s=r==="audio"?o.hasAudio:o.hasVideo;if(r==="audio"){o._trust_audio_enabled_state_=!0;let c=o._audio_enabled_;if(o._audio_enabled_=i,o._audio_enabled_===c)return;{let l=o._audio_enabled_?"enable-local-audio":"disable-local-audio";b.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(n,", msg: ").concat(l)),this.safeEmit(ut.USER_INFO_UPDATED,n,l)}}else{o._trust_video_enabled_state_=!0;let c=o._video_enabled_;if(o._video_enabled_=i,o._video_enabled_===c)return;{let l=o._video_enabled_?"enable-local-video":"disable-local-video";b.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(n,", msg: ").concat(l)),this.safeEmit(ut.USER_INFO_UPDATED,n,l)}}let a=r==="audio"?o.hasAudio:o.hasVideo;return s!==a?!s&&a?(b.info("[".concat(this._clientId,"] remote user ").concat(n," published ").concat(r)),void this.safeEmit(ut.USER_PUBLISHED,o,r)):(r==="video"&&o._videoTrack&&o._videoTrack._destroy(),r==="audio"&&o._audioTrack,this._p2pChannel.muteRemote(o,r),b.info("[".concat(this._clientId,"] remote user ").concat(n," unpublished ").concat(r)),void this.safeEmit(ut.USER_UNPUBLISHED,o,r)):void 0}),C(this,"_handleMuteStream",(r,n,i)=>{if(D("BLOCK_LOCAL_CLIENT")&&Jd(r,this.channelName))return;b.debug("[".concat(this._clientId,"] receive mute message"),r,n,i);let o=this._users.find(c=>c.uid===r);if(!o)return void b.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(r));let s=n==="audio"?o.hasAudio:o.hasVideo;if(n==="audio"){o._trust_audio_mute_state_=!0;let c=o._audio_muted_;if(o._audio_muted_=i,o._audio_muted_===c)return;{let l=o._audio_muted_?"mute-audio":"unmute-audio";b.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(r,", msg: ").concat(l)),this.safeEmit(ut.USER_INFO_UPDATED,r,l)}}else{o._trust_video_mute_state_=!0;let c=o._video_muted_;if(o._video_muted_=i,o._video_muted_===c)return;{let l=o._video_muted_?"mute-video":"unmute-video";b.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(r,", msg: ").concat(l)),this.safeEmit(ut.USER_INFO_UPDATED,r,l)}}let a=n==="audio"?o.hasAudio:o.hasVideo;if(s!==a){if(!s&&a)return(n==="audio"?o._audioSSRC:o._videoSSRC)?(b.info("[".concat(this._clientId,"] remote user ").concat(r," published ").concat(n)),void this.safeEmit(ut.USER_PUBLISHED,o,n)):void b.warning("[".concat(this._clientId,"] remote user ").concat(r," receive ").concat(n," unmute message  before add stream message, ").concat(n," SSRC doesn't exist yet."));n==="video"&&o._videoTrack&&!o._video_pre_subscribed&&o._videoTrack._destroy(),n==="audio"&&o._audioTrack,this._p2pChannel.muteRemote(o,n),b.info("[".concat(this._clientId,"] remote user ").concat(r," unpublished ").concat(n)),this.safeEmit(ut.USER_UNPUBLISHED,o,n)}}),C(this,"_handleP2PLost",async r=>{b.debug("[".concat(this._clientId,"] receive p2p lost"),r),parseInt(r.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():b.warning("[".concat(this._clientId,"] P2PLost stream not found"),r)}),C(this,"_handleTokenWillExpire",()=>{b.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(ut.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),C(this,"_handleBeforeUnload",r=>{r.type==="beforeunload"&&r.returnValue!==void 0&&r.returnValue!==""||(this.leave(),b.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),C(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(ut.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});let r={downlinkNetworkQuality:0,uplinkNetworkQuality:0};r.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),r.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(ut.NETWORK_QUALITY,r)}),C(this,"_handleP2PAddAudioOrVideoStream",(r,n,i,o)=>{let s=this._users.find(c=>c.uid===n);if(!s)return void b.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));b.debug("[".concat(this._clientId,"] stream added with uid ").concat(n,", type ").concat(r)),this.store.subscribe(s.uid,r,void 0,void 0,void 0,Date.now());let a=r==="audio"?s.hasAudio:s.hasVideo;r==="audio"?s._trust_audio_stream_added_state_=!0:s._trust_video_stream_added_state_=!0,r==="audio"?(s._audio_added_=!0,i!==void 0&&(s._audioSSRC=i),o!==void 0&&(s._audioMid=o)):(s._video_added_=!0,i!==void 0&&(s._videoSSRC=i),o!==void 0&&(s._videoMid=o)),(r==="audio"?s.hasAudio:s.hasVideo)&&!a&&(b.info("[".concat(this._clientId,"] remote user ").concat(s.uid," published ").concat(r)),this.safeEmit(ut.USER_PUBLISHED,s,r)),this._p2pChannel.hasPendingRemoteMedia(s,r)&&(b.debug("[".concat(this._clientId,"] resubscribe ").concat(r," for user ").concat(s.uid," after reconnect.")),this._subscribe(s,r,!0).catch(c=>{b.error("[".concat(this._clientId,"] resubscribe error"),c.toString())}))}),this._config=e,this._clientId=qt(5,"client-"),this.store=new NDe(e.codec,e.audioCodec,e.mode,this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),b.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(os," build: ").concat(DD,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{D3(e.clientRoleOptions),t=Object.assign({},e.clientRoleOptions)}catch(r){b.warning("[".concat(this._clientId,"] ").concat(r.toString()))}this._statsCollector=new dZ(this.store),this._statsCollector.onStatsException=(r,n,i)=>{b.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(r,", msg: ").concat(n,", uid: ").concat(i)),this.safeEmit(ut.EXCEPTION,{code:r,msg:n,uid:i})},this._statsCollector.onUploadPublishDuration=(r,n,i,o)=>{let s=this._users.find(a=>a.uid===r);s&&_e.peerPublishStatus(this._sessionId,{subscribeElapse:o,audioPublishDuration:n,videoPublishDuration:i,peer:s._uintid})},this.store.useP2P=e.mode==="p2p",this._gateway=new aMe(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||Fr,httpRetryConfig:e.httpRetryConfig||Fr,forceWaitGatewayResponse:e.forceWaitGatewayResponse===void 0||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:t}),this._configDistribute=new yMe,this.store.useP2P?(this._p2pChannel=new ro(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new _E(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,t,r,n,i){let o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],s=arguments.length>6&&arguments[6]!==void 0&&arguments[6];Ft("JOIN_GATEWAY_USE_443PORT_ONLY",o),Ft("JOIN_GATEWAY_USE_DUAL_DOMAIN",s);let a=this._gateway.signal.websocket;return a instanceof MD&&(a.use443PortOnly=o,a.tryDoubleDomain=s),async function(c,l,d){Qv.get(c)||Qv.set(c,[]),Zv.get(c)||Zv.set(c,l),Ga.get(c)||Ga.set(c,0);let u=Qv.get(c),p=Zv.get(c);if(!u||!p)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(Ga.get(c)===p){let v=L0();u.push(v),await v.promise}Ga.set(c,Ga.get(c)+1);for(var f=arguments.length,m=new Array(f>3?f-3:0),g=3;g<f;g++)m[g-3]=arguments[g];let y=await d(...m);return Ga.set(c,Ga.get(c)-1),Ga.get(c)===p-1&&u.length>0&&(u[0].resolve(),u.shift()),Ga.get(c)===0&&(Qv.set(c,[]),Zv.set(c,0),Ga.set(c,0)),y}("client.join",D("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,t,r,n,i)}async join(e,t,r,n,i){let o=++this._numberOfJoinCount;this.store.joinStart(),n&&(this.store.uid=n);let s=(tE||tE||(tE=(window.location.protocol.split(":")[0]||"").toUpperCase(),tE))==="HTTPS",a=B3()?window.isSecureContext:"Browser Not Support";(!B3()&&!s||!window.isSecureContext)&&b.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser"),this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),b.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart))),_e.setAppId(e);try{if(!r&&r!==null)throw new G(I.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&En(r,"token",1,2047),En(e,"appid",1,2047),rT(t),n&&nT(n),i&&En(i,"optionalInfo",1,2047)}catch(g){throw _e.reportApiInvoke(Np(),{name:Gr.JOIN,options:[e,t,r,n],states:{isHttps:s,isSecureContext:a},tag:Er.TRACER}).onError(g),g}if(this._leaveMutex.isLocked&&(b.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),b.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){let g=new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw _e.reportApiInvoke(Np(),{name:Gr.JOIN,options:[e,t,r,n],states:{isHttps:s,isSecureContext:a},tag:Er.TRACER}).onError(g),g}this._gateway.state="CONNECTING";let c=await m6({appId:e,cname:t,uid:n,stringUid:typeof n=="string"?n:void 0,token:r||e,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));let l=(c==null?void 0:c.sid)||Np();b.info("[".concat(this._clientId,"] start join channel ").concat(t,", join number: ").concat(o)),this._sessionId||(this._sessionId=l,this.store.sessionId=this._sessionId);let d=_e.reportApiInvoke(l,{name:Gr.JOIN,options:[e,t,r,n],states:{isHttps:s,isSecureContext:a},tag:Er.TRACER}),u=va(va({},this._rtmConfig),{},{clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:typeof n!="string"?n:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:r||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:i,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!c},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(u.setLocalAPVersion=this._setLocalAPVersion),typeof n=="string"&&(u.stringUid=n,this._uintUid?(u.uid=this._uintUid,this._uintUid=void 0):u.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(u.aesmode=this._encryptionMode,u.aespassword=await(async g=>{let y=function(S){let A=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),N=new Uint8Array(new ArrayBuffer(A.length));for(let L=0;L<A.length;L+=1)N[L]=A.charCodeAt(L);return N}(),v=await window.crypto.subtle.importKey("spki",y,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),E=OD(g),w=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},v,E);return function(S){let A="";for(let N=0;N<S.length;N+=1)A+=String.fromCharCode(S[N]);return window.btoa(A)}(new Uint8Array(w))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(u.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){let g=new TextEncoder,y=D("USE_PURE_ENCRYPTION_MASTER_KEY")?g.encode(u.appId+this._encryptionSecret+this._encryptionSecret):g.encode(u.appId+u.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(v,E,w){let S=await window.crypto.subtle.importKey("raw",E,"PBKDF2",!1,["deriveBits","deriveKey"]),A=v==="aes-128-gcm2"?128:256,N=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:H3,hash:"SHA-256",salt:w},S,A+kDe);return new Uint8Array(N).subarray(A/8)}(this._encryptionMode,y,Tu(this._encryptionSalt)),this._encryptDataStreamKey=await async function(v,E,w){let S=await window.crypto.subtle.importKey("raw",E,"PBKDF2",!1,["deriveBits","deriveKey"]),A=v==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:H3,hash:"SHA-256",salt:w},S,{name:"AES-GCM",length:A},!0,["encrypt","decrypt"])}(this._encryptionMode,y,Tu(this._encryptionSalt))}else a?b.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):b.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,b.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:t,appId:e,stringUid:u.stringUid});let p=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&p===this._sessionId&&_e.joinChannelTimeout(this._sessionId,5)},5e3);try{var f;let g,y=u.cloudProxyServer;if(pe(f=["proxy3","proxy4","proxy5"]).call(f,y)){let A=D("PROXY_SERVER_TYPE3");Array.isArray(A)?u.proxyServer=A[0]:u.proxyServer=A}if(_e.setProxyServer(u.proxyServer),b.setProxyServer(u.proxyServer),this.store.requestAPStart(),c){if(b.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(u.stringUid?", ".concat(u.stringUid," => ").concat(c.intUid):""," ")),u.stringUid&&!u.uid&&(u.uid=c.intUid),g={gatewayInfo:c.ap.gatewayInfo},D("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&u.turnServer.mode==="auto")if(c.ap.proxyInfo.addresses.length===0)b.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{let A=(await dQ(c.ap.proxyInfo,c.ap.gatewayInfo.uid)).map(N=>({turnServerURL:N.address,tcpport:N.tcpport||xn.tcpport,udpport:N.udpport||xn.udpport,username:N.username||xn.username,password:N.password||xn.password,forceturn:!1,security:!0}));u.turnServer={mode:"manual",servers:A}}g6(c,u.stringUid)}else{if(u.stringUid&&!u.uid){let A;[A,g]=await de.all([tZ(u.stringUid,u,this._axiosCancelSource.token,this._config.httpRetryConfig||Fr,this.store),vB(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Fr,!0,this.store)]),b.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(u.stringUid," => ").concat(A)),u.uid=A,g.gatewayInfo.uid=A,g.gatewayInfo.res.uid=A}else g=await vB(u,this._axiosCancelSource.token,this._config.httpRetryConfig||Fr,!0,this.store);if(!this._joinAndNotLeaveYet)throw new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(u,this._axiosCancelSource.token),this._configDistribute.on(jO.UPDATE_BITRATE_LIMIT,A=>{this._p2pChannel.updateBitrateLimit(A)})},0),this._key=r||e;let v=g.gatewayInfo,E=u.uid?u.uid:v.uid;this._joinInfo=va(va({},u),{},{cid:v.cid,uid:E,vid:v.vid,apResponse:v.res,apGatewayAddress:v.apGatewayAddress,uni_lbs_ip:v.uni_lbs_ip,gatewayAddrs:v.gatewayAddrs}),this.store.intUid=E;let w=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));d.onSuccess(w),this._appId=e,this._channelName=u.cname,this._uid=w,this.store.uid=w,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(Pn()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);let S=u.stringUid?"string uid: ".concat(u.stringUid,",uid: ").concat(u.uid):"uid: ".concat(this._uid);return b.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(t,",").concat(S)),setTimeout(()=>{b.startUpload()},5e3),this.store.joinEnd(),m=this,pe(zl).call(zl,m)||zl.push(m),this._cloudProxyServerMode==="disabled"&&Et().supportWebCrypto&&D("ENABLE_PRELOAD")&&e2(this._joinInfo),w}catch(g){let y=Array.isArray(g)?g[0]:g;throw y&&y.code===I.OPERATION_ABORTED?b.warning("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),y):b.error("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),y),y.code!==I.OPERATION_ABORTED&&this._numberOfJoinCount===o&&(this._gateway.state="DISCONNECTED",this._reset()),d.onError(y),y}var m}_joinGateway(){if(!this._joinInfo||!this._key)throw new G(I.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!D("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){b.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(Pn()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(t){let r=zl.indexOf(t);r!==-1&&zl.splice(r,1)}(this),this._statsCollector.stopUpdateStats();let e=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return b.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void e();await this._gateway.leave(this.connectionState!=="CONNECTED"),b.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),e()}async publish(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(e)){if(!(e instanceof Dp))return this._publishDataChannel(e);e=[e]}if(e.length===0)throw new G(I.INVALID_PARAMS,"param list is empty");let r=e;if(this._gateway.role==="audience")throw new G(I.INVALID_OPERATION,"audience can not publish stream");for(let i of r){if(!(i instanceof Dp))throw new G(I.INVALID_PARAMS,"parameter is not local track");if(!i._enabled&&t)throw new G(I.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(i.getTrackId()))}b.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(r.map(i=>"".concat(i.getTrackId()," "))));let n=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),t&&r.forEach(i=>{let o=this._configDistribute.getBitrateLimit();i instanceof Qt&&o&&i.setBitrateLimit(o.uplink)});try{await this._publishHighStream(r),b.info("[".concat(this._clientId,"] Publish success, id ").concat(r.map(i=>"".concat(i.getTrackId()," "))))}catch(i){throw b.error("[".concat(this._clientId,"] publish error"),i.toString()),i}finally{n()}}async _publishDataChannel(e){Vt(e.id,"id",0,65535,!0),qc(e.ordered,"ordered"),En(e.metadata,"metadata",0,512),b.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));let t=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(i=>i.id===e.id)!==-1)throw new G(I.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new G(I.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&D("FORCE_TURN")&&!D("TURN_ENABLE_TCP")&&!D("TURN_ENABLE_UDP"))throw new G(I.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");let r=function(i){return d6(i,!1)}(e),n=await this._p2pChannel.publishDataChannel([r]);if(n.length>0){if(typeof r._originDataChannelId!="number")throw b.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new G(I.CREATE_DATACHANNEL_ERROR);try{await de.all(n.map(i=>this._uid&&this._gateway.publishDataChannel(this._uid,i,!0))),await r._waitTillOpen()}catch(i){if(i.code!==I.DISCONNECT_P2P)throw i}}return b.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(r.id)),r}catch(r){throw b.error("[".concat(this._clientId,"] publish datachannels error"),r.toString()),r}finally{t()}}async unpublish(e){if(!this._joinInfo||this._uid===void 0)throw new G(I.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let t=[];if(e)if(Array.isArray(e))t=e;else{if(!(e instanceof Dp))return this._unpublishDataChannel([e]);t=[e]}else this.store.useP2P||await this._unpublishDataChannel(),t=this._p2pChannel.getAllTracks(!0);b.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(t.map(n=>"".concat(n.getTrackId()," "))," "));let r=await this._publishMutex.lock();try{if(this._p2pChannel instanceof ro){let n=await this._p2pChannel.unpublish(t);n&&await this._gateway.sendExtensionMessage(Cr.UNPUBLISH,{unpubMsg:n},!0)}else{let n=await this._p2pChannel.unpublish(t);n&&await this._gateway.unpublish(n,this._uid),b.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(t.map(i=>"".concat(i.getTrackId()))))}}catch(n){throw b.error("[".concat(this._clientId,"] unpublish error"),n.toString()),n}finally{r&&r()}}async _unpublishDataChannel(e){e!==void 0&&e.length!==0||(e=this._p2pChannel.getAllDataChannels()),b.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map(r=>"".concat(r.id," "))," "));let t=await this._publishMutex.lock();try{let r=await this._p2pChannel.unpublishDataChannel(e);r&&await this._gateway.unpublishDataChannel(r),b.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map(n=>"".concat(n.id))))}catch(r){throw b.error("[".concat(this._clientId,"] unpublish dataChannel error"),r.toString()),r}finally{t&&t()}}async subscribe(e,t,r){if(!(e instanceof ql)){let n=this.remoteUsers.find(i=>i.uid===e);if(!n)throw new G(I.INVALID_REMOTE_USER,"user is not in the channel");e=n}return t==="datachannel"?this._subscribeDataChannel(e,r):this._subscribe(e,t)}async presubscribe(e,t){if(Xr(t,"mediaType",["audio","video"]),this._p2pChannel instanceof ro)throw new G(I.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new G(I.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));let r=t===we.AUDIO,n=t===we.VIDEO,i=await this._subscribeMutex.lock();try{let{ssrcId:o,ortc:s,rtxSsrcId:a,cname:c,uint_id:l}=await this._gateway.presubscribe(e,t,!0);if(o==null)throw new G(I.UNEXPECTED_RESPONSE,"no ssrc id");let d=this._users.find(p=>p.uid===e);d||(d=new ql(e,l||e),d._is_pre_created=!0,this._users.push(d)),c&&(d._cname=c),d._uintid||(d._uintid=l||e),r&&(d._audioSSRC=o,d._audio_pre_subscribed=!0,s&&(d._audioOrtc=s)),n&&(d._videoSSRC=o,d._video_pre_subscribed=!0,s&&(d._videoOrtc=s),a!=null&&(d._rtxSsrcId=a)),b.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(o)),await this._p2pChannel.subscribe(d,t,o,a,s);let u=r?d._audioTrack:d._videoTrack;if(!u)throw new G(I.UNEXPECTED_ERROR,"can not find remote track in user");return r&&(d._trust_audio_stream_added_state_=!0,d._audio_added_=!0),n&&(d._trust_video_stream_added_state_=!0,d._video_added_=!0),u}catch(o){throw b.error("[".concat(this._clientId,"] presub user ").concat(e," error"),o),o}finally{i()}}async _subscribeDataChannel(e,t){var r;if(Vt(t,"channelId",0,65535,!0),!this._joinInfo)throw new G(I.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(s=>s===e))throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new G(I.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&e._dataChannels.length===0)throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new G(I.INVALID_REMOTE_USER,"user is not published");let n=(r=e._dataChannels)===null||r===void 0?void 0:r.find(s=>s.id===t);if(!n)throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new G(I.REMOTE_USER_IS_NOT_PUBLISHED);let i=await this._subscribeMutex.lock();b.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{let s=await this._p2pChannel.subscribeDataChannel(e,[n]);if(s&&pe(s).call(s,n.id))try{var o;if(typeof n._originDataChannelId!="number")throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new G(I.CREATE_DATACHANNEL_ERROR);let a={id:n.id,datachannelId:n._originDataChannelId,ordered:n.ordered,maxRetransmits:n.maxRetransmits,metadata:(o=n.metadata)!==null&&o!==void 0?o:""};await this._gateway.subscribeDataChannel(e.uid,a,!0),await n._waitTillOpen()}catch(a){if((a==null?void 0:a.code)!==I.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[n]),a;await this._p2pChannel.unsubscribeDataChannel(e,[n]),this._p2pChannel.setPendingRemoteDataChannel(e,n.id)}return b.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),n}finally{i()}}async _p2pSubscribe(e,t,r){if(Xr(t,"mediaType",["audio","video"]),!this._joinInfo)throw new G(I.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(i=>i===e)){let i=new G(I.INVALID_REMOTE_USER,"user is not in the channel");throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),i}if(!e.hasAudio&&!e.hasVideo){let i=new G(I.INVALID_REMOTE_USER,"user is not published");throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),i}if(!r&&(t==="audio"&&!e.hasAudio||t==="video"&&!e.hasVideo)){let i=new G(I.REMOTE_USER_IS_NOT_PUBLISHED);throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),i}let n=await this._subscribeMutex.lock();b.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{let o=t==="audio"?e._audioSSRC:e._videoSSRC,s=t==="audio"?e._audioMid:e._videoMid;this.store.subscribe(e.uid,t,Date.now()),this._p2pChannel instanceof ro&&await this._p2pChannel.subscribe(e,t,o,s)}catch(o){throw o}b.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(o=>{b.warning("[".concat(this._clientId,"] auto set fallback failed"),o)});let i=t==="audio"?e._audioTrack:e._videoTrack;if(!i)throw new G(I.UNEXPECTED_ERROR,"can not find remote track in user object");return i}catch(i){throw b.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),i),i}finally{n()}}async _subscribe(e,t,r){if(this._p2pChannel instanceof ro)return this._p2pSubscribe(e,t);if(Xr(t,"mediaType",["audio","video"]),!this._joinInfo)throw new G(I.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(c=>c===e)){let c=new G(I.INVALID_REMOTE_USER,"user is not in the channel");throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),c}if(!e.hasAudio&&!e.hasVideo){let c=new G(I.INVALID_REMOTE_USER,"user is not published");throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),c}if(!(r||(t!=="audio"||e.hasAudio&&e._audioSSRC!==void 0)&&(t!=="video"||e.hasVideo&&e._videoSSRC!==void 0))){let c=new G(I.REMOTE_USER_IS_NOT_PUBLISHED);throw b.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),c}let n=t==="audio"?e._audioSSRC:e._videoSSRC,i=t==="audio"?e._audioOrtc:e._videoOrtc,o=t==="video"?e._rtxSsrcId:void 0,s={stream_type:t==="audio"?we.AUDIO:we.VIDEO,ssrcId:n},a=await this._subscribeMutex.lock();b.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{let l=t==="audio"?e._audioSSRC:e._videoSSRC;l!==void 0&&l!==n&&(n=l,i=t==="audio"?e._audioOrtc:e._videoOrtc,o=t==="video"?e._rtxSsrcId:void 0,s={stream_type:t==="audio"?we.AUDIO:we.VIDEO,ssrcId:n}),$n.markSubscribeStart(this.store.clientId,n),this.store.subscribe(e.uid,t,Date.now()),await this._p2pChannel.subscribe(e,t,n,o,i);try{this._p2pChannel.isPreSubScribe(n)||await this._gateway.subscribe(e.uid,s,!0)}catch(d){if((d==null?void 0:d.code)!==I.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,t),d;await this._p2pChannel.unsubscribe(e,t,!0),this._p2pChannel.setPendingRemoteMedia(e,t)}this.store.subscribe(e.uid,t,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(l){throw this._p2pChannel.reportSubscribeEvent(!1,l==null?void 0:l.code,e,t),l}b.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(l=>{b.warning("[".concat(this._clientId,"] auto set fallback failed"),l)});let c=t==="audio"?e._audioTrack:e._videoTrack;if(!c)throw new G(I.UNEXPECTED_ERROR,"can not find remote track in user object");return c}catch(c){throw b.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),c),c}finally{a()}}async massSubscribe(e){if($c(e,"subscribeList"),!this._joinInfo)throw new G(I.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));let t=Date.now(),r=new Map,n=await this._subscribeMutex.lock();b.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map(a=>{let{user:c,mediaType:l}=a;return"user: ".concat(c==null?void 0:c.uid,", mediaType: ").concat(l)}).join("; ")));let i=(e=[...e]).map(a=>{let{user:c,mediaType:l}=a;return{user:c,mediaType:l}}),o=await this._p2pChannel.globalLock();try{var s;for(let c=e.length-1;c>=0;c--){let l=e[c],{user:d,mediaType:u}=l;if(Xr(u,"mediaType",["audio","video"]),!d){let m=new G(I.INVALID_PARAMS,"user property does not exist in subscribeList item");throw b.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),m}if(!this._users.find(m=>m===d)){let m=new G(I.INVALID_REMOTE_USER,"user is not in the channel");b.error("[".concat(this._clientId,"] can not massSubscribe ").concat(d.uid,", this user is not in the channel")),i[c].error=m,e.splice(c,1);continue}if(u==="audio"&&(!d.hasAudio||d._audioSSRC===void 0)||u==="video"&&(!d.hasVideo||d._videoSSRC===void 0)){let m=new G(I.REMOTE_USER_IS_NOT_PUBLISHED);b.error("[".concat(this._clientId,"] can not subscribe ").concat(d.uid," with mediaType ").concat(u,", remote user is not published")),i[c].error=m,e.splice(c,1);continue}let p=rn.Video|rn.LwoVideo,f=r.get(d);if(f){if(u==="video"?f&p:f&rn.Audio){e.splice(c,1),b.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(d.uid,", mediaType:").concat(u," twice"));continue}r.set(d,f|(u==="video"?p:rn.Audio))}else r.set(d,u==="video"?p:rn.Audio)}for(let c=e.length-1;c>=0;c--){let l=e[c],{user:d,mediaType:u}=l,p=rn.Video|rn.LwoVideo;if(this._p2pChannel.hasRemoteMedia(d,u)){await this._p2pChannel.unmuteRemoteNoLock(d,u);let f=r.get(d);r.set(d,u==="video"?f^p:f^rn.Audio),e.splice(c,1)}}this.store.massSubscribe(e.map(c=>({userId:c.user.uid,type:c.mediaType})),t);let a=ka(s=Array.from(r.entries())).call(s,(c,l)=>{let[d,u]=l;if(u===0)return c;let p={stream_id:d.uid,stream_type:u};return u&rn.Audio&&(p.audio_ssrc=d._audioSSRC),u&rn.Video&&(p.video_ssrc=d._videoSSRC),c.push(p),c},[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map(l=>{let{user:d,mediaType:u}=l;return{user:d,mediaType:u,ssrcId:u===we.VIDEO?d._videoSSRC:d._audioSSRC,rtxSsrcId:u===we.VIDEO?d._rtxSsrcId:void 0}}));let c=new Map;if(a=a.filter(l=>l.video_ssrc&&!this._p2pChannel.isPreSubScribe(l.video_ssrc)||l.audio_ssrc&&!this._p2pChannel.isPreSubScribe(l.audio_ssrc)||!l.video_ssrc&&!l.audio_ssrc),a.length>0){let l=await this._gateway.subscribeAll(a,!0);((l==null?void 0:l.users)||[]).forEach(d=>{let{stream_id:u,video_error_code:p,audio_error_code:f,error_code:m}=d;(p||f||m)&&c.set(u,{video_error_code:p,audio_error_code:f,error_code:m})})}if(Array.from(c.entries()).length>0){let l=[];Array.from(c.entries()).forEach(d=>{let[u,p]=d,f=this.remoteUsers.find(m=>m.uid===u);if(f){let m;p.error_code||p.video_error_code&&p.audio_error_code?m=void 0:p.video_error_code?m=we.VIDEO:p.audio_error_code&&(m=we.AUDIO),l.push({user:f,mediaType:m})}}),l.length>0&&await this._p2pChannel.massUnsubscribeNoLock(l)}for(let l of i){let d=c.get(l.user.uid);if(d){let u=d.error_code||l.mediaType==="audio"&&d.audio_error_code||l.mediaType==="video"&&d.video_error_code;if(u){let p=F0(u);b.error("user:".concat(l.user.uid," mediaType:").concat(l.mediaType," has massSubscribe error ").concat(p.desc)),l.error=new G(I.SUBSCRIBE_FAILED,"code ".concat(u,": ").concat(p.desc))}}l.error||(l.mediaType==="video"?l.track=l.user.videoTrack:l.track=l.user.audioTrack)}return this.store.massSubscribe(i.filter(l=>!l.error).map(l=>({userId:l.user.uid,type:l.mediaType})),void 0,Date.now()),i.forEach(l=>{var d;_e.subscribe(this.store.sessionId,{succ:!!l.error,ec:((d=l.error)===null||d===void 0?void 0:d.code)||null,video:l.mediaType===we.VIDEO,audio:l.mediaType===we.AUDIO,peerid:l.user.uid,subscribeRequestid:l.mediaType===we.VIDEO?l.user._videoSSRC:l.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-t),preSsrc:this._p2pChannel.isPreSubScribe(l.user._videoSSRC)},!0)}),b.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map(l=>{let{user:d,mediaType:u}=l;return"user: ".concat(d==null?void 0:d.uid,", mediaType: ").concat(u)}).join("; "))),i}catch(c){throw await this._p2pChannel.massUnsubscribeNoLock(e),c}}finally{o(),n()}}async unsubscribe(e,t,r){if(!(e instanceof ql)){let i=this.remoteUsers.find(o=>o.uid===e);if(!i)throw new G(I.INVALID_REMOTE_USER,"user is not in the channel");e=i}if(t||this.store.useP2P){if(t==="datachannel")return this._unsubscribeDataChannel(e,r)}else await this._unsubscribeDataChannel(e,r);if(t&&Xr(t,"mediaType",["audio","video"]),!this._joinInfo)throw new G(I.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(i=>i===e)){let i=new G(I.INVALID_REMOTE_USER,"user is not in the channel");throw b.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),i}b.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t));let n=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof ro)await this._p2pChannel.unsubscribe(e,t);else{let i=await this._p2pChannel.unsubscribe(e,t);i&&await this._gateway.unsubscribe(i,e.uid),t&&t!=="audio"||(e._audio_pre_subscribed=!1),t&&t!=="video"||(e._video_pre_subscribed=!1),e._is_pre_created&&Jb(this._users,e),b.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t))}}catch(i){if(i.code===I.DISCONNECT_P2P)return void b.warning("disconnecting p2p, abort unsubscribe request.");throw b.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),i.toString()),i}finally{n()}}async _unsubscribeDataChannel(e,t){if(t&&Vt(t,"id",0,65535,!0),!this._joinInfo)throw new G(I.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(n=>n===e)){let n=new G(I.INVALID_REMOTE_USER,"user is not in the channel");throw b.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),n}let r;if(typeof t=="number"){let n=e._dataChannels.find(i=>i.id===t);n&&(r=[n])}else r=e._dataChannels;if(r===void 0){let n=new G(I.REMOTE_USER_IS_NOT_PUBLISHED);throw b.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(t,", remote datachannel is not published")),n}b.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(r.map(n=>n.id)));try{let n=await this._p2pChannel.unsubscribeDataChannel(e,r);n&&await this._gateway.unsubscribeDataChannel(n,e.uid),b.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(n))}catch(n){if(n.code===I.DISCONNECT_P2P)return void b.warning("disconnecting p2p, abort unsubscribe request.");throw b.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),n.toString()),n}}async massUnsubscribe(e){if($c(e,"unsubscribeList"),!this._joinInfo)throw new G(I.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");b.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map(r=>{let{user:n,mediaType:i}=r;return"user: ".concat(n==null?void 0:n.uid,", mediaType: ").concat(i,";")}).join())),e=[...e];let t=new Map;for(let r=e.length-1;r>=0;r--){let{user:n,mediaType:i}=e[r];if(!n){let s=new G(I.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw b.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),s}if(Xr(i,"mediaType",["video","audio",void 0]),!this._users.find(s=>s===n)){b.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid,", user is not in the channel")),e.splice(r,1);continue}let o=rn.Video|rn.LwoVideo;if(t.has(n)){let s=t.get(n),a;switch(i){case"video":a=s&o;break;case"audio":a=s&rn.Audio;break;default:a=s&(rn.Audio|o)}if(a){b.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(n.uid,",mediaType:").concat(i," twice.")),e.splice(r,1);continue}i?i==="audio"?t.set(n,s|rn.Audio):i==="video"&&t.set(n,s|o):t.set(n,s|rn.Audio|o)}else i?i==="audio"?t.set(n,rn.Audio):i==="video"&&t.set(n,o):t.set(n,rn.Audio|o)}try{let r=await this._p2pChannel.massUnsubscribe(e);r&&await this._gateway.massUnsubscribe(r),b.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map(n=>{let{user:i,mediaType:o}=n;return"user: ".concat(i==null?void 0:i.uid,", mediaType: ").concat(o,";")}).join()))}catch(r){if(r.code===I.DISCONNECT_P2P)return void b.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw b.error("[".concat(this._clientId,"] massUnsubscribe error"),r.toString()),r}}async setLowStreamParameter(e){(function(r){if(!r)throw new X(I.INVALID_PARAMS);dr(r.width)||zR(r.width,"streamParameter.width"),dr(r.height)||zR(r.height,"streamParameter.height"),dr(r.framerate)||zR(r.framerate,"streamParameter.framerate"),dr(r.bitrate)||Vt(r.bitrate,"streamParameter.bitrate")})(e),(!e.width&&e.height||e.width&&!e.height)&&b.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),b.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));let t=this._configDistribute.getLowStreamConfigDistribute();if(t&&t.bitrate&&e.bitrate&&t.bitrate<e.bitrate&&(e.bitrate=t.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,ne.LocalVideoLowTrack)}async enableDualStream(){if(!Et().supportDualStream)throw _e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new G(I.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new G(I.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw _e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,_e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),b.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new G(I.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(ne.LocalVideoLowTrack))try{let e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw _e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,_e.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),b.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,t){if(function(r){Xr(r,"role",["audience","host"])}(e),t&&D3(t),this.mode==="rtc"||this.mode==="p2p")throw b.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new G(I.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(t&&t.level&&e==="host")throw new G(I.INVALID_OPERATION,"host mode can not set audience latency level");if(e==="audience"&&this._p2pChannel.hasLocalMedia())throw new G(I.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(e,t),this._config.role=e,b.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level))}getRemoteInboundOffset(){var e;let t=(e=this._p2pChannel.getStats())===null||e===void 0?void 0:e.audioSend[0];if(!t||!t.timestamp)return 0;let r=t.timestamp-Date.now();return Math.abs(r)>1e3+t.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?r:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,t){if(En(e,"proxyServer"),!t){if(this.connectionState!=="DISCONNECTED")throw new G(I.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new G(I.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,_e.setProxyServer(this._proxyServer),b.setProxyServer(this._proxyServer),b.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success."))}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if(this.connectionState!=="DISCONNECTED")throw new G(I.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new G(I.INVALID_OPERATION,"You have already set the proxy")}if(QS(e))return this._turnServer={servers:e,mode:"original-manual"},void b.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map(r=>r.urls).join(","),"."));e.forEach(r=>XJ(r)),this._turnServer={servers:e,mode:"manual"},b.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success."))}setLicense(e){if(this.connectionState!=="DISCONNECTED")throw new G(I.INVALID_OPERATION,"you should set license before join channel");if(En(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new G(I.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,b.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if(this.connectionState!=="DISCONNECTED")throw new G(I.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new G(I.INVALID_OPERATION,"You have already set the proxy");let t=[3,4,5],r;switch(e===void 0&&(e=3),e){case 1:case 2:throw new G(I.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:r="proxy3";break;case 4:r="proxy4";break;case 5:r="proxy5";break;default:throw new G(I.INVALID_PARAMS,"proxy server mode must be ".concat(t.join("|")))}this._cloudProxyServerMode=r,this.store.cloudProxyServerMode=r,b.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new G(I.INVALID_OPERATION,"Stop proxy server after leave channel");_e.setProxyServer(),b.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",b.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new G(I.INVALID_PARAMS,"accessPoints is required.");$c(e.accessPoints.serverList,"accessPoints.serverList"),En(e.accessPoints.domain,"accessPoints.domain");let t=(p,f)=>{Vt(p,f,0,65535,!0)},r=443;if(e.accessPoints.port&&(t(e.accessPoints.port,"accessPoints.port"),r=e.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new G(I.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");D("CLOSE_AFB_FOR_LOCAL_AP")&&(Ft("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),Ft("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));let n=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,i=e.accessPoints.domain,o=e.accessPoints.serverList.map(p=>n.test(p)?"".concat(p.replace(/\./g,"-"),".").concat(i):p),s=o.map(p=>"".concat(p,":").concat(r));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,Ft("WEBCS_DOMAIN",s),Ft("WEBCS_DOMAIN_BACKUP_LIST",s),Ft("GATEWAY_DOMAINS",[i]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?($c(e.report.hostname,"report.hostname"),Ft("EVENT_REPORT_DOMAIN",e.report.hostname[0]),Ft("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(Ft("EVENT_REPORT_DOMAIN",o[0]),Ft("EVENT_REPORT_BACKUP_DOMAIN",o[1]||o[0]));let a=6443;e.report&&e.report.port&&(t(e.report.port,"report.port"),a=e.report.port),Ft("STATS_COLLECTOR_PORT",a),e.report?Ft("ENABLE_EVENT_REPORT",!0):Ft("ENABLE_EVENT_REPORT",!1);let c="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?($c(e.log.hostname,"log.hostname"),c=e.log.hostname[0]):c=o[0];let l=6444;e.log&&e.log.port&&(t(e.log.port,"log.port"),l=e.log.port),Ft("LOG_UPLOAD_SERVER","".concat(c,":").concat(l));let d=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?($c(e.cds.hostname,"cds.hostname"),d=e.cds.hostname):d=o;let u=443;e.cds&&e.cds.port&&(t(e.cds.port,"cds.port"),u=e.cds.port),Ft("CDS_AP",d.map(p=>"".concat(p,":").concat(u))),e.cds?Ft("ENABLE_CONFIG_DISTRIBUTE",!0):Ft("ENABLE_CONFIG_DISTRIBUTE",!1),b.info("set local access point v2 success")}setLocalAccessPoints(e,t){if($c(e,"serverList"),En(t,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new G(I.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");let r=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(n=>r.test(n)?"".concat(n.replace(/\./g,"-"),".").concat(t):n),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,Ft("WEBCS_DOMAIN",e),Ft("WEBCS_DOMAIN_BACKUP_LIST",e),Ft("GATEWAY_DOMAINS",[t]),Ft("EVENT_REPORT_DOMAIN",e[0]),Ft("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),Ft("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),b.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(Xr(e,"streamType",[0,1]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(t){throw b.error("[".concat(this._clientId,"] set default remote video stream type error"),t.toString()),t}else b.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,t){Xr(t,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(e,t),setTimeout(()=>{let r=this._users.find(n=>n.uid===e);r&&r.videoTrack&&r.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(r){throw b.error("[".concat(this._clientId,"] set remote video stream type error"),r.toString()),r}b.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),this._remoteStreamTypeCacheMap.set(e,t)}async setStreamFallbackOption(e,t){Xr(t,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(e,t)}catch(r){throw b.error("[".concat(this._clientId,"] set stream fallback option"),r.toString()),r}b.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),this._streamFallbackTypeCacheMap.set(e,t)}setEncryptionConfig(e,t,r,n){(function(o){Xr(o,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(e),En(t,"secret");let i=["aes-128-gcm2","aes-256-gcm2"];if(pe(i).call(i,e)){if(!r||!(r instanceof Uint8Array&&r.length===32))throw new G(I.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(r)throw new G(I.INVALID_PARAMS,"current encrypt mode does not need salt");if(n){if(qc(n,"encryptDataStream"),!pe(i).call(i,e))throw new G(I.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(t)||b.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=e,this._encryptionSecret=t,r&&(this._encryptionSalt=Ed(r))}async renewToken(e){if(En(e,"token",1,2047),!this._key||!this._joinInfo)throw new G(I.INVALID_OPERATION,"renewToken should not be called before user join");let t=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);let r=await this._renewTokenMutex.lock();try{if(D("USE_NEW_TOKEN")){b.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));let n=await gMe(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Fr);b.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:n})}else b.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});b.debug("[".concat(this._clientId,"] renewToken success"))}catch(n){throw this._key=t,this._joinInfo.token=t,b.error("[".concat(this._clientId,"] renewToken failed"),n.toString()),n}finally{r()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?b.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{let e=this._p2pChannel.getAudioLevels();this.safeEmit(ut.VOLUME_INDICATOR,e)},D("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){let e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}async startLiveStreaming(e,t){if(!t){if(this.codec!=="h264")throw new G(I.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new G(I.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new G(I.LIVE_STREAMING_TASK_CONFLICT);let r=t?Qc.TRANSCODE:Qc.RAW;return this._createLiveStreamingClient(r).startLiveStreamingTask(e,r)}setLiveTranscoding(e){return this._createLiveStreamingClient(Qc.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){let t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(r=>r&&r.hasUrl(e));if(!t.length)throw new G(I.INVALID_PARAMS,"can not find live streaming url to stop");await de.all(t.map(r=>r&&r.stopLiveStreamingTask(e)))}async startChannelMediaRelay(e){JB(e),await this._createChannelMediaRelayClient().startChannelMediaRelay(e)}async updateChannelMediaRelay(e){JB(e),await this._createChannelMediaRelayClient().updateChannelMediaRelay(e)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}async sendStreamMessage(e){var t;let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new G(I.INVALID_OPERATION,"can not send data stream, not joined");if((typeof e=="string"||e instanceof Uint8Array)&&(e={payload:e}),typeof e.payload=="string"){let i=new TextEncoder;e.payload=i.encode(e.payload)}let n=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&pe(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)&&(n=!0,e.payload=await async function(i,o,s){var a;let c=ka(a=Array.from(s)).call(a,(g,y)=>g+y,0),l={serverTs:0,seq:PDe++,length:s.length,checkSum:c},d=new Uint8Array(V3(c,2)),u=new ArrayBuffer(Hh),p=new DataView(u);p.setUint32(0,l.serverTs),p.setUint16(4,l.seq),p.setUint16(6,l.length),p.setUint16(8,l.checkSum);let f=16-s.length%16;s=M3(s,new Uint8Array(f));let m=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i,tagLength:$3,additionalData:d},o,s);return M3(new Uint8Array(u),new Uint8Array(m))}(this._encryptDataStreamIv,this._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new G(I.INVALID_PARAMS,n?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(Me.DATA_STREAM,{payload:Ed(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-BMe},!r)}sendMetadata(e){if(!this._joinInfo)throw new G(I.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new G(I.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(Me.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Ed(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(LDe),!this._joinInfo)throw new G(I.INVALID_OPERATION,"can not send custom report, not joined");await _e.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,t){Xr(t.spatialLayer,"spatialLayer",[0,1,2,3]),Xr(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(r){throw b.error("[".concat(this._clientId,"] pick SVC layer failed"),r.toString()),r}}async setRTMConfig(e){let{apRTM:t=!1,rtmFlag:r}=e;if(qc(t,"apRTM"),Vt(r,"rtmFlag",0),this._rtmConfig.apRTM=t,this._rtmConfig.rtmFlag=r,b.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=t,this._joinInfo.rtmFlag=r,this._gateway.setRTM2Flag(r)}_reset(){if(b.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=Li.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&EZ(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach(t=>t._close()),e._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Gn("client-publish"),this._subscribeMutex=new Gn("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(e,t){var r;let n=e||Np();e?b.debug("[".concat(this._clientId,"] new Session ").concat(n)):b.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(n));let i=e?"":this._sessionId||"";this._sessionId=n,this.store.sessionId=n;let o={lts:new Date().getTime(),mode:this.mode,buildFormat:2,stringUid:(t==null?void 0:t.stringUid)||((r=this._joinInfo)===null||r===void 0?void 0:r.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:i,clientRole:this.role==="audience"?2:1};_e.sessionInit(this._sessionId,va({cname:t.channel,appid:t.appId},o)),this._joinInfo&&(this._joinInfo.sid=n),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=n)}async _publishHighStream(e){if(!this._joinInfo||this._uid===void 0)throw new G(I.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&D("FORCE_TURN")&&!D("TURN_ENABLE_TCP")&&!D("TURN_ENABLE_UDP"))throw new G(I.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");b.debug("[".concat(this._clientId,"] publish high stream"));try{let r=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this._p2pChannel instanceof ro){let n=(await r.next()).value;if(n){try{await this._gateway.sendExtensionMessage(Cr.PUBLISH,n,!0)}catch(i){throw r.throw(i),i}await r.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{let n=(await r.next()).value;if(n){var t;let i;try{i=await this._gateway.publish(this._uid,n,!0)}catch(o){if(o.code!==I.DISCONNECT_P2P)throw r.throw(o),o}await r.next(((t=i)===null||t===void 0?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(let i of e)i instanceof Qt&&i._encoderConfig&&this._gateway.setVideoProfile(i._encoderConfig),!i.muted&&i.enabled||await this._p2pChannel.muteLocalTrack(i)}}catch(r){if(this._p2pChannel.reportPublishEvent(!1,r==null?void 0:r.code,e),(r==null?void 0:r.code)===I.WS_ABORT)return;throw r}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new G(I.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new G(I.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));b.debug("[".concat(this._clientId,"] publish low stream"));let e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{let r=await this._p2pChannel.publishLowStream(this._lowStreamParameter),n=(await r.next()).value;if(n){var t;let i;try{i=await this._gateway.publish(this._uid,n,!0)}catch(o){if(o.code!==I.DISCONNECT_P2P)throw r.throw(o),o}r.next(((t=i)===null||t===void 0?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(r){if(this._p2pChannel.reportPublishEvent(!1,r==null?void 0:r.code,void 0,!0),(r==null?void 0:r.code)===I.WS_ABORT)return;throw r}}_createLiveStreamingClient(e){let t=()=>{if(!this._joinInfo||!this._appId)return new G(I.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();let r=(n={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},mg("LiveStreaming").create(n));var n;return r.onLiveStreamError=(i,o)=>{_e.reportApiInvoke(this._sessionId,{name:Gr.ON_LIVE_STREAM_ERROR,options:[i,o],tag:Er.TRACER}).onSuccess(),this.safeEmit(ut.LIVE_STREAMING_ERROR,i,o)},r.onLiveStreamWarning=(i,o)=>{_e.reportApiInvoke(this._sessionId,{name:Gr.ON_LIVE_STREAM_WARNING,options:[i,o],tag:Er.TRACER}).onSuccess(),this.safeEmit(ut.LIVE_STREAMING_WARNING,i,o)},r.on(MO.REQUEST_WORKER_MANAGER_LIST,(i,o,s)=>{if(!this._joinInfo)return s(new G(I.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(a,c,l,d){let u=D("UAP_AP").slice(0,D("AJAX_REQUEST_CONCURRENT")).map(p=>c.proxyServer?"https://".concat(c.proxyServer,"/ap/?url=").concat(p+"/api/v1?action=uap"):"https://".concat(p,"/api/v1?action=uap"));return await dMe(u,a,c,l,d)})(i,this._joinInfo,this._axiosCancelSource.token,Fr).then(o).catch(s)}),r};return e===Qc.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||t(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||t(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new G(I.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){let{sendResolutionWidth:t,sendResolutionHeight:r}=this.getLocalVideoStats(),n=(e={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:t,height:r}},mg("ChannelMediaRelay").create(e));n.on("state",i=>{i===Bi.RELAY_STATE_FAILURE&&n&&n.dispose(),this.safeEmit(ut.CHANNEL_MEDIA_RELAY_STATE,i)}),n.on("event",i=>{this.safeEmit(ut.CHANNEL_MEDIA_RELAY_EVENT,i)}),this._channelMediaRelayClient=n,this._statsCollector.onStatsChanged=(i,o)=>{var s;i==="resolution"&&((s=this._channelMediaRelayClient)===null||s===void 0||s.setVideoProfile(o))}}var e;return this._channelMediaRelayClient}_handleUpdateDataChannel(e,t){let{added:r,deleted:n}=e,i=[];if(t){let o=[];this._users.forEach(s=>{s._dataChannels.forEach(a=>{r.every(c=>c.uid!==s._uintid||c.stream_id!==a.id)&&o.push({uid:s._uintid,stream_id:a.id,ordered:a.ordered,max_retrans_times:a.maxRetransmits,metadata:a.metadata})})}),o.length>0&&this._handleUpdateDataChannel({added:[],deleted:o})}Array.isArray(r)&&r.length>0&&r.forEach(o=>{let{uid:s,stream_id:a,ordered:c,max_retrans_times:l,metadata:d}=o,u=this._users.find(p=>p._uintid===s);if(!u)return void b.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(b.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(s)),pe(i).call(i,u)||i.push(u),u._uintid||(u._uintid=s),u._dataChannels.findIndex(p=>p.id===o.stream_id)===-1){let p={id:a,ordered:!!c,maxRetransmits:l,metadata:d},f=function(m){return d6(m,!0)}(p);u._dataChannels.push(f),b.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published datachannel")),t||this.safeEmit(ut.USER_PUBLISHED,u,"datachannel",p)}this._p2pChannel.hasPendingRemoteDataChannel(u,o.stream_id)&&(b.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(u.uid," after reconnect.")),this._subscribeDataChannel(u,o.stream_id).catch(p=>{b.error("[".concat(this._clientId,"] resubscribe datachannel error"),p.toString())}))}),t&&(this.safeEmit(ut.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(n)&&n.length>0&&n.forEach(o=>{let{uid:s,stream_id:a}=o,c=this._users.find(d=>d._uintid===s);if(!c)return void b.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));let l=c._dataChannels.find(d=>d.id===o.stream_id);l&&(b.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(s)),this._p2pChannel.unsubscribeDataChannel(c,[l]).then(d=>{if(c._dataChannels=c._dataChannels.filter(u=>u!==l),d)return this._gateway.unsubscribeDataChannel(d,c.uid)}),b.info("[".concat(this._clientId,"] remote user ").concat(s," unpublished datachannel ,id:").concat(l.id)),this.safeEmit(ut.USER_UNPUBLISHED,c,"datachannel",l._config))})}_handleRemoveDataChannels(e){let t=this._users.find(r=>r.uid===e.uid);if(t){if(t._dataChannels!==void 0&&t._dataChannels.length>0){b.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));let r=()=>{b.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished datachannel")),t._dataChannels.forEach(n=>{this.safeEmit(ut.USER_UNPUBLISHED,t,"datachannel",n._config)})};this._p2pChannel.unsubscribeDataChannel(t,t._dataChannels).then(n=>{if(n)return this._gateway.unsubscribeDataChannel(n,t.uid)}),r()}}else b.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(An.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(An.CONNECTION_STATE_CHANGE,(e,t,r)=>{var n;if(r===Mt.FALLBACK)return;let i=()=>{this.safeEmit(ut.CONNECTION_STATE_CHANGE,e,t,r)};if(_e.reportApiInvoke(this._sessionId||((n=this._gateway.joinInfo)===null||n===void 0?void 0:n.sid)||null,{name:Gr.CONNECTION_STATE_CHANGE,options:[e,t,r],tag:Er.TRACER}).onSuccess(JSON.stringify({cur:e,prev:t,reason:r})),b.info("[".concat(this._clientId,"] connection state change: ").concat(t," -> ").concat(e)),e==="DISCONNECTED")return this._reset(),void i();if(e==="RECONNECTING")this._users.forEach(s=>{s._trust_in_room_=!1,s._trust_audio_enabled_state_=!1,s._trust_video_enabled_state_=!1,s._trust_audio_mute_state_=!1,s._trust_video_mute_state_=!1,s._trust_audio_stream_added_state_=!1,s._trust_video_stream_added_state_=!1,s._is_pre_created||(s._audio_pre_subscribed||(s._audioSSRC=void 0,s._audioOrtc=void 0),s._video_pre_subscribed||(s._videoSSRC=void 0,s._videoOrtc=void 0,s._rtxSsrcId=void 0),s._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(e==="CONNECTED"){var o;this._streamFallbackTypeCacheMap.forEach((s,a)=>{this._gateway.setStreamFallbackOption(a,s).catch(c=>{b.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),c)})}),this._remoteStreamTypeCacheMap.forEach((s,a)=>{this._gateway.setRemoteVideoStreamType(a,s).catch(c=>{b.warning("[".concat(this._clientId,"] auto set remote stream type failed"),c)})}),this._remoteDefaultVideoStreamType!==void 0&&((o=this._joinInfo)===null||o===void 0?void 0:o.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{b.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(s=>{b.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(s))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(s=>!s._trust_in_room_).forEach(s=>{b.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(s.uid)),this._handleUserOffline({uid:s.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(s=>{s._trust_audio_mute_state_||(b.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(s.uid)),this._handleMuteStream(s.uid,we.AUDIO,!1)),s._trust_video_mute_state_||(b.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(s.uid)),this._handleMuteStream(s.uid,we.VIDEO,!1)),s._trust_audio_enabled_state_||(b.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(s.uid)),this._handleSetStreamLocalEnable("audio",s.uid,!0)),s._trust_video_enabled_state_||(b.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(s.uid)),this._handleSetStreamLocalEnable("video",s.uid,!0)),s._trust_video_stream_added_state_||(b.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(s.uid)),this._handleResetAddStream(s,"video")),s._trust_audio_stream_added_state_||(b.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(s.uid)),this._handleResetAddStream(s,"audio")),s._video_added_||s._audio_added_||(b.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(s.uid)),this._handleRemoveStream({uid:s.uid,uint_id:s._uintid}))}))},1e3))}i()}),this._gateway.on(An.REQUEST_NEW_GATEWAY_LIST,async(e,t)=>{if(!this._joinInfo)return t(new G(I.UNEXPECTED_ERROR,"can not recover, no join info"));try{let r,n=await m6(va(va({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));n?(r=n.ap,g6(n),this._joinInfo.preload=!0):(r=await YO(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Fr,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=r.gatewayInfo.res,this._joinInfo.gatewayAddrs=r.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=r.gatewayInfo.uni_lbs_ip);let i=[];r.gatewayInfo.gatewayAddrs.forEach(o=>{let{address:s}=o,[a,c]=s.split(":");this._joinInfo&&this._joinInfo.proxyServer?i.push({proxy:this._joinInfo.proxyServer,host:a,port:c}):i.push({host:a,port:c})}),e(i)}catch(r){t(r)}}),this._gateway.on(An.NETWORK_QUALITY,e=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(ut.NETWORK_QUALITY,e)}),this._gateway.on(An.STREAM_TYPE_CHANGE,(e,t)=>{this.safeEmit(ut.STREAM_TYPE_CHANGED,e,t),_e.reportApiInvoke(this._sessionId,{name:Gr.STREAM_TYPE_CHANGE,options:[e,t],tag:Er.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:t}))}),this._gateway.on(An.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(An.REQUEST_P2P_CONNECTION_PARAMS,async(e,t,r)=>{try{let n=await this._p2pChannel.getEstablishParams();D("ENABLE_PREALLOC_PC")&&n||(n=await this._p2pChannel.startP2PConnection(e)),t(n)}catch(n){r(n)}}),this._gateway.on(An.JOIN_RESPONSE,(e,t)=>{if(this.store.useP2P)return;let r=uB(e.ortc,t,e.attributes.userAttributes.preSubSsrcs);this._p2pChannel.connect(r)}),this._gateway.on(An.PRE_CONNECT_PC,async e=>{let{candidates:t,fingerprint:r}=e;if(this._joinInfo&&t.length>0&&!this._p2pChannel.isPlanB){var n;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});let{cert:i,cid:o}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(o,"_").concat(i),icePwd:"".concat(o,"_").concat(i)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(n=D("FINGERPRINT"))!==null&&n!==void 0?n:r}]},candidates:t,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}})}_handleGatewaySignalEvents(){this._gateway.signal.on(ct.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(ct.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(ct.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(ct.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId)),this._gateway.signal.on(ct.ON_REMOTE_DATASTREAM_UPDATE,e=>{this._handleUpdateDataChannel(e)}),this._gateway.signal.on(ct.ON_REMOTE_FULL_DATASTREAM_INFO,e=>{this._handleUpdateDataChannel({added:e.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(ct.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(ct.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(ct.MUTE_AUDIO,e=>this._handleMuteStream(e.uid,we.AUDIO,!0)),this._gateway.signal.on(ct.UNMUTE_AUDIO,e=>this._handleMuteStream(e.uid,we.AUDIO,!1)),this._gateway.signal.on(ct.MUTE_VIDEO,e=>this._handleMuteStream(e.uid,we.VIDEO,!0)),this._gateway.signal.on(ct.UNMUTE_VIDEO,e=>this._handleMuteStream(e.uid,we.VIDEO,!1)),this._gateway.signal.on(ct.RECEIVE_METADATA,e=>{let t=Tu(e.metadata);this.safeEmit(ut.RECEIVE_METADATA,e.uid,t)}),this._gateway.signal.on(ct.ON_DATA_STREAM,async e=>{var t;if(!e)return;let r=Tu(e.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&pe(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)){if(e.payload.length<Hh)throw new G(I.UNEXPECTED_RESPONSE,"payload length ".concat(e.payload.length," is less than header length ").concat(Hh));r=await async function(i,o,s){let a=s.subarray(0,Hh),c=a.slice(8,Hh),l=(c[0]<<8)+c[1],d=(a[6]<<8)+a[7],u=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:i,tagLength:$3,additionalData:new Uint8Array(V3(l,2))},o,s.subarray(Hh));return new Uint8Array(u).subarray(0,d)}(this._encryptDataStreamIv,this._encryptDataStreamKey,r)}let n=0;if(e.ordered||e.syncWithAudio){let i=this._p2pChannel.getStats(),o=this.remoteUsers.find(a=>a.uid===e.uid),s=i==null?void 0:i.audioRecv.find(a=>a.ssrc===(o==null?void 0:o._audioSSRC));n=s==null?void 0:s.jitterBufferMs}n==null&&(n=0),HMe(va(va({},e),{},{payload:r}),n,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(ct.ON_CRYPT_ERROR,()=>{Nd(()=>{b.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(ut.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(ct.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(ct.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{b.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,Mt.TOKEN_EXPIRE),this.safeEmit(ut.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(ct.ON_STREAM_FALLBACK_UPDATE,e=>{b.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(ut.STREAM_FALLBACK,e.stream_id,e.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(ct.ON_PUBLISH_STREAM,e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),b.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))}),this._gateway.signal.on(ct.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(ct.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(je.REQUEST_TIMEOUT,(e,t)=>{if(this._joinInfo)switch(e){case Me.PUBLISH:{if(!t)return;let i=t.ortc;if(i){var r,n;let o=i.some(c=>{let{stream_type:l}=c;return l===Ot.Audio}),s=i.some(c=>{let{stream_type:l}=c;return l!==Ot.Audio}),a=i.some(c=>{let{stream_type:l}=c;return l===Ot.Screen||l===Ot.ScreenLow});t.state==="offer"&&_e.publish(this._joinInfo.sid,{eventElapse:$n.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:I.TIMEOUT,audio:o,video:s,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:a,audioName:o?(r=i.find(c=>{let{stream_type:l}=c;return l===Ot.Audio}))===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId.toString():void 0,videoName:s?(n=i.find(c=>{let{stream_type:l}=c;return l!==Ot.Audio}))===null||n===void 0||(n=n.ssrcs[0])===null||n===void 0?void 0:n.ssrcId.toString():void 0})}break}case Me.SUBSCRIBE:t&&_e.subscribe(this._joinInfo.sid,{succ:!1,ec:I.TIMEOUT,audio:t.stream_type===we.AUDIO,video:t.stream_type===we.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:$n.measureFromSubscribeStart(this.store.clientId,t.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(t.ssrcId)})}}),this._gateway.signal.on(ct.ON_P2P_OK,e=>{this.uid,this._uid}),this._gateway.signal.on(ct.ON_PUBLISHED_USER_LIST,e=>{if(e==null||!e.users)return;D("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter(n=>!Jd(n.string_id||n.stream_id,this.channelName)));let t=[],r=[];for(let n of e.users){let i=this._users.find(d=>d._uintid===n.stream_id);i?i._trust_in_room_=!0:(i=new ql(n.string_id||n.stream_id,n.stream_id),this._users.push(i),this.getListeners(ut.PUBLISHED_USER_LIST).length===0&&(b.debug("[".concat(this._clientId,"] user online"),n.stream_id),this.safeEmit(ut.USER_JOINED,i)));let o=rn.Audio&n.stream_type,s=(rn.Video|rn.LwoVideo)&n.stream_type,a=(65280&n.stream_type)!=0,c=o&&i.hasAudio,l=s&&i.hasVideo;s&&(i._trust_video_stream_added_state_=!0,i._video_added_=!0,i._videoSSRC=n.video_ssrc,i._rtxSsrcId=n.video_rtx),o&&(i._trust_audio_stream_added_state_=!0,i._audio_added_=!0,i._audioSSRC=n.audio_ssrc),o&&!c&&this.getListeners(ut.PUBLISHED_USER_LIST).length===0&&(b.info("[".concat(this._clientId,"] remote user ").concat(i.uid," published audio")),this.safeEmit(ut.USER_PUBLISHED,i,"audio")),s&&!l&&this.getListeners(ut.PUBLISHED_USER_LIST).length===0&&(b.info("[".concat(this._clientId,"] remote user ").concat(i.uid," published video")),this.safeEmit(ut.USER_PUBLISHED,i,"video")),(o&&!c||s&&!l||a)&&t.push(i),s&&this._p2pChannel.hasPendingRemoteMedia(i,"video")&&r.push({user:i,mediaType:"video"}),o&&this._p2pChannel.hasPendingRemoteMedia(i,"audio")&&r.push({user:i,mediaType:"audio"})}r.length>0&&(b.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(r.map(n=>"user: ".concat(n.user.uid,", mediaType: ").concat(n.mediaType)).join("; ")," ")),this.massSubscribe(r).catch(n=>{b.error("[".concat(this._clientId,"] mass resubscribe error"),n.toString())})),this.getListeners(ut.PUBLISHED_USER_LIST).length>0?D("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=t:(b.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(t.map(n=>n.uid).join(", "))),this.safeEmit(ut.PUBLISHED_USER_LIST,t)):b.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(t.map(n=>n.uid).join(", ")))}),this._gateway.signal.on(ct.ON_RTP_CAPABILITY_CHANGE,e=>{let{video_codec:t}=e;this._p2pChannel instanceof _E&&this._p2pChannel.updateRemoteRTPCapabilities(t.map(r=>r.toLowerCase()).filter(r=>{var n;return pe(n=Object.keys(tT)).call(n,r)}))})}_handleP2PEvents(){this._gateway.signal.on(ct.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(Cr.PUBLISH,(e,t,r)=>{let{uid:n}=e;e.forEach(i=>{let{kind:o,ssrcs:s,mid:a,isMuted:c}=i;this._handleP2PAddAudioOrVideoStream(o,n,s[0].ssrcId,a);let l=this._users.find(d=>d.uid===n);return l&&this._p2pChannel instanceof ro?this._p2pChannel.mockSubscribe(l,o,s[0].ssrcId,a).then(()=>{t()}).catch(r):t(),this._handleMuteStream(n,o,!!c)})}),this._gateway.signal.on(Cr.CALL,async(e,t,r)=>{if(this._p2pChannel instanceof ro)try{var n;t(await this._p2pChannel.startP2P({turnServer:(n=this._joinInfo)===null||n===void 0?void 0:n.turnServer},e))}catch(i){r(i)}}),this._gateway.signal.on(je.P2P_CONNECTION,async e=>{this._p2pChannel instanceof ro&&await this._p2pChannel.p2pConnect(e)}),this._gateway.signal.on(Cr.UNPUBLISH,async(e,t,r)=>{if(this._p2pChannel instanceof ro){let{unpubMsg:n,uid:i}=e,o=this._users.find(s=>s.uid===i);if(!o)return b.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(i)),void t();try{n.forEach(async s=>{let{stream_type:a}=s,c=a===Ot.Audio?we.AUDIO:we.VIDEO;await this._p2pChannel.unsubscribe(o,c),this._handleMuteStream(i,c,!0)}),t()}catch(s){r(s)}}}),this._gateway.signal.on(Cr.CONTROL,async(e,t)=>{let{action:r}=e;switch(r){case id.MUTE_LOCAL_VIDEO:this._handleMuteStream(t,we.VIDEO,!0);break;case id.MUTE_LOCAL_AUDIO:this._handleMuteStream(t,we.AUDIO,!0);break;case id.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",t),this._handleMuteStream(t,we.VIDEO,!1);break;case id.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",t),this._handleMuteStream(t,we.AUDIO,!1)}}),this._gateway.signal.on(Cr.RESTART_ICE,async(e,t,r)=>{if(this._p2pChannel instanceof ro)try{let{direction:n,iceParameter:i}=e;n!==yi.SEND_ONLY||i?t(await this._p2pChannel.restartICE(n,i)):(this._p2pChannel.handleDisconnect(n),t())}catch(n){r(n)}}),this._gateway.signal.on(Cr.CANDIDATE,e=>{if(this._p2pChannel instanceof ro){let{candidate:t,direction:r}=e;this._p2pChannel.addRemoteCandidate(t,r)}}),this._p2pChannel.on(Ne.RequestP2PRestartICE,async(e,t,r)=>{try{let{direction:n}=e;t(await this._gateway.sendExtensionMessage(Cr.RESTART_ICE,e,n===yi.SEND_ONLY))}catch(n){r(n)}}),this._p2pChannel.on(Ne.LocalCandidate,e=>{this._gateway.sendExtensionMessage(Cr.CANDIDATE,JSON.stringify(e),!0)}),this._p2pChannel.on(Ne.RequestP2PMuteLocal,async(e,t,r)=>{try{await this._gateway.sendExtensionMessage(Cr.CONTROL,e,!0),t()}catch(n){r(n)}}),this._p2pChannel.on(Ne.RequestP2PUnmuteRemote,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(n){n.code===I.DISCONNECT_P2P?t():r(n)}else t()}),this._p2pChannel.on(Ne.RequestP2PMuteRemote,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(n){n.code===I.DISCONNECT_P2P?t():r(n)}else t()}),this._p2pChannel.on(Ne.StateChange,(e,t)=>{t===xt.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Ne.RequestMuteLocal,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(n){n.code===I.DISCONNECT_P2P?t():r(n)}else t()}),this._p2pChannel.on(Ne.RequestUnmuteLocal,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(n){n.code===I.DISCONNECT_P2P?t():r(n)}else t()}),this._p2pChannel.on(Ne.RequestRePublish,(e,t,r)=>{this.publish(e,!1).then(t).catch(r)}),this._p2pChannel.on(Ne.RequestRePublishDataChannel,(e,t,r)=>{de.all(e.map(async n=>{let i=await this._p2pChannel.publishDataChannel([n]);try{i.forEach(o=>{this._uid&&this._gateway.publishDataChannel(this._uid,o,!0)})}catch(o){if(o.code!==I.DISCONNECT_P2P)throw o}})).then(t).catch(r)}),this._p2pChannel.on(Ne.RequestReSubscribe,async(e,t,r)=>{try{for(let{user:n,kind:i}of e)i===we.VIDEO?await this.subscribe(n,"video"):await this.subscribe(n,"audio");t()}catch(n){r(n)}}),this._p2pChannel.on(Ne.RequestUpload,(e,t)=>{this._gateway.upload(e,t)}),this._p2pChannel.on(Ne.RequestUploadStats,e=>{this._gateway.uploadWRTCStats(e)}),this._p2pChannel.on(Ne.MediaReconnectStart,e=>{this.safeEmit(ut.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(Ne.MediaReconnectEnd,e=>{this.safeEmit(ut.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(Ne.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(Ne.RequestRestartICE,async e=>{if(this._p2pChannel instanceof ro)return;let t=await this._p2pChannel.restartICE(e),r=await t.next();if(r.done)return;let n=r.value,i;try{i=await this._gateway.restartICE({iceParameters:n})}catch(s){return void t.throw(s)}let{iceParameters:o}=function(s){let a=s.iceParameters;return{iceParameters:{iceUfrag:a.iceUfrag,icePwd:a.icePwd}}}(i);await t.next({remoteIceParameters:o})}),this._p2pChannel.on(Ne.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Ne.RequestReconnectPC,async()=>{var e;let{iceParameters:t,dtlsParameters:r,rtpCapabilities:n}=await this._p2pChannel.startP2PConnection({turnServer:(e=this._joinInfo)===null||e===void 0?void 0:e.turnServer}),{gatewayEstablishParams:i,gatewayAddress:o}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:r,rtpCapabilities:n}),s=uB(i,o);await this._p2pChannel.connect(s),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Ne.RequestUnpublishForReconnectPC,async(e,t,r)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(e,this._uid),t()):r()}),this._p2pChannel.on(Ne.P2PLost,()=>{this.safeEmit(ut.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Ne.UpdateVideoEncoder,e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)}),this._p2pChannel.on(Ne.ConnectionTypeChange,e=>{this.safeEmit(ut.IS_USING_CLOUD_PROXY,e)}),this._p2pChannel.on(Ne.RequestLowStreamParameter,e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Ne.QueryClientConnectionState,e=>{e(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{let r=(t={config:e},mg("ContentInspect").create(t));this._inspect=r,this.handleVideoInspectEvents(r);let{appId:n,cname:i,sid:o,token:s,uid:a,cid:c,vid:l}=this._joinInfo;await r.init({appId:n,areaCode:"",cname:i,sid:o,token:s,uid:a,cid:c,vid:l?Number(l):0},Fr)}catch(r){throw Array.isArray(r)?r[0]:r}var t}handleVideoInspectEvents(e){e.on(dn.CONNECTION_STATE_CHANGE,(t,r)=>{if(this.safeEmit(ut.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,r),r===Ms.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(ut.CONTENT_INSPECT_ERROR,new G(I.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}}),e.on(dn.INSPECT_RESULT,(t,r)=>{var n;if((r==null?void 0:r.code)===I.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return b.debug("Stop inspect content because that has left channel"),this==null||(n=this._inspect)===null||n===void 0||n.close(),void(this._inspect=void 0);this.safeEmit(ut.CONTENT_INSPECT_RESULT,t,r)}),e.on(dn.CLIENT_LOCAL_VIDEO_TRACK,t=>{t(this.localTracks.filter(r=>r.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,t){if(qc(e,"enabled"),e){if(!t)throw new G(I.INVALID_PARAMS,"config is required");if(CZ(t),!this._joinInfo)throw new G(I.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(t);else{let n=(r={config:t},mg("ImageModeration").create(r));this._moderation=n,this.handleImageModerationEvents(n);let{appId:i,cname:o,sid:s,token:a,uid:c,cid:l,vid:d}=this._joinInfo;await n.init({appId:i,areaCode:"",cname:o,sid:s,token:a,uid:c,cid:l,vid:d?Number(d):0},Fr)}}catch(n){throw Array.isArray(n)?n[0]:n}}else{var r;if(!this._moderation)throw new G(I.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(n){throw Array.isArray(n)?n[0]:n}}}handleImageModerationEvents(e){e.on(ga.CONNECTION_STATE_CHANGE,(t,r)=>{if(this.safeEmit(ut.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,t,r),t===qo.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new G(I.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}}),e.on(ga.CLIENT_LOCAL_VIDEO_TRACK,t=>{t(this.localTracks.filter(r=>r.trackMediaType==="video")[0])})}setP2PTransport(e){if(function(t){Xr(t,"transport",["default","auto","relay","sd-rtn"])}(e),this.mode!=="p2p")throw new G(I.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,b.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}getJoinChannelServiceRecords(){return b.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){qc(e,"enabled"),Ft("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}},ve(he.prototype,"leave",[C6],Object.getOwnPropertyDescriptor(he.prototype,"leave"),he.prototype),ve(he.prototype,"publish",[R6],Object.getOwnPropertyDescriptor(he.prototype,"publish"),he.prototype),ve(he.prototype,"unpublish",[I6],Object.getOwnPropertyDescriptor(he.prototype,"unpublish"),he.prototype),ve(he.prototype,"subscribe",[A6],Object.getOwnPropertyDescriptor(he.prototype,"subscribe"),he.prototype),ve(he.prototype,"presubscribe",[x6],Object.getOwnPropertyDescriptor(he.prototype,"presubscribe"),he.prototype),ve(he.prototype,"massSubscribe",[O6],Object.getOwnPropertyDescriptor(he.prototype,"massSubscribe"),he.prototype),ve(he.prototype,"unsubscribe",[N6],Object.getOwnPropertyDescriptor(he.prototype,"unsubscribe"),he.prototype),ve(he.prototype,"massUnsubscribe",[k6],Object.getOwnPropertyDescriptor(he.prototype,"massUnsubscribe"),he.prototype),ve(he.prototype,"setLowStreamParameter",[P6],Object.getOwnPropertyDescriptor(he.prototype,"setLowStreamParameter"),he.prototype),ve(he.prototype,"enableDualStream",[D6],Object.getOwnPropertyDescriptor(he.prototype,"enableDualStream"),he.prototype),ve(he.prototype,"disableDualStream",[L6],Object.getOwnPropertyDescriptor(he.prototype,"disableDualStream"),he.prototype),ve(he.prototype,"setClientRole",[M6],Object.getOwnPropertyDescriptor(he.prototype,"setClientRole"),he.prototype),ve(he.prototype,"setProxyServer",[j6],Object.getOwnPropertyDescriptor(he.prototype,"setProxyServer"),he.prototype),ve(he.prototype,"setTurnServer",[U6],Object.getOwnPropertyDescriptor(he.prototype,"setTurnServer"),he.prototype),ve(he.prototype,"setLicense",[F6],Object.getOwnPropertyDescriptor(he.prototype,"setLicense"),he.prototype),ve(he.prototype,"startProxyServer",[V6],Object.getOwnPropertyDescriptor(he.prototype,"startProxyServer"),he.prototype),ve(he.prototype,"stopProxyServer",[B6],Object.getOwnPropertyDescriptor(he.prototype,"stopProxyServer"),he.prototype),ve(he.prototype,"setLocalAccessPointsV2",[$6],Object.getOwnPropertyDescriptor(he.prototype,"setLocalAccessPointsV2"),he.prototype),ve(he.prototype,"setLocalAccessPoints",[H6],Object.getOwnPropertyDescriptor(he.prototype,"setLocalAccessPoints"),he.prototype),ve(he.prototype,"setRemoteDefaultVideoStreamType",[W6],Object.getOwnPropertyDescriptor(he.prototype,"setRemoteDefaultVideoStreamType"),he.prototype),ve(he.prototype,"setRemoteVideoStreamType",[G6],Object.getOwnPropertyDescriptor(he.prototype,"setRemoteVideoStreamType"),he.prototype),ve(he.prototype,"setStreamFallbackOption",[z6],Object.getOwnPropertyDescriptor(he.prototype,"setStreamFallbackOption"),he.prototype),ve(he.prototype,"setEncryptionConfig",[K6],Object.getOwnPropertyDescriptor(he.prototype,"setEncryptionConfig"),he.prototype),ve(he.prototype,"renewToken",[q6],Object.getOwnPropertyDescriptor(he.prototype,"renewToken"),he.prototype),ve(he.prototype,"enableAudioVolumeIndicator",[Y6],Object.getOwnPropertyDescriptor(he.prototype,"enableAudioVolumeIndicator"),he.prototype),ve(he.prototype,"startLiveStreaming",[X6],Object.getOwnPropertyDescriptor(he.prototype,"startLiveStreaming"),he.prototype),ve(he.prototype,"setLiveTranscoding",[J6],Object.getOwnPropertyDescriptor(he.prototype,"setLiveTranscoding"),he.prototype),ve(he.prototype,"stopLiveStreaming",[Q6],Object.getOwnPropertyDescriptor(he.prototype,"stopLiveStreaming"),he.prototype),ve(he.prototype,"startChannelMediaRelay",[Z6],Object.getOwnPropertyDescriptor(he.prototype,"startChannelMediaRelay"),he.prototype),ve(he.prototype,"updateChannelMediaRelay",[e8],Object.getOwnPropertyDescriptor(he.prototype,"updateChannelMediaRelay"),he.prototype),ve(he.prototype,"stopChannelMediaRelay",[t8],Object.getOwnPropertyDescriptor(he.prototype,"stopChannelMediaRelay"),he.prototype),ve(he.prototype,"sendCustomReportMessage",[r8],Object.getOwnPropertyDescriptor(he.prototype,"sendCustomReportMessage"),he.prototype),ve(he.prototype,"pickSVCLayer",[n8],Object.getOwnPropertyDescriptor(he.prototype,"pickSVCLayer"),he.prototype),ve(he.prototype,"setRTMConfig",[i8],Object.getOwnPropertyDescriptor(he.prototype,"setRTMConfig"),he.prototype),ve(he.prototype,"enableContentInspect",[o8],Object.getOwnPropertyDescriptor(he.prototype,"enableContentInspect"),he.prototype),ve(he.prototype,"disableContentInspect",[s8],Object.getOwnPropertyDescriptor(he.prototype,"disableContentInspect"),he.prototype),ve(he.prototype,"setImageModeration",[a8],Object.getOwnPropertyDescriptor(he.prototype,"setImageModeration"),he.prototype),ve(he.prototype,"setP2PTransport",[c8],Object.getOwnPropertyDescriptor(he.prototype,"setP2PTransport"),he.prototype),ve(he.prototype,"getJoinChannelServiceRecords",[l8],Object.getOwnPropertyDescriptor(he.prototype,"getJoinChannelServiceRecords"),he.prototype),ve(he.prototype,"setPublishAudioFilterEnabled",[d8],Object.getOwnPropertyDescriptor(he.prototype,"setPublishAudioFilterEnabled"),he.prototype),he),RZ=class rN{constructor(t,r){C(this,"id",0),C(this,"element",void 0),C(this,"peerPair",void 0),C(this,"context",void 0),C(this,"audioPlayerElement",void 0),C(this,"audioTrack",void 0),rN.count+=1,this.id=rN.count,this.element=t,this.context=r}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=t=>{let r=document.createElement("audio");r.srcObject=new MediaStream([t.track]),r.play(),this.audioPlayerElement=r}}async switchSdp(){if(!this.peerPair)return;let t=async(n,i)=>{let o=i==="offer"?await n.createOffer():await n.createAnswer();return await n.setLocalDescription(o),n.iceGatheringState==="complete"?n.localDescription:new de(s=>{n.onicegatheringstatechange=()=>{n.iceGatheringState==="complete"&&s(n.localDescription)}})},r=async(n,i)=>await n.setRemoteDescription(i);try{let n=await t(this.peerPair[0],"offer");await r(this.peerPair[1],n);let i=await t(this.peerPair[1],"answer");await r(this.peerPair[0],i)}catch(n){throw new G(I.LOCAL_AEC_ERROR,n.toString()).print()}}async getTracksFromMediaElement(t){if(this.audioTrack)return this.audioTrack;let r;try{t instanceof HTMLVideoElement&&(t.captureStream?t.captureStream():t.mozCaptureStream()),r=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(t).connect(r)}catch(i){throw new G(I.LOCAL_AEC_ERROR,i.toString()).print()}if(!r)throw new G(I.LOCAL_AEC_ERROR,"no dest node when local aec").print();let n=r.stream.getAudioTracks()[0];return this.audioTrack=n,n}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();let t=this.element,r=await this.getTracksFromMediaElement(t);this.peerPair&&this.peerPair[0].addTrack(r),await this.switchSdp()}close(){b.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(t=>{t.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}},h8,wE;C(RZ,"count",0);var aje=window.AudioContext||window.webkitAudioContext,cje=new(h8=Oe({report:_e}),ve((wE=class{constructor(){C(this,"units",[]),C(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return b.debug("the system does not need to process local aec"),-1;this.context||(this.context=new aje);let t=this.units.find(r=>r&&r.getElement()===e);return t||(t=new RZ(e,this.context),this.units.push(t)),t.startEchoCancellation(),b.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return yt().name!==Nt.SAFARI}}).prototype,"processExternalMediaAEC",[h8],Object.getOwnPropertyDescriptor(wE.prototype,"processExternalMediaAEC"),wE.prototype),wE);function p8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function f8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p8(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var $I=window||document;function IZ(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!$I)return;let r=yr._cspEventHandlerPointer;if(r&&t)return void console.error(r,t);let n=i=>{if(!(i&&i.blockedURI&&(yr.onSecurityPolicyViolation||yr.getListeners(ic.SECURITY_POLICY_VIOLATION).length>0)))return;let o=i.blockedURI;D("CSP_DETECTED_HOSTNAME_LIST").some(s=>pe(o).call(o,s))&&(yr.onSecurityPolicyViolation&&typeof yr.onSecurityPolicyViolation=="function"&&yr.onSecurityPolicyViolation(i),yr.getListeners(ic.SECURITY_POLICY_VIOLATION).length>0&&yr.safeEmit(ic.SECURITY_POLICY_VIOLATION,i))};r&&$I.removeEventListener("securitypolicyviolation",r),(t||e&&typeof e=="function"||yr.getListeners(ic.SECURITY_POLICY_VIOLATION).length>0)&&$I.addEventListener("securitypolicyviolation",n),yr._cspEventHandlerPointer=n}var lje=Ti,dje=RJ,m8=RegExp.prototype,uje=function(e){return e===m8||lje(m8,e)?dje(e):e.flags},ii=xr(uje);function um(e){let t=e.length;for(;--t>=0;)e[t]=0}var t2=256,AZ=286,$g=30,Hg=15,nN=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),w_=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),hje=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),g8=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gc=new Array(576);um(Gc);var Wg=new Array(60);um(Wg);var K0=new Array(512);um(K0);var q0=new Array(256);um(q0);var r2=new Array(29);um(r2);var lw=new Array($g);function HI(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}var y8,v8,E8;function WI(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}um(lw);var xZ=e=>e<256?K0[e]:K0[256+(e>>>7)],Y0=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Io=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,Y0(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},oc=(e,t,r)=>{Io(e,r[2*t],r[2*t+1])},OZ=(e,t)=>{let r=0;do r|=1&e,e>>>=1,r<<=1;while(--t>0);return r>>>1},NZ=(e,t,r)=>{let n=new Array(16),i,o,s=0;for(i=1;i<=Hg;i++)s=s+r[i-1]<<1,n[i]=s;for(o=0;o<=t;o++){let a=e[2*o+1];a!==0&&(e[2*o]=OZ(n[a]++,a))}},kZ=e=>{let t;for(t=0;t<AZ;t++)e.dyn_ltree[2*t]=0;for(t=0;t<$g;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},PZ=e=>{e.bi_valid>8?Y0(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},_8=(e,t,r,n)=>{let i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]},GI=(e,t,r)=>{let n=e.heap[r],i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&_8(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!_8(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},b8=(e,t,r)=>{let n,i,o,s,a=0;if(e.sym_next!==0)do n=255&e.pending_buf[e.sym_buf+a++],n+=(255&e.pending_buf[e.sym_buf+a++])<<8,i=e.pending_buf[e.sym_buf+a++],n===0?oc(e,i,t):(o=q0[i],oc(e,o+t2+1,t),s=nN[o],s!==0&&(i-=r2[o],Io(e,i,s)),n--,o=xZ(n),oc(e,o,r),s=w_[o],s!==0&&(n-=lw[o],Io(e,n,s)));while(a<e.sym_next);oc(e,256,t)},zI=(e,t)=>{let r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems,s,a,c,l=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<o;s++)r[2*s]!==0?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):r[2*s+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,r[2*c]=1,e.depth[c]=0,e.opt_len--,i&&(e.static_len-=n[2*c+1]);for(t.max_code=l,s=e.heap_len>>1;s>=1;s--)GI(e,r,s);c=o;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],GI(e,r,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,r[2*c]=r[2*s]+r[2*a],e.depth[c]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,r[2*s+1]=r[2*a+1]=c,e.heap[1]=c++,GI(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((d,u)=>{let p=u.dyn_tree,f=u.max_code,m=u.stat_desc.static_tree,g=u.stat_desc.has_stree,y=u.stat_desc.extra_bits,v=u.stat_desc.extra_base,E=u.stat_desc.max_length,w,S,A,N,L,j,W=0;for(N=0;N<=Hg;N++)d.bl_count[N]=0;for(p[2*d.heap[d.heap_max]+1]=0,w=d.heap_max+1;w<573;w++)S=d.heap[w],N=p[2*p[2*S+1]+1]+1,N>E&&(N=E,W++),p[2*S+1]=N,S>f||(d.bl_count[N]++,L=0,S>=v&&(L=y[S-v]),j=p[2*S],d.opt_len+=j*(N+L),g&&(d.static_len+=j*(m[2*S+1]+L)));if(W!==0){do{for(N=E-1;d.bl_count[N]===0;)N--;d.bl_count[N]--,d.bl_count[N+1]+=2,d.bl_count[E]--,W-=2}while(W>0);for(N=E;N!==0;N--)for(S=d.bl_count[N];S!==0;)A=d.heap[--w],A>f||(p[2*A+1]!==N&&(d.opt_len+=(N-p[2*A+1])*p[2*A],p[2*A+1]=N),S--)}})(e,t),NZ(r,l,e.bl_count)},w8=(e,t,r)=>{let n,i,o=-1,s=t[1],a=0,c=7,l=4;for(s===0&&(c=138,l=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=t[2*(n+1)+1],++a<c&&i===s||(a<l?e.bl_tree[2*i]+=a:i!==0?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=i,s===0?(c=138,l=3):i===s?(c=6,l=3):(c=7,l=4))},S8=(e,t,r)=>{let n,i,o=-1,s=t[1],a=0,c=7,l=4;for(s===0&&(c=138,l=3),n=0;n<=r;n++)if(i=s,s=t[2*(n+1)+1],!(++a<c&&i===s)){if(a<l)do oc(e,i,e.bl_tree);while(--a!=0);else i!==0?(i!==o&&(oc(e,i,e.bl_tree),a--),oc(e,16,e.bl_tree),Io(e,a-3,2)):a<=10?(oc(e,17,e.bl_tree),Io(e,a-3,3)):(oc(e,18,e.bl_tree),Io(e,a-11,7));a=0,o=i,s===0?(c=138,l=3):i===s?(c=6,l=3):(c=7,l=4)}},T8=!1,DZ=(e,t,r,n)=>{Io(e,0+(n?1:0),3),PZ(e),Y0(e,r),Y0(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},pje=e=>{T8||((()=>{let t,r,n,i,o,s=new Array(16);for(n=0,i=0;i<28;i++)for(r2[i]=n,t=0;t<1<<nN[i];t++)q0[n++]=i;for(q0[n-1]=i,o=0,i=0;i<16;i++)for(lw[i]=o,t=0;t<1<<w_[i];t++)K0[o++]=i;for(o>>=7;i<$g;i++)for(lw[i]=o<<7,t=0;t<1<<w_[i]-7;t++)K0[256+o++]=i;for(r=0;r<=Hg;r++)s[r]=0;for(t=0;t<=143;)Gc[2*t+1]=8,t++,s[8]++;for(;t<=255;)Gc[2*t+1]=9,t++,s[9]++;for(;t<=279;)Gc[2*t+1]=7,t++,s[7]++;for(;t<=287;)Gc[2*t+1]=8,t++,s[8]++;for(NZ(Gc,287,s),t=0;t<$g;t++)Wg[2*t+1]=5,Wg[2*t]=OZ(t,5);y8=new HI(Gc,nN,257,AZ,Hg),v8=new HI(Wg,w_,0,$g,Hg),E8=new HI(new Array(0),hje,0,19,7)})(),T8=!0),e.l_desc=new WI(e.dyn_ltree,y8),e.d_desc=new WI(e.dyn_dtree,v8),e.bl_desc=new WI(e.bl_tree,E8),e.bi_buf=0,e.bi_valid=0,kZ(e)},fje=(e,t,r,n)=>{let i,o,s=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=(a=>{let c,l=4093624447;for(c=0;c<=31;c++,l>>>=1)if(1&l&&a.dyn_ltree[2*c]!==0)return 0;if(a.dyn_ltree[18]!==0||a.dyn_ltree[20]!==0||a.dyn_ltree[26]!==0)return 1;for(c=32;c<t2;c++)if(a.dyn_ltree[2*c]!==0)return 1;return 0})(e)),zI(e,e.l_desc),zI(e,e.d_desc),s=(a=>{let c;for(w8(a,a.dyn_ltree,a.l_desc.max_code),w8(a,a.dyn_dtree,a.d_desc.max_code),zI(a,a.bl_desc),c=18;c>=3&&a.bl_tree[2*g8[c]+1]===0;c--);return a.opt_len+=3*(c+1)+5+5+4,c})(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&t!==-1?DZ(e,t,r,n):e.strategy===4||o===i?(Io(e,2+(n?1:0),3),b8(e,Gc,Wg)):(Io(e,4+(n?1:0),3),((a,c,l,d)=>{let u;for(Io(a,c-257,5),Io(a,l-1,5),Io(a,d-4,4),u=0;u<d;u++)Io(a,a.bl_tree[2*g8[u]+1],3);S8(a,a.dyn_ltree,c-1),S8(a,a.dyn_dtree,l-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),b8(e,e.dyn_ltree,e.dyn_dtree)),kZ(e),n&&PZ(e)},mje=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(q0[r]+t2+1)]++,e.dyn_dtree[2*xZ(t)]++),e.sym_next===e.sym_end),gje=e=>{Io(e,2,3),oc(e,256,Gc),(t=>{t.bi_valid===16?(Y0(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(e)},yje={_tr_init:pje,_tr_stored_block:DZ,_tr_flush_block:fje,_tr_tally:mje,_tr_align:gje},X0=(e,t,r,n)=>{let i=65535&e|0,o=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+t[n++]|0,o=o+i|0;while(--s);i%=65521,o%=65521}return i|o<<16|0},vje=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})()),fi=(e,t,r,n)=>{let i=vje,o=n+r;e^=-1;for(let s=n;s<o;s++)e=e>>>8^i[255&(e^t[s])];return-1^e},oh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},hm={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:Eje,_tr_stored_block:iN,_tr_flush_block:_je,_tr_tally:_d,_tr_align:bje}=yje,{Z_NO_FLUSH:bd,Z_PARTIAL_FLUSH:wje,Z_FULL_FLUSH:Sje,Z_FINISH:Gs,Z_BLOCK:C8,Z_OK:xi,Z_STREAM_END:R8,Z_STREAM_ERROR:fc,Z_DATA_ERROR:Tje,Z_BUF_ERROR:KI,Z_DEFAULT_COMPRESSION:Cje,Z_FILTERED:Rje,Z_HUFFMAN_ONLY:SE,Z_RLE:Ije,Z_FIXED:Aje,Z_DEFAULT_STRATEGY:xje,Z_UNKNOWN:Oje,Z_DEFLATED:sT}=hm,oN=286,Nje=30,kje=19,Pje=2*oN+1,Dje=15,Ru=258,mc=262,kf=42,Iu=113,yg=666,Au=(e,t)=>(e.msg=oh[t],t),I8=e=>2*e-(e>4?9:0),Yl=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Lje=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=i?r-i:0;while(--t);t=i,n=t;do r=e.prev[--n],e.prev[n]=r>=i?r-i:0;while(--t)},wd=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,Jo=e=>{let t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},es=(e,t)=>{_je(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Jo(e.strm)},wr=(e,t)=>{e.pending_buf[e.pending++]=t},Jm=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},sN=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),e.state.wrap===1?e.adler=X0(e.adler,t,i,r):e.state.wrap===2&&(e.adler=fi(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},LZ=(e,t)=>{let r,n,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,c=e.strstart>e.w_size-mc?e.strstart-(e.w_size-mc):0,l=e.window,d=e.w_mask,u=e.prev,p=e.strstart+Ru,f=l[o+s-1],m=l[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do if(r=t,l[r+s]===m&&l[r+s-1]===f&&l[r]===l[o]&&l[++r]===l[o+1]){o+=2,r++;do;while(l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&o<p);if(n=Ru-(p-o),o=p-Ru,n>s){if(e.match_start=t,s=n,n>=a)break;f=l[o+s-1],m=l[o+s]}}while((t=u[t&d])>c&&--i!=0);return s<=e.lookahead?s:e.lookahead},Pf=e=>{let t=e.w_size,r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-mc)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Lje(e),n+=t),e.strm.avail_in===0)break;if(r=sN(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=wd(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=wd(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<mc&&e.strm.avail_in!==0)},MZ=(e,t)=>{let r,n,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,a=e.strm.avail_in;do{if(r=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>i&&(r=i),r<o&&(r===0&&t!==Gs||t===bd||r!==n+e.strm.avail_in)))break;s=t===Gs&&r===n+e.strm.avail_in?1:0,iN(e,0,0,s),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,Jo(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(sN(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(s===0);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==bd&&t!==Gs&&e.strm.avail_in===0&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(sN(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,o=i>e.w_size?e.w_size:i,n=e.strstart-e.block_start,(n>=o||(n||t===Gs)&&t!==bd&&e.strm.avail_in===0&&n<=i)&&(r=n>i?i:n,s=t===Gs&&e.strm.avail_in===0&&r===n?1:0,iN(e,e.block_start,r,s),e.block_start+=r,Jo(e.strm)),s?3:1)},qI=(e,t)=>{let r,n;for(;;){if(e.lookahead<mc){if(Pf(e),e.lookahead<mc&&t===bd)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=wd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-mc&&(e.match_length=LZ(e,r)),e.match_length>=3)if(n=_d(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=wd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=wd(e,e.ins_h,e.window[e.strstart+1]);else n=_d(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(es(e,!1),e.strm.avail_out===0))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Gs?(es(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(es(e,!1),e.strm.avail_out===0)?1:2},Zh=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<mc){if(Pf(e),e.lookahead<mc&&t===bd)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=wd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-mc&&(e.match_length=LZ(e,r),e.match_length<=5&&(e.strategy===Rje||e.match_length===3&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=_d(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=wd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(es(e,!1),e.strm.avail_out===0))return 1}else if(e.match_available){if(n=_d(e,0,e.window[e.strstart-1]),n&&es(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=_d(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Gs?(es(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(es(e,!1),e.strm.avail_out===0)?1:2};function Qa(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}var vg=[new Qa(0,0,0,0,MZ),new Qa(4,4,8,4,qI),new Qa(4,5,16,8,qI),new Qa(4,6,32,32,qI),new Qa(4,4,16,16,Zh),new Qa(8,16,32,32,Zh),new Qa(8,16,128,128,Zh),new Qa(8,32,128,256,Zh),new Qa(32,128,258,1024,Zh),new Qa(32,258,258,4096,Zh)];function Mje(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=sT,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Pje),this.dyn_dtree=new Uint16Array(2*(2*Nje+1)),this.bl_tree=new Uint16Array(2*(2*kje+1)),Yl(this.dyn_ltree),Yl(this.dyn_dtree),Yl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Dje+1),this.heap=new Uint16Array(2*oN+1),Yl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*oN+1),Yl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var J0=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.status!==kf&&t.status!==57&&t.status!==69&&t.status!==73&&t.status!==91&&t.status!==103&&t.status!==Iu&&t.status!==yg?1:0},jZ=e=>{if(J0(e))return Au(e,fc);e.total_in=e.total_out=0,e.data_type=Oje;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?57:t.wrap?kf:Iu,e.adler=t.wrap===2?0:1,t.last_flush=-2,Eje(t),xi},UZ=e=>{let t=jZ(e);return t===xi&&(r=>{r.window_size=2*r.w_size,Yl(r.head),r.max_lazy_match=vg[r.level].max_lazy,r.good_match=vg[r.level].good_length,r.nice_match=vg[r.level].nice_length,r.max_chain_length=vg[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0})(e.state),t},A8=(e,t,r,n,i,o)=>{if(!e)return fc;let s=1;if(t===Cje&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>9||r!==sT||n<8||n>15||t<0||t>9||o<0||o>Aje||n===8&&s!==1)return Au(e,fc);n===8&&(n=9);let a=new Mje;return e.state=a,a.strm=e,a.status=kf,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=o,a.method=r,UZ(e)},jje=(e,t)=>{if(J0(e)||t>C8||t<0)return e?Au(e,fc):fc;let r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===yg&&t!==Gs)return Au(e,e.avail_out===0?KI:fc);let n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(Jo(e),e.avail_out===0)return r.last_flush=-1,xi}else if(e.avail_in===0&&I8(t)<=I8(n)&&t!==Gs)return Au(e,KI);if(r.status===yg&&e.avail_in!==0)return Au(e,KI);if(r.status===kf&&r.wrap===0&&(r.status=Iu),r.status===kf){let i=sT+(r.w_bits-8<<4)<<8,o=-1;if(o=r.strategy>=SE||r.level<2?0:r.level<6?1:r.level===6?2:3,i|=o<<6,r.strstart!==0&&(i|=32),i+=31-i%31,Jm(r,i),r.strstart!==0&&(Jm(r,e.adler>>>16),Jm(r,65535&e.adler)),e.adler=1,r.status=Iu,Jo(e),r.pending!==0)return r.last_flush=-1,xi}if(r.status===57){if(e.adler=0,wr(r,31),wr(r,139),wr(r,8),r.gzhead)wr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),wr(r,255&r.gzhead.time),wr(r,r.gzhead.time>>8&255),wr(r,r.gzhead.time>>16&255),wr(r,r.gzhead.time>>24&255),wr(r,r.level===9?2:r.strategy>=SE||r.level<2?4:0),wr(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(wr(r,255&r.gzhead.extra.length),wr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=fi(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(wr(r,0),wr(r,0),wr(r,0),wr(r,0),wr(r,0),wr(r,r.level===9?2:r.strategy>=SE||r.level<2?4:0),wr(r,3),r.status=Iu,Jo(e),r.pending!==0)return r.last_flush=-1,xi}if(r.status===69){if(r.gzhead.extra){let i=r.pending,o=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+o>r.pending_buf_size;){let a=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>i&&(e.adler=fi(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex+=a,Jo(e),r.pending!==0)return r.last_flush=-1,xi;i=0,o-=a}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending+=o,r.gzhead.hcrc&&r.pending>i&&(e.adler=fi(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=73}if(r.status===73){if(r.gzhead.name){let i,o=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>o&&(e.adler=fi(e.adler,r.pending_buf,r.pending-o,o)),Jo(e),r.pending!==0)return r.last_flush=-1,xi;o=0}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,wr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>o&&(e.adler=fi(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex=0}r.status=91}if(r.status===91){if(r.gzhead.comment){let i,o=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>o&&(e.adler=fi(e.adler,r.pending_buf,r.pending-o,o)),Jo(e),r.pending!==0)return r.last_flush=-1,xi;o=0}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,wr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>o&&(e.adler=fi(e.adler,r.pending_buf,r.pending-o,o))}r.status=103}if(r.status===103){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Jo(e),r.pending!==0))return r.last_flush=-1,xi;wr(r,255&e.adler),wr(r,e.adler>>8&255),e.adler=0}if(r.status=Iu,Jo(e),r.pending!==0)return r.last_flush=-1,xi}if(e.avail_in!==0||r.lookahead!==0||t!==bd&&r.status!==yg){let i=r.level===0?MZ(r,t):r.strategy===SE?((o,s)=>{let a;for(;;){if(o.lookahead===0&&(Pf(o),o.lookahead===0)){if(s===bd)return 1;break}if(o.match_length=0,a=_d(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++,a&&(es(o,!1),o.strm.avail_out===0))return 1}return o.insert=0,s===Gs?(es(o,!0),o.strm.avail_out===0?3:4):o.sym_next&&(es(o,!1),o.strm.avail_out===0)?1:2})(r,t):r.strategy===Ije?((o,s)=>{let a,c,l,d,u=o.window;for(;;){if(o.lookahead<=Ru){if(Pf(o),o.lookahead<=Ru&&s===bd)return 1;if(o.lookahead===0)break}if(o.match_length=0,o.lookahead>=3&&o.strstart>0&&(l=o.strstart-1,c=u[l],c===u[++l]&&c===u[++l]&&c===u[++l])){d=o.strstart+Ru;do;while(c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&l<d);o.match_length=Ru-(d-l),o.match_length>o.lookahead&&(o.match_length=o.lookahead)}if(o.match_length>=3?(a=_d(o,1,o.match_length-3),o.lookahead-=o.match_length,o.strstart+=o.match_length,o.match_length=0):(a=_d(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++),a&&(es(o,!1),o.strm.avail_out===0))return 1}return o.insert=0,s===Gs?(es(o,!0),o.strm.avail_out===0?3:4):o.sym_next&&(es(o,!1),o.strm.avail_out===0)?1:2})(r,t):vg[r.level].func(r,t);if(i!==3&&i!==4||(r.status=yg),i===1||i===3)return e.avail_out===0&&(r.last_flush=-1),xi;if(i===2&&(t===wje?bje(r):t!==C8&&(iN(r,0,0,!1),t===Sje&&(Yl(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Jo(e),e.avail_out===0))return r.last_flush=-1,xi}return t!==Gs?xi:r.wrap<=0?R8:(r.wrap===2?(wr(r,255&e.adler),wr(r,e.adler>>8&255),wr(r,e.adler>>16&255),wr(r,e.adler>>24&255),wr(r,255&e.total_in),wr(r,e.total_in>>8&255),wr(r,e.total_in>>16&255),wr(r,e.total_in>>24&255)):(Jm(r,e.adler>>>16),Jm(r,65535&e.adler)),Jo(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?xi:R8)},Uje=(e,t)=>{let r=t.length;if(J0(e))return fc;let n=e.state,i=n.wrap;if(i===2||i===1&&n.status!==kf||n.lookahead)return fc;if(i===1&&(e.adler=X0(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){i===0&&(Yl(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(r-n.w_size,r),0),t=c,r=n.w_size}let o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Pf(n);n.lookahead>=3;){let c=n.strstart,l=n.lookahead-2;do n.ins_h=wd(n,n.ins_h,n.window[c+3-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--l);n.strstart=c,n.lookahead=2,Pf(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,n.wrap=i,xi},Gg={deflateInit:(e,t)=>A8(e,t,sT,15,8,xje),deflateInit2:A8,deflateReset:UZ,deflateResetKeep:jZ,deflateSetHeader:(e,t)=>J0(e)||e.state.wrap!==2?fc:(e.state.gzhead=t,xi),deflate:jje,deflateEnd:e=>{if(J0(e))return fc;let t=e.state.status;return e.state=null,t===Iu?Au(e,Tje):xi},deflateSetDictionary:Uje,deflateInfo:"pako deflate (from Nodeca project)"},Fje=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),aT={assign:function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(let n in r)Fje(r,n)&&(e[n]=r[n])}}return e},flattenChunks:e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;let r=new Uint8Array(t);for(let n=0,i=0,o=e.length;n<o;n++){let s=e[n];r.set(s,i),i+=s.length}return r}},FZ=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{FZ=!1}var Q0=new Uint8Array(256);for(let e=0;e<256;e++)Q0[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Q0[254]=Q0[254]=1;var Z0={string2buf:e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,o,s=e.length,a=0;for(i=0;i<s;i++)r=e.charCodeAt(i),(64512&r)==55296&&i+1<s&&(n=e.charCodeAt(i+1),(64512&n)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(a),o=0,i=0;o<a;i++)r=e.charCodeAt(i),(64512&r)==55296&&i+1<s&&(n=e.charCodeAt(i+1),(64512&n)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},buf2string:(e,t)=>{let r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i,o=new Array(2*r);for(i=0,n=0;n<r;){let s=e[n++];if(s<128){o[i++]=s;continue}let a=Q0[s];if(a>4)o[i++]=65533,n+=a-1;else{for(s&=a===2?31:a===3?15:7;a>1&&n<r;)s=s<<6|63&e[n++],a--;a>1?o[i++]=65533:s<65536?o[i++]=s:(s-=65536,o[i++]=55296|s>>10&1023,o[i++]=56320|1023&s)}}return((s,a)=>{if(a<65534&&s.subarray&&FZ)return String.fromCharCode.apply(null,s.length===a?s:s.subarray(0,a));let c="";for(let l=0;l<a;l++)c+=String.fromCharCode(s[l]);return c})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(192&e[r])==128;)r--;return r<0||r===0?t:r+Q0[e[r]]>t?r:t}},VZ=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},BZ=Object.prototype.toString,{Z_NO_FLUSH:Vje,Z_SYNC_FLUSH:Bje,Z_FULL_FLUSH:$je,Z_FINISH:Hje,Z_OK:dw,Z_STREAM_END:Wje,Z_DEFAULT_COMPRESSION:Gje,Z_DEFAULT_STRATEGY:zje,Z_DEFLATED:Kje}=hm;function zg(e){this.options=aT.assign({level:Gje,method:Kje,chunkSize:16384,windowBits:15,memLevel:8,strategy:zje},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new VZ,this.strm.avail_out=0;let r=Gg.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==dw)throw new Error(oh[r]);if(t.header&&Gg.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(n=typeof t.dictionary=="string"?Z0.string2buf(t.dictionary):BZ.call(t.dictionary)==="[object ArrayBuffer]"?new Uint8Array(t.dictionary):t.dictionary,r=Gg.deflateSetDictionary(this.strm,n),r!==dw)throw new Error(oh[r]);this._dict_set=!0}}function YI(e,t){let r=new zg(t);if(r.push(e,!0),r.err)throw r.msg||oh[r.err];return r.result}zg.prototype.push=function(e,t){let r=this.strm,n=this.options.chunkSize,i,o;if(this.ended)return!1;for(o=t===~~t?t:t===!0?Hje:Vje,typeof e=="string"?r.input=Z0.string2buf(e):BZ.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===Bje||o===$je)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(i=Gg.deflate(r,o),i===Wje)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Gg.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===dw;if(r.avail_out!==0){if(o>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(r.avail_in===0)break}else this.onData(r.output)}return!0},zg.prototype.onData=function(e){this.chunks.push(e)},zg.prototype.onEnd=function(e){e===dw&&(this.result=aT.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var qje={Deflate:zg,deflate:YI,deflateRaw:function(e,t){return(t=t||{}).raw=!0,YI(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,YI(e,t)},constants:hm},TE=16209,Yje=function(e,t){let r,n,i,o,s,a,c,l,d,u,p,f,m,g,y,v,E,w,S,A,N,L,j,W,V=e.state;r=e.next_in,j=e.input,n=r+(e.avail_in-5),i=e.next_out,W=e.output,o=i-(t-e.avail_out),s=i+(e.avail_out-257),a=V.dmax,c=V.wsize,l=V.whave,d=V.wnext,u=V.window,p=V.hold,f=V.bits,m=V.lencode,g=V.distcode,y=(1<<V.lenbits)-1,v=(1<<V.distbits)-1;e:do{f<15&&(p+=j[r++]<<f,f+=8,p+=j[r++]<<f,f+=8),E=m[p&y];t:for(;;){if(w=E>>>24,p>>>=w,f-=w,w=E>>>16&255,w===0)W[i++]=65535&E;else{if(!(16&w)){if(!(64&w)){E=m[(65535&E)+(p&(1<<w)-1)];continue t}if(32&w){V.mode=16191;break e}e.msg="invalid literal/length code",V.mode=TE;break e}S=65535&E,w&=15,w&&(f<w&&(p+=j[r++]<<f,f+=8),S+=p&(1<<w)-1,p>>>=w,f-=w),f<15&&(p+=j[r++]<<f,f+=8,p+=j[r++]<<f,f+=8),E=g[p&v];r:for(;;){if(w=E>>>24,p>>>=w,f-=w,w=E>>>16&255,!(16&w)){if(!(64&w)){E=g[(65535&E)+(p&(1<<w)-1)];continue r}e.msg="invalid distance code",V.mode=TE;break e}if(A=65535&E,w&=15,f<w&&(p+=j[r++]<<f,f+=8,f<w&&(p+=j[r++]<<f,f+=8)),A+=p&(1<<w)-1,A>a){e.msg="invalid distance too far back",V.mode=TE;break e}if(p>>>=w,f-=w,w=i-o,A>w){if(w=A-w,w>l&&V.sane){e.msg="invalid distance too far back",V.mode=TE;break e}if(N=0,L=u,d===0){if(N+=c-w,w<S){S-=w;do W[i++]=u[N++];while(--w);N=i-A,L=W}}else if(d<w){if(N+=c+d-w,w-=d,w<S){S-=w;do W[i++]=u[N++];while(--w);if(N=0,d<S){w=d,S-=w;do W[i++]=u[N++];while(--w);N=i-A,L=W}}}else if(N+=d-w,w<S){S-=w;do W[i++]=u[N++];while(--w);N=i-A,L=W}for(;S>2;)W[i++]=L[N++],W[i++]=L[N++],W[i++]=L[N++],S-=3;S&&(W[i++]=L[N++],S>1&&(W[i++]=L[N++]))}else{N=i-A;do W[i++]=W[N++],W[i++]=W[N++],W[i++]=W[N++],S-=3;while(S>2);S&&(W[i++]=W[N++],S>1&&(W[i++]=W[N++]))}break}}break}}while(r<n&&i<s);S=f>>3,r-=S,f-=S<<3,p&=(1<<f)-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=i<s?s-i+257:257-(i-s),V.hold=p,V.bits=f},CE=15,Xje=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Jje=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Qje=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Zje=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Kg=(e,t,r,n,i,o,s,a)=>{let c=a.bits,l,d,u,p,f,m,g=0,y=0,v=0,E=0,w=0,S=0,A=0,N=0,L=0,j=0,W=null,V=new Uint16Array(16),Y=new Uint16Array(16),Z,te,H,$=null;for(g=0;g<=CE;g++)V[g]=0;for(y=0;y<n;y++)V[t[r+y]]++;for(w=c,E=CE;E>=1&&V[E]===0;E--);if(w>E&&(w=E),E===0)return i[o++]=20971520,i[o++]=20971520,a.bits=1,0;for(v=1;v<E&&V[v]===0;v++);for(w<v&&(w=v),N=1,g=1;g<=CE;g++)if(N<<=1,N-=V[g],N<0)return-1;if(N>0&&(e===0||E!==1))return-1;for(Y[1]=0,g=1;g<CE;g++)Y[g+1]=Y[g]+V[g];for(y=0;y<n;y++)t[r+y]!==0&&(s[Y[t[r+y]]++]=y);if(e===0?(W=$=s,m=20):e===1?(W=Xje,$=Jje,m=257):(W=Qje,$=Zje,m=0),j=0,y=0,g=v,f=o,S=w,A=0,u=-1,L=1<<w,p=L-1,e===1&&L>852||e===2&&L>592)return 1;for(;;){Z=g-A,s[y]+1<m?(te=0,H=s[y]):s[y]>=m?(te=$[s[y]-m],H=W[s[y]-m]):(te=96,H=0),l=1<<g-A,d=1<<S,v=d;do d-=l,i[f+(j>>A)+d]=Z<<24|te<<16|H|0;while(d!==0);for(l=1<<g-1;j&l;)l>>=1;if(l!==0?(j&=l-1,j+=l):j=0,y++,--V[g]==0){if(g===E)break;g=t[r+s[y]]}if(g>w&&(j&p)!==u){for(A===0&&(A=w),f+=v,S=g-A,N=1<<S;S+A<E&&(N-=V[S+A],!(N<=0));)S++,N<<=1;if(L+=1<<S,e===1&&L>852||e===2&&L>592)return 1;u=j&p,i[u]=w<<24|S<<16|f-o|0}}return j!==0&&(i[f+j]=g-A<<24|64<<16|0),a.bits=w,0},{Z_FINISH:x8,Z_BLOCK:eUe,Z_TREES:RE,Z_OK:Bu,Z_STREAM_END:tUe,Z_NEED_DICT:rUe,Z_STREAM_ERROR:zs,Z_DATA_ERROR:$Z,Z_MEM_ERROR:HZ,Z_BUF_ERROR:nUe,Z_DEFLATED:O8}=hm,cT=16180,uw=16190,Mc=16191,XI=16192,JI=16194,IE=16199,AE=16200,QI=16206,ln=16209,N8=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function iUe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var $u=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<cT||t.mode>16211?1:0},WZ=e=>{if($u(e))return zs;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=cT,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Bu},GZ=e=>{if($u(e))return zs;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,WZ(e)},zZ=(e,t)=>{let r;if($u(e))return zs;let n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?zs:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,GZ(e))},k8=(e,t)=>{if(!e)return zs;let r=new iUe;e.state=r,r.strm=e,r.window=null,r.mode=cT;let n=zZ(e,t);return n!==Bu&&(e.state=null),n},ZI,eA,P8=!0,oUe=e=>{if(P8){ZI=new Int32Array(512),eA=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Kg(1,e.lens,0,288,ZI,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Kg(2,e.lens,0,32,eA,0,e.work,{bits:5}),P8=!1}e.lencode=ZI,e.lenbits=9,e.distcode=eA,e.distbits=5},KZ=(e,t,r,n)=>{let i,o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),(n-=i)?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},sUe=(e,t)=>{let r,n,i,o,s,a,c,l,d,u,p,f,m,g,y,v,E,w,S,A,N,L,j=0,W=new Uint8Array(4),V,Y,Z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($u(e)||!e.output||!e.input&&e.avail_in!==0)return zs;r=e.state,r.mode===Mc&&(r.mode=XI),s=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,l=r.hold,d=r.bits,u=a,p=c,L=Bu;e:for(;;)switch(r.mode){case cT:if(r.wrap===0){r.mode=XI;break}for(;d<16;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(2&r.wrap&&l===35615){r.wbits===0&&(r.wbits=15),r.check=0,W[0]=255&l,W[1]=l>>>8&255,r.check=fi(r.check,W,2,0),l=0,d=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",r.mode=ln;break}if((15&l)!==O8){e.msg="unknown compression method",r.mode=ln;break}if(l>>>=4,d-=4,N=8+(15&l),r.wbits===0&&(r.wbits=N),N>15||N>r.wbits){e.msg="invalid window size",r.mode=ln;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&l?16189:Mc,l=0,d=0;break;case 16181:for(;d<16;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(r.flags=l,(255&ii(r))!==O8){e.msg="unknown compression method",r.mode=ln;break}if(57344&ii(r)){e.msg="unknown header flags set",r.mode=ln;break}r.head&&(r.head.text=l>>8&1),512&ii(r)&&4&r.wrap&&(W[0]=255&l,W[1]=l>>>8&255,r.check=fi(r.check,W,2,0)),l=0,d=0,r.mode=16182;case 16182:for(;d<32;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}r.head&&(r.head.time=l),512&ii(r)&&4&r.wrap&&(W[0]=255&l,W[1]=l>>>8&255,W[2]=l>>>16&255,W[3]=l>>>24&255,r.check=fi(r.check,W,4,0)),l=0,d=0,r.mode=16183;case 16183:for(;d<16;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&ii(r)&&4&r.wrap&&(W[0]=255&l,W[1]=l>>>8&255,r.check=fi(r.check,W,2,0)),l=0,d=0,r.mode=16184;case 16184:if(1024&ii(r)){for(;d<16;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}r.length=l,r.head&&(r.head.extra_len=l),512&ii(r)&&4&r.wrap&&(W[0]=255&l,W[1]=l>>>8&255,r.check=fi(r.check,W,2,0)),l=0,d=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&ii(r)&&(f=r.length,f>a&&(f=a),f&&(r.head&&(N=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+f),N)),512&ii(r)&&4&r.wrap&&(r.check=fi(r.check,n,f,o)),a-=f,o+=f,r.length-=f),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&ii(r)){if(a===0)break e;f=0;do N=n[o+f++],r.head&&N&&r.length<65536&&(r.head.name+=String.fromCharCode(N));while(N&&f<a);if(512&ii(r)&&4&r.wrap&&(r.check=fi(r.check,n,f,o)),a-=f,o+=f,N)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&ii(r)){if(a===0)break e;f=0;do N=n[o+f++],r.head&&N&&r.length<65536&&(r.head.comment+=String.fromCharCode(N));while(N&&f<a);if(512&ii(r)&&4&r.wrap&&(r.check=fi(r.check,n,f,o)),a-=f,o+=f,N)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&ii(r)){for(;d<16;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(4&r.wrap&&l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=ln;break}l=0,d=0}r.head&&(r.head.hcrc=ii(r)>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Mc;break;case 16189:for(;d<32;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}e.adler=r.check=N8(l),l=0,d=0,r.mode=uw;case uw:if(r.havedict===0)return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,r.hold=l,r.bits=d,rUe;e.adler=r.check=1,r.mode=Mc;case Mc:if(t===eUe||t===RE)break e;case XI:if(r.last){l>>>=7&d,d-=7&d,r.mode=QI;break}for(;d<3;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}switch(r.last=1&l,l>>>=1,d-=1,3&l){case 0:r.mode=16193;break;case 1:if(oUe(r),r.mode=IE,t===RE){l>>>=2,d-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=ln}l>>>=2,d-=2;break;case 16193:for(l>>>=7&d,d-=7&d;d<32;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=ln;break}if(r.length=65535&l,l=0,d=0,r.mode=JI,t===RE)break e;case JI:r.mode=16195;case 16195:if(f=r.length,f){if(f>a&&(f=a),f>c&&(f=c),f===0)break e;i.set(n.subarray(o,o+f),s),a-=f,o+=f,c-=f,s+=f,r.length-=f;break}r.mode=Mc;break;case 16196:for(;d<14;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(r.nlen=257+(31&l),l>>>=5,d-=5,r.ndist=1+(31&l),l>>>=5,d-=5,r.ncode=4+(15&l),l>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=ln;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;d<3;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}r.lens[Z[r.have++]]=7&l,l>>>=3,d-=3}for(;r.have<19;)r.lens[Z[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,V={bits:r.lenbits},L=Kg(0,r.lens,0,19,r.lencode,0,r.work,V),r.lenbits=V.bits,L){e.msg="invalid code lengths set",r.mode=ln;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;j=r.lencode[l&(1<<r.lenbits)-1],y=j>>>24,v=j>>>16&255,E=65535&j,!(y<=d);){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(E<16)l>>>=y,d-=y,r.lens[r.have++]=E;else{if(E===16){for(Y=y+2;d<Y;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(l>>>=y,d-=y,r.have===0){e.msg="invalid bit length repeat",r.mode=ln;break}N=r.lens[r.have-1],f=3+(3&l),l>>>=2,d-=2}else if(E===17){for(Y=y+3;d<Y;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}l>>>=y,d-=y,N=0,f=3+(7&l),l>>>=3,d-=3}else{for(Y=y+7;d<Y;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}l>>>=y,d-=y,N=0,f=11+(127&l),l>>>=7,d-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=ln;break}for(;f--;)r.lens[r.have++]=N}}if(r.mode===ln)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=ln;break}if(r.lenbits=9,V={bits:r.lenbits},L=Kg(1,r.lens,0,r.nlen,r.lencode,0,r.work,V),r.lenbits=V.bits,L){e.msg="invalid literal/lengths set",r.mode=ln;break}if(r.distbits=6,r.distcode=r.distdyn,V={bits:r.distbits},L=Kg(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,V),r.distbits=V.bits,L){e.msg="invalid distances set",r.mode=ln;break}if(r.mode=IE,t===RE)break e;case IE:r.mode=AE;case AE:if(a>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,r.hold=l,r.bits=d,Yje(e,p),s=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,l=r.hold,d=r.bits,r.mode===Mc&&(r.back=-1);break}for(r.back=0;j=r.lencode[l&(1<<r.lenbits)-1],y=j>>>24,v=j>>>16&255,E=65535&j,!(y<=d);){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(v&&!(240&v)){for(w=y,S=v,A=E;j=r.lencode[A+((l&(1<<w+S)-1)>>w)],y=j>>>24,v=j>>>16&255,E=65535&j,!(w+y<=d);){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}l>>>=w,d-=w,r.back+=w}if(l>>>=y,d-=y,r.back+=y,r.length=E,v===0){r.mode=16205;break}if(32&v){r.back=-1,r.mode=Mc;break}if(64&v){e.msg="invalid literal/length code",r.mode=ln;break}r.extra=15&v,r.mode=16201;case 16201:if(r.extra){for(Y=r.extra;d<Y;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;j=r.distcode[l&(1<<r.distbits)-1],y=j>>>24,v=j>>>16&255,E=65535&j,!(y<=d);){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(!(240&v)){for(w=y,S=v,A=E;j=r.distcode[A+((l&(1<<w+S)-1)>>w)],y=j>>>24,v=j>>>16&255,E=65535&j,!(w+y<=d);){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}l>>>=w,d-=w,r.back+=w}if(l>>>=y,d-=y,r.back+=y,64&v){e.msg="invalid distance code",r.mode=ln;break}r.offset=E,r.extra=15&v,r.mode=16203;case 16203:if(r.extra){for(Y=r.extra;d<Y;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=ln;break}r.mode=16204;case 16204:if(c===0)break e;if(f=p-c,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=ln;break}f>r.wnext?(f-=r.wnext,m=r.wsize-f):m=r.wnext-f,f>r.length&&(f=r.length),g=r.window}else g=i,m=s-r.offset,f=r.length;f>c&&(f=c),c-=f,r.length-=f;do i[s++]=g[m++];while(--f);r.length===0&&(r.mode=AE);break;case 16205:if(c===0)break e;i[s++]=r.length,c--,r.mode=AE;break;case QI:if(r.wrap){for(;d<32;){if(a===0)break e;a--,l|=n[o++]<<d,d+=8}if(p-=c,e.total_out+=p,r.total+=p,4&r.wrap&&p&&(e.adler=r.check=ii(r)?fi(r.check,i,p,s-p):X0(r.check,i,p,s-p)),p=c,4&r.wrap&&(ii(r)?l:N8(l))!==r.check){e.msg="incorrect data check",r.mode=ln;break}l=0,d=0}r.mode=16207;case 16207:if(r.wrap&&ii(r)){for(;d<32;){if(a===0)break e;a--,l+=n[o++]<<d,d+=8}if(4&r.wrap&&l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=ln;break}l=0,d=0}r.mode=16208;case 16208:L=tUe;break e;case ln:L=$Z;break e;case 16210:return HZ;default:return zs}return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,r.hold=l,r.bits=d,(r.wsize||p!==e.avail_out&&r.mode<ln&&(r.mode<QI||t!==x8))&&KZ(e,e.output,e.next_out,p-e.avail_out),u-=e.avail_in,p-=e.avail_out,e.total_in+=u,e.total_out+=p,r.total+=p,4&r.wrap&&p&&(e.adler=r.check=ii(r)?fi(r.check,i,p,e.next_out-p):X0(r.check,i,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Mc?128:0)+(r.mode===IE||r.mode===JI?256:0),(u===0&&p===0||t===x8)&&L===Bu&&(L=nUe),L},zc={inflateReset:GZ,inflateReset2:zZ,inflateResetKeep:WZ,inflateInit:e=>k8(e,15),inflateInit2:k8,inflate:sUe,inflateEnd:e=>{if($u(e))return zs;let t=e.state;return t.window&&(t.window=null),e.state=null,Bu},inflateGetHeader:(e,t)=>{if($u(e))return zs;let r=e.state;return 2&r.wrap?(r.head=t,t.done=!1,Bu):zs},inflateSetDictionary:(e,t)=>{let r=t.length,n,i,o;return $u(e)?zs:(n=e.state,n.wrap!==0&&n.mode!==uw?zs:n.mode===uw&&(i=1,i=X0(i,t,r,0),i!==n.check)?$Z:(o=KZ(e,t,r,r),o?(n.mode=16210,HZ):(n.havedict=1,Bu)))},inflateInfo:"pako inflate (from Nodeca project)"},aUe=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},qZ=Object.prototype.toString,{Z_NO_FLUSH:cUe,Z_FINISH:lUe,Z_OK:qg,Z_STREAM_END:tA,Z_NEED_DICT:rA,Z_STREAM_ERROR:dUe,Z_DATA_ERROR:D8,Z_MEM_ERROR:uUe}=hm;function Yg(e){this.options=aT.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new VZ,this.strm.avail_out=0;let r=zc.inflateInit2(this.strm,t.windowBits);if(r!==qg)throw new Error(oh[r]);if(this.header=new aUe,zc.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Z0.string2buf(t.dictionary):qZ.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=zc.inflateSetDictionary(this.strm,t.dictionary),r!==qg)))throw new Error(oh[r])}function nA(e,t){let r=new Yg(t);if(r.push(e),r.err)throw r.msg||oh[r.err];return r.result}Yg.prototype.push=function(e,t){let r=this.strm,n=this.options.chunkSize,i=this.options.dictionary,o,s,a;if(this.ended)return!1;for(s=t===~~t?t:t===!0?lUe:cUe,qZ.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=zc.inflate(r,s),o===rA&&i&&(o=zc.inflateSetDictionary(r,i),o===qg?o=zc.inflate(r,s):o===D8&&(o=rA));r.avail_in>0&&o===tA&&r.state.wrap>0&&e[r.next_in]!==0;)zc.inflateReset(r),o=zc.inflate(r,s);switch(o){case dUe:case D8:case rA:case uUe:return this.onEnd(o),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(r.avail_out===0||o===tA))if(this.options.to==="string"){let c=Z0.utf8border(r.output,r.next_out),l=r.next_out-c,d=Z0.buf2string(r.output,c);r.next_out=l,r.avail_out=n-l,l&&r.output.set(r.output.subarray(c,c+l),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(o!==qg||a!==0){if(o===tA)return o=zc.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},Yg.prototype.onData=function(e){this.chunks.push(e)},Yg.prototype.onEnd=function(e){e===qg&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=aT.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var hUe={Inflate:Yg,inflate:nA,inflateRaw:function(e,t){return(t=t||{}).raw=!0,nA(e,t)},ungzip:nA,constants:hm},{Deflate:s4e,deflate:pUe,deflateRaw:a4e,gzip:c4e}=qje,{Inflate:l4e,inflate:fUe,inflateRaw:d4e,ungzip:u4e}=hUe,mUe=pUe,gUe=fUe,YZ=function(e){return e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE",e}(YZ||{}),yUe=class{constructor(){C(this,"_sequence",0),C(this,"_startTime",Date.now()),C(this,"isUseOneByte",!0)}get startTime(){let e=Date.now()-this._startTime;return e<Math.pow(2,16)?e:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(e){let t={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:e};if(e.byteLength>128){let s=new Uint8Array(4);s.set([1,0,0,0]);let a={id:0,length:4,data:s.buffer},c={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[a]};t.commonPacketHeader.extension=1,t.extension=c,t.payload=this.compress(e),t.commonPacketHeader.length=8+(t.extension.length+2)+t.payload.byteLength}else t.commonPacketHeader.length=8+t.payload.byteLength;D("SHOW_DATASTREAM2_LOG")&&b.debug("send data header: ".concat(JSON.stringify(t.commonPacketHeader)));let r=new ArrayBuffer(t.commonPacketHeader.length),n=new Uint8Array(r),i=new DataView(r),o=0;if(i.setUint16(o,t.commonPacketHeader.extension<<15|t.commonPacketHeader.reserved<<14|t.commonPacketHeader.length,!0),o+=2,i.setUint32(o,t.commonPacketHeader.sequence,!0),o+=4,i.setUint16(o,t.commonStreamHeader,!0),o+=2,t.extension){let s=this.serializeExtension(t.extension);n.set(new Uint8Array(s),o),o+=s.byteLength}if(n.set(new Uint8Array(t.payload),o),o+=t.payload.byteLength,o!==t.commonPacketHeader.length)throw Error("serialize error!");return r}deserialize(e){if(e.byteLength<4)return new ArrayBuffer(0);let t=new DataView(e),r=0,n=t.getUint16(r,!0);r+=2;let i={length:16383&n,reserved:(16384&n)>>14,extension:(32768&n)>>15,sequence:t.getUint16(r+2,!0)<<16|t.getUint16(r,!0)},o,s;if(r+=4,D("SHOW_DATASTREAM2_LOG")&&b.debug("receive data header: ".concat(JSON.stringify(i))),t.getUint16(r,!0),r+=2,i.extension){s=this.deserializeExtension(e.slice(r)),r+=2+s.length,o=e.slice(r);let a=!1;if(s.datas.length>0){let c=s.datas.find(l=>l.id===0);c&&(a=(1&new DataView(c.data).getUint32(0,!0))==1)}o=a?this.decompress(o):o}else o=e.slice(8);return o}serializeExtension(e){let{profile:t,length:r,datas:n}=e,i=new ArrayBuffer(r+2),o=new Uint8Array(i),s=new DataView(i),a=0;if(s.setUint8(a++,t),s.setUint8(a++,r),n.forEach(c=>{t?(s.setUint8(a++,c.id),s.setUint8(a++,c.length),o.set(new Uint8Array(c.data),a),a+=c.data.byteLength):(s.setUint8(a++,c.id|c.length<<4),o.set(new Uint8Array(c.data),a),a+=c.data.byteLength)}),a!==r+2)throw Error("serialize extension error, is ".concat(a,"!==").concat(r+2));return i}deserializeExtension(e){let t=new DataView(e),r=0,n=t.getUint8(r);r++;let i=t.getUint8(r);r++;let o=n===YZ.TWO_BYTE,s=[],a=new DataView(e,2),c=0;for(;c<i;){let l=0,d=0,u=new ArrayBuffer(0);o?(l=a.getUint8(c),c++,d=a.getUint8(c),c++):(l=15&a.getUint8(c),d=a.getUint8(c)>>4,c++),d>0&&(u=a.buffer.slice(c+2,c+2+d),c+=u.byteLength),s.push({id:l,length:d,data:u})}if(c!==i)throw Error("parse error");return{profile:n,length:i,datas:s}}decompress(e){return gUe(new Uint8Array(e))}compress(e){return mUe(new Uint8Array(e))}},vUe={name:"DataStream",create:(e,t)=>{let r=t?new nMe(e):new iMe(e);return r.useDataStream(new yUe),r}},EUe=class extends fr{constructor(e,t,r){super(),C(this,"ws",void 0),C(this,"requestId",1),C(this,"heartBeatTimer",void 0),C(this,"joinInfo",void 0),C(this,"clientId",void 0),C(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),C(this,"onClose",n=>{this.emit("close"),this.dispose()}),C(this,"onMessage",n=>{let i=JSON.parse(n.data);if(!i||i.command!=="serverResponse"||!i.requestId)return i&&i.command==="serverStatus"&&i.serverStatus&&i.serverStatus.command?(this.emit("status",i.serverStatus),void this.emit(i.serverStatus.command,i.serverStatus)):void 0;this.emit("req_".concat(i.requestId),i)}),this.joinInfo=e,this.clientId=t,this.ws=new V0("cross-channel-".concat(this.clientId),r),this.ws.on(Fe.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(Fe.CONNECTED,this.onOpen),this.ws.on(Fe.ON_MESSAGE,this.onMessage),this.ws.on(Fe.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(e){let t=this.requestId++;return e.requestId=t,e.seq=t,this.ws.sendMessage(e),t}waitStatus(e){return new de((t,r)=>{let n=window.setTimeout(()=>{r(new G(I.TIMEOUT,"wait status timeout, status: ".concat(e)))},5e3);this.once(e,i=>{window.clearTimeout(n),i.state&&i.state!==0?r(new G(I.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):t(void 0)}),this.once("dispose",()=>{window.clearTimeout(n),r(new G(I.WS_ABORT))})})}async request(e){if(this.ws.state==="closed")throw new G(I.WS_DISCONNECT);let t=()=>new de((o,s)=>{this.ws.once(Fe.CLOSED,()=>s(new G(I.WS_ABORT))),this.ws.once(Fe.CONNECTED,o)});this.ws.state!=="connected"&&await t();let r=this.sendMessage(e),n=new de((o,s)=>{let a=()=>{s(new G(I.WS_ABORT))};this.ws.once(Fe.RECONNECTING,a),this.ws.once(Fe.CLOSED,a),this.once("req_".concat(r),o),Tn(3e3).then(()=>{this.removeAllListeners("req_".concat(r)),this.ws.off(Fe.RECONNECTING,a),this.ws.off(Fe.CLOSED,a),s(new G(I.TIMEOUT,"cross channel ws request timeout"))})}),i=await n;if(!i||i.code!==200)throw new G(I.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(i)));return i}async connect(e){this.ws.removeAllListeners(Fe.REQUEST_NEW_URLS),this.ws.on(Fe.REQUEST_NEW_URLS,t=>{t(e)}),await this.ws.init(e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(e){let t=this.requestId++;return e.requestId=t,this.ws.sendMessage(e),t}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}},_Ue=class extends fr{set state(e){e!==this._state&&(e!==Bi.RELAY_STATE_FAILURE&&(this.errorCode=np.RELAY_OK),this.emit("state",e,this.errorCode),this._state=e)}get state(){return this._state}constructor(e,t,r,n,i){super(),C(this,"joinInfo",void 0),C(this,"sid",void 0),C(this,"clientId",void 0),C(this,"cancelToken",Li.CancelToken.source()),C(this,"workerToken",void 0),C(this,"requestId",0),C(this,"signal",void 0),C(this,"prevChannelMediaConfig",void 0),C(this,"httpRetryConfig",void 0),C(this,"_resolution",void 0),C(this,"_state",Bi.RELAY_STATE_IDLE),C(this,"errorCode",np.RELAY_OK),C(this,"onStatus",o=>{b.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(o))),o&&o.command&&(o.command==="onAudioPacketReceived"&&this.emit("event",jc.PACKET_RECEIVED_AUDIO_FROM_SRC),o.command==="onVideoPacketReceived"&&this.emit("event",jc.PACKET_RECEIVED_VIDEO_FROM_SRC),o.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=np.SRC_TOKEN_EXPIRED,this.state=Bi.RELAY_STATE_FAILURE),o.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=np.DEST_TOKEN_EXPIRED,this.state=Bi.RELAY_STATE_FAILURE))}),C(this,"onReconnect",async()=>{b.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",jc.NETWORK_DISCONNECTED),this.state=Bi.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(o=>{this.state!==Bi.RELAY_STATE_IDLE&&(b.error("auto restart channel media relay failed",o.toString()),this.errorCode=np.SERVER_CONNECTION_LOST,this.state=Bi.RELAY_STATE_FAILURE)})}),this.joinInfo=e,this.clientId=t,this.sid=Np(),this.signal=new EUe(this.joinInfo,this.clientId,r),this.httpRetryConfig=n,this._resolution=i}async startChannelMediaRelay(e){if(this.state!==Bi.RELAY_STATE_IDLE)throw new G(I.INVALID_OPERATION);this.state=Bi.RELAY_STATE_CONNECTING,await this.connect(),b.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(e)}catch(t){throw t.data&&t.data.serverResponse&&t.data.serverResponse.command==="SetSourceChannel"?new G(I.CROSS_CHANNEL_FAILED_JOIN_SRC):t.data&&t.data.serverResponse&&t.serverResponse.command==="SetDestChannelStatus"?new G(I.CROSS_CHANNEL_FAILED_JOIN_DEST):t.data&&t.data.serverResponse&&t.serverResponse.command==="StartPacketTransfer"?new G(I.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):t}this.prevChannelMediaConfig=e}async updateChannelMediaRelay(e){if(this.state!==Bi.RELAY_STATE_RUNNING)throw new G(I.INVALID_OPERATION);await this.sendUpdateMessage(e),this.prevChannelMediaConfig=e}async setVideoProfile(e){if(this._resolution=e,this.state!==Bi.RELAY_STATE_RUNNING)throw new G(I.INVALID_OPERATION);let t=this.genMessage(hi.SetVideoProfile);await this.signal.request(t),b.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),b.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Bi.RELAY_STATE_IDLE,this.dispose()}dispose(){b.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Li.CancelToken.source(),this.state=Bi.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){let e=await mMe(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=e.workerToken,await this.signal.connect(e.addressList),this.emit("event",jc.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(e){let t=this.genMessage(hi.StopPacketTransfer);await this.signal.request(t),await this.signal.waitStatus("Normal Quit"),b.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));let r=this.genMessage(hi.SetSdkProfile,e);await this.signal.request(r),b.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));let n=this.genMessage(hi.SetSourceChannel,e);await this.signal.request(n),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",jc.PACKET_JOINED_SRC_CHANNEL),b.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));let i=this.genMessage(hi.SetSourceUserId,e);await this.signal.request(i),b.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));let o=this.genMessage(hi.SetDestChannel,e);await this.signal.request(o),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",jc.PACKET_JOINED_DEST_CHANNEL),b.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));let s=this.genMessage(hi.StartPacketTransfer,e);await this.signal.request(s),this.emit("event",jc.PACKET_SENT_TO_DEST_CHANNEL),this.state=Bi.RELAY_STATE_RUNNING,b.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(e){let t=this.genMessage(hi.UpdateDestChannel,e);await this.signal.request(t),this.emit("event",jc.PACKET_UPDATE_DEST_CHANNEL),b.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){let e=this.genMessage(hi.StopPacketTransfer);await this.signal.request(e),b.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(e,t){let r=[],n=[],i=[];this.requestId+=1;let o={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:os,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};o.sdkVersion==="4.22.0"&&(o.sdkVersion="0.0.1");let s=null,a=null;switch(e){case hi.SetSdkProfile:return o.clientRequest={command:"SetSdkProfile",type:"multi_channel"},o;case hi.SetSourceChannel:if(a=t&&t.getSrcChannelMediaInfo(),!a)throw new G(I.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceChannel",uid:"0",channelName:a.channelName,token:a.token||this.joinInfo.appId},o;case hi.SetSourceUserId:if(a=t&&t.getSrcChannelMediaInfo(),!a)throw new G(I.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceUserId",uid:a.uid+""},o;case hi.SetDestChannel:if(s=t&&t.getDestChannelMediaInfo(),!s)throw new G(I.UNEXPECTED_ERROR,"can not find dest config");return s.forEach(c=>{r.push(c.channelName),n.push(c.uid+""),i.push(c.token||this.joinInfo.appId)}),o.clientRequest={command:"SetDestChannel",channelName:r,uid:n,token:i},o;case hi.StartPacketTransfer:return o.clientRequest={command:"StartPacketTransfer"},o;case hi.Reconnect:return o.clientRequest={command:"Reconnect"},o;case hi.StopPacketTransfer:return o.clientRequest={command:"StopPacketTransfer"},o;case hi.UpdateDestChannel:if(s=t&&t.getDestChannelMediaInfo(),!s)throw new G(I.UNEXPECTED_ERROR,"can not find dest config");return s.forEach(c=>{r.push(c.channelName),n.push(c.uid+""),i.push(c.token||this.joinInfo.appId)}),o.clientRequest={command:"UpdateDestChannel",channelName:r,uid:n,token:i},o;case hi.SetVideoProfile:o.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return o}},bUe={name:"ChannelMediaRelay",create:function(e){return new _Ue(e.joinInfo,e.clientId,e.websocketRetryConfig||Fr,e.httpRetryConfig||Fr,e.resolution)}};function L8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Qm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L8(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var wUe=class extends fr{constructor(e,t,r,n){super(),C(this,"spec",void 0),C(this,"token",void 0),C(this,"websocket",void 0),C(this,"pingpongTimer",void 0),C(this,"reconnectMode","retry"),C(this,"serviceMode",void 0),C(this,"reqId",0),C(this,"commandReqId",0),C(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),C(this,"handleWebSocketMessage",i=>{if(!i.data)return;let o=JSON.parse(i.data);o.requestId?this.emit("@".concat(o.requestId,"-").concat(o.sid),o):(_e.workerEvent(this.spec.sid,{actionType:"status",serverCode:o.code,workerType:this.serviceMode===Qc.TRANSCODE?1:2}),this.emit(Kl.PUBLISH_STREAM_STATUS,o))}),this.spec=t,this.token=e,this.serviceMode=n,this.websocket=new V0("live-streaming",r),this.websocket.on(Fe.CONNECTED,this.handleWebSocketOpen),this.websocket.on(Fe.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(Fe.REQUEST_NEW_URLS,(i,o)=>{Dn(this,Kl.REQUEST_NEW_ADDRESS).then(i).catch(o)}),this.websocket.on(Fe.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(e){return this.websocket.init(e)}async request(e,t,r,n){this.reqId+=1,e==="request"&&(this.commandReqId+=1);let i=this.commandReqId,o=this.reqId;if(!o||!this.websocket)throw new G(I.UNEXPECTED_ERROR);let s=Qm({command:e,sdkVersion:os==="4.22.0"?"0.0.1":os,seq:o,requestId:o,allocate:r,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},t);if(this.websocket.state==="closed")throw new G(I.WS_DISCONNECT);let a=()=>new de((u,p)=>{this.websocket.once(Fe.CLOSED,()=>p(new G(I.WS_ABORT))),this.websocket.once(Fe.CONNECTED,u)});this.websocket.state!=="connected"&&await a(),s.clientRequest&&(s.clientRequest.workerToken=this.token);let c=new de((u,p)=>{let f=()=>{p(new G(I.WS_ABORT))};this.websocket.once(Fe.RECONNECTING,f),this.websocket.once(Fe.CLOSED,f),this.once("@".concat(o,"-").concat(this.spec.sid),m=>{u(m)})});n&&_e.workerEvent(this.spec.sid,Qm(Qm({},n),{},{requestId:i,actionType:"request",payload:JSON.stringify(t.clientRequest),serverCode:0,code:0}));let l=Date.now();this.websocket.sendMessage(s);let d=null;try{d=await c}catch(u){if(this.websocket.state==="closed")throw u;return await a(),await this.request(e,t,r)}return n&&_e.workerEvent(this.spec.sid,Qm(Qm({},n),{},{requestId:i,actionType:"response",payload:JSON.stringify(d.serverResponse),serverCode:d.code,success:d.code===200,responseTime:Date.now()-l})),d.code!==200&&this.handleResponseError(d),d}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){let e=os==="4.22.0"?"0.0.1":os;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(e){switch(e.code){case Wr.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void b.warning("live stream response already exists stream");case Wr.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Wr.LIVE_STREAM_RESPONSE_BAD_STREAM:case Wr.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new G(I.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case Wr.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(e.serverResponse.command==="UnpublishStream")return;throw new G(I.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Wr.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new G(I.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case Wr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{let t=new G(I.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(Kl.WARNING,t,e.serverResponse.url)}case Wr.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{let t=new G(I.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(Kl.WARNING,t,e.serverResponse.url)}case Wr.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new G(I.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Wr.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new G(I.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case Wr.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{let t=new G(I.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(Kl.WARNING,t,e.serverResponse.url)}case Wr.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new G(I.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case Wr.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new G(I.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Wr.LIVE_STREAM_RESPONSE_WORKER_LOST:case Wr.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(e.serverResponse.command==="UnpublishStream")return;throw new G(I.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Wr.ERROR_FAIL_SEND_MESSAGE:if(e.serverResponse.command==="UnpublishStream")return;if(e.serverResponse.command==="UpdateTranscoding"||e.serverResponse.command==="ControlStream")return new G(I.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new G(I.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Wr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Wr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Wr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Wr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new G(I.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(eT)},6e3)}};function M8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M8(Object(r),!0).forEach(function(n){C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var SUe=class extends fr{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fr,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fr;super(),C(this,"onLiveStreamWarning",void 0),C(this,"onLiveStreamError",void 0),C(this,"spec",void 0),C(this,"retryTimeout",1e4),C(this,"connection",void 0),C(this,"httpRetryConfig",void 0),C(this,"wsRetryConfig",void 0),C(this,"streamingTasks",new Map),C(this,"isStartingStreamingTask",!1),C(this,"taskMutex",new Gn("live-streaming")),C(this,"cancelToken",Li.CancelToken.source()),C(this,"transcodingConfig",void 0),C(this,"uapResponse",void 0),C(this,"lastTaskId",1),C(this,"statusError",new Map),this.spec=e,this.httpRetryConfig=r,this.wsRetryConfig=t}async setTranscodingConfig(e){let t=Vi(Vi({},b2e),e);t.videoCodecProfile!==66&&t.videoCodecProfile!==77&&t.videoCodecProfile!==100&&(b.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(t.videoCodecProfile," -> 100")),t.videoCodecProfile=100),t.transcodingUsers||(t.transcodingUsers=t.userConfigs),t.transcodingUsers&&(t.transcodingUsers=t.transcodingUsers.map(o=>Vi(Vi(Vi({},_2e),o),{},{zOrder:o.zOrder?o.zOrder+1:1}))),function(o){dr(o.width)||Vt(o.width,"config.width",0,1e4),dr(o.height)||Vt(o.height,"config.height",0,1e4),dr(o.videoBitrate)||Vt(o.videoBitrate,"config.videoBitrate",1,1e6),dr(o.videoFrameRate)||Vt(o.videoFrameRate,"config.videoFrameRate"),dr(o.lowLatency)||qc(o.lowLatency,"config.lowLatency"),dr(o.audioSampleRate)||Xr(o.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),dr(o.audioBitrate)||Vt(o.audioBitrate,"config.audioBitrate",1,128),dr(o.audioChannels)||Xr(o.audioChannels,"config.audioChannels",[1,2,3,4,5]),dr(o.videoGop)||Vt(o.videoGop,"config.videoGop"),dr(o.videoCodecProfile)||Xr(o.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),dr(o.userCount)||Vt(o.userCount,"config.userCount",0,17),dr(o.backgroundColor)||Vt(o.backgroundColor,"config.backgroundColor",0,16777215),dr(o.userConfigExtraInfo)||En(o.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),o.transcodingUsers&&!dr(o.transcodingUsers)&&($c(o.transcodingUsers,"config.transcodingUsers"),o.transcodingUsers.forEach((s,a)=>{nT(s.uid),dr(s.x)||Vt(s.x,"transcodingUser[".concat(a,"].x"),0,1e4),dr(s.y)||Vt(s.y,"transcodingUser[".concat(a,"].y"),0,1e4),dr(s.width)||Vt(s.width,"transcodingUser[".concat(a,"].width"),0,1e4),dr(s.height)||Vt(s.height,"transcodingUser[".concat(a,"].height"),0,1e4),dr(s.zOrder)||Vt(s.zOrder-1,"transcodingUser[".concat(a,"].zOrder"),0,100),dr(s.alpha)||Vt(s.alpha,"transcodingUser[".concat(a,"].alpha"),0,1,!1)})),dr(o.watermark)||rI(o.watermark,"watermark"),dr(o.backgroundImage)||rI(o.backgroundImage,"backgroundImage"),o.images&&!dr(o.images)&&($c(o.images,"config.images"),o.images.forEach((s,a)=>{rI(s,"images[".concat(a,"]"))}))}(t);let r=[];t.images&&r.push(...t.images.map(o=>Vi(Vi(Vi({},tI),o),{},{zOrder:255}))),t.backgroundImage&&(r.push(Vi(Vi(Vi({},tI),t.backgroundImage),{},{zOrder:0})),delete t.backgroundImage),t.watermark&&(r.push(Vi(Vi(Vi({},tI),t.watermark),{},{zOrder:255})),delete t.watermark),t.images=r,t.transcodingUsers&&(t.userConfigs=t.transcodingUsers.map(o=>Vi({},o)),t.userCount=t.transcodingUsers.length,delete t.transcodingUsers);let n=(t.userConfigs||[]).map(o=>typeof o.uid=="number"?de.resolve(o.uid):tZ(o.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await de.all(n)).forEach((o,s)=>{t.userConfigs&&t.userConfigs[s]&&(t.userConfigs[s].uid=o)}),this.transcodingConfig=t,this.connection)try{var i;let o=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(il(i=this.streamingTasks).call(i)).map(s=>s.taskId).join("#")});b.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(o.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(o){if(!o.data||!o.data.retry)throw o;o.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(s=>{b.warning("[".concat(this.spec.clientId,"] live streaming receive error"),o.toString(),"try to republish",s.url),this.startLiveStreamingTask(s.url,s.mode,o).then(()=>{b.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(s.url," success"))}).catch(a=>{b.error("[".concat(this.spec.clientId,"] live streaming republish failed"),s.url,a.toString()),this.onLiveStreamError&&this.onLiveStreamError(s.url,a)})})}}async startLiveStreamingTask(e,t,r){if(!this.transcodingConfig&&t===Qc.TRANSCODE)throw new G(I.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let n={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};b.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(e,", mode: ").concat(t));let i=await this.taskMutex.lock();if(!this.connection&&r)return void i();if(this.streamingTasks.get(e)&&!r)return i(),new G(I.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(t))}catch(s){throw i(),s}switch(t){case Qc.TRANSCODE:n.transcodingConfig=Vi({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(n.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;let o=this.lastTaskId++;try{let s=new de((c,l)=>{Tn(this.retryTimeout).then(()=>{if(r)return l(r);let d=this.statusError.get(e);return d?(this.statusError.delete(e),l(d)):void 0})}),a=await de.race([this.connection.request("request",{clientRequest:n},!0,{url:e,command:"PublishStream",workerType:t===Qc.TRANSCODE?1:2,requestByUser:!r,tid:o.toString()}),s]);this.isStartingStreamingTask=!1,b.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(a.code)),this.streamingTasks.set(e,{clientRequest:n,mode:t,url:e,taskId:o}),i()}catch(s){if(i(),this.isStartingStreamingTask=!1,!s.data||!s.data.retry||r)throw s;return s.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(e,t,s)):await this.startLiveStreamingTask(e,t,s)}}stopLiveStreamingTask(e){return new de((t,r)=>{let n=this.streamingTasks.get(e);if(!n||!this.connection)return new G(I.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();let i=n.mode;n.abortTask=()=>{b.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(e),t()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:n.url}},!1,{url:e,command:"UnPublishStream",workerType:i===Qc.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(o=>{b.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(o.code)),this.streamingTasks.delete(e),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),t()}).catch(r)})}resetAllTask(){var e;let t=Array.from(il(e=this.streamingTasks).call(e));this.terminate();for(let r of t)this.startLiveStreamingTask(r.url,r.mode).catch(n=>{this.onLiveStreamError&&this.onLiveStreamError(r.url,n)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=Li.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(e){if(this.connection)throw new G(I.UNEXPECTED_ERROR,"live streaming connection has already connected");let t=await Dn(this,MO.REQUEST_WORKER_MANAGER_LIST,e);return this.uapResponse=t,this.connection=new wUe(t.workerToken,this.spec,this.wsRetryConfig,e),this.connection.on(Kl.WARNING,(r,n)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(n,r)),this.connection.on(Kl.PUBLISH_STREAM_STATUS,r=>this.handlePublishStreamServer(r)),this.connection.on(Kl.REQUEST_NEW_ADDRESS,(r,n)=>{if(!this.connection)return n(new G(I.UNEXPECTED_ERROR,"can not get new live streaming address list"));Dn(this,MO.REQUEST_WORKER_MANAGER_LIST,e).then(i=>{this.uapResponse=i,r(i.addressList)}).catch(n)}),await this.connection.init(t.addressList),this.connection}handlePublishStreamServer(e){let t=e.serverStatus&&e.serverStatus.url||"empty_url",r=this.streamingTasks.get(t),n=e.reason;switch(e.code){case Wr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Wr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Wr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Wr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{let o=new G(I.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(r)return b.error(o.toString()),this.onLiveStreamError&&this.onLiveStreamError(t,o);if(!this.isStartingStreamingTask)return;this.statusError.set(t,o)}case Wr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{let o=new G(I.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,n);return this.onLiveStreamWarning&&this.onLiveStreamWarning(t,o)}case Wr.LIVE_STREAM_RESPONSE_WORKER_LOST:case Wr.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var i;if(!this.connection)return;this.connection.tryNextAddress();let o=Array.from(il(i=this.streamingTasks).call(i));for(let s of o)s.abortTask?s.abortTask():(b.warning("[".concat(this.spec.clientId,"] publish stream status code"),e.code,"try to republish",s.url),this.startLiveStreamingTask(s.url,s.mode,new G(I.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then(()=>{b.debug("[".concat(this.spec.clientId,"] republish live stream success"),s.url)}).catch(a=>{b.error(a.toString()),this.onLiveStreamError&&this.onLiveStreamError(s.url,a)}));return}}}hasUrl(e){return this.streamingTasks.has(e)}},TUe={name:"LiveStreaming",create:function(e){return new SUe(e.joinInfo,e.websocketRetryConfig||Fr,e.httpRetryConfig||Fr)}};function CUe(e){let t=j8();return function(r,n){let i=r.appId;i!==void 0&&(Lt(n,10),ec(n,i));let o=r.cid;o!==void 0&&(Lt(n,16),Lt(n,o));let s=r.cname;s!==void 0&&(Lt(n,26),ec(n,s));let a=r.deviceId;a!==void 0&&(Lt(n,34),ec(n,a));let c=r.elapse;c!==void 0&&(Lt(n,40),jl(n,c));let l=r.fileSize;l!==void 0&&(Lt(n,48),jl(n,ep(l)));let d=r.height;d!==void 0&&(Lt(n,56),jl(n,ep(d)));let u=r.jpg;u!==void 0&&(Lt(n,66),Lt(n,u.length),function(K,x){let O=pm(K,x.length);K.bytes.set(x,O)}(n,u));let p=r.networkType;p!==void 0&&(Lt(n,72),jl(n,ep(p)));let f=r.osType;f!==void 0&&(Lt(n,80),jl(n,ep(f)));let m=r.requestId;m!==void 0&&(Lt(n,90),ec(n,m));let g=r.sdkVersion;g!==void 0&&(Lt(n,98),ec(n,g));let y=r.sequence;y!==void 0&&(Lt(n,104),jl(n,ep(y)));let v=r.sid;v!==void 0&&(Lt(n,114),ec(n,v));let E=r.timestamp;E!==void 0&&(Lt(n,120),jl(n,E));let w=r.uid;w!==void 0&&(Lt(n,128),Lt(n,w));let S=r.vid;S!==void 0&&(Lt(n,136),Lt(n,S));let A=r.width;A!==void 0&&(Lt(n,144),jl(n,ep(A)));let N=r.service;N!==void 0&&(Lt(n,152),Lt(n,N));let L=r.callbackData;L!==void 0&&(Lt(n,162),ec(n,L));let j=r.jpgEncryption;j!==void 0&&(Lt(n,168),Lt(n,j));let W=r.requestType;W!==void 0&&(Lt(n,176),Lt(n,W));let V=r.scorePorn;V!==void 0&&(Lt(n,185),sA(n,V));let Y=r.scoreSexy;Y!==void 0&&(Lt(n,193),sA(n,Y));let Z=r.scoreNeutral;Z!==void 0&&(Lt(n,201),sA(n,Z));let te=r.scene;te!==void 0&&(Lt(n,208),Lt(n,te));let H=r.ossFilePrefix;H!==void 0&&(Lt(n,218),ec(n,H));let $=r.serviceVendor;if($!==void 0)for(let K of $){Lt(n,226);let x=j8();AUe(K,x),Lt(n,x.limit),kUe(n,x),NUe(x)}}(e,t),function(r){let n=r.bytes,i=r.limit;return n.length===i?n:n.subarray(0,i)}(t)}function RUe(e){return function(r){let n={};e:for(;!QZ(r);){let i=sc(r);switch(i>>>3){case 0:break e;case 1:n.code=sc(r);break;case 2:n.msg=ZZ(r,sc(r));break;case 3:{let o=xUe(r);n.data=IUe(r),r.limit=o;break}default:XZ(r,7&i)}}return n}({bytes:t=e,offset:0,limit:t.length});var t}function IUe(e){let t={};e:for(;!QZ(e);){let r=sc(e);switch(r>>>3){case 0:break e;case 1:t.requestId=ZZ(e,sc(e));break;case 2:t.requestType=sc(e)>>>0;break;case 3:t.scorePorn=oA(e);break;case 4:t.scoreSexy=oA(e);break;case 5:t.scoreNeutral=oA(e);break;case 6:t.requestScene=sc(e)>>>0;break;case 7:t.scene=sc(e)>>>0;break;default:XZ(e,7&r)}}return t}function AUe(e,t){let r=e.service;r!==void 0&&(Lt(t,8),Lt(t,r));let n=e.vendor;n!==void 0&&(Lt(t,16),Lt(t,n));let i=e.token;i!==void 0&&(Lt(t,26),ec(t,i));let o=e.callbackUrl;o!==void 0&&(Lt(t,34),ec(t,o))}function xUe(e){let t=sc(e),r=e.limit;return e.limit=e.offset+t,r}function XZ(e,t){switch(t){case 0:for(;128&e1(e););break;case 2:iA(e,sc(e));break;case 5:iA(e,4);break;case 1:iA(e,8);break;default:throw new Error("Unimplemented type: "+t)}}var OUe=new Float32Array(1);new Uint8Array(OUe.buffer);var n2=new Float64Array(1),Wi=new Uint8Array(n2.buffer);function ep(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}var JZ=[];function j8(){let e=JZ.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function NUe(e){JZ.push(e)}function iA(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function QZ(e){return e.offset>=e.limit}function pm(e,t){let r=e.bytes,n=e.offset,i=e.limit,o=n+t;if(o>r.length){let s=new Uint8Array(2*o);s.set(r),e.bytes=s}return e.offset=o,o>i&&(e.limit=o),n}function i2(e,t){let r=e.offset;if(r+t>e.limit)throw new Error("Read past limit");return e.offset+=t,r}function ZZ(e,t){let r=i2(e,t),n=String.fromCharCode,i=e.bytes,o="�",s="";for(let a=0;a<t;a++){let c,l,d,u,p=i[a+r];128&p?(224&p)==192?a+1>=t?s+=o:(c=i[a+r+1],(192&c)!=128?s+=o:(u=(31&p)<<6|63&c,u<128?s+=o:(s+=n(u),a++))):(240&p)==224?a+2>=t?s+=o:(c=i[a+r+1],l=i[a+r+2],(49344&(c|l<<8))!=32896?s+=o:(u=(15&p)<<12|(63&c)<<6|63&l,u<2048||u>=55296&&u<=57343?s+=o:(s+=n(u),a+=2))):(248&p)==240?a+3>=t?s+=o:(c=i[a+r+1],l=i[a+r+2],d=i[a+r+3],(12632256&(c|l<<8|d<<16))!=8421504?s+=o:(u=(7&p)<<18|(63&c)<<12|(63&l)<<6|63&d,u<65536||u>1114111?s+=o:(u-=65536,s+=n(55296+(u>>10),56320+(1023&u)),a+=3))):s+=o:s+=n(p)}return s}function ec(e,t){let r=t.length,n=0;for(let s=0;s<r;s++){let a=t.charCodeAt(s);a>=55296&&a<=56319&&s+1<r&&(a=(a<<10)+t.charCodeAt(++s)-56613888),n+=a<128?1:a<2048?2:a<65536?3:4}Lt(e,n);let i=pm(e,n),o=e.bytes;for(let s=0;s<r;s++){let a=t.charCodeAt(s);a>=55296&&a<=56319&&s+1<r&&(a=(a<<10)+t.charCodeAt(++s)-56613888),a<128?o[i++]=a:(a<2048?o[i++]=a>>6&31|192:(a<65536?o[i++]=a>>12&15|224:(o[i++]=a>>18&7|240,o[i++]=a>>12&63|128),o[i++]=a>>6&63|128),o[i++]=63&a|128)}}function kUe(e,t){let r=pm(e,t.limit),n=e.bytes,i=t.bytes;for(let o=0,s=t.limit;o<s;o++)n[o+r]=i[o]}function e1(e){return e.bytes[i2(e,1)]}function U8(e,t){let r=pm(e,1);e.bytes[r]=t}function oA(e){let t=i2(e,8),r=e.bytes;return Wi[0]=r[t++],Wi[1]=r[t++],Wi[2]=r[t++],Wi[3]=r[t++],Wi[4]=r[t++],Wi[5]=r[t++],Wi[6]=r[t++],Wi[7]=r[t++],n2[0]}function sA(e,t){let r=pm(e,8),n=e.bytes;n2[0]=t,n[r++]=Wi[0],n[r++]=Wi[1],n[r++]=Wi[2],n[r++]=Wi[3],n[r++]=Wi[4],n[r++]=Wi[5],n[r++]=Wi[6],n[r++]=Wi[7]}function sc(e){let t,r=0,n=0;do t=e1(e),r<32&&(n|=(127&t)<<r),r+=7;while(128&t);return n}function Lt(e,t){for(t>>>=0;t>=128;)U8(e,127&t|128),t>>>=7;U8(e,t)}function jl(e,t){let r=t.low>>>0,n=(t.low>>>28|t.high<<4)>>>0,i=t.high>>>24,o=i===0?n===0?r<16384?r<128?1:2:r<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:i<128?9:10,s=pm(e,o),a=e.bytes;switch(o){case 10:a[s+9]=i>>>7&1;case 9:a[s+8]=o!==9?128|i:127&i;case 8:a[s+7]=o!==8?n>>>21|128:n>>>21&127;case 7:a[s+6]=o!==7?n>>>14|128:n>>>14&127;case 6:a[s+5]=o!==6?n>>>7|128:n>>>7&127;case 5:a[s+4]=o!==5?128|n:127&n;case 4:a[s+3]=o!==4?r>>>21|128:r>>>21&127;case 3:a[s+2]=o!==3?r>>>14|128:r>>>14&127;case 2:a[s+1]=o!==2?r>>>7|128:r>>>7&127;case 1:a[s]=o!==1?128|r:127&r}}function F8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}var PUe=new Map([["moderation",1],["supervise",2]]);function V8(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}var DUe=class extends fr{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;let t=this._connectionState;this._connectionState=e,this.emit(dn.CONNECTION_STATE_CHANGE,t,e)}get inspectType(){return this._inspectType}set inspectType(e){var t;this._inspectMode=ka(t=e.map(r=>PUe.get(r)||0)).call(t,(r,n)=>r+n),this._inspectType=e}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(e){super(),C(this,"name","AgoraRTCVideoContentInspect"),C(this,"_connectionState",Ms.CONNECTING),C(this,"_innerConnectionState",void 0),C(this,"sequence",0),C(this,"inspectStartTime",void 0),C(this,"workerManagerConnection",void 0),C(this,"workerConnection",void 0),C(this,"workerMessageLengthLimit",void 0),C(this,"inspectIntervalMinimum",void 0),C(this,"qualityRatio",void 0),C(this,"_connectInfo",void 0),C(this,"_cancelTokenSource",Li.CancelToken.source()),C(this,"_retryConfig",void 0),C(this,"wmSequence",0),C(this,"inspectInterval",void 0),C(this,"inspectTimer",null),C(this,"ossFilePrefix",void 0),C(this,"extraInfo",void 0),C(this,"_inspectType",void 0),C(this,"_inspectMode",void 0),C(this,"_quality",1),C(this,"qualityTimer",null),C(this,"_inspectId",void 0),C(this,"_needWorkUrlOnly",!1),C(this,"inspectImage",()=>{if(this.connectionState!==Ms.CONNECTED)throw new G(I.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===Ms.CONNECTED?this.requestToInspectImage():b.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=qt(5,"inspect-"),this.workerMessageLengthLimit=D("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=D("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=D("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=e.interval,this.ossFilePrefix=e.ossFilePrefix,this.extraInfo=e.extraInfo,this.inspectType=e.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new V0("worker-manager-"+this._inspectId,Fr),this.on(dn.STATE_CHANGE,(t,r)=>{this._innerConnectionState=t,b.debug("[".concat(this._inspectId,"] Inspect operation :").concat(Os[t]," ").concat(r||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new V0("worker-"+this._inspectId,Fr),this.handleWorkerEvents()}async init(e,t){this.emit(dn.STATE_CHANGE,Os.CONNECT_AP),this._connectInfo=e;let r=this._cancelTokenSource.token;return this._retryConfig=t,new de((n,i)=>{this.on(dn.CONNECTION_STATE_CHANGE,(o,s)=>{s===Ms.CONNECTED&&n()}),this.requestAP(e,r,t).then(o=>{this.connectWorkerManager(o)}).catch(o=>{i(o)})})}async requestAP(e,t,r){let n=D("WEBCS_DOMAIN").map(s=>"https://".concat(s,"/api/v1")),i=await function(s,a,c,l){let{appId:d,areaCode:u,cname:p,sid:f,token:m,uid:g}=a;Qp++;let y="image_moderation_api",v={service_name:y,json_body:JSON.stringify({appId:d,areaCode:u,cname:p,command:"allocateEdge",requestId:Qp,seq:Qp,sid:f,token:m,ts:Date.now(),uid:g+""})},E,w,S=s[0];return Ua(async()=>{E=Date.now();let A=await Fa(S,{data:v,cancelToken:c,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(w=Date.now()-E,A.code!==0){let W=new G(I.UNEXPECTED_RESPONSE,"image inspect ap error, code"+A.code,{retry:!0,responseTime:w});throw b.error(W.toString()),W}let N=JSON.parse(A.json_body);if(N.code!==200){let W=new G(I.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(N.code,", reason: ").concat(N.reason),{code:N.code,responseTime:w});throw b.error(W.toString()),W}if(!N.servers||!Array.isArray(N.servers)||N.servers.length===0){let W=new G(I.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:N.code,responseTime:w});throw b.error(W.toString()),W}let L=D("VIDEO_INSPECT_WORKER_MANAGER_HOST"),j=D("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:N.servers.map(W=>{let{address:V,wss:Y}=W;if(V&&Y)return"wss://".concat(V.replace(/\./g,"-"),".").concat(L,":").concat(j||Y)}).filter(W=>!!W),workerToken:N.workerToken,vid:N.vid,responseTime:w}},(A,N)=>(_e.apworkerEvent(f,{success:!0,sc:200,serviceName:y,responseDetail:JSON.stringify(A.addressList),firstSuccess:N===0,responseTime:w,serverIp:s[N%s.length]}),!1),(A,N)=>(_e.apworkerEvent(f,{success:!1,sc:A.data&&A.data.code||200,serviceName:y,responseTime:w,serverIp:s[N%s.length]}),!!(A.code!==I.OPERATION_ABORTED&&A.code!==I.UNEXPECTED_RESPONSE||A.data&&A.data.retry)&&(S=s[(N+1)%s.length],!0)),l)}(n,e,t,r);this.emit(dn.STATE_CHANGE,Os.AP_CONNECTED);let{addressList:o}=i;return this.wmSequence++,o}async connectWorkerManager(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=t,this.emit(dn.STATE_CHANGE,Os.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(e,1e4)}async connectWorker(e){await this.workerConnection.init([e])}handleWorkerManagerEvents(){this.workerManagerConnection.on(Fe.CONNECTED,async()=>{this.emit(dn.STATE_CHANGE,Os.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.22.0",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(Fe.CLOSED,()=>{this._innerConnectionState<Os.GET_WORKER_MANAGER_RESPONSE&&b.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(Fe.FAILED,()=>{this._innerConnectionState<Os.GET_WORKER_MANAGER_RESPONSE&&b.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(Fe.RECONNECTING,()=>{this._innerConnectionState<Os.GET_WORKER_MANAGER_RESPONSE&&b.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(Fe.ON_MESSAGE,async e=>{this.emit(dn.STATE_CHANGE,Os.GET_WORKER_MANAGER_RESPONSE);let t=this.workerManagerConnection.url;this.workerManagerConnection.close();let r=JSON.parse(e.data);if(r.code!==200)throw b.error("[".concat(this._inspectId,"] Unexpected code ").concat(r.code," from worker manager")),new G(I.UNEXPECTED_RESPONSE,"response code of worker is unexpected",r);if(!(r.serverResponse&&r.serverResponse.portWss&&t))throw b.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(r))),new G(I.UNEXPECTED_RESPONSE,"response content of worker is unexpected",r);{let n=D("VIDEO_INSPECT_WORKER_PORT")||r.serverResponse.portWss,i=t.replace(/:\d+\/?$/,":".concat(n));this.emit(dn.STATE_CHANGE,Os.CONNECT_WORKER,i),this._needWorkUrlOnly?this.emit(dn.REQUEST_NEW_WORKER_URL,i):await this.connectWorker(i)}}),this.workerManagerConnection.on(Fe.WILL_RECONNECT,(e,t,r)=>{r(e)}),this.workerManagerConnection.on(Fe.REQUEST_NEW_URLS,(e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)})}handleWorkerEvents(){this.workerConnection.on(Fe.CONNECTED,async()=>{this.emit(dn.STATE_CHANGE,Os.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=Ms.CONNECTED}),this.workerConnection.on(Fe.ON_MESSAGE,async e=>{if(e.data instanceof ArrayBuffer){let r=RUe(new Uint8Array(e.data));if(D("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&b.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(r)),r.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(dn.INSPECT_RESULT,void 0,void 0);if(r.data&&r.data.scorePorn&&r.data.scoreSexy&&r.data.scoreNeutral){var t;let n={porn:r.data.scorePorn,sexy:r.data.scoreSexy,neutral:r.data.scoreNeutral},i=ka(t=Object.keys(n)).call(t,(s,a)=>n[s]>n[a]?s:a,"porn"),o=Object.keys(n).find(s=>s===i);this.emit(dn.INSPECT_RESULT,o)}else this.emit(dn.INSPECT_RESULT,void 0,new G(I.UNEXPECTED_RESPONSE,r.code+"","There is an unexpected data on message"))}else this.emit(dn.INSPECT_RESULT,void 0,new G(I.UNEXPECTED_RESPONSE,r.code+"",r.msg))}else b.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(dn.INSPECT_RESULT,void 0,new G(I.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(Fe.CLOSED,()=>{this.connectionState=Ms.CLOSED}),this.workerConnection.on(Fe.FAILED,()=>{this.connectionState=Ms.CLOSED}),this.workerConnection.on(Fe.RECONNECTING,()=>{this.connectionState=this.connectionState===Ms.CONNECTED?Ms.RECONNECTING:Ms.CONNECTING}),this.workerConnection.on(Fe.WILL_RECONNECT,(e,t,r)=>{e==="recover"&&r(e),r("tryNext")}),this.workerConnection.on(Fe.REQUEST_NEW_URLS,(e,t)=>{this.workerManagerConnection.close(),this.once(dn.REQUEST_NEW_WORKER_URL,r=>{e([r])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(r=>{this.connectWorkerManager(r,!0)}).catch(r=>{t(r)})})}async requestToInspectImage(){this.sequence++;let e=is(this,dn.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void this.emit(dn.INSPECT_RESULT,void 0,new G(I.INVALID_OPERATION,"Only the track being played can be inspected"));let r=await this.generateRequestData(e,t);this.workerConnection.sendMessage(r,!0,!0)}else this.emit(dn.INSPECT_RESULT,void 0,new G(I.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(e,t){let{appId:r,cname:n,cid:i,vid:o,sid:s,uid:a}=t,c=Date.now(),l=await e.getCurrentFrameImage("image/jpeg",this.quality),d=await MQ(l,r,n),u=this.sequence+"-"+i+"-"+a+"-"+c+"-"+qt(12,""),p={appId:r,cid:i,cname:n,deviceId:"",elapse:V8(Number(c-this.inspectStartTime)),fileSize:d.byteLength,jpgEncryption:2,height:l.height,width:l.width,jpg:d,networkType:6,osType:7,requestId:u,sdkVersion:"4.22.0",sequence:this.sequence,sid:s,timestamp:V8(c),uid:a,vid:o,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete p.callbackData,this.ossFilePrefix===void 0&&delete p.ossFilePrefix;let f=CUe(p);if(f.byteLength<this.workerMessageLengthLimit){if(D("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){let m=function(g){for(var y=1;y<arguments.length;y++){var v=arguments[y]!=null?arguments[y]:{};y%2?F8(Object(v),!0).forEach(function(E){C(g,E,v[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(v)):F8(Object(v)).forEach(function(E){Object.defineProperty(g,E,Object.getOwnPropertyDescriptor(v,E))})}return g}({},p);delete m.jpg,b.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(m))}return f}{let m=this.quality*this.qualityRatio;return this.quality=m,await this.generateRequestData(e,{appId:r,cname:n,cid:i,vid:o,sid:s,uid:a})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Li.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Ms.CLOSED,this.emit(dn.STATE_CHANGE,Os.CLOSED)}},LUe={name:"ContentInspect",create:function(e){let{config:t}=e;return function(r){if(!r)throw new G(I.INVALID_PARAMS,"inspectConfig is necessary.");if(!r.inspectType||!Array.isArray(r.inspectType))throw new G(I.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{let n=[...new Set(r.inspectType)];n.forEach(i=>{var o;if(!pe(o=["supervise","moderation"]).call(o,i))throw new G(I.INVALID_PARAMS,"".concat(i," is not a valid inspect type."))}),r.inspectType=n}if(r&&r.extraInfo&&r.extraInfo.length>1024)throw new G(I.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(t),new DUe(t)}};Ft("PROCESS_ID","process-".concat(qt(8,""),"-").concat(qt(4,""),"-").concat(qt(4,""),"-").concat(qt(4,""),"-").concat(qt(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(t){return void b.error("Error loading sdk config",t.message)}if(e)try{let t=JSON.parse(window.atob(e)),r=Date.now();b.debug("Loading global parameters from cache",t),Object.keys(t).forEach(n=>{if(Object.prototype.hasOwnProperty.call(Ir,n)){let{value:i,expires:o}=t[n];if(o&&o<=r)return;nd[n]=i,Ir[n]=i}})}catch(t){b.error("Error loading mutableParamsCache: ".concat(e),t.message)}}(),Array.isArray(nd.AREAS)&&nd.AREAS.length>0&&qD(nd.AREAS,!0);var B8=(e,t,r)=>{b.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(t))),Ft(e,t,r)};Xm(bUe,!1),Xm(TUe,!1),Xm(oje,!1),Xm(LUe,!1),Xm(vUe,!1);var yr=function(e){let t=new fr,r=e,n={getListeners:t.getListeners.bind(t),on:(i,o)=>(function(s,a){s===ic.SECURITY_POLICY_VIOLATION&&IZ(a,!0)}(i,o),t.on.bind(t)(i,o)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return f8(f8({},r),n)}({__TRACK_LIST__:ip,VERSION:os,BUILD:DD,ESM_BUNDLER:!1,ESM:!0,UMD:!1,DEV:!1,setParameter:B8,getParameter:D,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection,r=await async function(n){let i;return Et().supportUnifiedPlan?(n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"}),i=(await n.createOffer()).sdp):i=(await n.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,i}(t);if(!r)return e;t.close(),t=null,e=function(n){let i={video:[],audio:[]};return n.match(/ VP8/i)&&i.video.push("VP8"),n.match(/ VP9/i)&&i.video.push("VP9"),n.match(/ AV1/i)&&i.video.push("AV1"),n.match(/ H264/i)&&i.video.push("H264"),n.match(/ H265/i)&&i.video.push("H265"),n.match(/ opus/i)&&i.audio.push("OPUS"),n.match(/ PCMU/i)&&i.audio.push("PCMU"),n.match(/ PCMA/i)&&i.audio.push("PCMA"),n.match(/ G722/i)&&i.audio.push("G722"),i}(r)}catch(t){throw new G(I.CREATE_OFFER_FAILED,t.toString&&t.toString()).print()}return e},checkSystemRequirements:function(){let e=_e.reportApiInvoke(null,{name:Gr.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Er.TRACER}),t=!1;try{let o=window.RTCPeerConnection,s=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,a=window.WebSocket;t=!!(o&&s&&a),t&&xD()&&BJ(75)&&new o().close()}catch(o){return b.error("check system requirement failed: ",o),!1}let r=!1,n=yt();n.name===Nt.CHROME&&Number(n.version)>=58&&(wa.engine.name!=="WebKit"||function(){let o=yt();if(Xb()){if(o.os===sn.MAC_OS)return!0;if(o.os===sn.IOS){let s=wa.os.version&&wa.os.version.split(".");if(s&&Number(s[0])===14&&s[1]&&Number(s[1])>=3||s&&Number(s[0])>14)return!0}}return!1}())&&(r=!0),(n.name===Nt.FIREFOX&&Number(n.version)>=56||n.name===Nt.OPERA&&Number(n.version)>=45||n.name===Nt.SAFARI&&Number(n.version)>=11||n.name==="WebKit"&&(Ei()||Js())&&n.osVersion&&Number(n.osVersion.split(".")[0])>=11||GJ()||yt().name===Nt.QQ)&&(r=!0),b.debug("checkSystemRequirements, api:",t,"browser",r);let i=t&&r;return e.onSuccess(i),i},getDevices:function(e){return Oo.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return Oo.getRecordingDevices(e)},getCameras:function(e){return Oo.getCamerasDevices(e)},getElectronScreenSources:RQ,getPlaybackDevices:function(e){return Oo.getSpeakers(e)},createClient:function(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"},r=_e.reportApiInvoke(null,{name:Gr.CREATE_CLIENT,options:[t],tag:Er.TRACER});try{(function(n){Xr(n.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Xr(n.mode,"config.mode",["rtc","live","p2p"]),n.audioCodec!==void 0&&Xr(n.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),n.proxyServer!==void 0&&En(n.proxyServer,"config.proxyServer",1,1e4),n.turnServer!==void 0&&XJ(n.turnServer),n.httpRetryConfig!==void 0&&P3(n.httpRetryConfig),n.websocketRetryConfig!==void 0&&P3(n.websocketRetryConfig)})(t)}catch(n){throw r.onError(n),n}return(HJ(16,0)||WJ(16,0))&&(t.codec==="vp9"&&(t.codec="vp8",b.debug("browser not support vp9, force use vp8")),Ft("UNSUPPORTED_VIDEO_CODEC",["vp9"])),t.audioCodec===void 0&&(t.audioCodec="opus"),r.onSuccess(),new sje(va(va({forceWaitGatewayResponse:!0},t),{},{role:pe(e=["rtc","p2p"]).call(e,t.mode)?"host":t.role||"audience"}))},createCameraVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=D("CAMERA_CAPTURE_CONFIG"),r=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CREATE_CAM_VIDEO_TRACK,options:[sr({},e),t]});t&&(e.encoderConfig=t);let n=ew(e),i=qt(8,"track-cam-"),o=null;b.info("start create camera video track with config",JSON.stringify(e),"trackId",i);try{o=(await Ro({video:n},i)).getVideoTracks()[0]||null}catch(a){throw r.onError(a),a}if(!o){let a=new X(I.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(a),a.throw(b)}e.optimizationMode&&II(i,o,e,lc(e.encoderConfig));let s=new GO(o,e,n,e.scalabiltyMode?dE(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,i);return r.onSuccess(s.getTrackId()),b.info("create camera video success, trackId:",i),s},createCustomVideoTrack:function(e){let t=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),r=new Qt(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?dE(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,qt(8,"track-cus-"),[nr.CUSTOM_TRACK]);return t.onSuccess(r.getTrackId()),b.info("create custom video track success with config",e,"trackId",r.getTrackId()),r},createScreenVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable",r=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CREATE_SCREEN_VIDEO_TRACK,options:[sr({},e),t]});e.encoderConfig?typeof e.encoderConfig=="string"||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";let n=function(d){let u={};d.screenSourceType&&(u.mediaSource=d.screenSourceType),d.extensionId&&vd()&&(u.extensionId=d.extensionId);let{displaySurface:p,selfBrowserSurface:f,surfaceSwitching:m,systemAudio:g}=d;(xO(107)||I3(107)||A3(93))&&(p&&(Xr(p,"displaySurface",["browser","window","monitor"]),u.displaySurface=p),f?(Xr(f,"selfBrowserSurface",["exclude","include"]),u.selfBrowserSurface=f):u.selfBrowserSurface="include",m&&(Xr(m,"surfaceSwitching",["exclude","include"]),u.surfaceSwitching=m)),(xO(105)||I3(105)||A3(91))&&g&&(Xr(g,"systemAudio",["exclude","include"]),u.systemAudio=g),d.electronScreenSourceId&&(u.sourceId=d.electronScreenSourceId);let y=d.encoderConfig?SI(d.encoderConfig):null;return u.mandatory={chromeMediaSource:"desktop",maxWidth:y?y.width:void 0,maxHeight:y?y.height:void 0},y&&(y.frameRate&&(typeof y.frameRate=="number"?(u.mandatory.maxFrameRate=y.frameRate,u.mandatory.minFrameRate=y.frameRate):(u.mandatory.maxFrameRate=y.frameRate.max||y.frameRate.ideal||y.frameRate.exact||void 0,u.mandatory.minFrameRate=y.frameRate.min||y.frameRate.ideal||y.frameRate.exact||void 0),u.frameRate=y.frameRate),y.width&&(u.width=y.width),y.height&&(u.height=y.height)),u}(e),i=qt(8,"track-scr-v-"),o=null,s=null,a=Et();if(!a.supportShareAudio&&t==="enable"){let d=new X(I.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return r.onError(d),d.throw(b)}b.info("start create screen video track with config",e,"withAudio",t,"trackId",i);try{let d=await Ro({screen:n,screenAudio:t==="auto"?a.supportShareAudio:t==="enable"},i);o=d.getVideoTracks()[0]||null,s=d.getAudioTracks()[0]||null}catch(d){throw r.onError(d),d}if(!o){let d=new X(I.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(d),d.throw(b)}if(!s&&t==="enable"){o&&o.stop();let d=new X(I.SHARE_AUDIO_NOT_ALLOWED);return r.onError(d),d.throw(b)}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(II(i,o,e,e.encoderConfig&&SI(e.encoderConfig)||void 0),e.encoderConfig&&typeof e.encoderConfig!="string"&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));let c=new Qt(o,e.encoderConfig?SI(e.encoderConfig):{},e.scalabiltyMode?dE(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,i,[nr.SCREEN_TRACK]);if(!s)return r.onSuccess(c.getTrackId()),b.info("create screen video track success","video:",c.getTrackId()),c;let l=new vr(s,void 0,qt(8,"track-scr-a-"),!1);return r.onSuccess([c.getTrackId(),l.getTrackId()]),b.info("create screen video track success","video:",c.getTrackId(),"audio:",l.getTrackId()),[c,l]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=D("CAMERA_CAPTURE_CONFIG"),n=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CREATE_MIC_AND_CAM_TRACKS,options:[e,t,r]});r&&(t.encoderConfig=r);let i=ew(t),o=DF(e),s=qt(8,"track-mic-"),a=qt(8,"track-cam-"),c=null,l=null;b.info("start create camera video track(".concat(a,") and microphone audio track(").concat(s,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(t)));try{let p=await Ro({audio:o,video:i},"".concat(s,"-").concat(a));c=p.getAudioTracks()[0],l=p.getVideoTracks()[0]}catch(p){throw n.onError(p),p}if(!c||!l){let p=new X(I.UNEXPECTED_ERROR,"can not find tracks in media stream");return n.onError(p),p.throw(b)}t.optimizationMode&&II(a,l,t,lc(t.encoderConfig));let d=new tw(c,e,o,s),u=new GO(l,t,i,t.scalabiltyMode?dE(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,a);return n.onSuccess([d.getTrackId(),u.getTrackId()]),b.info("create camera video track(".concat(a,") and microphone audio track(").concat(s,") success")),[d,u]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CREATE_MIC_AUDIO_TRACK,options:[e]}),r=DF(e),n=qt(8,"track-mic-"),i=null;b.info("start create microphone audio track with config",JSON.stringify(e),"trackId",n);try{i=(await Ro({audio:r},n)).getAudioTracks()[0]||null}catch(s){throw t.onError(s),s}if(!i){let s=new X(I.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(s),s.throw(b)}let o=new tw(i,e,r,n);return t.onSuccess(o.getTrackId()),b.info("create microphone audio track success, trackId:",n),o},createCustomAudioTrack:function(e){let t=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),r=new vr(e.mediaStreamTrack,e.encoderConfig?Zb(e.encoderConfig):{},qt(8,"track-cus-"),!1);return b.info("create custom audio track success with config",e,"trackId",r.getTrackId()),t.onSuccess(r.getTrackId()),r},createBufferSourceAudioTrack:async function(e){var t;let{cacheOnlineFile:r,encoderConfig:n}=e,{source:i}=e,o={source:i instanceof AudioBuffer?"AudioBuffer":i instanceof File?(t=File.name)!==null&&t!==void 0?t:"File":i,cacheOnlineFile:r,encoderConfig:n},s=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CREATE_BUFFER_AUDIO_TRACK,options:[o]});if(D("DISABLE_WEBAUDIO"))throw new X(I.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");let a=qt(8,"track-buf-");b.info("start create buffer source audio track with config",JSON.stringify(o),"trackId",a);let c=i;if(!(i instanceof AudioBuffer))try{i=await async function(u,p){let f=null;if(typeof u=="string"){let g=vV.get(u);if(g)return b.debug("use cached audio resource: ",u),g;try{f=(await Ua(()=>Li.get(u,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(y){throw new X(I.FETCH_AUDIO_FILE_FAILED,y.toString())}}else f=await new de((g,y)=>{let v=new FileReader;v.onload=E=>{E.target?g(E.target.result):y(new X(I.READ_LOCAL_AUDIO_FILE_ERROR))},v.onerror=()=>{y(new X(I.READ_LOCAL_AUDIO_FILE_ERROR))},v.readAsArrayBuffer(u)});let m=await function(g){let y=lm();return new de((v,E)=>{y.decodeAudioData(g,w=>{v(w)},w=>{E(new X(I.DECODE_AUDIO_FILE_FAILED,w.toString()))})})}(f);return typeof u=="string"&&p&&vV.set(u,m),m}(i,r)}catch(u){return s.onError(u),u.throw(b)}let l=new rMe(i),d=new tMe(c,l,n?Zb(n):{},a);return b.info("create buffer source audio track success, trackId:",a),s.onSuccess(d.getTrackId()),d},setAppType:function(e){if(b.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw b.debug("Invalid appType"),new G(I.INVALID_PARAMS,"invalid app type",e);Ft("APP_TYPE",Math.floor(e))},setLogLevel:function(e){b.setLogLevel(e)},enableLogUpload:function(){D("USE_NEW_LOG")?Ft("UPLOAD_LOG",!0):b.enableLogUpload()},disableLogUpload:function(){D("USE_NEW_LOG")?Ft("UPLOAD_LOG",!1):b.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new uZ},checkAudioTrackIsActive:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3,r=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof vr||e instanceof Jp)){let c=new G(I.INVALID_TRACK,"the parameter is not a audio track");return r.onError(c),c.throw()}t&&t<1e3&&(t=1e3);let n=e instanceof vr?e.getTrackLabel():"remote_track",i=e.getVolumeLevel(),o=i,s=i,a=Date.now();return new de(c=>{let l=setInterval(()=>{let d=e.getVolumeLevel();o=d>o?d:o,s=d<s?d:s;let u=o-s>1e-4,p=Date.now()-a;if(u||p>t){clearInterval(l);let f=u,m={duration:p,deviceLabel:n,maxVolumeLevel:o,result:f};b.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(m))),r.onSuccess(m),c(f)}},200)})},checkVideoTrackIsActive:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3,r=_e.reportApiInvoke(null,{tag:Er.TRACER,name:Gr.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof Qt||e instanceof Xp)){let u=new G(I.INVALID_TRACK,"the parameter is not a video track");return r.onError(u),u.throw()}t&&t<1e3&&(t=1e3);let n=e instanceof Qt?e.getTrackLabel():"remote_track",i=e.getMediaStreamTrack(!0),o=document.createElement("video");o.style.width="1px",o.style.height="1px",o.setAttribute("muted",""),o.muted=!0,o.setAttribute("playsinline",""),o.controls=!1,(Pn()||Xb())&&(o.style.opacity="0.01",o.style.position="fixed",o.style.left="0",o.style.top="0",document.body.appendChild(o)),o.srcObject=new MediaStream([i]),o.play();let s=document.createElement("canvas");s.width=160,s.height=120;let a=0,c=0;try{let u=Date.now();a=await function(p,f,m,g){let y,v=0,E=null;return new de((w,S)=>{function A(){v>g&&y&&(y(),w(v));let N=m.getContext("2d");if(!N){let W=new G(I.UNEXPECTED_ERROR,"can not get canvas 2d context.");return b.error(W.toString()),void S(W)}N.drawImage(p,0,0,160,120);let L=N.getImageData(0,0,m.width,m.height),j=Math.floor(L.data.length/3);if(E){for(let W=0;W<j;W+=3)if(L.data[W]!==E[W])return v+=1,void(E=L.data);E=L.data}else E=L.data}setTimeout(()=>{y&&(y(),w(v))},f),y=$D(()=>{A()},30)})}(o,t,s,4),c=Date.now()-u}catch(u){throw r.onError(u),u}WMe===Nt.SAFARI&&(o.pause(),o.remove()),o.srcObject=null;let l=a>4,d={duration:c,changedPicNum:a,deviceLabel:n,result:l};return b.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(d))),r.onSuccess(d),l},setArea:qD,audioElementPlayCenter:Ni,resumeAudioContext:function(){Ni.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){cje.processExternalMediaAEC(e)},registerExtensions:function(e){let t=D("PLUGIN_INFO")||[];e.forEach(r=>{"name"in r&&!pe(t).call(t,r.name)&&t.push(r.name);let n=r;n.__registered__=!0,n.logger.hookLog=b.extLog,n.reporter.hookApiInvoke=_e.extApiInvoke,n.parameters&&Object.keys(n.parameters).forEach(i=>{n.parameters[i]=D(i)})}),B8("PLUGIN_INFO",t)},ChannelMediaRelayError:np,ChannelMediaRelayEvent:jc,ChannelMediaRelayState:Bi,RemoteStreamFallbackType:qLe,RemoteStreamType:KLe,ConnectionDisconnectedReason:Mt,AudienceLatencyLevelType:IDe,AREAS:St,preload:async function(e,t,r,n){return yZ(e,t,r,n)}});Object.defineProperties(yr,{onAudioAutoplayFailed:{get:()=>bo.onAudioAutoplayFailed,set:e=>{bo.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>bo.onAutoplayFailed,set:e=>{bo.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>yr._onSecurityPolicyViolation,set(e){yr._onSecurityPolicyViolation=e,IZ(e)}},__CLIENT_LIST__:{get:()=>D("SHOW_GLOBAL_CLIENT_LIST")?zl:[]}}),Oo.on(Cu.CAMERA_DEVICE_CHANGED,e=>{b.info("camera device changed",JSON.stringify(e)),yr.onCameraChanged&&yr.onCameraChanged(e),yr.safeEmit(ic.CAMERA_CHANGED,e)}),Oo.on(Cu.RECORDING_DEVICE_CHANGED,e=>{b.info("microphone device changed",JSON.stringify(e)),yr.onMicrophoneChanged&&yr.onMicrophoneChanged(e),yr.safeEmit(ic.MICROPHONE_CHANGED,e)}),Oo.on(Cu.PLAYOUT_DEVICE_CHANGED,e=>{b.debug("playout device changed",JSON.stringify(e)),yr.onPlaybackDeviceChanged&&yr.onPlaybackDeviceChanged(e),yr.safeEmit(ic.PLAYBACK_DEVICE_CHANGED,e)}),Ni.onAutoplayFailed=()=>{b.info("detect audio element autoplay failed"),bo.onAudioAutoplayFailed&&bo.onAudioAutoplayFailed()},Ut.on("autoplay-failed",()=>{b.info("detect webaudio autoplay failed"),bo.onAudioAutoplayFailed&&bo.onAudioAutoplayFailed(),yr.safeEmit(ic.AUTOPLAY_FAILED)}),Ut.on(bn.STATE_CHANGE,(e,t)=>{b.info("audio context state changed: ".concat(t," => ").concat(e)),yr.onAudioContextStateChanged&&yr.onAudioContextStateChanged(e,t),yr.safeEmit(ic.AUDIO_CONTEXT_STATE_CHANGED,e,t)}),Dr.on(xp.NETWORK_STATE_CHANGE,(e,t)=>{b.info("[network-indicator] network state changed, ".concat(t," => ").concat(e))}),window&&(window.__ARTC__=yr);function xu(e,t,r){return e.on(t,r),()=>e.off(t,r)}function MUe(e){try{return e()}catch(t){console.error(t)}}function lT(e){return()=>e.forEach(MUe)}function jUe(e,t){let r=setTimeout(e,t);return()=>clearTimeout(r)}function o2(){let e,t,r;function n(){if(t){let l=t;t=void 0,l()}}async function i(){if(r){let l=r;r=void 0;try{await l()}catch(d){console.error(d)}}}async function o(l){e=!0,await i();try{r=await l()}catch(d){console.error(d)}e=!1,n()}async function s(){e=!0,await i(),e=!1,n()}function a(l){e?t=()=>o(l):o(l)}function c(){e?t=s:s()}return{run:a,dispose:c}}var t1=typeof document<"u"?T.useLayoutEffect:T.useEffect;function UUe(e){return e!=null&&typeof e.then=="function"}function Gy(){let e=T.useRef(!1);return T.useEffect(()=>(e.current=!1,()=>{e.current=!0}),[]),e}function FUe(){let e=Gy();function t(r,n){return new Promise(async(i,o)=>{try{let s=await r;e.current||i(s)}catch(s){e.current?n&&n(s):o(s)}})}return T.useCallback(t,[e])}function r1(e){let t=FUe(),[r,n]=T.useState();return t1(()=>{UUe(e)?t(e).then(n):n(e)},[e,t]),r}function dT(e,t){let r=T.useRef();T.useEffect(()=>{let{run:n,dispose:i}=r.current||(r.current=o2());return n(e),i},t)}function VUe(e,t){let r=e.split("."),n=t.split("."),i=Math.max(r.length,n.length);for(let o=0;o<i;o++){let s=parseInt(r[o]||"0"),a=parseInt(n[o]||"0");if(s>a)return 1;if(s<a)return-1}return 0}var n1=T.createContext(null);function BUe({client:e,children:t}){return h.jsx(n1.Provider,{value:e,children:t})}function $Ue(e){return T.useContext(n1)}function zy(e){let t=$Ue();if(!t)throw new Error("Agora RTC client not found. Should be wrapped in <AgoraRTCProvider value={client} />");return t}T.createContext(null);function fm(e){let t=zy(),[r,n]=T.useState(t?t.connectionState==="CONNECTED":!1);return T.useEffect(()=>{if(t){n(t.connectionState==="CONNECTED");let i;return lT([xu(t,"connection-state-change",o=>{i==null||i(),i=jUe(()=>n(o==="CONNECTED"),0)}),()=>i==null?void 0:i()])}else n(!1)},[t]),r}var sh=class extends Error{constructor(t,r){var e=(...M3e)=>(super(...M3e),wm(this,"rtcMethod"),wm(this,"rtcError"),wm(this,"name","AgoraRTCReactException"),this);e(typeof r=="string"?r:r.message),this.rtcMethod=t,this.rtcError=r}log(t){console[t](this)}};function HUe(e,t=!0,r){let n=zy(),i=fm(),o=T.useRef(),[s,a]=T.useState(!1),[c,l]=T.useState(0),[d,u]=T.useState(null),p=Gy();return dT(async()=>{if(p.current||(u(null),l(0),a(!1)),t&&n){try{p.current||a(!0);let{appid:m,channel:g,token:y,uid:v}=typeof e=="function"?await e():e,E=await n.join(m,g,y,v);p.current||l(E)}catch(m){console.error(m),p.current||u(new sh("IAgoraRTCClient.join",m))}p.current||a(!1);let f=o.current||(o.current=o2());return lT([()=>{f.dispose()},()=>{f.run(()=>n.unpublish(n.localTracks))},()=>{for(let m of n.localTracks)m.isPlaying&&m.stop(),m.close();f.run(()=>n.leave())}])}},[t,r]),{data:c,isLoading:s,isConnected:i,error:d}}function WUe(e,t=!0,r){let n=zy(),i=fm(),o=T.useRef([]),[s,a]=T.useState(!1),[c,l]=T.useState(null),d=Gy();return dT(async()=>{if(d.current||(a(!1),l(null)),!n||!i||!t)return;let u=e.filter(Boolean),p=g=>{let y=VUe(yr.VERSION,"4.18.2")>=0;return y||new sh("usePublish","please check your agora-rtc-sdk-ng version in package.json, it's recommend upgrade to >= 4.18.2").log("warn"),y?n.mode!=="live"||n.role!=="audience":!0},f=g=>o.current.some(y=>y&&y.getTrackId()===g.getTrackId()),m=g=>p()&&g.enabled&&t&&!f(g);for(let g=0;g<u.length;g++){let y=u[g];if(y&&m(y)){await n.unpublish(o.current.filter(v=>(v==null?void 0:v.trackMediaType)===y.trackMediaType));try{d.current||a(!0),await n.publish(y)}catch(v){console.error(v),d.current||l(new sh("IAgoraRTCClient.publish",v))}d.current||a(!1)}}o.current=u},[i,t,n,e]),{isLoading:s,error:c}}function GUe(e=!0,t={ANS:!0,AEC:!0},r){let n=fm(),[i,o]=T.useState(null),[s,a]=T.useState(!1),[c,l]=T.useState(null),d=Gy();return dT(async()=>{if(d.current||(a(!1),l(null)),n&&e&&!i){try{d.current||a(!0);let u=await yr.createMicrophoneAudioTrack(t);d.current||o(u)}catch(u){console.error(u),d.current||l(new sh("IAgoraRTC.createMicrophoneAudioTrack",u))}d.current||a(!1)}!n&&!d.current&&o(null)},[n,e]),{localMicrophoneTrack:i,isLoading:s,error:c}}function zUe(e=!0,t,r){let n=fm(),[i,o]=T.useState(null),[s,a]=T.useState(!1),[c,l]=T.useState(null),d=Gy();return dT(async()=>{if(d.current||(a(!1),l(null)),n&&e&&!i){try{d.current||a(!0);let u=await yr.createCameraVideoTrack(t);d.current||o(u)}catch(u){console.error(u),d.current||l(new sh("IAgoraRTC.createCameraVideoTrack",u))}d.current||a(!1)}!n&&!d.current&&o(null)},[n,e]),{localCameraTrack:i,isLoading:s,error:c}}function $8(e,t,r){let n=zy(),i=t==="audio"?"audioTrack":"videoTrack",[o,s]=T.useState(e&&e[i]),a=fm(),c=T.useRef(),[l,d]=T.useState(!1),[u,p]=T.useState(null);return T.useEffect(()=>{if(!e||!a)return;let f=!1;f||p(null);let m=t==="audio"?"hasAudio":"hasVideo",g=e.uid,y=async(w,S)=>{if(w[i]&&n.remoteUsers.some(({uid:A})=>w.uid===A))try{f||d(!0),await n.unsubscribe(w,S)}catch(A){f||p(new sh("IAgoraRTCClient.unsubscribe",A)),console.error(A)}f||(s(void 0),d(!1))},v=async(w,S)=>{try{!w[i]&&n.remoteUsers.some(({uid:A})=>w.uid===A)&&(f||d(!0),await n.subscribe(w,S)),f||s(w[i])}catch(A){f||p(new sh("IAgoraRTCClient.subscribe",A)),console.error(A)}f||d(!1)},E=c.current||(c.current=o2());return!e[i]&&e[m]?E.run(()=>v(e,t)):s(e[i]),lT([()=>{f=!0,E.dispose()},xu(n,"user-published",(w,S)=>{w.uid===g&&S===t&&E.run(()=>v(w,t))}),xu(n,"user-unpublished",(w,S)=>{w.uid===g&&S===t&&E.run(()=>y(w,t))})])},[a,n,e,t,i]),{track:o,isLoading:l,error:u}}function KUe(e){let t=zy(),[r,n]=T.useState(t?t.remoteUsers:[]);return T.useEffect(()=>{if(t){let i=()=>n(t.remoteUsers.slice());return lT([xu(t,"user-joined",i),xu(t,"user-left",i),xu(t,"user-published",i),xu(t,"user-unpublished",i)])}},[t]),r}var i1=T.createContext(void 0);function o1(e,t,r,n){let i=T.useContext(i1);T.useEffect(()=>{if(e)return n&&t?e.play(n,r||void 0):e.stop(),i?(i.onMount(e),()=>i.onUnmount(e)):()=>{e.isPlaying&&e.stop()}},[e,n,t,i,r])}function s1(e,t){let r=T.useContext(i1);t1(()=>{if(e)return t?e.play():e.stop(),r?(r.onMount(e),()=>r.onUnmount(e)):()=>{e.isPlaying&&e.stop()}},[e,t,r])}function qUe({track:e,play:t=!1,volume:r,disabled:n,muted:i,children:o}){let s=r1(e);return s1(s,t),T.useEffect(()=>{s&&r!=null&&s.setVolume(r)},[s,r]),T.useEffect(()=>{s&&n!=null&&s.setEnabled(!n).catch(console.warn)},[n,s]),T.useEffect(()=>{s&&i!=null&&s.setMuted(i).catch(console.warn)},[i,s]),o?h.jsx(h.Fragment,{children:o}):null}var a1={position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#000"},c1={width:"100%",height:"100%"},s2={position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:2},uT=(e,t)=>T.useMemo(()=>({...e,...t}),[e,t]);function YUe({track:e,play:t,disabled:r,muted:n,style:i,videoPlayerConfig:o,...s}){let a=uT(c1,i),[c,l]=T.useState(null),d=r1(e);return o1(d,t,o,c),T.useEffect(()=>{d&&r!=null&&d.setEnabled(!r).catch(console.warn)},[r,d]),T.useEffect(()=>{d&&n!=null&&d.setMuted(n).catch(console.warn)},[n,d]),h.jsx("div",{...s,ref:l,style:a})}var XUe={width:"100%",height:"100%",background:"#1a1e21 center/cover no-repeat",filter:"blur(16px) brightness(0.4)"},JUe={position:"absolute",top:"50%",left:"50%",maxWidth:"50%",maxHeight:"50%",aspectRatio:"1",transform:"translate(-50%, -50%)",borderRadius:"50%",overflow:"hidden",objectFit:"cover"};function l1({cover:e}){return h.jsx("div",{style:s2,children:typeof e=="string"?h.jsxs(h.Fragment,{children:[h.jsx("div",{style:{...XUe,backgroundImage:`url(${e})`}}),h.jsx("img",{src:e,style:JUe})]}):e()})}function QUe({micOn:e,cameraOn:t,audioTrack:r,videoTrack:n,playAudio:i,playVideo:o,volume:s,cover:a,children:c,style:l,...d}){let u=uT(a1,l);return o=o??!!t,i=i??!!e,h.jsxs("div",{...d,style:u,children:[h.jsx(YUe,{disabled:!t,play:o,track:n}),h.jsx(qUe,{disabled:!e,play:i,track:r,volume:s}),a&&!t&&h.jsx(l1,{cover:a}),h.jsx("div",{style:s2,children:c})]})}function ZUe({track:e,play:t=!1,playbackDeviceId:r,volume:n,children:i}){return s1(e,t),T.useEffect(()=>{e&&r!=null&&e.setPlaybackDevice(r).catch(console.warn)},[e,r]),T.useEffect(()=>{e&&n!=null&&e.setVolume(n)},[e,n]),i?h.jsx(h.Fragment,{children:i}):null}function e5e({track:e,play:t,style:r,videoPlayerConfig:n,...i}){let o=uT(c1,r),[s,a]=T.useState(null);return o1(e,t,n,s),h.jsx("div",{...i,ref:a,style:o})}function t5e({user:e,playVideo:t,playAudio:r,playbackDeviceId:n,volume:i,cover:o,style:s,children:a,videoPlayerConfig:c,...l}){let d=uT(a1,s),{track:u}=$8(e,"video"),{track:p}=$8(e,"audio");return t=t??(e==null?void 0:e.hasVideo),r=r??(e==null?void 0:e.hasAudio),h.jsxs("div",{...l,style:d,children:[h.jsx(e5e,{play:t,track:u,videoPlayerConfig:c}),h.jsx(ZUe,{play:r,playbackDeviceId:n,track:p,volume:i}),o&&!t&&h.jsx(l1,{cover:o}),h.jsx("div",{style:s2,children:a})]})}var r5e=class{constructor(){wm(this,"appType",1001);yr.setAppType(this.appType)}};new r5e;var n5e=yr;const aN=n5e.createClient({mode:"rtc",codec:"vp8"});function i5e(){const e=new URLSearchParams(location.search),t=e.get("doctorId"),r=e.get("patientId");return h.jsxs("div",{className:"w-screen h-screen flex flex-col gap-2",children:[h.jsx("h1",{className:"w-full h-auto bg-blue-500 p-2 text-lg font-medium flex justify-center shadow-lg",children:"Consultation"}),h.jsx("div",{className:"flex flex-1 w-full p-2",children:h.jsx(BUe,{client:aN,children:h.jsx("div",{className:"w-full h-[80vh]",children:h.jsx(o5e,{doctorId:t,patientId:r})})})})]})}function o5e(e){const t="7b2118df626f4986907f6d989f14fa9d",r=fm(),[n,i]=T.useState(!0),[o,s]=T.useState(!0),[a,c]=T.useState(!0),{localMicrophoneTrack:l}=GUe(o),{localCameraTrack:d}=zUe(a),{doctorId:u,patientId:p}=e;HUe({appid:t,channel:`consulation_${u}_${p}`,token:null},n),WUe([l,d]),T.useEffect(()=>{aN.on("user-joined",m=>{console.log("userrr",m)}),aN.on("user-published",(m,g)=>{console.log("user published",m.uid,g)})},[]);const f=KUe();return h.jsx("div",{className:"w-full h-[88vh]  flex ",children:r&&h.jsxs("div",{className:"w-screen h-full flex gap-2 ",children:[h.jsxs("div",{className:"w-[80%] h-full grid grid-cols-1 ",children:[f.map((m,g)=>h.jsx("div",{className:"w-full h-full ",children:h.jsx(t5e,{user:m,className:"rounded-lg  "},g)},g)),h.jsx("div",{className:"h-full w-full px-5 py-2 flex flex-col justify-end",children:h.jsx(s5e,{setCameraOn:c,setMicOn:s,cameraOn:a,micOn:o,setCalling:i})})]}),h.jsx("div",{className:"w-[20%] h-full flex flex-col justify-end",children:h.jsx("div",{className:"w-full h-[30vh]",children:h.jsx(QUe,{cameraOn:a,micOn:o,videoTrack:d,audioTrack:l,className:"rounded-lg",children:h.jsx("samp",{className:"pr-2 flex justify-end text-white text-2xl",children:"you"})})})})]})})}function s5e(e){const{setMicOn:t,setCameraOn:r,micOn:n,cameraOn:i,setCalling:o}=e;return h.jsx("div",{className:"w-full h-[10vh] bg-white bg-opacity-20 rounded-lg  flex flex-between gap-2 ",children:h.jsxs("div",{className:"w-full h-full flex justify-center gap-4 p-4",children:[h.jsx("div",{className:`callButton ${n?"bg-red-500":"bg-white"}  w-[10%] h-full flex items-center justify-center`,onClick:s=>t(!n),children:h.jsx(Lbe,{})}),h.jsx("button",{className:`callButton ${i?"bg-red-500":"bg-white"}  w-[10%] h-full flex items-center justify-center`,onClick:s=>r(!i),children:h.jsx(B_e,{})}),h.jsx("button",{type:"button",className:"callButton bg-red-500  w-[10%] h-full flex items-center justify-center",onClick:s=>o(a=>!a),children:h.jsx(Pbe,{})})]})})}function a5e(){const{firstName:e}=lo(t=>t.patient);return h.jsx("div",{className:"w-full h-full flex",children:h.jsx("div",{className:"w-full h-full flex flex-col gap-2",children:h.jsxs("div",{className:"doctor details flex flex-col gap-4",children:[h.jsxs("h1",{className:"w-[60%] h-[20vh] flex item-center p-2 rounded-lg bg-red-400 ",children:[`you have a meeting ${e}`,"  "]}),h.jsx("div",{className:"content w-full h-full flex"})]})})})}function c5e(){return h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"w-full h-full flex flex-col p-2",children:h.jsxs("div",{className:"meetingAlert w-full h-full flex flex-col gap-2",children:[h.jsx("h2",{className:"w-[80%] h-[8vh] text-lg font-medium flex items-center pl-10 bg-blue-500",children:"Notifications"}),h.jsx("div",{className:"alerts flex flex-col hap-2",children:h.jsx(a5e,{})})]})})})}Ct.extend(vl);function l5e(e){var n,i,o,s,a,c;const{booking:t}=e,r=Ln();return console.log("test date",Ct().add(2,"hour").isBefore(Ct(`${t.slotDate} ${t.startTime}`,"D MMM, dddd YYYY H:mm A").add(2,"hour"))),h.jsx("div",{className:"w-full h-full ",children:h.jsxs("div",{className:"w-full h-full flex gap-2 border shadow-lg p-4 bg-white rounded-lg hover:bg-black hover:bg-opacity-10 cursor-pointer",children:[h.jsx("div",{className:"image w-auto h-full flex items-center px-5",children:h.jsx("img",{src:(n=t==null?void 0:t.patientId)==null?void 0:n.profileImage,className:"h-[15vh] w-[7vw] rounded-full"})}),h.jsxs("div",{className:"details w-auto h-full px-2 py-2 flex flex-col gap-4 flex-1 items-start border bg-black bg-opacity-5 ",children:[h.jsx("div",{className:"w-full h-auto",children:h.jsx("h4",{children:(i=t==null?void 0:t.patientId)==null?void 0:i.firstName})}),h.jsx("div",{className:"location w-full h-auto",children:h.jsxs("div",{className:"flex gap-4 items-start",children:[h.jsx(Oy,{}),h.jsxs("div",{className:"flex flex-col gap-2 w-auto h-full items-start justify-start",children:[h.jsx("span",{className:"flex items-center",children:(s=(o=t==null?void 0:t.patientId)==null?void 0:o.addressId)==null?void 0:s.place}),h.jsx("span",{className:"flex items-center",children:(c=(a=t==null?void 0:t.patientId)==null?void 0:a.addressId)==null?void 0:c.district})]})]})})]}),h.jsxs("div",{className:"w-auto h-full flex flex-1 flex-col justify-end font-bold gap-4 py-2 px-2 bg-emerald-200 bg-opacity-40",children:[h.jsxs("div",{className:"slotDetails w-full h-auto p-4 flex gap-4 items-center",children:[h.jsx(RS,{}),h.jsx("span",{children:`Completed On ${t==null?void 0:t.slotDate} ${Ct(t==null?void 0:t.startTime,"H:mm A").format("h:mm A").toString()}`})]}),h.jsxs("div",{className:"w-full h-auto flex flex-between gap-4",children:[h.jsx("button",{className:"cancel w-full h-auto p-2 bg-blue-500 font-medium flex items-center justify-center",onClick:l=>r(`/doctor/bookings/prescription/${t.patientId.userId}/${t._id}`),children:"Add Prescription"}),h.jsx("button",{className:"cancel w-full h-auto p-2 bg-orange-500 font-medium flex items-center justify-center",onClick:l=>r(`/doctor/bookings/labtest/${t.patientId.userId}/${t._id}`),children:"Request Lab Tests"}),h.jsx("button",{className:"cancel w-full h-auto p-2 bg-orange-500 font-medium flex items-center justify-center",onClick:l=>r(`/doctor/bookings/medicine/${t.patientId._id}/${t._id}`),children:"Request Medicines"})]})]})]})})}function d5e(){const[e,t]=T.useState([]),r=async()=>{const n=await Pwe();t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsx("div",{className:"w-full h-full flex flex-col gap-4 p-5",children:e.length>0&&e.map((n,i)=>h.jsx("div",{className:"w-[90%] h-[25vh]",children:h.jsx(l5e,{booking:n})},i))})})}const a2="http://localhost:5000/api",c2=sessionStorage.getItem("token"),u5e=async({patientId:e})=>{var t,r,n;try{return(await Ce.post(`${a2}/doctor/patient/getDetails`,{patientId:e},{headers:{authorization:`bearer ${c2}`}})).data.patientDetails}catch(i){return console.log(i),((t=i==null?void 0:i.response)==null?void 0:t.status)=="500"&&((n=(r=i==null?void 0:i.response)==null?void 0:r.data)!=null&&n.errorServer)&&oe.fire("Server Error","","error"),!1}},h5e=async({patientId:e,disease:t,prescription:r,bookingId:n})=>{var i,o,s;try{const a=await Ce.post(`${a2}/doctor/patient/prescription/add`,{patientId:e,disease:t,prescription:r,bookingId:n},{headers:{authorization:`bearer ${c2}`}});return!0}catch(a){return console.log(a),((i=a==null?void 0:a.response)==null?void 0:i.status)=="500"&&((s=(o=a==null?void 0:a.response)==null?void 0:o.data)!=null&&s.errorServer)&&oe.fire("Server Error","","error"),!1}},p5e=async({bookingId:e})=>{var t,r,n;try{const i=await Ce.post(`${a2}/doctor/patient/prescription/onLoad/view`,{bookingId:e},{headers:{authorization:`bearer ${c2}`}});return console.log(i),i.data.prescription}catch(i){return console.log(i),((t=i==null?void 0:i.response)==null?void 0:t.status)=="500"&&((n=(r=i==null?void 0:i.response)==null?void 0:r.data)!=null&&n.errorServer)&&oe.fire("Server Error","","error"),!1}};function f5e(){const[e,t]=T.useState(void 0),{patientId:r,bookingId:n}=sy(),i=Yi({initialValues:{disease:"",prescription:""},validationSchema:"",onSubmit:async(s,a)=>{await h5e({...s,patientId:r,bookingId:n})&&oe.fire("Added Prescription","","success")}}),o=async()=>{const s=await u5e({patientId:r}),a=await p5e({bookingId:n});a&&(i.setFieldValue("disease",a.disease),i.setFieldValue("prescription",a.prescription)),t(s)};return T.useEffect(()=>{o()},[]),h.jsx("div",{className:"w-full h-full flex ",children:h.jsx("div",{className:"w-full h-full flex flex-col gap-2",children:h.jsxs("div",{className:"patient profile w-full h-full flex flex-col gap-4",children:[h.jsxs("div",{className:"w-full h-[10vh] flex gap-10 items-center",children:[h.jsx("div",{className:"w-[5vw] h-[10vh] ",children:h.jsx("img",{src:e==null?void 0:e.profileImage,alt:"patientprofile",className:"w-full h-full rounded-full"})}),h.jsx("div",{className:"details w-full h-full flex flex-col justify-center ",children:h.jsx("h1",{className:"w-full h-[70%] pl-10 bg-blue-500 flex items-center text-lg font-medium",children:`${e==null?void 0:e.firstName} ${e==null?void 0:e.lastName}`})})]}),h.jsx("div",{className:"prescription w-full h-full flex",children:h.jsx("div",{className:"w-full h-full flex justify-center bg-black bg-opacity-30",children:h.jsxs("form",{onSubmit:i.handleSubmit,className:"w-[70%] h-full p-4 flex flex-col gap-5",children:[h.jsx("h1",{className:"w-full h-[5vh] pl-10 bg-orange-500 flex items-center text-lg font-medium",children:"Prescription"}),h.jsx(Je,{variant:"filled",label:"disease",name:"disease",value:i.values.disease,onChange:i.handleChange,onBlur:i.handleBlur}),h.jsx("textarea",{rows:"10",placeholder:"Prescription",name:"prescription",value:i.values.prescription,onChange:i.handleChange,onBlur:i.handleBlur}),h.jsx("button",{className:"bg-orange-500 w-[50%] h-[7vh]",type:"submit",children:"Add"})]})})})]})})})}const d1="http://localhost:5000/api",m5e=sessionStorage.getItem("token"),g5e=async()=>{try{const e=await Ce.get(`${d1}/patient/medicines/getAllMedicines`);return console.log(e),e.data.medicines}catch(e){console.log(e)}},y5e=async({patientId:e,pharmacyInventoryId:t,bookingId:r})=>{var n,i,o;try{const s=await Ce.post(`${d1}/doctor/patient/medicine/request`,{patientId:e,pharmacyInventoryId:t,bookingId:r},{headers:{Authorization:`bearer ${m5e}`}});return console.log(s),!0}catch(s){return console.log(s),((n=s==null?void 0:s.response)==null?void 0:n.status)=="500"&&((o=(i=s==null?void 0:s.response)==null?void 0:i.data)!=null&&o.errorServer)&&oe.fire("Server Error","","error"),!1}};function v5e(e){const{medicine:t,patientId:r,bookingId:n}=e,i=async(o,s)=>{await y5e({patientId:r,bookingId:n,pharmacyInventoryId:s._id})&&oe.fire("Requested Medicine","","success")};return h.jsx("div",{className:"w-[18vw] h-full flex flex-col shadow-lg rounded-lg ",children:h.jsxs("div",{className:"h-full w-full flex flex-col ",children:[h.jsx("div",{className:"w-full h-[50%] ",children:h.jsx("img",{src:t.medicineImage,className:"w-full h-full rounded-t-lg"})}),h.jsxs("div",{className:"content w-full h-[50%] flex flex-1 flex-col mt-2 ",children:[h.jsxs("div",{className:"content w-full h-full flex flex-col pl-4 gap-2  ",children:[h.jsx("h1",{className:"w-full flex justify-start font-medium text-md",children:t.medicineId.medicineName}),h.jsx("div",{className:"w-full font-medium flex flex-col gap-4 flex-1 ",children:h.jsx("div",{className:"price w-full h-[5vh]",children:h.jsxs("h1",{className:"w-full h-full flex gap-2 items-center text-xl",children:[h.jsx(Zf,{})," ",t.sellingPrice]})})})]}),h.jsx("div",{className:"w-full h-[10vh] flex  px-2 py-1 mb-2 ",children:h.jsx("button",{className:"w-full h-full  font-medium bg-orange-500  border",onClick:o=>i(o,t),children:"Prescribe Medicine"})})]})]})})}function E5e(){Ln();const{patientId:e,bookingId:t}=sy(),[r,n]=T.useState([]),i=async()=>{const o=await g5e();o.length>0&&await n(o)};return T.useEffect(()=>{i()},[]),h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"medicinesList w-full h-full flex flex px-20 py-5 ",children:h.jsx("div",{className:"w-full h-full p-4 grid grid-cols-3 justify-items-center gap-y-10 ",children:r&&r.length>0?r.map((o,s)=>h.jsx("div",{className:"w-auto h-[40vh] flex flex-col cursor-pointer hover:bg-slate-400 rounded-lg",children:h.jsx(v5e,{medicine:o,patientId:e,bookingId:t},o._id)},o._id)):h.jsx("span",{className:"text-lg font-medium",children:"No Medicines.....:)"})})})})}function _5e(e){const{order:t}=e,r=async(n,i)=>{const o=await jq({amount:t.doctorId.bookingPrice});if(o){const s=Ibe({order:o,medicineOrder:t});await new Razorpay(s).open()}};return h.jsx("div",{className:"w-[18vw] h-full flex flex-col shadow-lg rounded-lg ",children:h.jsxs("div",{className:"h-full w-full flex flex-col ",children:[h.jsx("div",{className:"w-full h-[50%] ",children:h.jsx("img",{src:t.pharmacyInventoryId.medicineImage,className:"w-full h-full rounded-t-lg"})}),h.jsxs("div",{className:"content w-full h-[50%] flex flex-1 flex-col mt-2 ",children:[h.jsxs("div",{className:"content w-full h-full flex flex-col pl-4 gap-2  ",children:[h.jsx("h1",{className:"w-full flex justify-start font-medium text-md",children:t.pharmacyInventoryId.medicineId.medicineName}),h.jsx("div",{className:"w-full font-medium flex flex-col gap-4 flex-1 ",children:h.jsx("div",{className:"price w-full h-[5vh]",children:h.jsxs("h1",{className:"w-full h-full flex gap-2 items-center text-xl",children:[h.jsx(Zf,{})," ",t.pharmacyInventoryId.sellingPrice]})})})]}),h.jsx("div",{className:"w-full h-[10vh] flex  px-2 py-1 mb-2 ",children:h.jsx("button",{className:"w-full h-full  font-medium bg-orange-500  border",onClick:n=>r(n,t.pharmacyInventoryId._id),children:"Order Medicine"})})]})]})})}function b5e(){const[e,t]=T.useState([]),r=async()=>{const n=await z_e();console.log(n),n&&t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"w-full h-full flex flex-col gap-2",children:[h.jsx("h1",{className:"w-full h-[6vh] bg-blue-500 flex items-center pl-10",children:"Prescribed Medicines"}),h.jsx("div",{className:"w-full h-full flex gap-4",children:(e==null?void 0:e.length)>0&&e.map((n,i)=>h.jsx("div",{className:"w-auto h-auto flex",children:h.jsx(_5e,{order:n})},i))})]})})}function w5e(){return h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"options w-full flex justify-start gap-10",children:[h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-blue-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"requests",children:"Requests"}),h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-red-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"ordered",children:"Ordered"})]})})}function S5e(){return h.jsxs("div",{className:"w-full h-full flex flex-col gap-5 overflow-y-auto",children:[h.jsx("div",{className:"header w-full h-[5vh]",children:h.jsx(w5e,{})}),h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx(po,{})})]})}function T5e(e){var r,n;const{order:t}=e;return h.jsx("div",{className:"w-[18vw] h-full flex flex-col shadow-xl rounded-lg border  ",children:h.jsxs("div",{className:"h-full w-full flex flex-col ",children:[h.jsx("div",{className:"w-full h-[50%] ",children:h.jsx("img",{src:t.pharmacyInventoryId.medicineImage,className:"w-full h-full rounded-t-lg"})}),h.jsxs("div",{className:"content w-full h-[50%] flex flex-1 flex-col mt-2 ",children:[h.jsxs("div",{className:"content w-full h-full flex flex-col pl-4 gap-2  ",children:[h.jsx("h1",{className:"w-full flex justify-start font-medium text-md",children:(n=(r=t==null?void 0:t.pharmacyInventoryId)==null?void 0:r.medicineId)==null?void 0:n.medicineName}),h.jsx("div",{className:"w-full font-medium flex flex-col gap-4 flex-1 ",children:h.jsx("div",{className:"price w-full h-[5vh]",children:h.jsxs("h1",{className:"w-full h-full flex gap-2 items-center text-xl",children:[h.jsx(Zf,{})," ",t.pharmacyInventoryId.sellingPrice]})})})]}),h.jsx("div",{className:"w-full h-[8vh] flex  px-2 py-1 mb-2 ",children:h.jsx("h2",{className:"text-md font-bold text-emerald-500 w-full p-5 bg-blue-100",children:(t==null?void 0:t.orderStatus)=="1"?"Pending Delivery":"Delivered"})})]})]})})}function C5e(){const[e,t]=T.useState([]),r=async()=>{const n=await q_e();console.log(n),n&&t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsx("div",{className:"w-full h-full flex flex-col gap-2",children:h.jsx("div",{className:"w-full h-full grid grid-cols-3 gap-4",children:(e==null?void 0:e.length)>0&&e.map((n,i)=>h.jsx("div",{className:"w-auto h-auto flex",children:h.jsx(T5e,{order:n})},i))})})})}function R5e(){return h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"options w-full flex justify-start gap-10",children:[h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-blue-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"requested",children:"Received"}),h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-red-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"delivered",children:"Delivered"})]})})}function I5e(){return h.jsxs("div",{className:"w-full h-full flex flex-col overflow-y-scroll",children:[h.jsx("div",{className:"w-full h-[8vh] p-5",children:h.jsx(R5e,{})}),h.jsx("div",{className:"w-full h-full mt-5 pb-2",children:h.jsx(po,{})})]})}const l2="http://localhost:5000/api",d2=sessionStorage.getItem("token"),A5e=async()=>{try{const e=await Ce.get(`${l2}/pharmacy/order/medicines/requests`,{headers:{Authorization:`bearer ${d2}`}});return console.log(e),e.data.medicines}catch(e){return console.log(e),!1}},x5e=async({pharmacyInventoryId:e})=>{try{const t=await Ce.post(`${l2}/pharmacy/order/medicines/deliver`,{pharmacyInventoryId:e},{headers:{Authorization:`bearer ${d2}`}});return!0}catch(t){return console.log(t),!1}},O5e=async()=>{try{const e=await Ce.get(`${l2}/pharmacy/order/medicines/delivered`,{headers:{Authorization:`bearer ${d2}`}});return console.log(e),e.data.medicines}catch(e){return console.log(e),!1}};function N5e(e){const{order:t}=e,r=async n=>{await x5e({pharmacyInventoryId:t.pharmacyInventoryId})&&oe.fire("Updated as Delivered","","success")};return h.jsx("div",{className:"w-full h-full flex flex-col shadow-xl rounded-lg border ",children:h.jsxs("div",{className:"h-full w-full flex gap-2 ",children:[h.jsx("div",{className:"w-[30%] h-full ",children:h.jsx("img",{src:t==null?void 0:t.pharmacyInventoryId.medicineImage,className:"w-full h-full rounded-t-lg"})}),h.jsxs("div",{className:"content w-full h-full flex flex-1 flex-col gap-4 mt-2 p-1 ",children:[h.jsxs("div",{className:"w-full h-auto flex gap-10 items-center p-2 bg-blue-500",children:[h.jsx("div",{className:"w-[3vw] h-[6vh]",children:h.jsx("img",{src:t.patientId.profileImage,alt:"",className:"w-full h-full rounded-full"})}),h.jsxs("div",{className:"w-auto h-auto",children:[h.jsx("h2",{className:"text-lg font-medium",children:`${t.patientId.firstName} ${t.patientId.lastName}`}),h.jsx("h2",{})]})]}),h.jsx("div",{className:"content w-full h-[10vh] flex flex-col pl-4 gap-2  ",children:h.jsx("h1",{className:"w-full flex justify-start font-medium text-md",children:t==null?void 0:t.pharmacyInventoryId.medicineId.medicineName})}),h.jsx("div",{className:"w-full h-[8vh] flex  px-2 py-1 mb-2 ",children:h.jsx("button",{className:"w-full h-full  font-medium bg-orange-500  border",onClick:n=>r(),children:"Delivered"})})]})]})})}function k5e(){const[e,t]=T.useState([]),r=async()=>{const n=await A5e();n&&t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex p-2",children:h.jsx("div",{className:"w-full h-full flex flex-col gap-5",children:h.jsx("div",{className:"orders w-full h-full flex flex-col",children:h.jsx("div",{className:"w-full h-full grid grid-cols-1",children:e.length>0&&e.map((n,i)=>h.jsx("div",{className:"w-[80%] h-[30vh]",children:h.jsx(N5e,{order:n})},i))})})})})}function P5e(e){const{order:t}=e;return h.jsx("div",{className:"w-full h-full flex flex-col shadow-xl rounded-lg border ",children:h.jsxs("div",{className:"h-full w-full flex gap-2 ",children:[h.jsx("div",{className:"w-[30%] h-full ",children:h.jsx("img",{src:t==null?void 0:t.pharmacyInventoryId.medicineImage,className:"w-full h-full rounded-t-lg"})}),h.jsxs("div",{className:"content w-full h-full flex flex-1 flex-col gap-4 mt-2 p-1 ",children:[h.jsxs("div",{className:"w-full h-auto flex gap-10 items-center p-2 bg-blue-500",children:[h.jsx("div",{className:"w-[3vw] h-[6vh]",children:h.jsx("img",{src:t.patientId.profileImage,alt:"",className:"w-full h-full rounded-full"})}),h.jsxs("div",{className:"w-auto h-auto",children:[h.jsx("h2",{className:"text-lg font-medium",children:`${t.patientId.firstName} ${t.patientId.lastName}`}),h.jsx("h2",{})]})]}),h.jsx("div",{className:"content w-full h-[10vh] flex flex-col pl-4 gap-2  ",children:h.jsx("h1",{className:"w-full flex justify-start font-medium text-md",children:t==null?void 0:t.pharmacyInventoryId.medicineId.medicineName})}),h.jsx("div",{className:"w-full h-[8vh] flex  px-2 py-1 mb-2 ",children:h.jsx("h2",{className:"text-md font-bold text-emerald-500 w-full p-5 bg-blue-100",children:"Delivered"})})]})]})})}function D5e(){const[e,t]=T.useState([]),r=async()=>{const n=await O5e();n&&t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex p-2",children:h.jsx("div",{className:"w-full h-full flex flex-col gap-5",children:h.jsx("div",{className:"orders w-full h-full flex flex-col",children:h.jsx("div",{className:"w-full h-full grid grid-cols-1",children:e.length>0&&e.map((n,i)=>h.jsx("div",{className:"w-[80%] h-[30vh]",children:h.jsx(P5e,{order:n})},i))})})})})}const u2="http://localhost:5000/api",h2=sessionStorage.getItem("token"),L5e=async()=>{var e,t,r;try{return(await Ce.get(`${u2}/doctor/patient/test/allTests`,{headers:{Authorization:`bearer ${h2}`}})).data.tests}catch(n){return console.log(n),((e=n==null?void 0:n.response)==null?void 0:e.status)=="500"&&((r=(t=n==null?void 0:n.response)==null?void 0:t.data)!=null&&r.errorServer)&&oe.fire("Server Error","","error"),!1}},M5e=async({testId:e})=>{try{const t=await Ce.post(`${u2}/doctor/patient/test/testDetails`,{testId:e},{headers:{Authorization:`bearer ${h2}`}});return console.log(t.data),t.data.testAndLabs}catch(t){return console.log(t),t.status=="500"&&t.response.status.errorServer?oe.fire({icon:"error",text:"Server Issue"}):t.status=="400"&&t.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):t.status=="401"?oe.fire({icon:"warning",text:"Log In"}):t.status=="404"&&t.response.data.errorTestPresent&&oe.fire({icon:"warning",text:"Test can't be found at database"}),!1}},j5e=async({labTestId:e,patientId:t,bookingId:r})=>{var n,i;try{const o=await Ce.post(`${u2}/doctor/patient/test/request`,{labTestId:e,patientId:t,bookingId:r},{headers:{Authorization:`bearer ${h2}`}});return!0}catch(o){return console.log(o),o.status=="500"&&((i=(n=o==null?void 0:o.response)==null?void 0:n.data)!=null&&i.errorServer)?oe.fire({icon:"error",text:"Server Issue"}):o.status=="400"&&o.response.data.invalidToken?oe.fire({icon:"warning",text:"Log In"}):o.status=="401"?oe.fire({icon:"warning",text:"Log In"}):o.status=="404"&&o.response.data.errorTestPresent?oe.fire({icon:"warning",text:"Test can't be found at database"}):o.status=="404"&&o.response.data.errorTestOrdered&&oe.fire({icon:"warning",text:"Test Already Ordered"}),!1}};function U5e(e){var o;const{test:t,patientId:r,bookingId:n}=e,i=async s=>{await j5e({labTestId:t._id,patientId:r,bookingId:n})&&oe.fire("Requested Test for the patient","","success")};return h.jsx("div",{className:"flex w-full h-full ",children:h.jsxs("div",{className:"flex h-full w-[40vw] gap-6 bg-white  border rounded-lg p-4 shadow-lg",children:[h.jsx("div",{className:"image w-[20%] h-[90%]",children:h.jsx("img",{src:"/normalUser.png",alt:"image",className:"object-fit w-full h-full"})}),h.jsxs("div",{className:"details h-full w-full flex flex-1 flex-col gap-4 ",children:[h.jsx("h1",{children:(o=t==null?void 0:t.labId)==null?void 0:o.userId.username}),h.jsx("div",{className:"location"}),h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx(Oy,{}),h.jsx("span",{children:"Koovappally"})]}),h.jsxs("div",{className:"flex gap-2 w-full h-auto",children:[(t==null?void 0:t.atHome)&&h.jsxs("button",{className:"w-[50%] text-white text-md font-medium bg-orange-400 p-3 rounded-md flex gap-4 items-center",children:[h.jsx("span",{children:" Home Service"}),h.jsxs("span",{className:"flex gap-2 items-center",children:[h.jsx(jb,{}),h.jsx("h6",{children:t==null?void 0:t.priceHome})]})]}),(t==null?void 0:t.atLab)&&h.jsxs("button",{className:"w-[50%] text-white text-md font-medium bg-blue-400 p-3 rounded-md flex gap-4 items-center",children:[h.jsx("span",{children:" Lab Service"}),h.jsxs("span",{className:"flex gap-2 items-center",children:[h.jsx(jb,{}),h.jsx("h6",{children:t==null?void 0:t.priceLab})]})]}),h.jsx("button",{className:"w-[30%] text-white text-md font-medium bg-emerald-400 p-3 rounded-md flex gap-4 items-center",onClick:s=>i(),children:"Request Test"})]})]})]})})}function F5e(){const[e,t]=T.useState([]),[r,n]=T.useState(void 0),{patientId:i,bookingId:o,testId:s}=sy();console.log("testId",s);const a=async()=>{const c=await M5e({testId:s});t(c),n(c[0].testId)};return T.useEffect(()=>{a()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"screen w-full h-full flex  gap-2 justify-between ",children:[h.jsxs("div",{className:"w-[56%] h-[80vh] flex gap-10 border p-4 shadow-lg items-center bg-emerald-400 bg-opacity-10 bg-blur-sm",children:[h.jsx("div",{className:"image h-[40vh] w-[70%]",children:h.jsx("img",{src:r==null?void 0:r.testImage,alt:"testImage",className:"w-full h-full object-fit"})}),h.jsxs("div",{className:"testDetails flex flex-col gap-2 w-full h-full justify-center",children:[h.jsxs("div",{className:"description w-full h-[10vh] border shadow-lg flex flex-col gap-2 px-1",children:[h.jsx("h2",{className:"flex w-full justify-start text-md font-medium opacity-40",children:"Test Name"}),h.jsx("span",{className:"text-lg font-medium",children:r==null?void 0:r.testName.toUpperCase()})]}),h.jsxs("div",{className:"testDescription flex flex-col gap-2 border w-full h-[40vh] shadow-lg px-1",children:[h.jsx("h2",{className:"flex w-full justify-start text-md font-medium opacity-40",children:"Test Description"}),h.jsx("span",{className:"h-[10vh] p-2",children:r==null?void 0:r.testDescription})]})]})]}),h.jsxs("div",{className:"laboratorys bg-black bg-opacity-10 p-3 flex flex-col gap-4 w-auto h-full border  ",children:[h.jsx("h2",{className:"text-lg text-white  font-medium flex justify-center bg-blue-500 py-2",children:"Labs where the service available"}),h.jsx("div",{className:"labs flex flex-col gap-4 h-full w-full overflow-y-auto",children:(e==null?void 0:e.length)>0&&e.map((c,l)=>h.jsx("div",{className:"w-full h-auto",children:h.jsx(U5e,{test:c,patientId:i,bookingId:o})},l))})]})]})})}function V5e(e){const{test:t,patientId:r,bookingId:n}=e;return h.jsx("div",{className:"flex w-auto h-auto border rounded-lg shadow-lg shadow-emerald-300 hover:bg-black hover:bg-opacity-10 py-5 px-3 cursor-pointer   ",children:h.jsxs("div",{className:"w-[30vw] h-auto flex flex-row gap-5 ",children:[h.jsx("div",{className:"image w-[50%] h-full flex justify-center items-center",children:h.jsx("img",{src:t==null?void 0:t.testImage,alt:"testImage",className:"object-cover w-full h-[70%]"})}),h.jsxs("div",{className:"w-full h-full content flex flex-col gap-5 bg-black bg-opacity-10 p-4",children:[h.jsx("h2",{className:"flex justify-center text-white bg-blue-500 py-3 font-medium",children:t==null?void 0:t.testName}),h.jsx("textarea",{name:"testDescription",id:"id_testDescripion",value:t==null?void 0:t.testDescription,rows:"10",className:"flex text-sm cursor-pointer border-0",disabled:!0})]})]})})}function B5e(){const[e,t]=T.useState([]),r=Ln(),{patientId:n,bookingId:i}=sy(),o=async()=>{const s=await L5e();t(s)};return T.useEffect(()=>{o()},[]),h.jsx("div",{className:"flex flex-col w-full h-full",children:h.jsx("div",{className:"w-full h-full grid grid-cols-2 gap-2 justify-items-start",children:(e==null?void 0:e.length)>0&&e.map((s,a)=>h.jsx("div",{className:"w-auto h-auto cursor-pointer",onClick:()=>r(`/doctor/bookings/labtest/testDetails/${n}/${i}/${s._id}`),children:h.jsx(V5e,{test:s,patientId:n,bookingId:i})},a))})})}function $5e(){return h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"options w-full flex justify-start gap-10",children:[h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-blue-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"requests",children:"Requests"}),h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-red-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"",children:"Ordered"})]})})}function H5e(){return h.jsxs("div",{className:"w-full h-full flex flex-col gap-5 overflow-y-auto",children:[h.jsx("div",{className:"header w-full h-[5vh]",children:h.jsx($5e,{})}),h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx(po,{})})]})}function W5e(e){var n,i,o,s,a,c,l,d,u,p,f,m;const{testOrder:t}=e;console.log(t);const r=async(g,y)=>{await _we({testOrderId:y})&&oe.fire("Successfully Ordered Test","","success")};return h.jsx("div",{className:"w-full h-full flex ",children:h.jsxs("div",{className:"w-full h-full flex flex-col gap-2 p-1 border border-black rounded-lg p-2 shadow-lg",children:[h.jsxs("div",{className:"w-full h-auto flex gap-2",children:[h.jsx("div",{className:"img w-[30%] h-full",children:h.jsx("img",{src:(i=(n=t==null?void 0:t.labTestId)==null?void 0:n.testId)==null?void 0:i.testImage,alt:"test image",className:"w-full h-full object-fit"})}),h.jsxs("div",{className:"content w-auto h-auto flex flex-col gap-2",children:[h.jsx("div",{className:"w-full h-auto flex ",children:h.jsxs("div",{className:"w-full h-auto grid grid-cols-2 gap-2",children:[h.jsx("h1",{className:"w-full h-auto p-1 bg-blue-500 flex justify-center",children:(s=(o=t==null?void 0:t.labTestId)==null?void 0:o.testId)==null?void 0:s.testName}),h.jsx("button",{className:"w-full h-auto p-1 bg-orange-500 flex justify-center",children:`booking ${t==null?void 0:t.bookingId._id}`})]})}),h.jsxs("div",{className:"testDetails w-full h-[80%] flex gap-2",children:[h.jsx("div",{className:"description w-[60%] bg-black bg-opacity-20 p-2",children:h.jsx("h2",{className:"w-full h--full",children:(c=(a=t==null?void 0:t.labTestId)==null?void 0:a.testId)==null?void 0:c.testDescription})}),h.jsxs("div",{className:"pharmacy w-[40%] flex flex-col gap-2 p-1",children:[h.jsxs("div",{className:"w-full h-[7vh] flex gap-6 justify-end items-center bg-black bg-opacity-20 border p-2 ",children:[h.jsx("div",{className:"w-[3vw] h-[6vh] flex items-center",children:h.jsx("img",{src:((d=(l=t==null?void 0:t.labTestId)==null?void 0:l.labId)==null?void 0:d.profileImage)||"/normalUser.png",alt:"test image",className:"w-[3vw] h-[6vh] object-fit rounded-full"})}),h.jsx("div",{className:"w-full h-full flex flex-1 items-center flex justify-end pr-4 ",children:(p=(u=t==null?void 0:t.labTestId)==null?void 0:u.labId)==null?void 0:p.laboratoryName})]}),h.jsx("div",{className:"address w-full h-auto flex gap-6 justify-end items-center border items-center bg-black bg-opacity-20 border",children:h.jsxs("div",{className:"w-full h-auto flex justify-between gap-8 p-4",children:[h.jsx(BP,{className:"w-[3vw]"}),h.jsx("h3",{className:"flex ",children:"koovappally"})]})}),h.jsxs("div",{className:"w-full h-[7vh] flex gap-6 justify-end items-center bg-black bg-opacity-20 border p-2",children:[h.jsx("div",{className:"w-[3vw] h-[6vh] flex items-center",children:h.jsx("img",{src:((f=t==null?void 0:t.doctorId)==null?void 0:f.profileImage)||"/normalUser.png",alt:"test image",className:"w-[3vw] h-[6vh] object-fit rounded-full"})}),h.jsx("div",{className:"w-full h-full flex flex-1 items-center flex justify-end pr-4 ",children:`prescribed by the doctor ${(m=t==null?void 0:t.doctorId)==null?void 0:m.firstName}`})]})]})]})]})]}),h.jsx("div",{className:"w-full h-[5vh] flex gap-2",children:h.jsx("button",{className:"w-full h-full p-4 bg-emerald-500 flex justify-center items-center",onClick:g=>r(g,t._id),children:"Order Test"})})]})})}function G5e(){const[e,t]=T.useState([]),r=async()=>{const n=await Ewe();console.log(n),n&&await t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"requestedTests flex flex-col gap-4",children:e.length>0&&e.map((n,i)=>h.jsx("div",{className:"w-[90%] h-auto",children:h.jsx(W5e,{testOrder:n})},i))})})})}function z5e(){return h.jsx("div",{className:"w-full h-full flex",children:h.jsxs("div",{className:"options w-full flex justify-start gap-10",children:[h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-blue-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"test/ordered",children:"Received"}),h.jsx(Kr,{className:"w-auto h-auto px-16 py-6 text-md font-medium bg-red-500 flex justify-center items-center shadow-lg shadow-emerald-400",to:"test/completed",children:"Serviced"})]})})}function K5e(){return h.jsxs("div",{className:"w-full h-full flex flex-col overflow-y-scroll",children:[h.jsx("div",{className:"w-full h-[8vh] p-5",children:h.jsx(z5e,{})}),h.jsx("div",{className:"w-full h-full mt-5 pb-2",children:h.jsx(po,{})})]})}function q5e(e){var n,i,o,s,a,c,l,d,u,p,f,m,g,y,v,E;const{testOrder:t}=e;console.log(t);const r=async(w,S)=>{await awe({testOrderId:S})&&oe.fire("Successfully Updated as completed","","success")};return h.jsx("div",{className:"w-full h-full flex ",children:h.jsxs("div",{className:"w-full h-full flex flex-col gap-2 p-1 border border-black rounded-lg p-2 shadow-lg",children:[h.jsxs("div",{className:"w-full h-auto flex gap-2",children:[h.jsx("div",{className:"img w-[30%] h-full",children:h.jsx("img",{src:(i=(n=t==null?void 0:t.labTestId)==null?void 0:n.testId)==null?void 0:i.testImage,alt:"test image",className:"w-full h-full object-fit"})}),h.jsxs("div",{className:"content w-auto h-auto flex flex-col gap-2",children:[h.jsx("div",{className:"w-full h-auto flex ",children:h.jsxs("div",{className:"w-full h-auto grid grid-cols-2 gap-2",children:[h.jsx("h1",{className:"w-full h-auto p-1 bg-blue-500 flex justify-center",children:(s=(o=t==null?void 0:t.labTestId)==null?void 0:o.testId)==null?void 0:s.testName}),h.jsx("button",{className:"w-full h-auto p-1 bg-orange-500 flex justify-center",children:`booking ${t==null?void 0:t.bookingId._id}`})]})}),h.jsxs("div",{className:"testDetails w-full h-[80%] flex gap-2",children:[h.jsx("div",{className:"description w-[40%] bg-black bg-opacity-20 p-2",children:h.jsx("h2",{className:"w-full h--full",children:(c=(a=t==null?void 0:t.labTestId)==null?void 0:a.testId)==null?void 0:c.testDescription})}),h.jsxs("div",{className:"pharmacy w-[30%] flex flex-col gap-2 p-1",children:[h.jsxs("div",{className:"w-full h-[7vh] flex gap-6 justify-end items-center bg-black bg-opacity-20 border p-2 ",children:[h.jsx("div",{className:"w-[3vw] h-[6vh] flex items-center",children:h.jsx("img",{src:((d=(l=t==null?void 0:t.labTestId)==null?void 0:l.labId)==null?void 0:d.profileImage)||"/normalUser.png",alt:"test image",className:"w-[3vw] h-[6vh] object-fit rounded-full"})}),h.jsx("div",{className:"w-full h-full flex flex-1 items-center flex justify-end pr-4 ",children:(p=(u=t==null?void 0:t.labTestId)==null?void 0:u.labId)==null?void 0:p.laboratoryName})]}),h.jsxs("div",{className:"w-full h-[7vh] flex gap-6 justify-end items-center bg-black bg-opacity-20 border p-2",children:[h.jsx("div",{className:"w-[3vw] h-[6vh] flex items-center",children:h.jsx("img",{src:((f=t==null?void 0:t.patientId)==null?void 0:f.profileImage)||"/normalUser.png",alt:"test image",className:"w-[3vw] h-[6vh] object-fit rounded-full"})}),h.jsx("div",{className:"w-full h-full flex flex-1 items-center flex justify-end pr-4 ",children:`Ordered by ${(m=t==null?void 0:t.patientId)==null?void 0:m.firstName}`})]})]}),h.jsxs("div",{className:"w-full h-full flex flex-1 bg-blue-400 flex-col gap-2 text-white",children:[h.jsx("div",{className:"address w-full h-auto flex gap-6 justify-end items-center border items-center bg-black bg-opacity-20 border",children:h.jsxs("div",{className:"w-full h-auto flex justify-between gap-8 p-4",children:[h.jsx(BP,{className:"w-[3vw]"}),h.jsx("h3",{className:"flex ",children:(y=(g=t==null?void 0:t.patientId)==null?void 0:g.addressId)==null?void 0:y.place})]})}),h.jsx("div",{className:"address w-full h-auto flex gap-6 justify-end items-center border items-center bg-black bg-opacity-20 border",children:h.jsxs("div",{className:"w-full h-auto flex justify-between gap-8 p-4",children:[h.jsx(xq,{className:"w-[3vw]"}),h.jsx("h3",{className:"flex ",children:(E=(v=t==null?void 0:t.patientId)==null?void 0:v.userId)==null?void 0:E.phone})]})})]})]})]})]}),h.jsxs("div",{className:"w-full h-[5vh] flex gap-2",children:[h.jsx("button",{className:"w-full h-full p-4 bg-emerald-500 flex justify-center items-center",onClick:w=>r(w,t._id),children:"Completed"}),h.jsx("button",{className:"w-full h-full p-4 bg-blue-500 flex justify-center items-center",children:"Upload test Result"})]})]})})}function Y5e(){const[e,t]=T.useState([]),r=async()=>{const n=await swe();t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"orders w-full h-full flex flex-col gap-5 p-5",children:e.length>0&&e.map((n,i)=>h.jsx("div",{className:"w-[90%] h-auto",children:h.jsx(q5e,{testOrder:n})},i))})})})}function X5e(e){var s,a,c,l,d,u,p,f,m,g,y,v,E,w,S,A;const[t,r]=T.useState(!1),{testOrder:n}=e;console.log(n);const i=Ln(),o=async()=>{await Vq({testOrderId:n._id})&&r(!0)};return T.useEffect(()=>{o()},[]),h.jsx("div",{className:"w-full h-full flex ",children:h.jsxs("div",{className:"w-full h-full flex flex-col gap-2 p-1 border border-black rounded-lg p-2 shadow-lg",children:[h.jsxs("div",{className:"w-full h-auto flex gap-2",children:[h.jsx("div",{className:"img w-[30%] h-full",children:h.jsx("img",{src:(a=(s=n==null?void 0:n.labTestId)==null?void 0:s.testId)==null?void 0:a.testImage,alt:"test image",className:"w-full h-full object-fit"})}),h.jsxs("div",{className:"content w-auto h-auto flex flex-col gap-2",children:[h.jsx("div",{className:"w-full h-auto flex ",children:h.jsxs("div",{className:"w-full h-auto grid grid-cols-2 gap-2",children:[h.jsx("h1",{className:"w-full h-auto p-1 bg-blue-500 flex justify-center",children:(l=(c=n==null?void 0:n.labTestId)==null?void 0:c.testId)==null?void 0:l.testName}),h.jsx("button",{className:"w-full h-auto p-1 bg-orange-500 flex justify-center",children:`booking ${n==null?void 0:n.bookingId._id}`})]})}),h.jsxs("div",{className:"testDetails w-full h-[80%] flex gap-2",children:[h.jsx("div",{className:"description w-[40%] bg-black bg-opacity-20 p-2",children:h.jsx("h2",{className:"w-full h--full",children:(u=(d=n==null?void 0:n.labTestId)==null?void 0:d.testId)==null?void 0:u.testDescription})}),h.jsxs("div",{className:"pharmacy w-[30%] flex flex-col gap-2 p-1",children:[h.jsxs("div",{className:"w-full h-[7vh] flex gap-6 justify-end items-center bg-black bg-opacity-20 border p-2 ",children:[h.jsx("div",{className:"w-[3vw] h-[6vh] flex items-center",children:h.jsx("img",{src:((f=(p=n==null?void 0:n.labTestId)==null?void 0:p.labId)==null?void 0:f.profileImage)||"/normalUser.png",alt:"test image",className:"w-[3vw] h-[6vh] object-fit rounded-full"})}),h.jsx("div",{className:"w-full h-full flex flex-1 items-center flex justify-end pr-4 ",children:(g=(m=n==null?void 0:n.labTestId)==null?void 0:m.labId)==null?void 0:g.laboratoryName})]}),h.jsxs("div",{className:"w-full h-[7vh] flex gap-6 justify-end items-center bg-black bg-opacity-20 border p-2",children:[h.jsx("div",{className:"w-[3vw] h-[6vh] flex items-center",children:h.jsx("img",{src:((y=n==null?void 0:n.patientId)==null?void 0:y.profileImage)||"/normalUser.png",alt:"test image",className:"w-[3vw] h-[6vh] object-fit rounded-full"})}),h.jsx("div",{className:"w-full h-full flex flex-1 items-center flex justify-end pr-4 ",children:`Ordered by ${(v=n==null?void 0:n.patientId)==null?void 0:v.firstName}`})]})]}),h.jsxs("div",{className:"w-full h-full flex flex-1 bg-blue-400 flex-col gap-2 text-white",children:[h.jsx("div",{className:"address w-full h-auto flex gap-6 justify-end items-center border items-center bg-black bg-opacity-20 border",children:h.jsxs("div",{className:"w-full h-auto flex justify-between gap-8 p-4",children:[h.jsx(BP,{className:"w-[3vw]"}),h.jsx("h3",{className:"flex ",children:(w=(E=n==null?void 0:n.patientId)==null?void 0:E.addressId)==null?void 0:w.place})]})}),h.jsx("div",{className:"address w-full h-auto flex gap-6 justify-end items-center border items-center bg-black bg-opacity-20 border",children:h.jsxs("div",{className:"w-full h-auto flex justify-between gap-8 p-4",children:[h.jsx(xq,{className:"w-[3vw]"}),h.jsx("h3",{className:"flex ",children:(A=(S=n==null?void 0:n.patientId)==null?void 0:S.userId)==null?void 0:A.phone})]})})]})]})]})]}),h.jsx("div",{className:"w-full h-[5vh] flex gap-2",children:h.jsx("button",{className:"w-full h-full p-4 bg-blue-500 flex justify-center items-center",onClick:N=>{var L;return i(`uploadResult?patientId=${n.patientId._id}&testOrderId=${n._id}&bookingId=${(L=n==null?void 0:n.bookingId)==null?void 0:L._id}&doctorId=${n.doctorId._id}`)},children:t?"View Uploaded result":"Upload test Result"})})]})})}function J5e(){const[e,t]=T.useState([]),r=async()=>{const n=await cwe();t(n)};return T.useEffect(()=>{r()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx("div",{className:"orders w-full h-full flex flex-col gap-5 p-5",children:e.length>0&&e.map((n,i)=>h.jsx("div",{className:"w-[90%] h-auto",children:h.jsx(X5e,{testOrder:n})},i))})})})}function Q5e(){var l,d;const e=Ln(),t=new URLSearchParams(location.search),r=t.get("testOrderId"),n=t.get("patientId"),i=t.get("doctorId");console.log("doctorId",i);const[o,s]=T.useState(void 0),a=Yi({initialValues:{testResultDescription:""},validationSchema:uwe,onSubmit:async(u,p)=>{await dwe({...u,testOrderId:r,patientId:n,doctorId:i})&&(oe.fire("Result uploaded successfully","","success"),e("/laboratory/order/test/completed"))}}),c=async()=>{const u=await lwe({testOrderId:r}),p=await Vq({testOrderId:r});p&&a.setFieldValue("testResultDescription",p.testResultDescription),s(u)};return T.useEffect(()=>{c()},[]),h.jsx("div",{className:"w-full h-full flex",children:h.jsx("div",{className:"w-full h-full flex flex-col gap-2 p-10",children:h.jsxs("form",{onSubmit:a.handleSubmit,className:"flex flex-col gap-10",children:[h.jsx("h1",{className:"w-full h-[8vh] p-2 flex items-center justify-center text-white text-lg font-bold bg-blue-500",children:`Test Result for the Request from ${(l=o==null?void 0:o.doctorId)==null?void 0:l.firstName} for ${(d=o==null?void 0:o.patientId)==null?void 0:d.firstName}`}),h.jsx("textarea",{rows:15,name:"testResultDescription",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.testResultDescription}),a.touched.testResultDescription&&a.errors.testResultDescription?h.jsx("span",{className:"text-red",children:a.errors.testResultDescription}):"",h.jsx("div",{className:"w-full h-[5vh] flex",children:h.jsx("button",{className:"w-full h-full flex items-center justify-center bg-orange-500",children:"Upload Result"})})]})})})}function Z5e(){return h.jsx(h.Fragment,{children:h.jsx(zre,{children:h.jsxs(Ure,{children:[h.jsx(ot,{path:"/login",element:h.jsx(Bve,{})}),h.jsx(ot,{path:"/register",element:h.jsx(Jve,{})}),"//Patient",h.jsxs(ot,{path:"/",element:h.jsx(u_e,{}),children:[h.jsx(ot,{path:"/patient/medicines",element:h.jsx(Y_e,{})}),h.jsx(ot,{path:"/patient/medicines/medicineDetails",element:h.jsx(X_e,{})}),h.jsxs(ot,{path:"/patient/profile",element:h.jsx(Q_e,{}),children:[h.jsx(ot,{index:!0,path:"/patient/profile/details",element:h.jsx(tbe,{})}),h.jsx(ot,{path:"/patient/profile/contactDetails",element:h.jsx(rbe,{})}),h.jsx(ot,{path:"/patient/profile/bookings",element:h.jsx(Cwe,{}),children:h.jsx(ot,{path:"/patient/profile/bookings/currentBookings",element:h.jsx(xwe,{})})}),h.jsxs(ot,{path:"/patient/profile/medicine",element:h.jsx(S5e,{}),children:[h.jsx(ot,{path:"/patient/profile/medicine/requests",element:h.jsx(b5e,{})}),h.jsx(ot,{path:"/patient/profile/medicine/ordered",element:h.jsx(C5e,{})})]}),h.jsx(ot,{path:"/patient/profile/test",element:h.jsx(H5e,{}),children:h.jsx(ot,{path:"/patient/profile/test/requests",element:h.jsx(G5e,{})})})]}),h.jsx(ot,{path:"/patient/doctors",element:h.jsx(bbe,{}),children:h.jsx(ot,{path:"/patient/doctors/:doctorId",element:h.jsx(Abe,{})})}),"//test",h.jsx(ot,{path:"/patient/tests",element:h.jsx(bwe,{})}),h.jsx(ot,{path:"/patient/tests/testDetails",element:h.jsx(Swe,{})}),h.jsx(ot,{path:"/patient/treatmentPlan",element:h.jsx(Obe,{})}),h.jsx(ot,{path:"/patient/alerts",element:h.jsx(c5e,{})})]}),"//video",h.jsx(ot,{path:"/patient/bookings/videoConsult",element:h.jsx(i5e,{})}),"//pharmcacy",h.jsxs(ot,{path:"/pharmacy",element:h.jsx(R_e,{}),children:[h.jsx(ot,{path:"/pharmacy/home",element:h.jsx(zbe,{})}),h.jsx(ot,{path:"/pharmacy/stock/addCategory",element:h.jsx(S_e,{})}),h.jsx(ot,{path:"/pharmacy/stock/viewStocks",element:h.jsx(T_e,{})}),h.jsx(ot,{path:"/pharmacy/stock/editStock",element:h.jsx(I_e,{})}),h.jsxs(ot,{path:"/pharmacy/profile",element:h.jsx(U_e,{}),children:[h.jsx(ot,{path:"/pharmacy/profile/profileDetails",element:h.jsx(F_e,{})}),h.jsx(ot,{path:"/pharmacy/profile/contactDetails",element:h.jsx(V_e,{})}),h.jsx(ot,{path:"/pharmacy/profile/passwordReset",element:h.jsx($_e,{})})]}),h.jsxs(ot,{path:"/pharmacy/order",element:h.jsx(I5e,{}),children:[h.jsx(ot,{path:"/pharmacy/order/requested",element:h.jsx(k5e,{})}),h.jsx(ot,{path:"/pharmacy/order/delivered",element:h.jsx(D5e,{})})]})]}),"//Doctor",h.jsxs(ot,{path:"/doctor",element:h.jsx(dbe,{}),children:[h.jsx(ot,{path:"/doctor/slot",element:h.jsx(gbe,{})}),h.jsxs(ot,{path:"/doctor/profile",element:h.jsx(Ube,{}),children:[h.jsx(ot,{path:"/doctor/profile/details",element:h.jsx(Hbe,{})}),h.jsx(ot,{path:"/doctor/profile/contact",element:h.jsx(Wbe,{})}),h.jsx(ot,{path:"/doctor/profile/resetPassword",element:h.jsx(Gbe,{})})]}),h.jsxs(ot,{path:"/doctor/bookings",element:h.jsx(Nwe,{}),children:[h.jsx(ot,{path:"/doctor/bookings/currentBookings",element:h.jsx(Lwe,{})}),h.jsx(ot,{path:"/doctor/bookings/pastCompletedBookings",element:h.jsx(d5e,{})}),h.jsx(ot,{path:"/doctor/bookings/prescription/:patientId/:bookingId",element:h.jsx(f5e,{})}),h.jsx(ot,{path:"/doctor/bookings/medicine/:patientId/:bookingId",element:h.jsx(E5e,{})}),h.jsx(ot,{path:"/doctor/bookings/labtest/:patientId/:bookingId",element:h.jsx(B5e,{})}),h.jsx(ot,{path:"/doctor/bookings/labtest/testDetails/:patientId/:bookingId/:testId",element:h.jsx(F5e,{})})]})]}),"//Laboratory",h.jsxs(ot,{path:"/laboratory",element:h.jsx(Jbe,{}),children:[h.jsxs(ot,{path:"/laboratory/testServices",element:h.jsx(Zbe,{}),children:[h.jsx(ot,{path:"/laboratory/testServices/addTest",element:h.jsx(hwe,{})}),h.jsx(ot,{path:"/laboratory/testServices/viewTests",element:h.jsx(pwe,{})}),h.jsx(ot,{path:"/laboratory/testServices/editTestDetails",element:h.jsx(mwe,{})})]}),h.jsxs(ot,{path:"/laboratory/order",element:h.jsx(K5e,{}),children:[h.jsx(ot,{path:"/laboratory/order/test/ordered",element:h.jsx(Y5e,{})}),h.jsx(ot,{path:"/laboratory/order/test/completed",element:h.jsx(J5e,{})}),h.jsx(ot,{path:"/laboratory/order/test/completed/uploadResult",element:h.jsx(Q5e,{})})]})]})]})})})}const e4e={patient_meetingAlert:!1},t4e=dS({name:"alert",initialState:e4e,reducers:{setAlert(e,t){e.patient_meetingAlert=t.payload.patient_meetingAlert}}}),r4e=t4e.reducer,n4e=xpe({reducer:{user:$pe,patient:Nve,doctor:ibe,patient_alert:r4e}});nH(document.getElementById("root")).render(h.jsx(T.StrictMode,{children:h.jsx(epe,{store:n4e,children:h.jsx(Z5e,{})})}))});export default i4e();
